<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/stream-tcp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('stream-tcp_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">stream-tcp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf-yaml-loader_8h_source.html">conf-yaml-loader.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-pool_8h_source.html">util-pool.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-pool-thread_8h_source.html">util-pool-thread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-checksum_8h_source.html">util-checksum.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-print_8h_source.html">util-print.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-device_8h_source.html">util-device.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-inline_8h_source.html">stream-tcp-inline.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-sack_8h_source.html">stream-tcp-sack.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-util_8h_source.html">stream-tcp-util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pkt-var_8h_source.html">pkt-var.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="host_8h_source.html">host.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer_8h_source.html">app-layer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-protos_8h_source.html">app-layer-protos.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-htp-mem_8h_source.html">app-layer-htp-mem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-host-os-info_8h_source.html">util-host-os-info.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-misc_8h_source.html">util-misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-validate_8h_source.html">util-validate.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-runmodes_8h_source.html">util-runmodes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="source-pcap-file_8h_source.html">source-pcap-file.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp.c:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c__incl.png" border="0" usemap="#src_2stream-tcp_8c" alt=""/></div>
<map name="src_2stream-tcp_8c" id="src_2stream-tcp_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="672,155,805,181"/><area shape="rect" id="node20" href="suricata_8h.html" title="suricata.h" alt="" coords="1253,80,1331,107"/><area shape="rect" id="node11" href="decode_8h.html" title="decode.h" alt="" coords="1660,453,1735,480"/><area shape="rect" id="node21" href="debug_8h.html" title="debug.h" alt="" coords="2827,80,2895,107"/><area shape="rect" id="node14" href="detect_8h.html" title="detect.h" alt="" coords="904,304,973,331"/><area shape="rect" id="node15" href="flow_8h.html" title="flow.h" alt="" coords="1425,379,1481,405"/><area shape="rect" id="node22" href="flow-util_8h.html" title="flow&#45;util.h" alt="" coords="2919,80,2997,107"/><area shape="rect" id="node23" href="conf_8h.html" title="conf.h" alt="" coords="3023,80,3081,107"/><area shape="rect" id="node24" href="conf-yaml-loader_8h.html" title="conf&#45;yaml&#45;loader.h" alt="" coords="3106,80,3235,107"/><area shape="rect" id="node5" href="threads_8h.html" title="threads.h" alt="" coords="1086,603,1161,629"/><area shape="rect" id="node12" href="threadvars_8h.html" title="threadvars.h" alt="" coords="1449,528,1543,555"/><area shape="rect" id="node25" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="974,155,1068,181"/><area shape="rect" id="node26" href="util-pool_8h.html" title="util&#45;pool.h" alt="" coords="2318,304,2396,331"/><area shape="rect" id="node27" href="util-pool-thread_8h.html" title="util&#45;pool&#45;thread.h" alt="" coords="2458,304,2576,331"/><area shape="rect" id="node28" href="util-checksum_8h.html" title="util&#45;checksum.h" alt="" coords="3260,80,3375,107"/><area shape="rect" id="node29" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="3399,80,3496,107"/><area shape="rect" id="node30" href="util-print_8h.html" title="util&#45;print.h" alt="" coords="3521,80,3599,107"/><area shape="rect" id="node7" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="201,379,289,405"/><area shape="rect" id="node31" href="util-device_8h.html" title="util&#45;device.h" alt="" coords="3623,80,3715,107"/><area shape="rect" id="node32" href="stream-tcp-private_8h.html" title="stream&#45;tcp&#45;private.h" alt="" coords="2224,229,2363,256"/><area shape="rect" id="node33" href="stream-tcp-reassemble_8h.html" title="stream&#45;tcp&#45;reassemble.h" alt="" coords="1885,155,2051,181"/><area shape="rect" id="node35" href="stream-tcp_8h.html" title="stream&#45;tcp.h" alt="" coords="2065,80,2159,107"/><area shape="rect" id="node36" href="stream-tcp-inline_8h.html" title="stream&#45;tcp&#45;inline.h" alt="" coords="2229,155,2357,181"/><area shape="rect" id="node37" href="stream-tcp-sack_8h.html" title="stream&#45;tcp&#45;sack.h" alt="" coords="1026,80,1152,107"/><area shape="rect" id="node38" href="stream-tcp-util_8h.html" title="stream&#45;tcp&#45;util.h" alt="" coords="2382,155,2497,181"/><area shape="rect" id="node34" href="stream_8h.html" title="stream.h" alt="" coords="1511,229,1584,256"/><area shape="rect" id="node39" href="pkt-var_8h.html" title="pkt&#45;var.h" alt="" coords="3739,80,3812,107"/><area shape="rect" id="node40" href="host_8h.html" title="host.h" alt="" coords="2461,379,2520,405"/><area shape="rect" id="node41" href="app-layer_8h.html" title="app&#45;layer.h" alt="" coords="1655,80,1741,107"/><area shape="rect" id="node43" href="app-layer-parser_8h.html" title="app&#45;layer&#45;parser.h" alt="" coords="3837,80,3963,107"/><area shape="rect" id="node13" href="app-layer-protos_8h.html" title="app&#45;layer&#45;protos.h" alt="" coords="2129,528,2255,555"/><area shape="rect" id="node44" href="app-layer-htp-mem_8h.html" title="app&#45;layer&#45;htp&#45;mem.h" alt="" coords="1899,80,2040,107"/><area shape="rect" id="node45" href="util-host-os-info_8h.html" title="util&#45;host&#45;os&#45;info.h" alt="" coords="3988,80,4111,107"/><area shape="rect" id="node46" href="util-privs_8h.html" title="util&#45;privs.h" alt="" coords="4135,80,4217,107"/><area shape="rect" id="node42" href="util-profiling_8h.html" title="util&#45;profiling.h" alt="" coords="1761,155,1860,181"/><area shape="rect" id="node47" href="util-misc_8h.html" title="util&#45;misc.h" alt="" coords="43,304,125,331"/><area shape="rect" id="node48" href="util-validate_8h.html" title="util&#45;validate.h" alt="" coords="4241,80,4340,107"/><area shape="rect" id="node49" href="util-runmodes_8h.html" title="util&#45;runmodes.h" alt="" coords="4365,80,4475,107"/><area shape="rect" id="node50" href="source-pcap-file_8h.html" title="source&#45;pcap&#45;file.h" alt="" coords="4500,80,4625,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="353,229,425,256"/><area shape="rect" id="node6" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="980,229,1129,256"/><area shape="rect" id="node8" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="125,453,205,480"/><area shape="rect" id="node9" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="451,229,533,256"/><area shape="rect" id="node10" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="815,229,955,256"/><area shape="rect" id="node16" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="979,453,1081,480"/><area shape="rect" id="node18" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="558,229,636,256"/><area shape="rect" id="node19" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="661,229,739,256"/><area shape="rect" id="node17" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="1069,379,1179,405"/></map>
</div>
</div>
<p><a href="stream-tcp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a704dec4e8267ebbea46b9622538c0a02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a704dec4e8267ebbea46b9622538c0a02">STREAMTCP_DEFAULT_PREALLOC</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:a704dec4e8267ebbea46b9622538c0a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe999ee6a99cea5b5b795e5e653c7dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#adbe999ee6a99cea5b5b795e5e653c7dc">STREAMTCP_DEFAULT_MEMCAP</a>&#160;&#160;&#160;(32 * 1024 * 1024) /* 32mb */</td></tr>
<tr class="separator:adbe999ee6a99cea5b5b795e5e653c7dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5dea44b5b98768801ad5c7d7b63ba0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a1b5dea44b5b98768801ad5c7d7b63ba0">STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</a>&#160;&#160;&#160;(64 * 1024 * 1024) /* 64mb */</td></tr>
<tr class="separator:a1b5dea44b5b98768801ad5c7d7b63ba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b628d585930d0abedf1bb1a3a44a3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a62b628d585930d0abedf1bb1a3a44a3e">STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</a>&#160;&#160;&#160;2560</td></tr>
<tr class="separator:a62b628d585930d0abedf1bb1a3a44a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ff119dd23fb1ae0d1d087b9a1ffd16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a67ff119dd23fb1ae0d1d087b9a1ffd16">STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE</a>&#160;&#160;&#160;2560</td></tr>
<tr class="separator:a67ff119dd23fb1ae0d1d087b9a1ffd16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b3328d83ed3060e38ad76f657d0beac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a6b3328d83ed3060e38ad76f657d0beac">STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a6b3328d83ed3060e38ad76f657d0beac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223e20288e3fe805570b1ffd448284fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a223e20288e3fe805570b1ffd448284fd">STREAMTCP_NEW_TIMEOUT</a>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a223e20288e3fe805570b1ffd448284fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc603b8e76e55d437f29b3d60bb82dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#acdc603b8e76e55d437f29b3d60bb82dc">STREAMTCP_EST_TIMEOUT</a>&#160;&#160;&#160;3600</td></tr>
<tr class="separator:acdc603b8e76e55d437f29b3d60bb82dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee6bdee8e2a1a40d8bb540935e0e1b66"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aee6bdee8e2a1a40d8bb540935e0e1b66">STREAMTCP_CLOSED_TIMEOUT</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:aee6bdee8e2a1a40d8bb540935e0e1b66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2aabf911cb84b728f15c543043c7b16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af2aabf911cb84b728f15c543043c7b16">STREAMTCP_EMERG_NEW_TIMEOUT</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:af2aabf911cb84b728f15c543043c7b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2905bd5c9b53b630f1708eca36e80809"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a2905bd5c9b53b630f1708eca36e80809">STREAMTCP_EMERG_EST_TIMEOUT</a>&#160;&#160;&#160;300</td></tr>
<tr class="separator:a2905bd5c9b53b630f1708eca36e80809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5dd939397edb79ecb62dc848ad00046"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aa5dd939397edb79ecb62dc848ad00046">STREAMTCP_EMERG_CLOSED_TIMEOUT</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:aa5dd939397edb79ecb62dc848ad00046"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a387f8eba48e884ee147c39fcd084e4f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a387f8eba48e884ee147c39fcd084e4f1">StreamTcpUpdateLastAck</a>(ssn, stream, ack)</td></tr>
<tr class="memdesc:a387f8eba48e884ee147c39fcd084e4f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to update last_ack only if the new value is higher  <a href="#a387f8eba48e884ee147c39fcd084e4f1">More...</a><br/></td></tr>
<tr class="separator:a387f8eba48e884ee147c39fcd084e4f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e34441870e907cb9fc3a879882e9908"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0e34441870e907cb9fc3a879882e9908">StreamTcpUpdateNextWin</a>(ssn, stream, win)</td></tr>
<tr class="memdesc:a0e34441870e907cb9fc3a879882e9908"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to update next_win only if the new value is higher  <a href="#a0e34441870e907cb9fc3a879882e9908">More...</a><br/></td></tr>
<tr class="separator:a0e34441870e907cb9fc3a879882e9908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf7d2fd0cd1bbbb032d9fa2d5650b87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a9cf7d2fd0cd1bbbb032d9fa2d5650b87">PSEUDO_PKT_SET_IPV4HDR</a>(nipv4h, ipv4h)</td></tr>
<tr class="separator:a9cf7d2fd0cd1bbbb032d9fa2d5650b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ea8445a808ecb6ad08512a02f78a74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aa0ea8445a808ecb6ad08512a02f78a74">PSEUDO_PKT_SET_IPV6HDR</a>(nipv6h, ipv6h)</td></tr>
<tr class="separator:aa0ea8445a808ecb6ad08512a02f78a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed1d1754a4ede3576ab053bd5bd88e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a0ed1d1754a4ede3576ab053bd5bd88e5">PSEUDO_PKT_SET_TCPHDR</a>(ntcph, <a class="el" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>)</td></tr>
<tr class="separator:a0ed1d1754a4ede3576ab053bd5bd88e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adb13fb0808d68f1cbd9757cdc419fdab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab">StreamTcp</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *, void *, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *)</td></tr>
<tr class="separator:adb13fb0808d68f1cbd9757cdc419fdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a4a607332f606574d63bd2ec158ebe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a92a4a607332f606574d63bd2ec158ebe">StreamTcpThreadInit</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *, void *, void **)</td></tr>
<tr class="separator:a92a4a607332f606574d63bd2ec158ebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec7b18dbcad0affb03714548e584c4ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aec7b18dbcad0affb03714548e584c4ad">StreamTcpThreadDeinit</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *, void *)</td></tr>
<tr class="separator:aec7b18dbcad0affb03714548e584c4ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd3bdf46f5d8fcd8bf8ea644b3cc312e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#abd3bdf46f5d8fcd8bf8ea644b3cc312e">StreamTcpExitPrintStats</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *, void *)</td></tr>
<tr class="separator:abd3bdf46f5d8fcd8bf8ea644b3cc312e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47042a286da78d0a3ddd510991b3efcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a47042a286da78d0a3ddd510991b3efcf">StreamTcpRegisterTests</a> (void)</td></tr>
<tr class="separator:a47042a286da78d0a3ddd510991b3efcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96d6fa8305eedd10a095558194edf776"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a96d6fa8305eedd10a095558194edf776">StreamTcpReturnStreamSegments</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *)</td></tr>
<tr class="memdesc:a96d6fa8305eedd10a095558194edf776"><td class="mdescLeft">&#160;</td><td class="mdescRight">return all segments in this stream into the pool(s)  <a href="#a96d6fa8305eedd10a095558194edf776">More...</a><br/></td></tr>
<tr class="separator:a96d6fa8305eedd10a095558194edf776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf90c14b7c88907917a56107604dfeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a2bf90c14b7c88907917a56107604dfeb">StreamTcpInitConfig</a> (char quiet)</td></tr>
<tr class="memdesc:a2bf90c14b7c88907917a56107604dfeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">To initialize the stream global configuration data.  <a href="#a2bf90c14b7c88907917a56107604dfeb">More...</a><br/></td></tr>
<tr class="separator:a2bf90c14b7c88907917a56107604dfeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259c476320217554a84279beb8a5f1cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a259c476320217554a84279beb8a5f1cf">StreamTcpGetFlowState</a> (void *)</td></tr>
<tr class="separator:a259c476320217554a84279beb8a5f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a4bbabc99ab491dd9fa822fd5b3ade953">StreamTcpSetOSPolicy</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the OS policy for the given stream based on the destination of the received packet.  <a href="#a4bbabc99ab491dd9fa822fd5b3ade953">More...</a><br/></td></tr>
<tr class="separator:a4bbabc99ab491dd9fa822fd5b3ade953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad855fab70c5359eb4d6e2671925fdaa4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4">StreamTcpPseudoPacketCreateStreamEndPacket</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *stt, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq)</td></tr>
<tr class="memdesc:ad855fab70c5359eb4d6e2671925fdaa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wrap up stream reassembly.  <a href="#ad855fab70c5359eb4d6e2671925fdaa4">More...</a><br/></td></tr>
<tr class="separator:ad855fab70c5359eb4d6e2671925fdaa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f">StreamTcpReassembleMemuseGlobalCounter</a> (void)</td></tr>
<tr class="separator:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d327bdfaec16a40f479229f4a47fd12"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a2d327bdfaec16a40f479229f4a47fd12">SC_ATOMIC_DECLARE</a> (uint64_t, st_memuse)</td></tr>
<tr class="separator:a2d327bdfaec16a40f479229f4a47fd12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7570830e107bef9adb9c4a729222114"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ac7570830e107bef9adb9c4a729222114">TmModuleStreamTcpRegister</a> (void)</td></tr>
<tr class="separator:ac7570830e107bef9adb9c4a729222114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59514802880d4d9475c3cffb5d3a7716"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716">StreamTcpIncrMemuse</a> (uint64_t size)</td></tr>
<tr class="separator:a59514802880d4d9475c3cffb5d3a7716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b0702f9f4d8ac41c5c439c4bc49c64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64">StreamTcpDecrMemuse</a> (uint64_t size)</td></tr>
<tr class="separator:a73b0702f9f4d8ac41c5c439c4bc49c64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03aa3237dccab0112a80bb24ded9e19"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19">StreamTcpMemuseCounter</a> (void)</td></tr>
<tr class="separator:af03aa3237dccab0112a80bb24ded9e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c9973d678db064e54f760cc1d372a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8">StreamTcpCheckMemcap</a> (uint64_t size)</td></tr>
<tr class="memdesc:a89c9973d678db064e54f760cc1d372a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if alloc'ing "size" would mean we're over memcap.  <a href="#a89c9973d678db064e54f760cc1d372a8">More...</a><br/></td></tr>
<tr class="separator:a89c9973d678db064e54f760cc1d372a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add92e80f13e88362630ba978ac24c241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241">StreamTcpSessionClear</a> (void *ssnptr)</td></tr>
<tr class="memdesc:add92e80f13e88362630ba978ac24c241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream back to the pool. It returns the segments in the stream to the segment pool.  <a href="#add92e80f13e88362630ba978ac24c241">More...</a><br/></td></tr>
<tr class="separator:add92e80f13e88362630ba978ac24c241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f131faa6d6c797ab5d639c88418a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e">StreamTcpSessionPktFree</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:af9f131faa6d6c797ab5d639c88418a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream segments back to the pool.  <a href="#af9f131faa6d6c797ab5d639c88418a1e">More...</a><br/></td></tr>
<tr class="separator:af9f131faa6d6c797ab5d639c88418a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a149be8c880933a5c3d0e4a2de749977b"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b">StreamTcpSessionPoolAlloc</a> ()</td></tr>
<tr class="memdesc:a149be8c880933a5c3d0e4a2de749977b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stream alloc function for the Pool.  <a href="#a149be8c880933a5c3d0e4a2de749977b">More...</a><br/></td></tr>
<tr class="separator:a149be8c880933a5c3d0e4a2de749977b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a434ace0515e1fafb67276969b1e2a7d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2">StreamTcpSessionPoolInit</a> (void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, void *initdata)</td></tr>
<tr class="separator:a434ace0515e1fafb67276969b1e2a7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb09a993ff83021bd05e01e8c8787937"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937">StreamTcpSessionPoolCleanup</a> (void *s)</td></tr>
<tr class="memdesc:aeb09a993ff83021bd05e01e8c8787937"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pool free function.  <a href="#aeb09a993ff83021bd05e01e8c8787937">More...</a><br/></td></tr>
<tr class="separator:aeb09a993ff83021bd05e01e8c8787937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51099fd84c37e01eb49bc9b35d043086"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a51099fd84c37e01eb49bc9b35d043086">StreamTcpFreeConfig</a> (char quiet)</td></tr>
<tr class="separator:a51099fd84c37e01eb49bc9b35d043086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79e61268f43482932954f1cc027eec8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ae79e61268f43482932954f1cc027eec8">StreamTcpNewSession</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, int id)</td></tr>
<tr class="memdesc:ae79e61268f43482932954f1cc027eec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function is used to to fetch a TCP session from the ssn_pool, when a TCP SYN is received.  <a href="#ae79e61268f43482932954f1cc027eec8">More...</a><br/></td></tr>
<tr class="separator:ae79e61268f43482932954f1cc027eec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#ac6eb354bf30fe61419200ddf1b0a2ee2">StreamTcpGetStreamSize</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream)</td></tr>
<tr class="memdesc:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the size of a stream  <a href="#ac6eb354bf30fe61419200ddf1b0a2ee2">More...</a><br/></td></tr>
<tr class="separator:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4623bdd0fc62727f5021649ad2f73489"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-private_8h.html#ae4496c5dfdba79892e2828793f8ed1b6">TcpStateQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a4623bdd0fc62727f5021649ad2f73489">StreamTcp3whsFindSynAckBySynAck</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:a4623bdd0fc62727f5021649ad2f73489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bce056559e974e5f89cdf1f1fa7576e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e">StreamTcp3whsQueueSynAck</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:a8bce056559e974e5f89cdf1f1fa7576e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b75c6879d7915b8c1c9aae0e7ab476"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-private_8h.html#ae4496c5dfdba79892e2828793f8ed1b6">TcpStateQueue</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a34b75c6879d7915b8c1c9aae0e7ab476">StreamTcp3whsFindSynAckByAck</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:a34b75c6879d7915b8c1c9aae0e7ab476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a248c85404fa06db3bc2b7d8d2f8de3a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a248c85404fa06db3bc2b7d8d2f8de3a0">StreamTcpPacket</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *stt, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq)</td></tr>
<tr class="separator:a248c85404fa06db3bc2b7d8d2f8de3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca31769dee3279d1ede0501420f5253d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#aca31769dee3279d1ede0501420f5253d">TcpSessionReuseDoneEnough</a> (const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, const <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn)</td></tr>
<tr class="memdesc:aca31769dee3279d1ede0501420f5253d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if SSN is done enough for reuse.  <a href="#aca31769dee3279d1ede0501420f5253d">More...</a><br/></td></tr>
<tr class="separator:aca31769dee3279d1ede0501420f5253d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8803814028dbe6165bae8ced1a27d2f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a8803814028dbe6165bae8ced1a27d2f2">TcpSessionPacketSsnReuse</a> (const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, const void *tcp_ssn)</td></tr>
<tr class="separator:a8803814028dbe6165bae8ced1a27d2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a9d7e90ce0fb1612fdb875cc836a9daa1">StreamTcpSetSessionNoReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, char direction)</td></tr>
<tr class="memdesc:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the No reassembly flag for the given direction in given TCP session.  <a href="#a9d7e90ce0fb1612fdb875cc836a9daa1">More...</a><br/></td></tr>
<tr class="separator:a9d7e90ce0fb1612fdb875cc836a9daa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a740e5a7f3e6792cf64cfe9926a93abb6">StreamTcpSetDisableRawReassemblyFlag</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, char direction)</td></tr>
<tr class="memdesc:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the No reassembly flag for the given direction in given TCP session.  <a href="#a740e5a7f3e6792cf64cfe9926a93abb6">More...</a><br/></td></tr>
<tr class="separator:a740e5a7f3e6792cf64cfe9926a93abb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25423d5ef88cdfe44ae21872cdff7ce2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a25423d5ef88cdfe44ae21872cdff7ce2">StreamTcpPseudoSetup</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *parent, uint8_t *pkt, uint32_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a25423d5ef88cdfe44ae21872cdff7ce2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream.  <a href="#a25423d5ef88cdfe44ae21872cdff7ce2">More...</a><br/></td></tr>
<tr class="separator:a25423d5ef88cdfe44ae21872cdff7ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#a85b1902bbd69d2620d60ce5e2cdfbdd3">StreamTcpSegmentForEach</a> (const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint8_t flag, <a class="el" href="stream_8h.html#af77f28d6baf7af12803dad7cd4b7084a">StreamSegmentCallback</a> CallbackFunc, void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="memdesc:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run callback function on each TCP segment.  <a href="#a85b1902bbd69d2620d60ce5e2cdfbdd3">More...</a><br/></td></tr>
<tr class="separator:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afdd8feda84e7de3f0280938317d588b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8c.html#afdd8feda84e7de3f0280938317d588b1">stream_inline</a> = 0</td></tr>
<tr class="separator:afdd8feda84e7de3f0280938317d588b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd>
<dd>
Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span style="display: none;">.nosp@m.</span>nder<span style="display: none;">.nosp@m.</span>singh<span style="display: none;">.nosp@m.</span>dahi<span style="display: none;">.nosp@m.</span>ya@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a></dd></dl>
<p>TCP stream tracking and reassembly engine.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000122">Todo:</a></b></dt><dd><ul>
<li>4WHS: what if after the 2nd SYN we turn out to be normal 3WHS anyway? </li>
</ul>
</dd></dl>

<p>Definition in file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a9cf7d2fd0cd1bbbb032d9fa2d5650b87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_IPV4HDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nipv4h, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ipv4h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { <a class="code" href="decode-ipv4_8h.html#ad9954b06d20789a0052520d7051db2cf">\</a></div>
<div class="line"><a class="code" href="decode-ipv4_8h.html#ad9954b06d20789a0052520d7051db2cf">        IPV4_SET_RAW_VER</a>(nipv4h, <a class="code" href="decode-ipv4_8h.html#acbd1b60f4655031c95e80e52d191cfb2">IPV4_GET_RAW_VER</a>(ipv4h)); <a class="code" href="decode-ipv4_8h.html#aa14eeb86c952539c41bac90b7d49aa56">\</a></div>
<div class="line"><a class="code" href="decode-ipv4_8h.html#aa14eeb86c952539c41bac90b7d49aa56">        IPV4_SET_RAW_HLEN</a>(nipv4h, <a class="code" href="decode-ipv4_8h.html#ad18ed67806404d9a111710d03c4ae0df">IPV4_GET_RAW_HLEN</a>(ipv4h)); <a class="code" href="decode-ipv4_8h.html#a76366465fa1713e93ecae594821e721c">\</a></div>
<div class="line"><a class="code" href="decode-ipv4_8h.html#a76366465fa1713e93ecae594821e721c">        IPV4_SET_RAW_IPLEN</a>(nipv4h, <a class="code" href="decode-ipv4_8h.html#a51c479632e474bc4b89d775ead54ff44">IPV4_GET_RAW_IPLEN</a>(ipv4h)); <a class="code" href="decode-ipv4_8h.html#afeccd191c953b16693ea019226c4ea4b">\</a></div>
<div class="line"><a class="code" href="decode-ipv4_8h.html#afeccd191c953b16693ea019226c4ea4b">        IPV4_SET_RAW_IPTOS</a>(nipv4h, <a class="code" href="decode-ipv4_8h.html#a50882506cc7fd56a79f7918ffe081c77">IPV4_GET_RAW_IPTOS</a>(ipv4h)); <a class="code" href="decode-ipv4_8h.html#a41464d5005a2e91090d9b97b8ffff249">\</a></div>
<div class="line"><a class="code" href="decode-ipv4_8h.html#a41464d5005a2e91090d9b97b8ffff249">        IPV4_SET_RAW_IPPROTO</a>(nipv4h, <a class="code" href="decode-ipv4_8h.html#af6324f0ddb677a11f985c7398fa5c7dc">IPV4_GET_RAW_IPPROTO</a>(ipv4h)); \</div>
<div class="line">        (nipv4h)-&gt;<a class="code" href="decode-ipv4_8h.html#ab8c734d3f1c632180cf6ac4b8aaa7649">s_ip_src</a> = <a class="code" href="decode-ipv4_8h.html#a691515eec90c36a5662330b3591726bd">IPV4_GET_RAW_IPDST</a>(ipv4h); \</div>
<div class="line">        (nipv4h)-&gt;<a class="code" href="decode-ipv4_8h.html#a0fb96cec5a08abecf6935ad1c6d9b6de">s_ip_dst</a> = <a class="code" href="decode-ipv4_8h.html#abc21610347a4f35a4cce23d5f55d927e">IPV4_GET_RAW_IPSRC</a>(ipv4h); \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="decode-ipv4_8h_html_ab8c734d3f1c632180cf6ac4b8aaa7649"><div class="ttname"><a href="decode-ipv4_8h.html#ab8c734d3f1c632180cf6ac4b8aaa7649">s_ip_src</a></div><div class="ttdeci">#define s_ip_src</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00090">decode-ipv4.h:90</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_acbd1b60f4655031c95e80e52d191cfb2"><div class="ttname"><a href="decode-ipv4_8h.html#acbd1b60f4655031c95e80e52d191cfb2">IPV4_GET_RAW_VER</a></div><div class="ttdeci">#define IPV4_GET_RAW_VER(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00094">decode-ipv4.h:94</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a51c479632e474bc4b89d775ead54ff44"><div class="ttname"><a href="decode-ipv4_8h.html#a51c479632e474bc4b89d775ead54ff44">IPV4_GET_RAW_IPLEN</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPLEN(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00097">decode-ipv4.h:97</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a76366465fa1713e93ecae594821e721c"><div class="ttname"><a href="decode-ipv4_8h.html#a76366465fa1713e93ecae594821e721c">IPV4_SET_RAW_IPLEN</a></div><div class="ttdeci">#define IPV4_SET_RAW_IPLEN(ip4h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00114">decode-ipv4.h:114</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a50882506cc7fd56a79f7918ffe081c77"><div class="ttname"><a href="decode-ipv4_8h.html#a50882506cc7fd56a79f7918ffe081c77">IPV4_GET_RAW_IPTOS</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPTOS(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00096">decode-ipv4.h:96</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_af6324f0ddb677a11f985c7398fa5c7dc"><div class="ttname"><a href="decode-ipv4_8h.html#af6324f0ddb677a11f985c7398fa5c7dc">IPV4_GET_RAW_IPPROTO</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPPROTO(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00101">decode-ipv4.h:101</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_aa14eeb86c952539c41bac90b7d49aa56"><div class="ttname"><a href="decode-ipv4_8h.html#aa14eeb86c952539c41bac90b7d49aa56">IPV4_SET_RAW_HLEN</a></div><div class="ttdeci">#define IPV4_SET_RAW_HLEN(ip4h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00112">decode-ipv4.h:112</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_ad9954b06d20789a0052520d7051db2cf"><div class="ttname"><a href="decode-ipv4_8h.html#ad9954b06d20789a0052520d7051db2cf">IPV4_SET_RAW_VER</a></div><div class="ttdeci">#define IPV4_SET_RAW_VER(ip4h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00111">decode-ipv4.h:111</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_afeccd191c953b16693ea019226c4ea4b"><div class="ttname"><a href="decode-ipv4_8h.html#afeccd191c953b16693ea019226c4ea4b">IPV4_SET_RAW_IPTOS</a></div><div class="ttdeci">#define IPV4_SET_RAW_IPTOS(ip4h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00113">decode-ipv4.h:113</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_ad18ed67806404d9a111710d03c4ae0df"><div class="ttname"><a href="decode-ipv4_8h.html#ad18ed67806404d9a111710d03c4ae0df">IPV4_GET_RAW_HLEN</a></div><div class="ttdeci">#define IPV4_GET_RAW_HLEN(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00095">decode-ipv4.h:95</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a41464d5005a2e91090d9b97b8ffff249"><div class="ttname"><a href="decode-ipv4_8h.html#a41464d5005a2e91090d9b97b8ffff249">IPV4_SET_RAW_IPPROTO</a></div><div class="ttdeci">#define IPV4_SET_RAW_IPPROTO(ip4h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00115">decode-ipv4.h:115</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a691515eec90c36a5662330b3591726bd"><div class="ttname"><a href="decode-ipv4_8h.html#a691515eec90c36a5662330b3591726bd">IPV4_GET_RAW_IPDST</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPDST(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00103">decode-ipv4.h:103</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_abc21610347a4f35a4cce23d5f55d927e"><div class="ttname"><a href="decode-ipv4_8h.html#abc21610347a4f35a4cce23d5f55d927e">IPV4_GET_RAW_IPSRC</a></div><div class="ttdeci">#define IPV4_GET_RAW_IPSRC(ip4h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00102">decode-ipv4.h:102</a></div></div>
<div class="ttc" id="decode-ipv4_8h_html_a0fb96cec5a08abecf6935ad1c6d9b6de"><div class="ttname"><a href="decode-ipv4_8h.html#a0fb96cec5a08abecf6935ad1c6d9b6de">s_ip_dst</a></div><div class="ttdeci">#define s_ip_dst</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv4_8h_source.html#l00091">decode-ipv4.h:91</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05724">5724</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa0ea8445a808ecb6ad08512a02f78a74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_IPV6HDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nipv6h, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ipv6h&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[0] = (ipv6h)-&gt;s_ip6_dst[0]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[1] = (ipv6h)-&gt;s_ip6_dst[1]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[2] = (ipv6h)-&gt;s_ip6_dst[2]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a>[3] = (ipv6h)-&gt;s_ip6_dst[3]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[0] = (ipv6h)-&gt;s_ip6_src[0]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[1] = (ipv6h)-&gt;s_ip6_src[1]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[2] = (ipv6h)-&gt;s_ip6_src[2]; \</div>
<div class="line">        (nipv6h)-&gt;<a class="code" href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a>[3] = (ipv6h)-&gt;s_ip6_src[3]; <a class="code" href="decode-ipv6_8h.html#af928f37d66e47fce993e8aa8591f02fa">\</a></div>
<div class="line"><a class="code" href="decode-ipv6_8h.html#af928f37d66e47fce993e8aa8591f02fa">        IPV6_SET_RAW_NH</a>(nipv6h, <a class="code" href="decode-ipv6_8h.html#a2cb25ef69103ad3e26b27191f70aeb57">IPV6_GET_RAW_NH</a>(ipv6h));    \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="decode-ipv6_8h_html_af928f37d66e47fce993e8aa8591f02fa"><div class="ttname"><a href="decode-ipv6_8h.html#af928f37d66e47fce993e8aa8591f02fa">IPV6_SET_RAW_NH</a></div><div class="ttdeci">#define IPV6_SET_RAW_NH(ip6h, value)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00070">decode-ipv6.h:70</a></div></div>
<div class="ttc" id="decode-ipv6_8h_html_a9f92495a70d93003da40aad2d35d5bcd"><div class="ttname"><a href="decode-ipv6_8h.html#a9f92495a70d93003da40aad2d35d5bcd">s_ip6_src</a></div><div class="ttdeci">#define s_ip6_src</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00052">decode-ipv6.h:52</a></div></div>
<div class="ttc" id="decode-ipv6_8h_html_a2cb25ef69103ad3e26b27191f70aeb57"><div class="ttname"><a href="decode-ipv6_8h.html#a2cb25ef69103ad3e26b27191f70aeb57">IPV6_GET_RAW_NH</a></div><div class="ttdeci">#define IPV6_GET_RAW_NH(ip6h)</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00065">decode-ipv6.h:65</a></div></div>
<div class="ttc" id="decode-ipv6_8h_html_a7fb0be5346cfffc29e0158bcdf964ed4"><div class="ttname"><a href="decode-ipv6_8h.html#a7fb0be5346cfffc29e0158bcdf964ed4">s_ip6_dst</a></div><div class="ttdeci">#define s_ip6_dst</div><div class="ttdef"><b>Definition:</b> <a href="decode-ipv6_8h_source.html#l00053">decode-ipv6.h:53</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05734">5734</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0ed1d1754a4ede3576ab053bd5bd88e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PKT_SET_TCPHDR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ntcph, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { <a class="code" href="decode_8h.html#a9f60d3302b85a7a17c13e5698a873b9c">\</a></div>
<div class="line"><a class="code" href="decode_8h.html#a9f60d3302b85a7a17c13e5698a873b9c">        COPY_PORT</a>((<a class="code" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>)-&gt;<a class="code" href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a>, (ntcph)-&gt;<a class="code" href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a>); <a class="code" href="decode_8h.html#a9f60d3302b85a7a17c13e5698a873b9c">\</a></div>
<div class="line"><a class="code" href="decode_8h.html#a9f60d3302b85a7a17c13e5698a873b9c">        COPY_PORT</a>((<a class="code" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>)-&gt;<a class="code" href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a>, (ntcph)-&gt;<a class="code" href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a>); \</div>
<div class="line">        (ntcph)-&gt;<a class="code" href="decode-tcp_8h.html#a44b335127ed14023ba6dc4f84d83071d">th_seq</a> = (<a class="code" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>)-&gt;th_ack; \</div>
<div class="line">        (ntcph)-&gt;<a class="code" href="decode-tcp_8h.html#a0fd270d538b4e85e75ac9e4982c4641b">th_ack</a> = (<a class="code" href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a>)-&gt;th_seq; \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
<div class="ttc" id="decode_8h_html_a9f60d3302b85a7a17c13e5698a873b9c"><div class="ttname"><a href="decode_8h.html#a9f60d3302b85a7a17c13e5698a873b9c">COPY_PORT</a></div><div class="ttdeci">#define COPY_PORT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="decode_8h_source.html#l00226">decode.h:226</a></div></div>
<div class="ttc" id="decode-tcp_8h_html_a29b81527953a94bc51be676214c63d36"><div class="ttname"><a href="decode-tcp_8h.html#a29b81527953a94bc51be676214c63d36">th_sport</a></div><div class="ttdeci">uint16_t th_sport</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00503">decode-tcp.h:503</a></div></div>
<div class="ttc" id="decode-tcp_8h_html_a0fd270d538b4e85e75ac9e4982c4641b"><div class="ttname"><a href="decode-tcp_8h.html#a0fd270d538b4e85e75ac9e4982c4641b">th_ack</a></div><div class="ttdeci">uint32_t th_ack</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00506">decode-tcp.h:506</a></div></div>
<div class="ttc" id="decode-tcp_8h_html_a610220501c65f8401dd9252e4a468693"><div class="ttname"><a href="decode-tcp_8h.html#a610220501c65f8401dd9252e4a468693">th_dport</a></div><div class="ttdeci">uint16_t th_dport</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00504">decode-tcp.h:504</a></div></div>
<div class="ttc" id="alert-unified2-alert_8c_html_a7f1158c58255f1c8b574f01616b26995"><div class="ttname"><a href="alert-unified2-alert_8c.html#a7f1158c58255f1c8b574f01616b26995">tcph</a></div><div class="ttdeci">TCPHdr tcph</div><div class="ttdef"><b>Definition:</b> <a href="alert-unified2-alert_8c_source.html#l00332">alert-unified2-alert.c:332</a></div></div>
<div class="ttc" id="decode-tcp_8h_html_a44b335127ed14023ba6dc4f84d83071d"><div class="ttname"><a href="decode-tcp_8h.html#a44b335127ed14023ba6dc4f84d83071d">th_seq</a></div><div class="ttdeci">uint32_t th_seq</div><div class="ttdef"><b>Definition:</b> <a href="decode-tcp_8h_source.html#l00505">decode-tcp.h:505</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05746">5746</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="aee6bdee8e2a1a40d8bb540935e0e1b66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_CLOSED_TIMEOUT&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00090">90</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6b3328d83ed3060e38ad76f657d0beac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00086">86</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="adbe999ee6a99cea5b5b795e5e653c7dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_MEMCAP&#160;&#160;&#160;(32 * 1024 * 1024) /* 32mb */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00082">82</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a704dec4e8267ebbea46b9622538c0a02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_PREALLOC&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00081">81</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a1b5dea44b5b98768801ad5c7d7b63ba0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP&#160;&#160;&#160;(64 * 1024 * 1024) /* 64mb */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00083">83</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a67ff119dd23fb1ae0d1d087b9a1ffd16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE&#160;&#160;&#160;2560</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00085">85</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a62b628d585930d0abedf1bb1a3a44a3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE&#160;&#160;&#160;2560</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00084">84</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5dd939397edb79ecb62dc848ad00046"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_EMERG_CLOSED_TIMEOUT&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00094">94</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2905bd5c9b53b630f1708eca36e80809"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_EMERG_EST_TIMEOUT&#160;&#160;&#160;300</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00093">93</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="af2aabf911cb84b728f15c543043c7b16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_EMERG_NEW_TIMEOUT&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00092">92</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="acdc603b8e76e55d437f29b3d60bb82dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_EST_TIMEOUT&#160;&#160;&#160;3600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00089">89</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a223e20288e3fe805570b1ffd448284fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_NEW_TIMEOUT&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00088">88</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a387f8eba48e884ee147c39fcd084e4f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpUpdateLastAck</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ack&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    if (<a class="code" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>((ack), (stream)-&gt;last_ack)) \</div>
<div class="line">    { <a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">\</a></div>
<div class="line"><a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">        SCLogDebug</a>(<span class="stringliteral">&quot;ssn %p: last_ack set to %&quot;</span>PRIu32<span class="stringliteral">&quot;, moved %u forward&quot;</span>, (ssn), (ack), (ack) - (stream)-&gt;last_ack); \</div>
<div class="line">        if ((<a class="code" href="stream-tcp-private_8h.html#a59976866ea454f08233fbc246908dbc8">SEQ_LEQ</a>((stream)-&gt;last_ack, (stream)-&gt;next_seq) &amp;&amp; <a class="code" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>((ack),(stream)-&gt;next_seq))) { <a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">\</a></div>
<div class="line"><a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">            SCLogDebug</a>(<span class="stringliteral">&quot;last_ack just passed next_seq: %u (was %u) &gt; %u&quot;</span>, (ack), (stream)-&gt;last_ack, (stream)-&gt;next_seq); \</div>
<div class="line">        } <span class="keywordflow">else</span> { <a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">\</a></div>
<div class="line"><a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">            SCLogDebug</a>(<span class="stringliteral">&quot;next_seq (%u) &lt;&gt; last_ack now %d&quot;</span>, (stream)-&gt;next_seq, (<span class="keywordtype">int</span>)(stream)-&gt;next_seq - (ack)); \</div>
<div class="line">        }\</div>
<div class="line">        (stream)-&gt;last_ack = (ack); <a class="code" href="stream-tcp-sack_8c.html#a4d3657a23c7fad0d69fb447b85131ff6">\</a></div>
<div class="line"><a class="code" href="stream-tcp-sack_8c.html#a4d3657a23c7fad0d69fb447b85131ff6">        StreamTcpSackPruneList</a>((stream)); \</div>
<div class="line">    } <span class="keywordflow">else</span> { <a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">\</a></div>
<div class="line"><a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">        SCLogDebug</a>(<span class="stringliteral">&quot;ssn %p: no update: ack %u, last_ack %&quot;</span>PRIu32<span class="stringliteral">&quot;, next_seq %u (state %u)&quot;</span>, \</div>
<div class="line">                    (ssn), (ack), (stream)-&gt;last_ack, (stream)-&gt;next_seq, (ssn)-&gt;state); \</div>
<div class="line">    }\</div>
<div class="line">}</div>
<div class="ttc" id="util-debug_8h_html_a5054188aacf949f2aad5e59fb352c866"><div class="ttname"><a href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">SCLogDebug</a></div><div class="ttdeci">#define SCLogDebug(...)</div><div class="ttdef"><b>Definition:</b> <a href="util-debug_8h_source.html#l00306">util-debug.h:306</a></div></div>
<div class="ttc" id="stream-tcp-sack_8c_html_a4d3657a23c7fad0d69fb447b85131ff6"><div class="ttname"><a href="stream-tcp-sack_8c.html#a4d3657a23c7fad0d69fb447b85131ff6">StreamTcpSackPruneList</a></div><div class="ttdeci">void StreamTcpSackPruneList(TcpStream *stream)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-sack_8c_source.html#l00296">stream-tcp-sack.c:296</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_a202607d795640148bc4b3fbd0ba0ae74"><div class="ttname"><a href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a></div><div class="ttdeci">#define SEQ_GT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00201">stream-tcp-private.h:201</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_a59976866ea454f08233fbc246908dbc8"><div class="ttname"><a href="stream-tcp-private_8h.html#a59976866ea454f08233fbc246908dbc8">SEQ_LEQ</a></div><div class="ttdeci">#define SEQ_LEQ(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00200">stream-tcp-private.h:200</a></div></div>
</div><!-- fragment -->
<p>macro to update last_ack only if the new value is higher </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>session </td></tr>
    <tr><td class="paramname">stream</td><td>stream to update </td></tr>
    <tr><td class="paramname">ack</td><td>ACK value to test and set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00764">764</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0e34441870e907cb9fc3a879882e9908"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpUpdateNextWin</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">win&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{ \</div>
<div class="line">    uint32_t sacked_size__ = StreamTcpSackedSize((stream)); \</div>
<div class="line">    if (<a class="code" href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a>(((win) + sacked_size__), (stream)-&gt;next_win)) { \</div>
<div class="line">        (stream)-&gt;next_win = ((win) + sacked_size__); <a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">\</a></div>
<div class="line"><a class="code" href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">        SCLogDebug</a>(<span class="stringliteral">&quot;ssn %p: next_win set to %&quot;</span>PRIu32, (ssn), (stream)-&gt;next_win); \</div>
<div class="line">    } \</div>
<div class="line">}</div>
<div class="ttc" id="util-debug_8h_html_a5054188aacf949f2aad5e59fb352c866"><div class="ttname"><a href="util-debug_8h.html#a5054188aacf949f2aad5e59fb352c866">SCLogDebug</a></div><div class="ttdeci">#define SCLogDebug(...)</div><div class="ttdef"><b>Definition:</b> <a href="util-debug_8h_source.html#l00306">util-debug.h:306</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_a202607d795640148bc4b3fbd0ba0ae74"><div class="ttname"><a href="stream-tcp-private_8h.html#a202607d795640148bc4b3fbd0ba0ae74">SEQ_GT</a></div><div class="ttdeci">#define SEQ_GT(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00201">stream-tcp-private.h:201</a></div></div>
</div><!-- fragment -->
<p>macro to update next_win only if the new value is higher </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>session </td></tr>
    <tr><td class="paramname">stream</td><td>stream to update </td></tr>
    <tr><td class="paramname">win</td><td>window value to test and set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00788">788</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2d327bdfaec16a40f479229f4a47fd12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">st_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="adb13fb0808d68f1cbd9757cdc419fdab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>postpq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05023">5023</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00055">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00098">StreamTcpThread_::counter_tcp_invalid_checksum</a>, <a class="el" href="stream-tcp_8h_source.html#l00100">StreamTcpThread_::counter_tcp_no_flow</a>, <a class="el" href="stream-tcp_8h_source.html#l00072">TcpStreamCnf_::flags</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00175">FLOW_PKT_TOSERVER_FIRST</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>, <a class="el" href="decode_8h_source.html#l01034">PKT_IGNORE_CHECKSUM</a>, <a class="el" href="decode_8h_source.html#l00242">PKT_IS_TCP</a>, <a class="el" href="decode_8h_source.html#l01026">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="stream-tcp_8h_source.html#l00083">StreamTcpThread_::pkts</a>, <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00081">StreamTcpThread_::runmode_flow_stream_async</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION</a>, <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_cgraph.png" border="0" usemap="#stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_cgraph" alt=""/></div>
<map name="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_cgraph" id="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1436,296,1511,323"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="142,321,269,348"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1935,196,2121,223"/><area shape="rect" id="node5" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool. " alt="" coords="328,380,507,407"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67" title="StreamTcpReassembleHandle\lSegment" alt="" coords="317,314,517,355"/><area shape="rect" id="node44" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="360,431,475,457"/><area shape="rect" id="node45" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="360,481,475,508"/><area shape="rect" id="node46" href="util-checksum_8c.html#ab76beb6b62cf242b0fc2b4373fde7081" title="ReCalculateChecksum" alt="" coords="339,532,496,559"/><area shape="rect" id="node10" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="1660,397,1809,424"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="565,640,792,667"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1105,725,1319,752"/><area shape="rect" id="node8" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1430,725,1517,752"/><area shape="rect" id="node11" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="841,549,1055,576"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="579,438,779,479"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="579,373,779,414"/><area shape="rect" id="node12" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1387,601,1560,628"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="1160,549,1264,576"/><area shape="rect" id="node32" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="1177,675,1247,701"/><area shape="rect" id="node13" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="1641,759,1828,801"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="1925,905,2131,932"/><area shape="rect" id="node16" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1660,652,1809,679"/><area shape="rect" id="node25" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1635,449,1834,476"/><area shape="rect" id="node26" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="1658,601,1811,628"/><area shape="rect" id="node30" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="1675,551,1794,577"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1894,500,2162,527"/><area shape="rect" id="node15" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="2255,804,2406,831"/><area shape="rect" id="node17" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1946,703,2110,729"/><area shape="rect" id="node19" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1947,551,2109,577"/><area shape="rect" id="node21" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1941,804,2115,831"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="2235,576,2426,603"/><area shape="rect" id="node22" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1921,855,2135,881"/><area shape="rect" id="node23" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1891,652,2165,679"/><area shape="rect" id="node18" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="2213,703,2448,729"/><area shape="rect" id="node27" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1931,449,2125,476"/><area shape="rect" id="node28" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="2245,449,2417,476"/><area shape="rect" id="node29" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="2497,442,2690,483"/><area shape="rect" id="node33" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="1435,675,1512,701"/><area shape="rect" id="node35" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988" title="Function to get the segment of required length from the pool. " alt="" coords="869,271,1027,297"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3" title="StreamTcpReassembleInsert\lSegment" alt="" coords="852,659,1044,701"/><area shape="rect" id="node36" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="1177,296,1247,323"/><area shape="rect" id="node38" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="1131,827,1293,853"/><area shape="rect" id="node39" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="1368,827,1579,853"/><area shape="rect" id="node41" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="1368,877,1579,904"/><area shape="rect" id="node40" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="1627,827,1842,853"/><area shape="rect" id="node42" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="1627,877,1842,904"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_icgraph.png" border="0" usemap="#stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_icgraph" alt=""/></div>
<map name="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_icgraph" id="stream-tcp_8c_adb13fb0808d68f1cbd9757cdc419fdab_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="142,5,338,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="387,5,522,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="571,5,669,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="915,5,965,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="717,31,867,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a34b75c6879d7915b8c1c9aae0e7ab476"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-private_8h.html#ae4496c5dfdba79892e2828793f8ed1b6">TcpStateQueue</a>* StreamTcp3whsFindSynAckByAck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l01158">1158</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00041">TcpStateQueue_::ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00040">TcpStateQueue_::seq</a>, <a class="el" href="decode-tcp_8h_source.html#l00104">TCP_GET_ACK</a>, and <a class="el" href="decode-tcp_8h_source.html#l00103">TCP_GET_SEQ</a>.</p>

</div>
</div>
<a class="anchor" id="a4623bdd0fc62727f5021649ad2f73489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-private_8h.html#ae4496c5dfdba79892e2828793f8ed1b6">TcpStateQueue</a>* StreamTcp3whsFindSynAckBySynAck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l01098">1098</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00041">TcpStateQueue_::ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00037">TcpStateQueue_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00040">TcpStateQueue_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00042">TcpStateQueue_::ts</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00039">TcpStateQueue_::win</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00038">TcpStateQueue_::wscale</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a4623bdd0fc62727f5021649ad2f73489_icgraph.png" border="0" usemap="#stream-tcp_8c_a4623bdd0fc62727f5021649ad2f73489_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a4623bdd0fc62727f5021649ad2f73489_icgraph" id="stream-tcp_8c_a4623bdd0fc62727f5021649ad2f73489_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e" title="StreamTcp3whsQueueSynAck" alt="" coords="259,12,461,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8bce056559e974e5f89cdf1f1fa7576e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcp3whsQueueSynAck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l01121">1121</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00073">TcpStreamCnf_::max_synack_queued</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00219">TcpSession_::queue_len</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="decode-events_8h_source.html#l00162">STREAM_3WHS_SYNACK_FLOOD</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp_8c_source.html#l01098">StreamTcp3whsFindSynAckBySynAck()</a>, <a class="el" href="stream-tcp_8c_source.html#l00161">StreamTcpCheckMemcap()</a>, <a class="el" href="stream-tcp_8c_source.html#l00137">StreamTcpIncrMemuse()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a8bce056559e974e5f89cdf1f1fa7576e_cgraph.png" border="0" usemap="#stream-tcp_8c_a8bce056559e974e5f89cdf1f1fa7576e_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a8bce056559e974e5f89cdf1f1fa7576e_cgraph" id="stream-tcp_8c_a8bce056559e974e5f89cdf1f1fa7576e_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a4623bdd0fc62727f5021649ad2f73489" title="StreamTcp3whsFindSynAckBy\lSynAck" alt="" coords="257,5,461,46"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="271,71,446,97"/><area shape="rect" id="node4" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="279,121,438,148"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89c9973d678db064e54f760cc1d372a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if alloc'ing "size" would mean we're over memcap. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00161">161</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00048">TcpStreamCnf_::memcap</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a89c9973d678db064e54f760cc1d372a8_icgraph.png" border="0" usemap="#stream-tcp_8c_a89c9973d678db064e54f760cc1d372a8_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a89c9973d678db064e54f760cc1d372a8_icgraph" id="stream-tcp_8c_a89c9973d678db064e54f760cc1d372a8_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e" title="StreamTcp3whsQueueSynAck" alt="" coords="230,5,431,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="237,56,425,83"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="699,31,842,57"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="480,81,624,108"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1445,81,1496,108"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="673,81,869,108"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="918,81,1053,108"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1101,81,1200,108"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1248,132,1397,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a73b0702f9f4d8ac41c5c439c4bc49c64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00143">143</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph.png" border="0" usemap="#stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph" id="stream-tcp_8c_a73b0702f9f4d8ac41c5c439c4bc49c64_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="241,5,405,32"/><area shape="rect" id="node5" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="219,56,426,83"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="475,5,618,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1440,56,1491,83"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="475,56,619,83"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="667,56,863,83"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="913,56,1047,83"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1096,56,1195,83"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1243,107,1392,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abd3bdf46f5d8fcd8bf8ea644b3cc312e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpExitPrintStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05161">5161</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00083">StreamTcpThread_::pkts</a>, and <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_abd3bdf46f5d8fcd8bf8ea644b3cc312e_icgraph.png" border="0" usemap="#stream-tcp_8c_abd3bdf46f5d8fcd8bf8ea644b3cc312e_icgraph" alt=""/></div>
<map name="stream-tcp_8c_abd3bdf46f5d8fcd8bf8ea644b3cc312e_icgraph" id="stream-tcp_8c_abd3bdf46f5d8fcd8bf8ea644b3cc312e_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="222,5,418,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="467,5,602,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="651,5,749,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="995,5,1045,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="797,31,947,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51099fd84c37e01eb49bc9b35d043086"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpFreeConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00620">620</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-pool-thread_8c_source.html#l00133">PoolThreadFree()</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00527">StreamTcpReassembleFree()</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_cgraph.png" border="0" usemap="#stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_cgraph" id="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="241,5,356,32"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#aaa019dfbfe83315c6aab375311eecc36" title="StreamTcpReassembleFree" alt="" coords="206,81,391,108"/><area shape="rect" id="node3" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="656,43,731,69"/><area shape="rect" id="node5" href="group__utilpool.html#ga06f51c149934cd93fb01a00f0ca27930" title="PoolPrintSaturation" alt="" coords="457,93,591,120"/><area shape="rect" id="node6" href="stream_8c.html#a8ebeba661601431d6ce3160ed95e95de" title="StreamMsgQueuesDeinit" alt="" coords="440,144,608,171"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_icgraph.png" border="0" usemap="#stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_icgraph" id="stream-tcp_8c_a51099fd84c37e01eb49bc9b35d043086_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="205,5,256,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a259c476320217554a84279beb8a5f1cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpGetFlowState </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac6eb354bf30fe61419200ddf1b0a2ee2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t StreamTcpGetStreamSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the size of a stream </p>
<dl class="section note"><dt>Note</dt><dd>this just calculates the diff between isn and last_ack and will not consider sequence wrap arounds (streams bigger than 4gb).</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">size</td><td>stream size </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00752">752</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00071">TcpStream_::isn</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>.</p>

</div>
</div>
<a class="anchor" id="a59514802880d4d9475c3cffb5d3a7716"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00137">137</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_icgraph.png" border="0" usemap="#stream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_icgraph" id="stream-tcp_8c_a59514802880d4d9475c3cffb5d3a7716_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e" title="StreamTcp3whsQueueSynAck" alt="" coords="214,5,415,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="226,56,403,83"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="683,31,826,57"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="464,81,608,108"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1429,81,1480,108"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="657,81,853,108"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="902,81,1037,108"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1085,81,1184,108"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1232,132,1381,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2bf90c14b7c88907917a56107604dfeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpInitConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To initialize the stream global configuration data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">quiet</td><td>It tells the mode of operation, if it is TRUE nothing will be get printed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00346">346</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00059">TcpStreamCnf_::async_oneside</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00442">ConfGetBool()</a>, <a class="el" href="conf_8c_source.html#l00380">ConfGetInt()</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="suricata_8c_source.html#l00243">EngineModeIsIPS()</a>, <a class="el" href="stream-tcp_8h_source.html#l00072">TcpStreamCnf_::flags</a>, <a class="el" href="flow_8h_source.html#l00171">FLOW_PKT_TOCLIENT</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8c_source.html#l00807">FlowSetProtoFreeFunc()</a>, <a class="el" href="stream-tcp_8h_source.html#l00073">TcpStreamCnf_::max_synack_queued</a>, <a class="el" href="stream-tcp_8h_source.html#l00048">TcpStreamCnf_::memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00058">TcpStreamCnf_::midstream</a>, <a class="el" href="util-misc_8c_source.html#l00156">ParseSizeStringU16()</a>, <a class="el" href="util-misc_8c_source.html#l00173">ParseSizeStringU32()</a>, <a class="el" href="util-misc_8c_source.html#l00190">ParseSizeStringU64()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00038">PoolThreadInit()</a>, <a class="el" href="stream-tcp_8h_source.html#l00057">TcpStreamCnf_::prealloc_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00060">TcpStreamCnf_::reassembly_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00049">TcpStreamCnf_::reassembly_memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00063">TcpStreamCnf_::reassembly_toclient_chunk_size</a>, <a class="el" href="stream-tcp_8h_source.html#l00062">TcpStreamCnf_::reassembly_toserver_chunk_size</a>, <a class="el" href="suricata_8c_source.html#l00263">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-error_8h_source.html#l00230">SC_ERR_SIZE_PARSE</a>, <a class="el" href="util-error_8h_source.html#l00265">SC_WARN_OPTION_OBSOLETE</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00263">SCLogWarning</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp_8h_source.html#l00052">TcpStreamCnf_::segment_init_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00182">SEGMENTTCP_FLAG_RAW_PROCESSED</a>, <a class="el" href="stream-tcp_8h_source.html#l00051">TcpStreamCnf_::ssn_init_flags</a>, <a class="el" href="counters_8c_source.html#l00911">StatsRegisterGlobalCounter()</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp_8c_source.html#l00123">stream_inline</a>, <a class="el" href="stream_8c_source.html#l00237">StreamMsgQueueSetMinChunkLen()</a>, <a class="el" href="stream-tcp_8c_source.html#l00086">STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</a>, <a class="el" href="stream-tcp_8c_source.html#l00082">STREAMTCP_DEFAULT_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00081">STREAMTCP_DEFAULT_PREALLOC</a>, <a class="el" href="stream-tcp_8c_source.html#l00083">STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00085">STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE</a>, <a class="el" href="stream-tcp_8c_source.html#l00084">STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00124">STREAMTCP_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION</a>, <a class="el" href="stream-tcp_8c_source.html#l00149">StreamTcpMemuseCounter()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>, <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>, <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>, <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>, and <a class="el" href="util-misc_8h_source.html#l00037">WarnInvalidConfEntry</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_cgraph.png" border="0" usemap="#stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_cgraph" id="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_cgraph">
<area shape="rect" id="node2" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="1051,126,1122,152"/><area shape="rect" id="node6" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="262,150,359,176"/><area shape="rect" id="node8" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer. " alt="" coords="811,151,898,178"/><area shape="rect" id="node3" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="1278,164,1381,191"/><area shape="rect" id="node9" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title="EngineModeIsIPS" alt="" coords="247,407,374,434"/><area shape="rect" id="node10" href="flow_8c.html#a05174d1570db7ee4b5a25f5ea7234e87" title="Function to set the function to get protocol specific flow state. " alt="" coords="233,458,389,484"/><area shape="rect" id="node12" href="util-misc_8c.html#ac799c82481f5e938b2ea704a014c6a0d" title="ParseSizeStringU16" alt="" coords="241,508,381,535"/><area shape="rect" id="node13" href="util-misc_8c.html#a4a65cb5e0f0109498b38fd1f9bd3a620" title="ParseSizeStringU32" alt="" coords="241,559,381,586"/><area shape="rect" id="node14" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title="ParseSizeStringU64" alt="" coords="241,610,381,636"/><area shape="rect" id="node15" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="801,252,908,279"/><area shape="rect" id="node19" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title="RunmodeIsUnittests" alt="" coords="239,660,382,687"/><area shape="rect" id="node20" href="counters_8c.html#a6e153d15fc6ea022e954f38fd80fbc0a" title="Registers a counter, which represents a global value. " alt="" coords="493,419,678,446"/><area shape="rect" id="node21" href="stream_8c.html#a2c70f0a0aab3fabd48ddc16913683259" title="StreamMsgQueueSetMinChunkLen" alt="" coords="197,711,424,738"/><area shape="rect" id="node22" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title="StreamTcpMemuseCounter" alt="" coords="219,762,402,788"/><area shape="rect" id="node23" href="stream-tcp-reassemble_8c.html#ad1b178831cdeb029f02fd53f08f328cf" title="StreamTcpReassembleInit" alt="" coords="222,306,399,332"/><area shape="rect" id="node38" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="229,863,393,890"/><area shape="rect" id="node46" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="217,936,405,963"/><area shape="rect" id="node48" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="207,812,414,839"/><area shape="rect" id="node49" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="222,1034,399,1060"/><area shape="rect" id="node4" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1497,462,1650,488"/><area shape="rect" id="node5" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1543,164,1604,191"/><area shape="rect" id="node7" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="532,99,639,126"/><area shape="rect" id="node11" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="510,470,661,496"/><area shape="rect" id="node16" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="1053,354,1120,380"/><area shape="rect" id="node18" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="1029,252,1144,279"/><area shape="rect" id="node17" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="1292,342,1367,368"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title="StreamTcpReassembleMemuse\lGlobalCounter" alt="" coords="481,302,690,344"/><area shape="rect" id="node25" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="487,368,684,395"/><area shape="rect" id="node26" href="util-byte_8c.html#a9cc0b7c198843ccaebe904f4653fb154" title="ByteExtractStringUint16" alt="" coords="773,303,936,330"/><area shape="rect" id="node28" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="773,354,936,380"/><area shape="rect" id="node29" href="stream_8c.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="779,506,931,532"/><area shape="rect" id="node35" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22" title="alloc a tcp segment pool entry " alt="" coords="1011,607,1162,634"/><area shape="rect" id="node36" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7" title="clean up a tcp segment pool entry " alt="" coords="769,455,940,482"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="785,632,925,659"/><area shape="rect" id="node27" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="1024,303,1149,330"/><area shape="rect" id="node30" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="1015,556,1159,583"/><area shape="rect" id="node32" href="stream_8c.html#ad6cd583c3811736afb335193f3e703c4" title="StreamMsgInit" alt="" coords="1033,506,1140,532"/><area shape="rect" id="node33" href="stream_8c.html#a38c2100a3b1c2756eb194d50f0bd49f7" title="StreamMsgPoolFree" alt="" coords="1016,455,1157,482"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="1231,600,1428,641"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments. " alt="" coords="1211,418,1448,444"/><area shape="rect" id="node39" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="472,760,699,787"/><area shape="rect" id="node42" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK list from a stream. " alt="" coords="504,963,667,990"/><area shape="rect" id="node43" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="501,811,670,838"/><area shape="rect" id="node44" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="503,862,667,888"/><area shape="rect" id="node45" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool " alt="" coords="791,887,918,914"/><area shape="rect" id="node40" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="747,760,962,787"/><area shape="rect" id="node41" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1043,811,1130,838"/><area shape="rect" id="node47" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="498,1014,673,1040"/><area shape="rect" id="node50" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="506,1064,665,1091"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_icgraph.png" border="0" usemap="#stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_icgraph" id="stream-tcp_8c_a2bf90c14b7c88907917a56107604dfeb_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="197,5,248,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af03aa3237dccab0112a80bb24ded9e19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpMemuseCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00149">149</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph.png" border="0" usemap="#stream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph" alt=""/></div>
<map name="stream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph" id="stream-tcp_8c_af03aa3237dccab0112a80bb24ded9e19_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="238,5,381,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="429,5,480,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae79e61268f43482932954f1cc027eec8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a>* StreamTcpNewSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function is used to to fetch a TCP session from the ssn_pool, when a TCP SYN is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">quiet</td><td>Packet P, which has been recieved for the new TCP session.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TcpSession</td><td>A new TCP session with field initilaized to 0/NULL. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00642">642</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="decode_8h_source.html#l00247">PKT_IS_TOCLIENT</a>, <a class="el" href="decode_8h_source.html#l00246">PKT_IS_TOSERVER</a>, <a class="el" href="util-pool-thread_8c_source.html#l00153">PoolThreadGetById()</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream-tcp_8h_source.html#l00051">TcpStreamCnf_::ssn_init_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00218">TcpSession_::state</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00069">TcpStream_::tcp_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00095">TCP_NONE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00222">TcpSession_::tcp_packet_flags</a>, and <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ae79e61268f43482932954f1cc027eec8_cgraph.png" border="0" usemap="#stream-tcp_8c_ae79e61268f43482932954f1cc027eec8_cgraph" alt=""/></div>
<map name="stream-tcp_8c_ae79e61268f43482932954f1cc027eec8_cgraph" id="stream-tcp_8c_ae79e61268f43482932954f1cc027eec8_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga3f594a299b98ed547fbb24a494dca1f2" title="get data from thread pool by thread id " alt="" coords="213,5,349,32"/><area shape="rect" id="node3" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="397,5,467,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a248c85404fa06db3bc2b7d8d2f8de3a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *&#160;</td>
          <td class="paramname"><em>stt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l04451">4451</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp_8h_source.html#l00108">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp_8h_source.html#l00104">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00106">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="util-validate_8h_source.html#l00103">DEBUG_ASSERT_FLOW_LOCKED</a>, <a class="el" href="decode_8h_source.html#l00925">DecodeSetNoPacketInspectionFlag</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="decode_8h_source.html#l00802">PACKET_DROP</a>, <a class="el" href="packet-queue_8c_source.html#l00164">PacketDequeue()</a>, <a class="el" href="packet-queue_8c_source.html#l00136">PacketEnqueue()</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l00247">PKT_IS_TOCLIENT</a>, <a class="el" href="decode_8h_source.html#l00246">PKT_IS_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l01026">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="decode_8h_source.html#l01023">PKT_STREAM_EST</a>, <a class="el" href="decode_8h_source.html#l01027">PKT_STREAM_MODIFIED</a>, <a class="el" href="decode_8h_source.html#l01029">PKT_STREAM_NOPCAPLOG</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00088">StreamTcpThread_::pseudo_queue</a>, <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-checksum_8c_source.html#l00030">ReCalculateChecksum()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00218">TcpSession_::state</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="decode-events_8h_source.html#l00203">STREAM_PKT_BROKEN_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00118">STREAMTCP_FLAG_MIDSTREAM_SYNACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00159">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00281">StreamTcpDisableAppLayer()</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">StreamTcpReassembleHandleSegment()</a>, <a class="el" href="stream-tcp_8c_source.html#l00250">StreamTcpSessionPktFree()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00104">TCP_CLOSE_WAIT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00106">TCP_CLOSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00105">TCP_CLOSING</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00099">TCP_ESTABLISHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00100">TCP_FIN_WAIT1</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00101">TCP_FIN_WAIT2</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00069">TcpStream_::tcp_flags</a>, <a class="el" href="decode-tcp_8h_source.html#l00104">TCP_GET_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00103">TCP_LAST_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00095">TCP_NONE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00222">TcpSession_::tcp_packet_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00098">TCP_SYN_RECV</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00097">TCP_SYN_SENT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00102">TCP_TIME_WAIT</a>, <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00039">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00037">TH_RST</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_SYN</a>, <a class="el" href="flow_8h_source.html#l00376">Flow_::thread_id</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph.png" border="0" usemap="#stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph" id="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph">
<area shape="rect" id="node2" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="224,5,339,32"/><area shape="rect" id="node3" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="224,56,339,83"/><area shape="rect" id="node4" href="util-checksum_8c.html#ab76beb6b62cf242b0fc2b4373fde7081" title="ReCalculateChecksum" alt="" coords="203,107,360,133"/><area shape="rect" id="node5" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1300,587,1375,613"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1799,107,1985,133"/><area shape="rect" id="node7" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="1524,309,1673,336"/><area shape="rect" id="node8" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67" title="StreamTcpReassembleHandle\lSegment" alt="" coords="181,333,381,374"/><area shape="rect" id="node44" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool. " alt="" coords="192,865,371,892"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="705,423,919,449"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="443,673,643,714"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="443,333,643,374"/><area shape="rect" id="node10" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1251,485,1424,512"/><area shape="rect" id="node29" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="1024,485,1128,512"/><area shape="rect" id="node30" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="1041,789,1111,816"/><area shape="rect" id="node32" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="969,840,1183,867"/><area shape="rect" id="node11" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="1505,782,1692,823"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="1789,563,1995,589"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1524,360,1673,387"/><area shape="rect" id="node23" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1499,651,1698,677"/><area shape="rect" id="node24" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="1522,600,1675,627"/><area shape="rect" id="node28" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="1539,448,1658,475"/><area shape="rect" id="node22" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1758,512,2026,539"/><area shape="rect" id="node13" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="2119,487,2270,513"/><area shape="rect" id="node15" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1810,157,1974,184"/><area shape="rect" id="node17" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1811,309,1973,336"/><area shape="rect" id="node19" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1805,461,1979,488"/><area shape="rect" id="node18" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="2099,259,2290,285"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1785,360,1999,387"/><area shape="rect" id="node21" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1755,259,2029,285"/><area shape="rect" id="node16" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="2077,157,2312,184"/><area shape="rect" id="node25" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1795,613,1989,640"/><area shape="rect" id="node26" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="2109,613,2281,640"/><area shape="rect" id="node27" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="2361,606,2554,647"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="1299,789,1376,816"/><area shape="rect" id="node33" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1294,840,1381,867"/><area shape="rect" id="node35" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988" title="Function to get the segment of required length from the pool. " alt="" coords="733,637,891,664"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3" title="StreamTcpReassembleInsert\lSegment" alt="" coords="716,807,908,849"/><area shape="rect" id="node36" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="1041,637,1111,664"/><area shape="rect" id="node38" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="995,941,1157,968"/><area shape="rect" id="node39" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="1232,992,1443,1019"/><area shape="rect" id="node41" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="1232,941,1443,968"/><area shape="rect" id="node40" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="1491,992,1706,1019"/><area shape="rect" id="node42" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="1491,941,1706,968"/><area shape="rect" id="node45" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="429,903,656,929"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph.png" border="0" usemap="#stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph" id="stream-tcp_8c_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="182,5,269,32"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="318,5,514,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="563,5,698,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="747,5,845,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1091,5,1141,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="893,31,1043,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad855fab70c5359eb4d6e2671925fdaa4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpPseudoPacketCreateStreamEndPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *&#160;</td>
          <td class="paramname"><em>stt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wrap up stream reassembly. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>real packet </td></tr>
    <tr><td class="paramname">pq</td><td>packet queue to store the new pseudo packet in </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05856">5856</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp_8h_source.html#l00094">StreamTcpThread_::counter_tcp_pseudo</a>, <a class="el" href="stream-tcp_8h_source.html#l00096">StreamTcpThread_::counter_tcp_pseudo_failed</a>, <a class="el" href="decode_8h_source.html#l00925">DecodeSetNoPacketInspectionFlag</a>, <a class="el" href="decode_8h_source.html#l00913">DecodeSetNoPayloadInspectionFlag</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00171">FLOW_PKT_TOCLIENT</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="decode_8h_source.html#l00214">GET_PKT_DATA</a>, <a class="el" href="decode_8h_source.html#l00213">GET_PKT_LEN</a>, <a class="el" href="packet-queue_8c_source.html#l00136">PacketEnqueue()</a>, <a class="el" href="decode_8h_source.html#l01025">PKT_HAS_FLOW</a>, <a class="el" href="decode_8h_source.html#l00247">PKT_IS_TOCLIENT</a>, <a class="el" href="decode_8h_source.html#l00246">PKT_IS_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l01018">PKT_NOPACKET_INSPECTION</a>, <a class="el" href="decode_8h_source.html#l01019">PKT_NOPAYLOAD_INSPECTION</a>, <a class="el" href="decode_8h_source.html#l01026">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="decode_8h_source.html#l01047">PKT_SET_SRC</a>, <a class="el" href="decode_8h_source.html#l00054">PKT_SRC_STREAM_TCP_STREAM_END_PSEUDO</a>, <a class="el" href="decode_8h_source.html#l01024">PKT_STREAM_EOF</a>, <a class="el" href="decode_8h_source.html#l01023">PKT_STREAM_EST</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="stream-tcp_8c_source.html#l05763">StreamTcpPseudoSetup()</a>, <a class="el" href="flow_8h_source.html#l00334">Flow_::tenant_id</a>, and <a class="el" href="decode_8h_source.html#l00542">Packet_::tenant_id</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ad855fab70c5359eb4d6e2671925fdaa4_cgraph.png" border="0" usemap="#stream-tcp_8c_ad855fab70c5359eb4d6e2671925fdaa4_cgraph" alt=""/></div>
<map name="stream-tcp_8c_ad855fab70c5359eb4d6e2671925fdaa4_cgraph" id="stream-tcp_8c_ad855fab70c5359eb4d6e2671925fdaa4_cgraph">
<area shape="rect" id="node2" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="289,5,404,32"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="309,56,384,83"/><area shape="rect" id="node4" href="stream-tcp_8c.html#a25423d5ef88cdfe44ae21872cdff7ce2" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="265,107,429,133"/><area shape="rect" id="node5" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="477,81,672,108"/><area shape="rect" id="node9" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="513,132,636,159"/><area shape="rect" id="node6" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="725,31,875,57"/><area shape="rect" id="node7" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="729,81,871,108"/><area shape="rect" id="node8" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="929,81,1018,108"/><area shape="rect" id="node10" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="721,132,879,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a25423d5ef88cdfe44ae21872cdff7ce2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* StreamTcpPseudoSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>Pointer to the parent of the pseudo packet </td></tr>
    <tr><td class="paramname">pkt</td><td>pointer to the raw packet of the parent </td></tr>
    <tr><td class="paramname">len</td><td>length of the packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>upon success returns the pointer to the new pseudo packet otherwise NULL </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05763">5763</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00518">Packet_::datalink</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="decode_8c_source.html#l00241">PacketCopyData()</a>, <a class="el" href="decode_8c_source.html#l00163">PacketGetFromQueueOrAlloc()</a>, <a class="el" href="decode_8h_source.html#l00385">Packet_::proto</a>, <a class="el" href="decode_8h_source.html#l00388">Packet_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00525">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>, <a class="el" href="decode_8h_source.html#l00849">SET_TUNNEL_PKT</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, and <a class="el" href="decode_8h_source.html#l00829">TUNNEL_INCR_PKT_TPR</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05856">StreamTcpPseudoPacketCreateStreamEndPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_cgraph.png" border="0" usemap="#stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_cgraph" id="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="255,5,377,32"/><area shape="rect" id="node4" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="219,56,413,83"/><area shape="rect" id="node3" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="462,5,621,32"/><area shape="rect" id="node5" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="466,56,617,83"/><area shape="rect" id="node6" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="470,107,613,133"/><area shape="rect" id="node7" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="670,107,759,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_icgraph.png" border="0" usemap="#stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_icgraph" id="stream-tcp_8c_a25423d5ef88cdfe44ae21872cdff7ce2_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="219,5,429,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a477c59db3b1fef12cb9b1e5e5de0f59f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleMemuseGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00138">138</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph.png" border="0" usemap="#stream-tcp_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" id="stream-tcp_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="265,12,442,39"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="491,12,634,39"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="683,12,733,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a47042a286da78d0a3ddd510991b3efcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l10738">10738</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8c_source.html#l08689">StreamTcpReassembleRegisterTests()</a>, and <a class="el" href="stream-tcp-sack_8c_source.html#l00928">StreamTcpSackRegisterTests()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_cgraph.png" border="0" usemap="#stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_cgraph" id="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f" title="The Function Register the Unit tests to test the reassembly engine for various OS policies..." alt="" coords="221,23,429,65"/><area shape="rect" id="node5" href="stream-tcp-sack_8c.html#a893ea33421ab3dff83dc070805d38376" title="StreamTcpSackRegisterTests" alt="" coords="226,89,425,116"/><area shape="rect" id="node3" href="stream-tcp-inline_8c.html#ad01a33c39b0309dd536c8cf89f6cf83a" title="StreamTcpInlineRegisterTests" alt="" coords="478,5,677,32"/><area shape="rect" id="node4" href="stream-tcp-util_8c.html#a44bf885919a659b8132eaa84aefee888" title="StreamTcpUtilRegisterTests" alt="" coords="483,56,671,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_icgraph.png" border="0" usemap="#stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_icgraph" id="stream-tcp_8c_a47042a286da78d0a3ddd510991b3efcf_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="222,5,418,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="467,5,602,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="651,5,749,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="995,5,1045,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="797,31,947,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a96d6fa8305eedd10a095558194edf776"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReturnStreamSegments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return all segments in this stream into the pool(s) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>the stream to cleanup </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">262</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00086">TcpStream_::seg_list_tail</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">StreamTcpSegmentReturntoPool()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, <a class="el" href="stream-tcp_8c_source.html#l00250">StreamTcpSessionPktFree()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph.png" border="0" usemap="#stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph" id="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="281,5,495,32"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="545,5,631,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph.png" border="0" usemap="#stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph" id="stream-tcp_8c_a96d6fa8305eedd10a095558194edf776_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="302,5,466,32"/><area shape="rect" id="node5" href="stream-tcp_8h.html#a48310db5e37bea30b769a8d6af0dbb80" title="Function to return the stream segments back to the pool. " alt="" coords="295,107,473,133"/><area shape="rect" id="node12" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="281,56,487,83"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="537,5,679,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1693,56,1744,83"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="545,107,671,133"/><area shape="rect" id="node7" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="757,107,843,133"/><area shape="rect" id="node8" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="921,81,1117,108"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1166,81,1301,108"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1349,81,1448,108"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1496,56,1645,83"/><area shape="rect" id="node13" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="728,56,872,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85b1902bbd69d2620d60ce5e2cdfbdd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSegmentForEach </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#af77f28d6baf7af12803dad7cd4b7084a">StreamSegmentCallback</a>&#160;</td>
          <td class="paramname"><em>CallbackFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run callback function on each TCP segment. </p>
<p>This function is used by StreamMsgForEach() which should be used directly.</p>
<dl class="section return"><dt>Returns</dt><dd>-1 in case of error, the number of segment in case of success </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05929">5929</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00207">FLOWLOCK_RDLOCK</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>.</p>

<p>Referenced by <a class="el" href="stream_8c_source.html#l00274">StreamSegmentForEach()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph.png" border="0" usemap="#stream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" id="stream-tcp_8c_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph">
<area shape="rect" id="node2" href="stream_8h.html#af1a6a686c53801b6b418efe258add530" title="Run callback for all segments. " alt="" coords="240,5,405,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="add92e80f13e88362630ba978ac24c241"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionClear </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ssnptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream back to the pool. It returns the segments in the stream to the segment pool. </p>
<p>This function is called when the flow is destroyed, so it should free <em>everything</em> related to the tcp session. So including the app layer data. We are guaranteed to only get here when the flow's use_cnt is 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>Void ptr to the ssn. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00178">178</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream_8h_source.html#l00037">StreamMsg_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="util-pool-thread_8c_source.html#l00172">PoolThreadReturn()</a>, <a class="el" href="stream_8h_source.html#l00038">StreamMsg_::prev</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00219">TcpSession_::queue_len</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream_8c_source.html#l00109">StreamMsgReturnToPool()</a>, <a class="el" href="stream-tcp_8c_source.html#l00143">StreamTcpDecrMemuse()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>, <a class="el" href="stream-tcp-sack_8c_source.html#l00338">StreamTcpSackFreeList()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00229">TcpSession_::toclient_smsg_head</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00227">TcpSession_::toserver_smsg_head</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph.png" border="0" usemap="#stream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph" alt=""/></div>
<map name="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph" id="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool " alt="" coords="538,5,665,32"/><area shape="rect" id="node4" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="517,56,686,83"/><area shape="rect" id="node5" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="250,107,414,133"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="219,157,445,184"/><area shape="rect" id="node8" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK list from a stream. " alt="" coords="251,208,413,235"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="758,56,845,83"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="494,132,709,159"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_icgraph.png" border="0" usemap="#stream-tcp_8c_add92e80f13e88362630ba978ac24c241_icgraph" alt=""/></div>
<map name="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_icgraph" id="stream-tcp_8c_add92e80f13e88362630ba978ac24c241_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="219,5,362,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="411,5,461,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af9f131faa6d6c797ab5d639c88418a1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionPktFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream segments back to the pool. </p>
<p>We don't clear out the app layer storage here as that is under protection of the "use_cnt" reference counter in the flow. This function is called when the use_cnt is always at least 1 (this pkt has incremented the flow use_cnt itself), so we don't bother.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Packet used to identify the stream. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00250">250</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph.png" border="0" usemap="#stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph" alt=""/></div>
<map name="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph" id="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="232,5,459,32"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="507,5,722,32"/><area shape="rect" id="node4" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="771,5,858,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_icgraph.png" border="0" usemap="#stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_icgraph" alt=""/></div>
<map name="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_icgraph" id="stream-tcp_8c_af9f131faa6d6c797ab5d639c88418a1e_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="233,5,359,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="409,5,495,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="545,5,741,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="790,5,925,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="973,5,1072,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1317,5,1368,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1120,31,1269,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a149be8c880933a5c3d0e4a2de749977b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* StreamTcpSessionPoolAlloc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stream alloc function for the Pool. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>void ptr to TcpSession structure with all vars set to 0/NULL </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00267">267</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="stream-tcp_8c_source.html#l00161">StreamTcpCheckMemcap()</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_cgraph.png" border="0" usemap="#stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_cgraph" id="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="243,5,418,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_icgraph.png" border="0" usemap="#stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_icgraph" id="stream-tcp_8c_a149be8c880933a5c3d0e4a2de749977b_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="462,5,605,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="243,56,387,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1208,56,1259,83"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="435,56,631,83"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="681,56,815,83"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="864,56,963,83"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1011,107,1160,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeb09a993ff83021bd05e01e8c8787937"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionPoolCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pool free function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Void ptr to TcpSession memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00291">291</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream_8h_source.html#l00037">StreamMsg_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="stream_8h_source.html#l00038">StreamMsg_::prev</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00219">TcpSession_::queue_len</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream_8c_source.html#l00109">StreamMsgReturnToPool()</a>, <a class="el" href="stream-tcp_8c_source.html#l00143">StreamTcpDecrMemuse()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00229">TcpSession_::toclient_smsg_head</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00227">TcpSession_::toserver_smsg_head</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_cgraph.png" border="0" usemap="#stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_cgraph" alt=""/></div>
<map name="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_cgraph" id="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_cgraph">
<area shape="rect" id="node2" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="559,5,729,32"/><area shape="rect" id="node4" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="293,43,457,69"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="261,93,488,120"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="801,37,887,64"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="537,68,751,95"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_icgraph.png" border="0" usemap="#stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_icgraph" alt=""/></div>
<map name="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_icgraph" id="stream-tcp_8c_aeb09a993ff83021bd05e01e8c8787937_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="481,5,623,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="261,56,405,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1227,56,1277,83"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="454,56,650,83"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="699,56,834,83"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="883,56,981,83"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1029,107,1179,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a434ace0515e1fafb67276969b1e2a7d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSessionPoolInit </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>initdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00281">281</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8c_source.html#l00137">StreamTcpIncrMemuse()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_cgraph.png" border="0" usemap="#stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_cgraph" id="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="233,5,391,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_icgraph.png" border="0" usemap="#stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_icgraph" id="stream-tcp_8c_a434ace0515e1fafb67276969b1e2a7d2_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="451,5,594,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="232,56,376,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1197,56,1248,83"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="425,56,621,83"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="670,56,805,83"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="853,56,952,83"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1000,107,1149,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a740e5a7f3e6792cf64cfe9926a93abb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetDisableRawReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the No reassembly flag for the given direction in given TCP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05718">5718</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00171">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>.</p>

<p>Referenced by <a class="el" href="app-layer-parser_8c_source.html#l00854">AppLayerParserParse()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a740e5a7f3e6792cf64cfe9926a93abb6_icgraph.png" border="0" usemap="#stream-tcp_8c_a740e5a7f3e6792cf64cfe9926a93abb6_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a740e5a7f3e6792cf64cfe9926a93abb6_icgraph" id="stream-tcp_8c_a740e5a7f3e6792cf64cfe9926a93abb6_icgraph">
<area shape="rect" id="node2" href="app-layer-parser_8h.html#a781eb6e91987a99a3b9fceb2e4af5806" title="AppLayerParserParse" alt="" coords="328,221,477,248"/><area shape="rect" id="node3" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="525,103,699,129"/><area shape="rect" id="node15" href="app-layer_8h.html#aef5d5c65f7222215acfe0bcbcd2c8a6e" title="Handles an udp chunk. " alt="" coords="541,340,683,367"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="747,40,851,67"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="899,71,1114,97"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="1416,55,1616,97"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="1163,5,1363,46"/><area shape="rect" id="node7" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1670,172,1797,199"/><area shape="rect" id="node8" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1891,223,1978,249"/><area shape="rect" id="node9" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="2091,476,2287,503"/><area shape="rect" id="node10" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2366,1008,2501,1035"/><area shape="rect" id="node11" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2564,1008,2663,1035"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2912,1008,2963,1035"/><area shape="rect" id="node13" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2715,1033,2864,1060"/><area shape="rect" id="node16" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="751,527,847,553"/><area shape="rect" id="node17" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="959,527,1055,553"/><area shape="rect" id="node49" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="959,932,1055,959"/><area shape="rect" id="node50" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="938,983,1075,1009"/><area shape="rect" id="node18" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1675,831,1791,857"/><area shape="rect" id="node39" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1212,983,1313,1009"/><area shape="rect" id="node30" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1883,628,1986,655"/><area shape="rect" id="node41" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1215,932,1310,959"/><area shape="rect" id="node43" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1471,1185,1561,1212"/><area shape="rect" id="node44" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1686,1033,1781,1060"/><area shape="rect" id="node45" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1183,527,1343,553"/><area shape="rect" id="node48" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1686,1084,1781,1111"/><area shape="rect" id="node47" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1692,983,1775,1009"/><area shape="rect" id="node26" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2136,679,2243,705"/><area shape="rect" id="node46" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1465,697,1567,724"/><area shape="rect" id="node19" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1888,1033,1981,1060"/><area shape="rect" id="node21" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1881,780,1989,807"/><area shape="rect" id="node23" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1882,831,1987,857"/><area shape="rect" id="node25" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1873,679,1996,705"/><area shape="rect" id="node31" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1886,1135,1983,1161"/><area shape="rect" id="node33" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1884,932,1985,959"/><area shape="rect" id="node35" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1873,983,1996,1009"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1845,1084,2024,1111"/><area shape="rect" id="node20" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="2088,1033,2291,1060"/><area shape="rect" id="node22" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="2080,780,2299,807"/><area shape="rect" id="node24" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="2082,856,2297,883"/><area shape="rect" id="node27" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="2355,185,2511,212"/><area shape="rect" id="node28" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="2565,261,2661,288"/><area shape="rect" id="node29" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="2560,185,2667,212"/><area shape="rect" id="node32" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="2086,1135,2293,1161"/><area shape="rect" id="node34" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="2084,932,2295,959"/><area shape="rect" id="node36" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="2073,983,2306,1009"/><area shape="rect" id="node38" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2074,1084,2305,1111"/><area shape="rect" id="node40" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="1411,1287,1621,1313"/><area shape="rect" id="node42" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1413,1236,1619,1263"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4bbabc99ab491dd9fa822fd5b3ade953"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetOSPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the OS policy for the given stream based on the destination of the received packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>TcpStream of which os_policy needs to set </td></tr>
    <tr><td class="paramname">p</td><td>Packet which is used to set the os policy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00709">709</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00206">GET_IPV4_DST_ADDR_PTR</a>, <a class="el" href="decode_8h_source.html#l00209">GET_IPV6_DST_ADDR</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00068">TcpStream_::os_policy</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00037">OS_POLICY_BSD</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00038">OS_POLICY_BSD_RIGHT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00069">OS_POLICY_DEFAULT</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00041">OS_POLICY_OLD_SOLARIS</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00042">OS_POLICY_SOLARIS</a>, <a class="el" href="decode_8h_source.html#l00240">PKT_IS_IPV4</a>, <a class="el" href="decode_8h_source.html#l00241">PKT_IS_IPV6</a>, <a class="el" href="util-host-os-info_8c_source.html#l00291">SCHInfoGetIPv4HostOSFlavour()</a>, <a class="el" href="util-host-os-info_8c_source.html#l00309">SCHInfoGetIPv6HostOSFlavour()</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00729">StreamTcpReassembleInsertSegment()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph.png" border="0" usemap="#stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph" id="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_cgraph">
<area shape="rect" id="node2" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="216,5,427,32"/><area shape="rect" id="node4" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="216,56,427,83"/><area shape="rect" id="node3" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="475,5,690,32"/><area shape="rect" id="node5" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="475,56,690,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph.png" border="0" usemap="#stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph" id="stream-tcp_8c_a4bbabc99ab491dd9fa822fd5b3ade953_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#aff3c4ea45ef46a39eda09a7bda2150f6" title="StreamTcpReassembleInsert\lSegment" alt="" coords="216,5,408,46"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="456,5,656,46"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="704,5,904,46"/><area shape="rect" id="node5" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="953,12,1079,39"/><area shape="rect" id="node6" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1129,12,1215,39"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1265,12,1461,39"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1510,12,1645,39"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1693,12,1792,39"/><area shape="rect" id="node10" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2037,12,2088,39"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1840,37,1989,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9d7e90ce0fb1612fdb875cc836a9daa1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSetSessionNoReassemblyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the No reassembly flag for the given direction in given TCP session. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TCP Session to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in: 0 toserver, 1 toclient </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05706">5706</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00083">AppLayerHandleTCPData()</a>, and <a class="el" href="app-layer-parser_8c_source.html#l00854">AppLayerParserParse()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a9d7e90ce0fb1612fdb875cc836a9daa1_icgraph.png" border="0" usemap="#stream-tcp_8c_a9d7e90ce0fb1612fdb875cc836a9daa1_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a9d7e90ce0fb1612fdb875cc836a9daa1_icgraph" id="stream-tcp_8c_a9d7e90ce0fb1612fdb875cc836a9daa1_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="520,103,693,129"/><area shape="rect" id="node14" href="app-layer-parser_8h.html#a781eb6e91987a99a3b9fceb2e4af5806" title="AppLayerParserParse" alt="" coords="323,153,472,180"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="741,40,845,67"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="894,71,1109,97"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="1411,55,1611,97"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="1157,5,1357,46"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1665,172,1791,199"/><area shape="rect" id="node7" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1886,223,1973,249"/><area shape="rect" id="node8" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="2086,476,2282,503"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2361,1008,2495,1035"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2559,1008,2657,1035"/><area shape="rect" id="node11" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2907,1008,2957,1035"/><area shape="rect" id="node12" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2709,1033,2859,1060"/><area shape="rect" id="node15" href="app-layer_8h.html#aef5d5c65f7222215acfe0bcbcd2c8a6e" title="Handles an udp chunk. " alt="" coords="535,340,678,367"/><area shape="rect" id="node16" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="745,527,841,553"/><area shape="rect" id="node17" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="953,527,1049,553"/><area shape="rect" id="node49" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="953,932,1049,959"/><area shape="rect" id="node50" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="933,983,1070,1009"/><area shape="rect" id="node18" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1670,831,1786,857"/><area shape="rect" id="node39" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1207,983,1308,1009"/><area shape="rect" id="node30" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1878,628,1981,655"/><area shape="rect" id="node41" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1210,932,1305,959"/><area shape="rect" id="node43" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1465,1185,1556,1212"/><area shape="rect" id="node44" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1681,1033,1775,1060"/><area shape="rect" id="node45" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1177,527,1337,553"/><area shape="rect" id="node48" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1681,1084,1775,1111"/><area shape="rect" id="node47" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1687,983,1769,1009"/><area shape="rect" id="node26" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2131,679,2237,705"/><area shape="rect" id="node46" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1459,697,1562,724"/><area shape="rect" id="node19" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1883,1033,1976,1060"/><area shape="rect" id="node21" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1875,780,1983,807"/><area shape="rect" id="node23" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1877,831,1982,857"/><area shape="rect" id="node25" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1868,679,1991,705"/><area shape="rect" id="node31" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1881,1135,1978,1161"/><area shape="rect" id="node33" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1879,932,1980,959"/><area shape="rect" id="node35" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1868,983,1991,1009"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1840,1084,2019,1111"/><area shape="rect" id="node20" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="2083,1033,2285,1060"/><area shape="rect" id="node22" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="2075,780,2293,807"/><area shape="rect" id="node24" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="2077,856,2291,883"/><area shape="rect" id="node27" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="2350,197,2506,224"/><area shape="rect" id="node28" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="2560,243,2656,269"/><area shape="rect" id="node29" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="2555,160,2661,187"/><area shape="rect" id="node32" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="2081,1135,2287,1161"/><area shape="rect" id="node34" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="2079,932,2289,959"/><area shape="rect" id="node36" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="2067,983,2301,1009"/><area shape="rect" id="node38" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2069,1084,2299,1111"/><area shape="rect" id="node40" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="1405,1287,1616,1313"/><area shape="rect" id="node42" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1408,1236,1613,1263"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aec7b18dbcad0affb03714548e584c4ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadDeinit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05141">5141</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00586">StreamTcpReassembleFreeThreadCtx()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_cgraph.png" border="0" usemap="#stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_cgraph" alt=""/></div>
<map name="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_cgraph" id="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc" title="StreamTcpReassembleFreeThreadCtx" alt="" coords="214,96,461,123"/><area shape="rect" id="node3" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="509,96,693,123"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="741,67,944,93"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="746,118,939,159"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="993,5,1202,46"/><area shape="rect" id="node7" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="997,71,1197,97"/><area shape="rect" id="node6" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1251,12,1402,39"/><area shape="rect" id="node9" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="1060,125,1135,152"/><area shape="rect" id="node10" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1278,125,1375,152"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_icgraph.png" border="0" usemap="#stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_icgraph" alt=""/></div>
<map name="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_icgraph" id="stream-tcp_8c_aec7b18dbcad0affb03714548e584c4ad_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="214,5,410,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="459,5,594,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="643,5,741,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="987,5,1037,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="789,31,939,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92a4a607332f606574d63bd2ec158ebe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>initdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05074">5074</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00098">StreamTcpThread_::counter_tcp_invalid_checksum</a>, <a class="el" href="stream-tcp_8h_source.html#l00100">StreamTcpThread_::counter_tcp_no_flow</a>, <a class="el" href="stream-tcp_8h_source.html#l00094">StreamTcpThread_::counter_tcp_pseudo</a>, <a class="el" href="stream-tcp_8h_source.html#l00096">StreamTcpThread_::counter_tcp_pseudo_failed</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00061">TcpReassemblyThreadCtx_::counter_tcp_reass_gap</a>, <a class="el" href="stream-tcp_8h_source.html#l00108">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00057">TcpReassemblyThreadCtx_::counter_tcp_segment_memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00090">StreamTcpThread_::counter_tcp_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00092">StreamTcpThread_::counter_tcp_ssn_memcap</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00059">TcpReassemblyThreadCtx_::counter_tcp_stream_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00104">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00106">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="util-pool-thread_8c_source.html#l00088">PoolThreadGrow()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00038">PoolThreadInit()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00126">PoolThreadSize()</a>, <a class="el" href="stream-tcp_8h_source.html#l00057">TcpStreamCnf_::prealloc_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00081">StreamTcpThread_::runmode_flow_stream_async</a>, <a class="el" href="util-runmodes_8c_source.html#l00064">RunmodeGetFlowStreamAsync()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp_8h_source.html#l00077">StreamTcpThread_::ssn_pool_id</a>, <a class="el" href="counters_8c_source.html#l00850">StatsRegisterCounter()</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00572">StreamTcpReassembleInitThreadCtx()</a>, <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>, <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>, <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_cgraph.png" border="0" usemap="#stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_cgraph" id="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga1262188db7dd25b18e1c4e58d8f6e59c" title="grow a thread pool by one " alt="" coords="258,5,377,32"/><area shape="rect" id="node5" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="264,56,371,83"/><area shape="rect" id="node7" href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce" title="get size of PoolThread (number of &#39;threads&#39;, so array elements) " alt="" coords="260,107,375,133"/><area shape="rect" id="node8" href="util-runmodes_8c.html#af065af67120665e6faa84ad4c184424b" title="RunmodeGetFlowStreamAsync" alt="" coords="214,157,421,184"/><area shape="rect" id="node9" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="243,208,391,235"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#a5dc1a2f2120af56ff09791171c822897" title="StreamTcpReassembleInitThreadCtx" alt="" coords="198,259,437,285"/><area shape="rect" id="node24" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="223,309,411,336"/><area shape="rect" id="node26" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="214,385,421,412"/><area shape="rect" id="node32" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="229,461,406,488"/><area shape="rect" id="node3" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="565,5,632,32"/><area shape="rect" id="node4" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="831,31,905,57"/><area shape="rect" id="node6" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="541,56,656,83"/><area shape="rect" id="node11" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="519,237,678,264"/><area shape="rect" id="node12" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="776,179,960,205"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="1024,229,1229,256"/><area shape="rect" id="node22" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="773,281,963,322"/><area shape="rect" id="node13" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="1025,175,1228,201"/><area shape="rect" id="node17" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="1030,281,1223,322"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="1278,109,1487,150"/><area shape="rect" id="node16" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="1283,175,1483,201"/><area shape="rect" id="node15" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1537,175,1687,201"/><area shape="rect" id="node18" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="1345,292,1420,319"/><area shape="rect" id="node19" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1563,292,1661,319"/><area shape="rect" id="node21" href="app-layer-parser_8c.html#a2b0517e26b65ae0299677d4f097b223f" title="AppLayerParserGetProtocol\lParserLocalStorage" alt="" coords="1291,226,1475,267"/><area shape="rect" id="node23" href="util-mpm_8c.html#aef0b59171845a87218792da6eb8cdfea" title="Setup a pmq. " alt="" coords="1085,347,1168,373"/><area shape="rect" id="node25" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="511,296,686,323"/><area shape="rect" id="node27" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="783,347,953,373"/><area shape="rect" id="node29" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="517,448,681,475"/><area shape="rect" id="node30" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="485,397,712,424"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1083,397,1170,424"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="761,397,975,424"/><area shape="rect" id="node33" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="519,499,678,525"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_icgraph.png" border="0" usemap="#stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_icgraph" alt=""/></div>
<map name="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_icgraph" id="stream-tcp_8c_a92a4a607332f606574d63bd2ec158ebe_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="198,5,394,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="443,5,578,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="627,5,725,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="971,5,1021,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="773,31,923,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8803814028dbe6165bae8ced1a27d2f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TcpSessionPacketSsnReuse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>tcp_ssn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l04870">4870</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00385">Packet_::proto</a>, <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>, and <a class="el" href="stream-tcp_8c_source.html#l04855">TcpSessionReuseDoneEnough()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_a8803814028dbe6165bae8ced1a27d2f2_cgraph.png" border="0" usemap="#stream-tcp_8c_a8803814028dbe6165bae8ced1a27d2f2_cgraph" alt=""/></div>
<map name="stream-tcp_8c_a8803814028dbe6165bae8ced1a27d2f2_cgraph" id="stream-tcp_8c_a8803814028dbe6165bae8ced1a27d2f2_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#aca31769dee3279d1ede0501420f5253d" title="Check if SSN is done enough for reuse. " alt="" coords="249,5,453,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca31769dee3279d1ede0501420f5253d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TcpSessionReuseDoneEnough </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if SSN is done enough for reuse. </p>
<p>Reuse means a new TCP session reuses the tuple (flow in suri)</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">bool</td><td>true if ssn can be reused, false if not </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l04855">4855</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00059">TcpStreamCnf_::async_oneside</a>, <a class="el" href="stream-tcp_8h_source.html#l00058">TcpStreamCnf_::midstream</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00039">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_SYN</a>, and <a class="el" href="suricata-common_8h_source.html#l00033">TRUE</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l04870">TcpSessionPacketSsnReuse()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_aca31769dee3279d1ede0501420f5253d_icgraph.png" border="0" usemap="#stream-tcp_8c_aca31769dee3279d1ede0501420f5253d_icgraph" alt=""/></div>
<map name="stream-tcp_8c_aca31769dee3279d1ede0501420f5253d_icgraph" id="stream-tcp_8c_aca31769dee3279d1ede0501420f5253d_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8803814028dbe6165bae8ced1a27d2f2" title="TcpSessionPacketSsnReuse" alt="" coords="259,5,453,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac7570830e107bef9adb9c4a729222114"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmModuleStreamTcpRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00125">125</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="tm-modules_8h_source.html#l00060">TmModule_::cap_flags</a>, <a class="el" href="tm-modules_8h_source.html#l00063">TmModule_::flags</a>, <a class="el" href="tm-modules_8h_source.html#l00048">TmModule_::Func</a>, <a class="el" href="tm-modules_8h_source.html#l00040">TmModule_::name</a>, <a class="el" href="tm-modules_8h_source.html#l00058">TmModule_::RegisterTests</a>, <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>, <a class="el" href="stream-tcp_8c_source.html#l05161">StreamTcpExitPrintStats()</a>, <a class="el" href="stream-tcp_8c_source.html#l10738">StreamTcpRegisterTests()</a>, <a class="el" href="stream-tcp_8c_source.html#l05141">StreamTcpThreadDeinit()</a>, <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>, <a class="el" href="tm-modules_8h_source.html#l00045">TmModule_::ThreadDeinit</a>, <a class="el" href="tm-modules_8h_source.html#l00044">TmModule_::ThreadExitPrintStats</a>, <a class="el" href="tm-modules_8h_source.html#l00043">TmModule_::ThreadInit</a>, <a class="el" href="tm-modules_8h_source.html#l00033">TM_FLAG_STREAM_TM</a>, <a class="el" href="tm-modules_8h_source.html#l00068">tmm_modules</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00067">TMM_STREAMTCP</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l00802">RegisterAllModules()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_cgraph.png" border="0" usemap="#stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_cgraph" alt=""/></div>
<map name="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_cgraph" id="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="291,416,378,443"/><area shape="rect" id="node20" href="stream-tcp_8c.html#abd3bdf46f5d8fcd8bf8ea644b3cc312e" title="StreamTcpExitPrintStats" alt="" coords="251,952,418,979"/><area shape="rect" id="node21" href="stream-tcp_8c.html#a47042a286da78d0a3ddd510991b3efcf" title="StreamTcpRegisterTests" alt="" coords="251,1057,419,1084"/><area shape="rect" id="node26" href="stream-tcp_8c.html#aec7b18dbcad0affb03714548e584c4ad" title="StreamTcpThreadDeinit" alt="" coords="255,901,415,928"/><area shape="rect" id="node31" href="stream-tcp_8c.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="263,771,407,797"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1871,93,1945,120"/><area shape="rect" id="node4" href="stream-tcp_8c.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="527,416,654,443"/><area shape="rect" id="node5" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="809,441,924,468"/><area shape="rect" id="node6" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="809,492,924,519"/><area shape="rect" id="node7" href="util-checksum_8c.html#ab76beb6b62cf242b0fc2b4373fde7081" title="ReCalculateChecksum" alt="" coords="788,543,945,569"/><area shape="rect" id="node8" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="774,593,959,620"/><area shape="rect" id="node9" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="2043,321,2192,348"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67" title="StreamTcpReassembleHandle\lSegment" alt="" coords="767,270,967,311"/><area shape="rect" id="node18" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool. " alt="" coords="777,391,956,417"/><area shape="rect" id="node11" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="1294,345,1509,372"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="1301,105,1501,146"/><area shape="rect" id="node17" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="1032,270,1232,311"/><area shape="rect" id="node12" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1821,403,1995,429"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="1613,296,1717,323"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1558,524,1773,551"/><area shape="rect" id="node15" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1865,524,1951,551"/><area shape="rect" id="node19" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="1019,524,1245,551"/><area shape="rect" id="node22" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f" title="The Function Register the Unit tests to test the reassembly engine for various OS policies..." alt="" coords="487,1050,695,1091"/><area shape="rect" id="node25" href="stream-tcp-sack_8c.html#a893ea33421ab3dff83dc070805d38376" title="StreamTcpSackRegisterTests" alt="" coords="491,1116,690,1143"/><area shape="rect" id="node23" href="stream-tcp-inline_8c.html#ad01a33c39b0309dd536c8cf89f6cf83a" title="StreamTcpInlineRegisterTests" alt="" coords="767,1032,966,1059"/><area shape="rect" id="node24" href="stream-tcp-util_8c.html#a44bf885919a659b8132eaa84aefee888" title="StreamTcpUtilRegisterTests" alt="" coords="773,1083,961,1109"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc" title="StreamTcpReassembleFreeThreadCtx" alt="" coords="467,999,714,1025"/><area shape="rect" id="node28" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="1040,855,1224,881"/><area shape="rect" id="node29" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="1300,855,1503,881"/><area shape="rect" id="node30" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="1305,789,1498,830"/><area shape="rect" id="node32" href="group__utilpool.html#ga1262188db7dd25b18e1c4e58d8f6e59c" title="grow a thread pool by one " alt="" coords="531,948,650,975"/><area shape="rect" id="node35" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="537,847,644,873"/><area shape="rect" id="node37" href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce" title="get size of PoolThread (number of &#39;threads&#39;, so array elements) " alt="" coords="533,897,648,924"/><area shape="rect" id="node38" href="util-runmodes_8c.html#af065af67120665e6faa84ad4c184424b" title="RunmodeGetFlowStreamAsync" alt="" coords="487,543,694,569"/><area shape="rect" id="node39" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="517,593,665,620"/><area shape="rect" id="node40" href="stream-tcp-reassemble_8c.html#a5dc1a2f2120af56ff09791171c822897" title="StreamTcpReassembleInitThreadCtx" alt="" coords="471,796,710,823"/><area shape="rect" id="node44" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="497,695,685,721"/><area shape="rect" id="node46" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="763,644,970,671"/><area shape="rect" id="node49" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="502,745,679,772"/><area shape="rect" id="node33" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="833,905,900,932"/><area shape="rect" id="node34" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="1095,905,1169,932"/><area shape="rect" id="node36" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="809,851,924,877"/><area shape="rect" id="node41" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="787,796,946,823"/><area shape="rect" id="node42" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="1029,737,1235,764"/><area shape="rect" id="node43" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="1037,789,1227,830"/><area shape="rect" id="node45" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="779,695,954,721"/><area shape="rect" id="node47" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="1581,577,1750,604"/><area shape="rect" id="node48" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="1050,644,1214,671"/><area shape="rect" id="node50" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="787,745,946,772"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_icgraph.png" border="0" usemap="#stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_icgraph" alt=""/></div>
<map name="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_icgraph" id="stream-tcp_8c_ac7570830e107bef9adb9c4a729222114_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="251,5,386,32"/><area shape="rect" id="node3" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="435,5,533,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="779,5,829,32"/><area shape="rect" id="node5" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="581,31,731,57"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="afdd8feda84e7de3f0280938317d588b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stream_inline = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>defined in <a class="el" href="stream-tcp-reassemble_8c.html">stream-tcp-reassemble.c</a> </p>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00123">123</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, and <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp_8c.html">stream-tcp.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:10 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
