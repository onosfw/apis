<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: libhtp/htp/htp_hooks.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('htp__hooks_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">htp_hooks.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="htp__config__auto_8h_source.html">htp_config_auto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="htp__private_8h_source.html">htp_private.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for htp_hooks.c:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c__incl.png" border="0" usemap="#libhtp_2htp_2htp__hooks_8c" alt=""/></div>
<map name="libhtp_2htp_2htp__hooks_8c" id="libhtp_2htp_2htp__hooks_8c">
<area shape="rect" id="node2" href="htp__config__auto_8h.html" title="htp_config_auto.h" alt="" coords="749,80,875,107"/><area shape="rect" id="node3" href="htp__private_8h.html" title="htp_private.h" alt="" coords="899,80,996,107"/><area shape="rect" id="node14" href="htp_8h.html" title="htp.h" alt="" coords="1364,155,1415,181"/><area shape="rect" id="node34" href="htp__config__private_8h.html" title="htp_config_private.h" alt="" coords="1439,155,1577,181"/><area shape="rect" id="node35" href="htp__connection__parser__private_8h.html" title="htp_connection_parser\l_private.h" alt="" coords="2193,454,2345,495"/><area shape="rect" id="node36" href="htp__connection__private_8h.html" title="htp_connection_private.h" alt="" coords="1781,155,1947,181"/><area shape="rect" id="node37" href="htp__list__private_8h.html" title="htp_list_private.h" alt="" coords="2262,304,2383,331"/><area shape="rect" id="node38" href="htp__multipart__private_8h.html" title="htp_multipart_private.h" alt="" coords="1601,155,1756,181"/><area shape="rect" id="node39" href="htp__table__private_8h.html" title="htp_table_private.h" alt="" coords="2201,229,2332,256"/><area shape="rect" id="node17" href="htp__core_8h.html" title="htp_core.h" alt="" coords="1937,544,2020,571"/><area shape="rect" id="node18" href="bstr_8h.html" title="bstr.h" alt="" coords="1598,304,1652,331"/><area shape="rect" id="node23" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="1203,229,1303,256"/><area shape="rect" id="node24" href="htp__config_8h.html" title="htp_config.h" alt="" coords="1848,229,1941,256"/><area shape="rect" id="node25" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="619,229,783,256"/><area shape="rect" id="node26" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="808,229,955,256"/><area shape="rect" id="node28" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="979,229,1072,256"/><area shape="rect" id="node22" href="htp__list_8h.html" title="htp_list.h" alt="" coords="1941,461,2016,488"/><area shape="rect" id="node29" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="2017,229,2124,256"/><area shape="rect" id="node30" href="htp__table_8h.html" title="htp_table.h" alt="" coords="2099,304,2185,331"/><area shape="rect" id="node31" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="1328,229,1451,256"/><area shape="rect" id="node32" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="1475,229,1596,256"/><area shape="rect" id="node33" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="1749,304,1883,331"/><area shape="rect" id="node21" href="bstr__builder_8h.html" title="bstr_builder.h" alt="" coords="1575,379,1675,405"/></map>
</div>
</div>
<p><a href="htp__hooks_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1f1e4fb530d86ef619a0eaff8bfe491e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#a1f1e4fb530d86ef619a0eaff8bfe491e">htp_hook_copy</a> (const <a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *hook)</td></tr>
<tr class="separator:a1f1e4fb530d86ef619a0eaff8bfe491e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1cdd71dc6965b5a9a6647e8ed650997"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#aa1cdd71dc6965b5a9a6647e8ed650997">htp_hook_create</a> (void)</td></tr>
<tr class="separator:aa1cdd71dc6965b5a9a6647e8ed650997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b480fb42419dec49170dbeb1189a73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#a58b480fb42419dec49170dbeb1189a73">htp_hook_destroy</a> (<a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *hook)</td></tr>
<tr class="separator:a58b480fb42419dec49170dbeb1189a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22b914ef6ae582b88a44e413efc48db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#ae22b914ef6ae582b88a44e413efc48db">htp_hook_register</a> (<a class="el" href="structhtp__hook__t.html">htp_hook_t</a> **hook, const <a class="el" href="htp__hooks_8h.html#abc1dcd1da25b169b45d7c78570bb0f32">htp_callback_fn_t</a> callback_fn)</td></tr>
<tr class="separator:ae22b914ef6ae582b88a44e413efc48db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8981d368a73f78ddfb4ad1de1f4a5fc2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#a8981d368a73f78ddfb4ad1de1f4a5fc2">htp_hook_run_all</a> (<a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *hook, void *user_data)</td></tr>
<tr class="separator:a8981d368a73f78ddfb4ad1de1f4a5fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c417adb40bcf110515cc00b6f8f956"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__hooks_8c.html#a67c417adb40bcf110515cc00b6f8f956">htp_hook_run_one</a> (<a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *hook, void *user_data)</td></tr>
<tr class="separator:a67c417adb40bcf110515cc00b6f8f956"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Ivan Ristic <a href="#" onclick="location.href='mai'+'lto:'+'iva'+'nr'+'@we'+'bk'+'rea'+'to'+'r.c'+'om'; return false;">ivanr<span style="display: none;">.nosp@m.</span>@web<span style="display: none;">.nosp@m.</span>kreat<span style="display: none;">.nosp@m.</span>or.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p>Definition in file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1f1e4fb530d86ef619a0eaff8bfe491e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a>* htp_hook_copy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td>
          <td class="paramname"><em>hook</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a copy of the provided hook. The hook is allowed to be NULL, in which case this function simply returns a NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hook</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A copy of the hook, or NULL (if the provided hook was NULL or, if it wasn't, if there was a memory allocation problem while constructing a copy). </dd></dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00043">43</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00053">htp_hook_t::callbacks</a>, <a class="el" href="htp__hooks_8h_source.html#l00057">htp_callback_t::fn</a>, <a class="el" href="htp__hooks_8c_source.html#l00060">htp_hook_create()</a>, <a class="el" href="htp__hooks_8c_source.html#l00073">htp_hook_destroy()</a>, <a class="el" href="htp__hooks_8c_source.html#l00085">htp_hook_register()</a>, <a class="el" href="htp__list_8h_source.html#l00053">htp_list_get</a>, <a class="el" href="htp__list_8h_source.html#l00057">htp_list_size</a>, and <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>.</p>

<p>Referenced by <a class="el" href="htp__config_8c_source.html#l00178">htp_config_copy()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_cgraph.png" border="0" usemap="#htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_cgraph" alt=""/></div>
<map name="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_cgraph" id="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_cgraph">
<area shape="rect" id="node2" href="htp__hooks_8c.html#aa1cdd71dc6965b5a9a6647e8ed650997" title="htp_hook_create" alt="" coords="355,56,474,83"/><area shape="rect" id="node4" href="htp__hooks_8c.html#a58b480fb42419dec49170dbeb1189a73" title="htp_hook_destroy" alt="" coords="165,5,291,32"/><area shape="rect" id="node6" href="htp__hooks_8c.html#ae22b914ef6ae582b88a44e413efc48db" title="htp_hook_register" alt="" coords="165,107,291,133"/><area shape="rect" id="node3" href="htp__list_8c.html#a03714eb8cf358dd34b29cdb36061af79" title="htp_list_array_create" alt="" coords="539,56,682,83"/><area shape="rect" id="node5" href="htp__list_8c.html#a61ba9d208a9a1cea26c574adb5fc9cf4" title="htp_list_array_destroy" alt="" coords="339,5,490,32"/><area shape="rect" id="node7" href="htp__list_8c.html#a5c8757fdc9427e8a8c776eaf5f4cbe5a" title="htp_list_array_push" alt="" coords="347,107,482,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_icgraph.png" border="0" usemap="#htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_icgraph" alt=""/></div>
<map name="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_icgraph" id="htp__hooks_8c_a1f1e4fb530d86ef619a0eaff8bfe491e_icgraph">
<area shape="rect" id="node2" href="htp__config_8h.html#a14d6ca85efd0ac1ada44d5f2aacd7c2e" title="htp_config_copy" alt="" coords="165,5,283,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa1cdd71dc6965b5a9a6647e8ed650997"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a>* htp_hook_create </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new hook.</p>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="structhtp__hook__t.html">htp_hook_t</a> structure on success, NULL on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00060">60</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00053">htp_hook_t::callbacks</a>, and <a class="el" href="htp__list_8c_source.html#l00045">htp_list_array_create()</a>.</p>

<p>Referenced by <a class="el" href="htp__hooks_8c_source.html#l00043">htp_hook_copy()</a>, and <a class="el" href="htp__hooks_8c_source.html#l00085">htp_hook_register()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_cgraph.png" border="0" usemap="#htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_cgraph" alt=""/></div>
<map name="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_cgraph" id="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_cgraph">
<area shape="rect" id="node2" href="htp__list_8c.html#a03714eb8cf358dd34b29cdb36061af79" title="htp_list_array_create" alt="" coords="174,5,317,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_icgraph.png" border="0" usemap="#htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_icgraph" alt=""/></div>
<map name="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_icgraph" id="htp__hooks_8c_aa1cdd71dc6965b5a9a6647e8ed650997_icgraph">
<area shape="rect" id="node2" href="htp__hooks_8h.html#a1f1e4fb530d86ef619a0eaff8bfe491e" title="htp_hook_copy" alt="" coords="375,5,486,32"/><area shape="rect" id="node4" href="htp__hooks_8h.html#ae22b914ef6ae582b88a44e413efc48db" title="htp_hook_register" alt="" coords="173,668,299,695"/><area shape="rect" id="node3" href="htp__config_8h.html#a14d6ca85efd0ac1ada44d5f2aacd7c2e" title="htp_config_copy" alt="" coords="597,5,715,32"/><area shape="rect" id="node5" href="htp__config_8h.html#ae1c5131f7c5b9422089976f3a1f139d2" title="htp_config_register_log" alt="" coords="353,253,509,280"/><area shape="rect" id="node6" href="htp__config_8h.html#a79584491f4650d3a35cf2ea11fe89888" title="htp_config_register\l_request_complete" alt="" coords="365,305,497,346"/><area shape="rect" id="node7" href="htp__config_8h.html#a8e5210ead8ff36676a5c7d31356d8334" title="htp_config_register\l_request_body_data" alt="" coords="361,370,500,411"/><area shape="rect" id="node8" href="htp__config_8h.html#a44421781c648fa4f66317bac0c6ed539" title="htp_config_register\l_request_file_data" alt="" coords="365,435,497,477"/><area shape="rect" id="node9" href="htp__config_8h.html#a9fc79b9b1860e7c0ca1ae968167b795e" title="htp_config_register\l_request_uri_normalize" alt="" coords="353,501,509,542"/><area shape="rect" id="node10" href="htp__config_8h.html#a9c61a0e80dbdfc5fe65c00581f3a3a6e" title="htp_config_register\l_request_header_data" alt="" coords="355,566,506,607"/><area shape="rect" id="node11" href="htp__config_8h.html#ace50008f0e8f16c98c1ffd489efa8d5c" title="htp_config_register\l_request_headers" alt="" coords="590,694,722,735"/><area shape="rect" id="node14" href="htp__config_8h.html#aac864b83debc229899ed171baa8e1e74" title="htp_config_register\l_request_line" alt="" coords="590,759,722,801"/><area shape="rect" id="node15" href="htp__config_8h.html#a641f052ac69592a6d23e499c2c49f690" title="htp_config_register\l_request_start" alt="" coords="365,799,497,841"/><area shape="rect" id="node16" href="htp__config_8h.html#a761963ebf50ad586211a95c2fb245a3d" title="htp_config_register\l_request_trailer" alt="" coords="365,865,497,906"/><area shape="rect" id="node17" href="htp__config_8h.html#a39d7d04bcf03c716eee45a2a63e30cdc" title="htp_config_register\l_request_trailer_data" alt="" coords="359,930,502,971"/><area shape="rect" id="node18" href="htp__config_8h.html#ad3104bf098cca7fa43fb2c7f7f1c85af" title="htp_config_register\l_response_body_data" alt="" coords="356,995,505,1037"/><area shape="rect" id="node19" href="htp__config_8h.html#a481784fc61b0aa8683eedc53faf7c512" title="htp_config_register\l_response_complete" alt="" coords="359,1061,502,1102"/><area shape="rect" id="node20" href="htp__config_8h.html#a705b7ea411d4bc44d56868d4f0ec0b45" title="htp_config_register\l_response_header_data" alt="" coords="351,1126,511,1167"/><area shape="rect" id="node21" href="htp__config_8h.html#ab794f8f44bf7628ea08ef4e6c9e47389" title="htp_config_register\l_response_headers" alt="" coords="363,1191,498,1233"/><area shape="rect" id="node22" href="htp__config_8h.html#a99a2eced70bea7d345558785b74881ff" title="htp_config_register\l_response_line" alt="" coords="365,1257,497,1298"/><area shape="rect" id="node23" href="htp__config_8h.html#a8f21ee9c8eafc9b620dce9c6cdbb4cd2" title="htp_config_register\l_response_start" alt="" coords="365,1322,497,1363"/><area shape="rect" id="node24" href="htp__config_8h.html#a6ce298622ec17a48f022ce9f55da8219" title="htp_config_register\l_response_trailer" alt="" coords="365,1387,497,1429"/><area shape="rect" id="node25" href="htp__config_8h.html#a1272be3cdfef474ad7cac251370bf6ff" title="htp_config_register\l_response_trailer_data" alt="" coords="354,57,507,98"/><area shape="rect" id="node26" href="htp__config_8h.html#a7bac45768ef40a58cf6c11c9573aa920" title="htp_config_register\l_transaction_complete" alt="" coords="354,122,507,163"/><area shape="rect" id="node27" href="htp__transaction_8h.html#a0c9f2e85d998104afb653ec4515ffc0f" title="htp_tx_register_request\l_body_data" alt="" coords="351,631,510,673"/><area shape="rect" id="node30" href="htp__transaction_8h.html#a82f072f41c942d9b78a2a551a24227be" title="htp_tx_register_response\l_body_data" alt="" coords="347,187,515,229"/><area shape="rect" id="node12" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="799,597,931,638"/><area shape="rect" id="node13" href="htp__config_8h.html#ae769cd9063e9432caf6dce6013306df0" title="htp_config_register\l_urlencoded_parser" alt="" coords="798,694,933,735"/><area shape="rect" id="node28" href="htp__private_8h.html#ac4a784badfbaddb77f6f6e1582fee11e" title="htp_ch_urlencoded_callback\l_request_headers" alt="" coords="563,629,749,670"/><area shape="rect" id="node29" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="569,563,743,605"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a58b480fb42419dec49170dbeb1189a73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htp_hook_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td>
          <td class="paramname"><em>hook</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys an existing hook. It is all right to send a NULL to this method because it will simply return straight away.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hook</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00073">73</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00053">htp_hook_t::callbacks</a>, <a class="el" href="htp__list_8c_source.html#l00078">htp_list_array_destroy()</a>, <a class="el" href="htp__list_8h_source.html#l00053">htp_list_get</a>, and <a class="el" href="htp__list_8h_source.html#l00057">htp_list_size</a>.</p>

<p>Referenced by <a class="el" href="htp__config_8c_source.html#l00352">htp_config_destroy()</a>, <a class="el" href="htp__hooks_8c_source.html#l00043">htp_hook_copy()</a>, and <a class="el" href="htp__transaction_8c_source.html#l00118">htp_tx_destroy_incomplete()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_cgraph.png" border="0" usemap="#htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_cgraph" alt=""/></div>
<map name="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_cgraph" id="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_cgraph">
<area shape="rect" id="node2" href="htp__list_8c.html#a61ba9d208a9a1cea26c574adb5fc9cf4" title="htp_list_array_destroy" alt="" coords="179,5,330,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_icgraph.png" border="0" usemap="#htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_icgraph" alt=""/></div>
<map name="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_icgraph" id="htp__hooks_8c_a58b480fb42419dec49170dbeb1189a73_icgraph">
<area shape="rect" id="node2" href="htp__config_8h.html#acf3f525de9bfaf3023ecad391cf243c0" title="htp_config_destroy" alt="" coords="179,108,311,135"/><area shape="rect" id="node50" href="htp__hooks_8h.html#a1f1e4fb530d86ef619a0eaff8bfe491e" title="htp_hook_copy" alt="" coords="190,51,301,77"/><area shape="rect" id="node4" href="htp__transaction_8c.html#a0d9bedcb7fd819340ebd8e8271263191" title="htp_tx_destroy_incomplete" alt="" coords="360,196,539,223"/><area shape="rect" id="node3" href="htp__config_8h.html#a14d6ca85efd0ac1ada44d5f2aacd7c2e" title="htp_config_copy" alt="" coords="391,44,508,71"/><area shape="rect" id="node48" href="htp__transaction_8h.html#a1c4b795d1d8be70fcc32e9396f53ebfb" title="htp_tx_set_config" alt="" coords="387,145,512,172"/><area shape="rect" id="node49" href="group__httplayer.html#gaa9b76d8c59e5673794cbe2656c825d74" title="Clears the HTTP server configuration memory used by HTP library. " alt="" coords="593,52,706,79"/><area shape="rect" id="node5" href="htp__connection__private_8h.html#a9c3166bd9ba64e90d9b3cf98ebb61a8d" title="htp_conn_destroy" alt="" coords="587,156,712,183"/><area shape="rect" id="node15" href="htp__transaction_8h.html#a38191123e58ad54c815b5291b38ae1ae" title="htp_tx_create" alt="" coords="599,559,700,585"/><area shape="rect" id="node35" href="htp__transaction_8h.html#a92daf5a21d1005ed658239203bab72e2" title="htp_tx_destroy" alt="" coords="595,236,703,263"/><area shape="rect" id="node6" href="htp__connection__parser_8h.html#a8716f61f158d3d39552dbdaccc4157f2" title="htp_connp_destroy_all" alt="" coords="760,141,912,168"/><area shape="rect" id="node7" href="group__httplayer.html#ga4d27f058e59815cc3ed5ba1d7f8acf61" title="Function to frees the HTTP state memory and also frees the HTTP connection parser memory which was us..." alt="" coords="984,137,1091,164"/><area shape="rect" id="node8" href="group__httplayer.html#ga23aaf4c00574fa636459e4377429ac13" title="Register the HTTP protocol and state handling functions to APP layer of the engine. " alt="" coords="1163,131,1306,157"/><area shape="rect" id="node9" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="1355,122,1567,163"/><area shape="rect" id="node10" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="1657,128,1767,155"/><area shape="rect" id="node11" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1899,77,1997,104"/><area shape="rect" id="node13" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1897,128,1999,155"/><area shape="rect" id="node14" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="1871,179,2025,205"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2167,27,2217,53"/><area shape="rect" id="node16" href="htp__connection__parser_8h.html#ae9f11134051280a0127eaa26c63b0c4d" title="htp_connp_tx_create" alt="" coords="765,657,907,684"/><area shape="rect" id="node17" href="htp__request_8c.html#ae4a3e37c2a1e728db9f80cca8e53c6fa" title="htp_connp_REQ_IDLE" alt="" coords="960,776,1115,803"/><area shape="rect" id="node18" href="htp__connection__parser_8h.html#af87403d33d361ee171e6e098a233ef3d" title="htp_connp_create" alt="" coords="1172,853,1297,880"/><area shape="rect" id="node19" href="htp__request_8c.html#a9bb99f12643c2be1ff5a74bce80aab47" title="htp_connp_REQ_CONNECT\l_PROBE_DATA" alt="" coords="1365,730,1557,771"/><area shape="rect" id="node29" href="htp__request_8c.html#a2212edc93dc47fd615a30297f8faad60" title="htp_connp_req_data" alt="" coords="3269,641,3408,668"/><area shape="rect" id="node31" href="htp__transaction_8h.html#a6b642aabfa0688477a73138803e8a96c" title="htp_tx_state_request\l_complete" alt="" coords="1163,567,1307,609"/><area shape="rect" id="node28" href="htp__util_8c.html#a81fca26cac57032120c6796bda2a660c" title="htp_connp_in_state\l_as_string" alt="" coords="3061,634,3195,675"/><area shape="rect" id="node20" href="htp__request_8c.html#ac6178cc04104e5e5e469489f5e77c04d" title="htp_connp_REQ_CONNECT\l_WAIT_RESPONSE" alt="" coords="1616,721,1808,762"/><area shape="rect" id="node21" href="htp__request_8c.html#a3e8c194c19ebdaaa21fe107e328e3a75" title="htp_connp_REQ_CONNECT\l_CHECK" alt="" coords="2096,651,2288,693"/><area shape="rect" id="node22" href="htp__transaction_8h.html#aed95ccccf477ee8adeb83291a2104156" title="htp_tx_state_request\l_headers" alt="" coords="2353,550,2497,591"/><area shape="rect" id="node23" href="htp__request_8c.html#af7b83f68a53afa0a16e0d78300b63a46" title="htp_connp_REQ_HEADERS" alt="" coords="2555,557,2746,584"/><area shape="rect" id="node24" href="htp__request_8c.html#a801f66183cf5693361eca92d66607314" title="htp_connp_REQ_PROTOCOL" alt="" coords="2795,448,2994,475"/><area shape="rect" id="node25" href="htp__transaction_8h.html#aaaf7174643f67cdb075d45333b6fd7b5" title="htp_tx_state_request_line" alt="" coords="3043,401,3213,428"/><area shape="rect" id="node26" href="htp__request_8c.html#af6eee641bbe7ef5f73ebc1288f1450ad" title="htp_connp_REQ_LINE\l_complete" alt="" coords="3261,246,3416,287"/><area shape="rect" id="node27" href="htp__transaction_8h.html#a524d59cd184104370ade58fb200f2379" title="htp_tx_state_response\l_start" alt="" coords="3464,70,3619,111"/><area shape="rect" id="node30" href="htp__connection__parser_8h.html#acc7723b7ab867bfde9d5ef78c1faf446" title="htp_connp_close" alt="" coords="3481,536,3601,563"/><area shape="rect" id="node32" href="htp__request_8c.html#a2702260435d65d58ff1ef824cfdc1091" title="htp_connp_REQ_FINALIZE" alt="" coords="1369,575,1553,601"/><area shape="rect" id="node33" href="htp__request_8c.html#aa5ab1e26414167266d8d0b98eb712723" title="htp_connp_REQ_BODY\l_IDENTITY" alt="" coords="1631,651,1793,693"/><area shape="rect" id="node34" href="htp__request_8c.html#ad207aff5c7e4a68d2a539ffd9e3fd623" title="htp_connp_REQ_BODY\l_DETERMINE" alt="" coords="1867,601,2029,642"/><area shape="rect" id="node36" href="htp__transaction_8c.html#a9256c1eaab954ec27241d1ad51067b55" title="htp_tx_finalize" alt="" coords="984,267,1091,293"/><area shape="rect" id="node37" href="htp__transaction_8c.html#a76675e7e250e24c1ac47c49b4181aff8" title="htp_tx_state_response\l_complete_ex" alt="" coords="1635,259,1789,301"/><area shape="rect" id="node38" href="htp__response_8c.html#a779958ef7d3b3742be8b13170c0a8977" title="htp_connp_RES_FINALIZE" alt="" coords="1857,296,2039,323"/><area shape="rect" id="node47" href="htp__transaction_8h.html#adcbbf6a88718344b9cbe0c5f508a07ce" title="htp_tx_state_response\l_complete" alt="" coords="1871,230,2025,271"/><area shape="rect" id="node39" href="htp__response_8c.html#a35978034dd65239e911dd33f7c751332" title="htp_connp_RES_BODY\l_IDENTITY_CL_KNOWN" alt="" coords="2105,305,2279,346"/><area shape="rect" id="node46" href="htp__response_8c.html#a2c9732ce72c12038353a4483475e180c" title="htp_connp_RES_BODY\l_IDENTITY_STREAM_CLOSE" alt="" coords="2089,78,2295,119"/><area shape="rect" id="node40" href="htp__response_8c.html#a5bf0430de9af721db6e03c90ec63adf6" title="htp_connp_RES_BODY\l_DETERMINE" alt="" coords="2344,246,2507,287"/><area shape="rect" id="node41" href="htp__response_8c.html#a92faf3d17df2d54dd67bd7fbe80fb525" title="htp_connp_RES_HEADERS" alt="" coords="2555,144,2746,171"/><area shape="rect" id="node43" href="htp__util_8c.html#af31ead38ae0851c906b72d93d9a29d5a" title="htp_connp_out_state\l_as_string" alt="" coords="3057,263,3199,305"/><area shape="rect" id="node42" href="htp__response_8c.html#ab601564fadb2bb9ff37cd75b448a03d7" title="htp_connp_RES_BODY\l_CHUNKED_LENGTH" alt="" coords="2813,179,2976,221"/><area shape="rect" id="node45" href="htp__response_8c.html#a45043cdc1b581e62abbf2423be76ea2a" title="htp_connp_RES_LINE" alt="" coords="2817,77,2972,104"/><area shape="rect" id="node44" href="htp__response_8c.html#a7bf7c40f55013deddf338b903e4310a4" title="htp_connp_res_data" alt="" coords="3269,431,3408,457"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae22b914ef6ae582b88a44e413efc48db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_hook_register </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> **&#160;</td>
          <td class="paramname"><em>hook</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="htp__hooks_8h.html#abc1dcd1da25b169b45d7c78570bb0f32">htp_callback_fn_t</a>&#160;</td>
          <td class="paramname"><em>callback_fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Registers a new callback with the hook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hook</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">callback_fn</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on memory allocation error. </dd></dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00085">85</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00057">htp_callback_t::fn</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__hooks_8c_source.html#l00060">htp_hook_create()</a>, <a class="el" href="htp__list_8c_source.html#l00116">htp_list_array_push()</a>, and <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>.</p>

<p>Referenced by <a class="el" href="htp__config_8c_source.html#l00384">htp_config_register_log()</a>, <a class="el" href="htp__config_8c_source.html#l00399">htp_config_register_request_body_data()</a>, <a class="el" href="htp__config_8c_source.html#l00394">htp_config_register_request_complete()</a>, <a class="el" href="htp__config_8c_source.html#l00404">htp_config_register_request_file_data()</a>, <a class="el" href="htp__config_8c_source.html#l00414">htp_config_register_request_header_data()</a>, <a class="el" href="htp__config_8c_source.html#l00419">htp_config_register_request_headers()</a>, <a class="el" href="htp__config_8c_source.html#l00424">htp_config_register_request_line()</a>, <a class="el" href="htp__config_8c_source.html#l00429">htp_config_register_request_start()</a>, <a class="el" href="htp__config_8c_source.html#l00434">htp_config_register_request_trailer()</a>, <a class="el" href="htp__config_8c_source.html#l00439">htp_config_register_request_trailer_data()</a>, <a class="el" href="htp__config_8c_source.html#l00409">htp_config_register_request_uri_normalize()</a>, <a class="el" href="htp__config_8c_source.html#l00444">htp_config_register_response_body_data()</a>, <a class="el" href="htp__config_8c_source.html#l00449">htp_config_register_response_complete()</a>, <a class="el" href="htp__config_8c_source.html#l00454">htp_config_register_response_header_data()</a>, <a class="el" href="htp__config_8c_source.html#l00459">htp_config_register_response_headers()</a>, <a class="el" href="htp__config_8c_source.html#l00464">htp_config_register_response_line()</a>, <a class="el" href="htp__config_8c_source.html#l00469">htp_config_register_response_start()</a>, <a class="el" href="htp__config_8c_source.html#l00474">htp_config_register_response_trailer()</a>, <a class="el" href="htp__config_8c_source.html#l00479">htp_config_register_response_trailer_data()</a>, <a class="el" href="htp__config_8c_source.html#l00484">htp_config_register_transaction_complete()</a>, <a class="el" href="htp__hooks_8c_source.html#l00043">htp_hook_copy()</a>, <a class="el" href="htp__transaction_8c_source.html#l01179">htp_tx_register_request_body_data()</a>, and <a class="el" href="htp__transaction_8c_source.html#l01190">htp_tx_register_response_body_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_cgraph.png" border="0" usemap="#htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_cgraph" alt=""/></div>
<map name="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_cgraph" id="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_cgraph">
<area shape="rect" id="node2" href="htp__hooks_8c.html#aa1cdd71dc6965b5a9a6647e8ed650997" title="htp_hook_create" alt="" coords="187,5,306,32"/><area shape="rect" id="node4" href="htp__list_8c.html#a5c8757fdc9427e8a8c776eaf5f4cbe5a" title="htp_list_array_push" alt="" coords="179,56,314,83"/><area shape="rect" id="node3" href="htp__list_8c.html#a03714eb8cf358dd34b29cdb36061af79" title="htp_list_array_create" alt="" coords="363,5,506,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_icgraph.png" border="0" usemap="#htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_icgraph" alt=""/></div>
<map name="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_icgraph" id="htp__hooks_8c_ae22b914ef6ae582b88a44e413efc48db_icgraph">
<area shape="rect" id="node2" href="htp__config_8h.html#ae1c5131f7c5b9422089976f3a1f139d2" title="htp_config_register_log" alt="" coords="185,5,341,32"/><area shape="rect" id="node3" href="htp__config_8h.html#a8e5210ead8ff36676a5c7d31356d8334" title="htp_config_register\l_request_body_data" alt="" coords="193,57,332,98"/><area shape="rect" id="node4" href="htp__config_8h.html#a79584491f4650d3a35cf2ea11fe89888" title="htp_config_register\l_request_complete" alt="" coords="197,122,329,163"/><area shape="rect" id="node5" href="htp__config_8h.html#a44421781c648fa4f66317bac0c6ed539" title="htp_config_register\l_request_file_data" alt="" coords="197,187,329,229"/><area shape="rect" id="node6" href="htp__config_8h.html#a9c61a0e80dbdfc5fe65c00581f3a3a6e" title="htp_config_register\l_request_header_data" alt="" coords="187,253,338,294"/><area shape="rect" id="node7" href="htp__config_8h.html#ace50008f0e8f16c98c1ffd489efa8d5c" title="htp_config_register\l_request_headers" alt="" coords="422,381,554,422"/><area shape="rect" id="node10" href="htp__config_8h.html#aac864b83debc229899ed171baa8e1e74" title="htp_config_register\l_request_line" alt="" coords="422,446,554,487"/><area shape="rect" id="node11" href="htp__config_8h.html#a641f052ac69592a6d23e499c2c49f690" title="htp_config_register\l_request_start" alt="" coords="197,486,329,527"/><area shape="rect" id="node12" href="htp__config_8h.html#a761963ebf50ad586211a95c2fb245a3d" title="htp_config_register\l_request_trailer" alt="" coords="197,551,329,593"/><area shape="rect" id="node13" href="htp__config_8h.html#a39d7d04bcf03c716eee45a2a63e30cdc" title="htp_config_register\l_request_trailer_data" alt="" coords="191,617,334,658"/><area shape="rect" id="node14" href="htp__config_8h.html#a9fc79b9b1860e7c0ca1ae968167b795e" title="htp_config_register\l_request_uri_normalize" alt="" coords="185,682,341,723"/><area shape="rect" id="node15" href="htp__config_8h.html#ad3104bf098cca7fa43fb2c7f7f1c85af" title="htp_config_register\l_response_body_data" alt="" coords="188,747,337,789"/><area shape="rect" id="node16" href="htp__config_8h.html#a481784fc61b0aa8683eedc53faf7c512" title="htp_config_register\l_response_complete" alt="" coords="191,813,334,854"/><area shape="rect" id="node17" href="htp__config_8h.html#a705b7ea411d4bc44d56868d4f0ec0b45" title="htp_config_register\l_response_header_data" alt="" coords="183,878,343,919"/><area shape="rect" id="node18" href="htp__config_8h.html#ab794f8f44bf7628ea08ef4e6c9e47389" title="htp_config_register\l_response_headers" alt="" coords="195,943,330,985"/><area shape="rect" id="node19" href="htp__config_8h.html#a99a2eced70bea7d345558785b74881ff" title="htp_config_register\l_response_line" alt="" coords="197,1009,329,1050"/><area shape="rect" id="node20" href="htp__config_8h.html#a8f21ee9c8eafc9b620dce9c6cdbb4cd2" title="htp_config_register\l_response_start" alt="" coords="197,1074,329,1115"/><area shape="rect" id="node21" href="htp__config_8h.html#a6ce298622ec17a48f022ce9f55da8219" title="htp_config_register\l_response_trailer" alt="" coords="197,1139,329,1181"/><area shape="rect" id="node22" href="htp__config_8h.html#a1272be3cdfef474ad7cac251370bf6ff" title="htp_config_register\l_response_trailer_data" alt="" coords="186,1205,339,1246"/><area shape="rect" id="node23" href="htp__config_8h.html#a7bac45768ef40a58cf6c11c9573aa920" title="htp_config_register\l_transaction_complete" alt="" coords="186,1270,339,1311"/><area shape="rect" id="node24" href="htp__hooks_8h.html#a1f1e4fb530d86ef619a0eaff8bfe491e" title="htp_hook_copy" alt="" coords="207,1336,318,1363"/><area shape="rect" id="node26" href="htp__transaction_8h.html#a0c9f2e85d998104afb653ec4515ffc0f" title="htp_tx_register_request\l_body_data" alt="" coords="183,318,342,359"/><area shape="rect" id="node29" href="htp__transaction_8h.html#a82f072f41c942d9b78a2a551a24227be" title="htp_tx_register_response\l_body_data" alt="" coords="179,1387,347,1429"/><area shape="rect" id="node8" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="631,283,763,325"/><area shape="rect" id="node9" href="htp__config_8h.html#ae769cd9063e9432caf6dce6013306df0" title="htp_config_register\l_urlencoded_parser" alt="" coords="630,381,765,422"/><area shape="rect" id="node25" href="htp__config_8h.html#a14d6ca85efd0ac1ada44d5f2aacd7c2e" title="htp_config_copy" alt="" coords="429,1336,547,1363"/><area shape="rect" id="node27" href="htp__private_8h.html#ac4a784badfbaddb77f6f6e1582fee11e" title="htp_ch_urlencoded_callback\l_request_headers" alt="" coords="395,315,581,357"/><area shape="rect" id="node28" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="401,250,575,291"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8981d368a73f78ddfb4ad1de1f4a5fc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_hook_run_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td>
          <td class="paramname"><em>hook</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Runs all the callbacks associated with a given hook. Only stops if one of the callbacks returns an error (HTP_ERROR) or stop (HTP_STOP).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hook</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK if at least one hook ran successfully, HTP_STOP if there was no error but processing should stop, and HTP_ERROR or any other value less than zero on error. </dd></dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00120">120</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00053">htp_hook_t::callbacks</a>, <a class="el" href="htp__hooks_8h_source.html#l00057">htp_callback_t::fn</a>, <a class="el" href="htp__core_8h_source.html#l00078">HTP_DECLINED</a>, <a class="el" href="htp__list_8h_source.html#l00053">htp_list_get</a>, <a class="el" href="htp__list_8h_source.html#l00057">htp_list_size</a>, and <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>.</p>

<p>Referenced by <a class="el" href="htp__response_8c_source.html#l00642">htp_connp_RES_HEADERS()</a>, <a class="el" href="htp__util_8c_source.html#l00339">htp_log()</a>, <a class="el" href="htp__multipart_8c_source.html#l00574">htp_mpartp_run_request_file_data_hook()</a>, <a class="el" href="htp__util_8c_source.html#l02359">htp_req_run_hook_body_data()</a>, <a class="el" href="htp__util_8c_source.html#l02396">htp_res_run_hook_body_data()</a>, <a class="el" href="htp__transaction_8c_source.html#l00998">htp_tx_finalize()</a>, <a class="el" href="htp__transaction_8c_source.html#l00833">htp_tx_state_request_complete_partial()</a>, <a class="el" href="htp__transaction_8c_source.html#l00903">htp_tx_state_request_headers()</a>, <a class="el" href="htp__transaction_8c_source.html#l00943">htp_tx_state_request_line()</a>, <a class="el" href="htp__transaction_8c_source.html#l00889">htp_tx_state_request_start()</a>, <a class="el" href="htp__transaction_8c_source.html#l01015">htp_tx_state_response_complete_ex()</a>, <a class="el" href="htp__transaction_8c_source.html#l01074">htp_tx_state_response_headers()</a>, <a class="el" href="htp__transaction_8c_source.html#l00670">htp_tx_state_response_line()</a>, and <a class="el" href="htp__transaction_8c_source.html#l01137">htp_tx_state_response_start()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__hooks_8c_a8981d368a73f78ddfb4ad1de1f4a5fc2_icgraph.png" border="0" usemap="#htp__hooks_8c_a8981d368a73f78ddfb4ad1de1f4a5fc2_icgraph" alt=""/></div>
<map name="htp__hooks_8c_a8981d368a73f78ddfb4ad1de1f4a5fc2_icgraph" id="htp__hooks_8c_a8981d368a73f78ddfb4ad1de1f4a5fc2_icgraph">
<area shape="rect" id="node2" href="htp__response_8c.html#a92faf3d17df2d54dd67bd7fbe80fb525" title="htp_connp_RES_HEADERS" alt="" coords="1139,247,1330,274"/><area shape="rect" id="node16" href="htp__util_8c.html#a3eef4d9c98d7bbfbbcb1ff7c5317f3c6" title="htp_log" alt="" coords="237,836,301,863"/><area shape="rect" id="node43" href="htp__multipart__private_8h.html#a72b162a6bdf6226c5181a15ddf28ee41" title="htp_mpartp_run_request\l_file_data_hook" alt="" coords="188,1593,351,1634"/><area shape="rect" id="node46" href="htp__util_8c.html#ae9186694fa6cb9d4985d3c66698f0968" title="htp_req_run_hook_body_data" alt="" coords="173,1476,365,1503"/><area shape="rect" id="node47" href="htp__util_8c.html#aa60cc60143dfb38260549c4df5219727" title="htp_res_run_hook_body_data" alt="" coords="173,258,365,284"/><area shape="rect" id="node48" href="htp__transaction_8c.html#a9256c1eaab954ec27241d1ad51067b55" title="htp_tx_finalize" alt="" coords="1181,1527,1288,1554"/><area shape="rect" id="node38" href="htp__transaction_8c.html#a094a6a35a7a937d160a2785e2e6e3269" title="htp_tx_state_request\l_complete_partial" alt="" coords="675,1578,819,1620"/><area shape="rect" id="node42" href="htp__transaction_8h.html#aed95ccccf477ee8adeb83291a2104156" title="htp_tx_state_request\l_headers" alt="" coords="436,1258,580,1300"/><area shape="rect" id="node27" href="htp__transaction_8h.html#aaaf7174643f67cdb075d45333b6fd7b5" title="htp_tx_state_request_line" alt="" coords="1149,684,1320,711"/><area shape="rect" id="node49" href="htp__transaction_8h.html#afe2a066b2bd7887debe3146218a1586c" title="htp_tx_state_request\l_start" alt="" coords="197,1528,341,1569"/><area shape="rect" id="node13" href="htp__transaction_8c.html#a76675e7e250e24c1ac47c49b4181aff8" title="htp_tx_state_response\l_complete_ex" alt="" coords="1987,837,2141,878"/><area shape="rect" id="node19" href="htp__transaction_8h.html#a55a3a62e1c697127c4b206e75f983386" title="htp_tx_state_response\l_headers" alt="" coords="669,913,824,954"/><area shape="rect" id="node40" href="htp__transaction_8h.html#af51ff64d772742097a2f4a1a76e0557f" title="htp_tx_state_response_line" alt="" coords="417,182,599,208"/><area shape="rect" id="node10" href="htp__transaction_8h.html#a524d59cd184104370ade58fb200f2379" title="htp_tx_state_response\l_start" alt="" coords="1581,618,1736,660"/><area shape="rect" id="node3" href="htp__response_8c.html#ab601564fadb2bb9ff37cd75b448a03d7" title="htp_connp_RES_BODY\l_CHUNKED_LENGTH" alt="" coords="2200,450,2363,492"/><area shape="rect" id="node9" href="htp__response_8c.html#a45043cdc1b581e62abbf2423be76ea2a" title="htp_connp_RES_LINE" alt="" coords="1379,466,1533,492"/><area shape="rect" id="node5" href="htp__util_8c.html#af31ead38ae0851c906b72d93d9a29d5a" title="htp_connp_out_state\l_as_string" alt="" coords="2646,538,2789,580"/><area shape="rect" id="node4" href="htp__response_8c.html#a028530726a98edc10fc5adf8a050b349" title="htp_connp_RES_BODY\l_CHUNKED_DATA_END" alt="" coords="2421,450,2597,492"/><area shape="rect" id="node8" href="htp__response_8c.html#a5bf0430de9af721db6e03c90ec63adf6" title="htp_connp_RES_BODY\l_DETERMINE" alt="" coords="2428,568,2591,609"/><area shape="rect" id="node6" href="htp__response_8c.html#a7bf7c40f55013deddf338b903e4310a4" title="htp_connp_res_data" alt="" coords="2837,946,2976,972"/><area shape="rect" id="node7" href="htp__connection__parser_8h.html#acc7723b7ab867bfde9d5ef78c1faf446" title="htp_connp_close" alt="" coords="3024,1095,3144,1122"/><area shape="rect" id="node11" href="htp__response_8c.html#a1b95d113c24de4c93db72889c738275d" title="htp_connp_RES_IDLE" alt="" coords="1784,692,1939,719"/><area shape="rect" id="node12" href="htp__connection__parser_8h.html#af87403d33d361ee171e6e098a233ef3d" title="htp_connp_create" alt="" coords="2001,786,2127,812"/><area shape="rect" id="node14" href="htp__response_8c.html#a779958ef7d3b3742be8b13170c0a8977" title="htp_connp_RES_FINALIZE" alt="" coords="2190,634,2373,660"/><area shape="rect" id="node15" href="htp__transaction_8h.html#adcbbf6a88718344b9cbe0c5f508a07ce" title="htp_tx_state_response\l_complete" alt="" coords="2204,837,2359,878"/><area shape="rect" id="node17" href="htp__connection__parser_8h.html#a9f18bc1870a26ca9389cb2ebd63940f2" title="htp_connp_open" alt="" coords="449,634,567,660"/><area shape="rect" id="node18" href="htp__decompressors_8h.html#aaa977d514f6a12044d2d754d6e767471" title="htp_gzip_decompressor\l_create" alt="" coords="428,938,588,980"/><area shape="rect" id="node20" href="htp__request_8c.html#a78975b59c610a8b5cd834b6c7ad7524b" title="htp_connp_REQ_BODY\l_CHUNKED_LENGTH" alt="" coords="909,1149,1072,1190"/><area shape="rect" id="node25" href="htp__request_8c.html#af7b83f68a53afa0a16e0d78300b63a46" title="htp_connp_REQ_HEADERS" alt="" coords="651,1240,842,1267"/><area shape="rect" id="node23" href="htp__request_8c.html#a2212edc93dc47fd615a30297f8faad60" title="htp_connp_req_data" alt="" coords="1589,1260,1728,1287"/><area shape="rect" id="node29" href="htp__request__generic_8c.html#a942dcbfae19b6ceb5c070cb84dc50bce" title="htp_parse_request_header\l_generic" alt="" coords="421,502,595,544"/><area shape="rect" id="node32" href="htp__request__generic_8c.html#a53bf758c818ba5d2554eba3ba380fb36" title="htp_parse_request_line\l_generic_ex" alt="" coords="430,568,586,609"/><area shape="rect" id="node35" href="htp__response__generic_8c.html#acbf864cbe06ef50937cb271c79261d18" title="htp_parse_response\l_header_generic" alt="" coords="439,385,577,426"/><area shape="rect" id="node36" href="htp__response__generic_8c.html#a7c9e1963cfe2008b92889c5e1e4f0bb1" title="htp_process_response\l_header_generic" alt="" coords="670,422,823,464"/><area shape="rect" id="node37" href="htp__transaction_8c.html#a13e830ded4af725cc7160b1406023d89" title="htp_tx_req_process\l_body_data_ex" alt="" coords="440,1477,576,1518"/><area shape="rect" id="node41" href="htp__transaction_8c.html#a219a0b24ed95d84a3fb9ad7c07cac511" title="htp_tx_res_process\l_body_data_ex" alt="" coords="1167,498,1303,540"/><area shape="rect" id="node21" href="htp__request_8c.html#a24a112bbe8db96d22a8d421a6ea6ac74" title="htp_connp_REQ_BODY\l_CHUNKED_DATA_END" alt="" coords="1147,1142,1323,1184"/><area shape="rect" id="node24" href="htp__request_8c.html#ad207aff5c7e4a68d2a539ffd9e3fd623" title="htp_connp_REQ_BODY\l_DETERMINE" alt="" coords="1153,1208,1316,1249"/><area shape="rect" id="node22" href="htp__util_8c.html#a81fca26cac57032120c6796bda2a660c" title="htp_connp_in_state\l_as_string" alt="" coords="1389,1162,1523,1204"/><area shape="rect" id="node26" href="htp__request_8c.html#a801f66183cf5693361eca92d66607314" title="htp_connp_REQ_PROTOCOL" alt="" coords="891,1240,1090,1267"/><area shape="rect" id="node28" href="htp__request_8c.html#af6eee641bbe7ef5f73ebc1288f1450ad" title="htp_connp_REQ_LINE\l_complete" alt="" coords="1379,677,1533,718"/><area shape="rect" id="node30" href="htp__request__generic_8c.html#a221bc903670a4cdea0d68314700db050" title="htp_process_request\l_header_generic" alt="" coords="675,488,818,529"/><area shape="rect" id="node31" href="htp__config_8h.html#a95de3fba682f24cf2d2e7ce22084ad03" title="htp_config_set_server\l_personality" alt="" coords="915,521,1066,562"/><area shape="rect" id="node33" href="htp__request__apache__2__2_8c.html#a84210ba8a498e578ab7f99914911b8e5" title="htp_parse_request_line\l_apache_2_2" alt="" coords="669,618,825,660"/><area shape="rect" id="node34" href="htp__request__generic_8c.html#a02add732118572070ba289abd8a4cd66" title="htp_parse_request_line\l_generic" alt="" coords="669,553,825,594"/><area shape="rect" id="node39" href="htp__transaction_8h.html#a6b642aabfa0688477a73138803e8a96c" title="htp_tx_state_request\l_complete" alt="" coords="1384,1520,1528,1561"/><area shape="rect" id="node44" href="htp__multipart__private_8h.html#adf2e99c5087b2ec07b11bf4df9e2073f" title="htp_mpart_part_finalize_data" alt="" coords="413,1594,603,1620"/><area shape="rect" id="node45" href="htp__multipart__private_8h.html#a368c461de4ad8f9d864f5c29968e6f4a" title="htp_mpart_part_handle_data" alt="" coords="415,1644,601,1671"/><area shape="rect" id="node50" href="htp__request_8c.html#ae4a3e37c2a1e728db9f80cca8e53c6fa" title="htp_connp_REQ_IDLE" alt="" coords="1157,1476,1312,1503"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a67c417adb40bcf110515cc00b6f8f956"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_hook_run_one </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__hook__t.html">htp_hook_t</a> *&#160;</td>
          <td class="paramname"><em>hook</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run callbacks one by one until one of them accepts to service the hook.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hook</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK if a hook was found to process the callback, HTP_DECLINED if no hook could be found, HTP_STOP if a hook signalled the processing to stop, and HTP_ERROR or any other value less than zero on error. </dd></dl>

<p>Definition at line <a class="el" href="htp__hooks_8c_source.html#l00140">140</a> of file <a class="el" href="htp__hooks_8c_source.html">htp_hooks.c</a>.</p>

<p>References <a class="el" href="htp__hooks_8h_source.html#l00053">htp_hook_t::callbacks</a>, <a class="el" href="htp__hooks_8h_source.html#l00057">htp_callback_t::fn</a>, <a class="el" href="htp__core_8h_source.html#l00078">HTP_DECLINED</a>, <a class="el" href="htp__list_8h_source.html#l00053">htp_list_get</a>, and <a class="el" href="htp__list_8h_source.html#l00057">htp_list_size</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a8a84310ac5c5a9ff38fc974698b3a7.html">libhtp</a></li><li class="navelem"><a class="el" href="dir_230ed285961c8f21296b4c8e0daccb5b.html">htp</a></li><li class="navelem"><a class="el" href="htp__hooks_8c.html">htp_hooks.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:00 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
