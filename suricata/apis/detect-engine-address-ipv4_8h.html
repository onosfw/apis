<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/detect-engine-address-ipv4.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('detect-engine-address-ipv4_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">detect-engine-address-ipv4.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h__dep__incl.png" border="0" usemap="#src_2detect-engine-address-ipv4_8hdep" alt=""/></div>
<map name="src_2detect-engine-address-ipv4_8hdep" id="src_2detect-engine-address-ipv4_8hdep">
<area shape="rect" id="node2" href="detect-engine-address_8c.html" title="src/detect&#45;engine&#45;address.c" alt="" coords="5,96,187,123"/></map>
</div>
</div>
<p><a href="detect-engine-address-ipv4_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8fb8ca03238582c65f0ee4b722730744"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#a8fb8ca03238582c65f0ee4b722730744">DetectAddressCutNotIPv4</a> (<a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> **)</td></tr>
<tr class="memdesc:a8fb8ca03238582c65f0ee4b722730744"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cuts and returns an address range, which is the complement of the address range that is supplied as the argument.  <a href="#a8fb8ca03238582c65f0ee4b722730744">More...</a><br/></td></tr>
<tr class="separator:a8fb8ca03238582c65f0ee4b722730744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c0fa19660a8bd72cbad5a2f6f2f4e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#ad9c0fa19660a8bd72cbad5a2f6f2f4e7">DetectAddressCmpIPv4</a> (<a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *a, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *b)</td></tr>
<tr class="memdesc:ad9c0fa19660a8bd72cbad5a2f6f2f4e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares 2 addresses(address ranges) and returns the relationship between the 2 addresses.  <a href="#ad9c0fa19660a8bd72cbad5a2f6f2f4e7">More...</a><br/></td></tr>
<tr class="separator:ad9c0fa19660a8bd72cbad5a2f6f2f4e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c85b240c7c47383d2dbcffe36cdde8d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#a3c85b240c7c47383d2dbcffe36cdde8d">DetectAddressCutIPv4</a> (<a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> **)</td></tr>
<tr class="memdesc:a3c85b240c7c47383d2dbcffe36cdde8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut groups and merge sigs.  <a href="#a3c85b240c7c47383d2dbcffe36cdde8d">More...</a><br/></td></tr>
<tr class="separator:a3c85b240c7c47383d2dbcffe36cdde8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6bac01b7f9087620caeaa81863b8b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#aad6bac01b7f9087620caeaa81863b8b5">DetectAddressJoinIPv4</a> (<a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *target, <a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *source)</td></tr>
<tr class="memdesc:aad6bac01b7f9087620caeaa81863b8b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extends a target address range if the the source address range is wider than the target address range on either sides.  <a href="#aad6bac01b7f9087620caeaa81863b8b5">More...</a><br/></td></tr>
<tr class="separator:aad6bac01b7f9087620caeaa81863b8b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237c0b35a4cf83da14cf9b406678795c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#a237c0b35a4cf83da14cf9b406678795c">DetectAddressIsCompleteIPSpaceIPv4</a> (<a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *)</td></tr>
<tr class="memdesc:a237c0b35a4cf83da14cf9b406678795c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the address group list covers the complete IPv4 IP space.  <a href="#a237c0b35a4cf83da14cf9b406678795c">More...</a><br/></td></tr>
<tr class="separator:a237c0b35a4cf83da14cf9b406678795c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee01f4b8cac5c1f3fe3e54764407b799"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-address-ipv4_8h.html#aee01f4b8cac5c1f3fe3e54764407b799">DetectAddressIPv4Tests</a> (void)</td></tr>
<tr class="separator:aee01f4b8cac5c1f3fe3e54764407b799"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd></dl>

<p>Definition in file <a class="el" href="detect-engine-address-ipv4_8h_source.html">detect-engine-address-ipv4.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad9c0fa19660a8bd72cbad5a2f6f2f4e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DetectAddressCmpIPv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares 2 addresses(address ranges) and returns the relationship between the 2 addresses. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Pointer to the first address instance to be compared. </td></tr>
    <tr><td class="paramname">b</td><td>Pointer to the second address instance to be compared.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ADDRESS_EQ</td><td>If the 2 address ranges a and b, are equal. </td></tr>
    <tr><td class="paramname">ADDRESS_ES</td><td>b encapsulates a. b_ip1[...a_ip1...a_ip2...]b_ip2. </td></tr>
    <tr><td class="paramname">ADDRESS_EB</td><td>a encapsulates b. a_ip1[...b_ip1....b_ip2...]a_ip2. </td></tr>
    <tr><td class="paramname">ADDRESS_LE</td><td>a_ip1(...b_ip1==a_ip2...)b_ip2 </td></tr>
    <tr><td class="paramname">ADDRESS_LT</td><td>a_ip1(...b_ip1...a_ip2...)b_ip2 </td></tr>
    <tr><td class="paramname">ADDRESS_GE</td><td>b_ip1(...a_ip1==b_ip2...)a_ip2 </td></tr>
    <tr><td class="paramname">ADDRESS_GT</td><td>a_ip1 &gt; b_ip2, i.e. the address range for 'a' starts only after the end of the address range for 'b' </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00059">59</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>References <a class="el" href="detect_8h_source.html#l00152">ADDRESS_EB</a>, <a class="el" href="detect_8h_source.html#l00150">ADDRESS_EQ</a>, <a class="el" href="detect_8h_source.html#l00147">ADDRESS_ER</a>, <a class="el" href="detect_8h_source.html#l00151">ADDRESS_ES</a>, <a class="el" href="detect_8h_source.html#l00153">ADDRESS_GE</a>, <a class="el" href="detect_8h_source.html#l00154">ADDRESS_GT</a>, <a class="el" href="detect_8h_source.html#l00149">ADDRESS_LE</a>, <a class="el" href="detect_8h_source.html#l00148">ADDRESS_LT</a>, <a class="el" href="detect_8h_source.html#l00171">DetectAddress_::ip</a>, <a class="el" href="detect_8h_source.html#l00172">DetectAddress_::ip2</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-address_8c_source.html#l01620">DetectAddressCmp()</a>, and <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00113">DetectAddressCutIPv4()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h_ad9c0fa19660a8bd72cbad5a2f6f2f4e7_icgraph.png" border="0" usemap="#detect-engine-address-ipv4_8h_ad9c0fa19660a8bd72cbad5a2f6f2f4e7_icgraph" alt=""/></div>
<map name="detect-engine-address-ipv4_8h_ad9c0fa19660a8bd72cbad5a2f6f2f4e7_icgraph" id="detect-engine-address-ipv4_8h_ad9c0fa19660a8bd72cbad5a2f6f2f4e7_icgraph">
<area shape="rect" id="node2" href="detect-engine-address_8h.html#a6c6acf140e9b6bb8e059d4319bc6eb8d" title="Used to compare 2 address ranges. " alt="" coords="229,117,366,144"/><area shape="rect" id="node19" href="detect-engine-address-ipv4_8h.html#a3c85b240c7c47383d2dbcffe36cdde8d" title="Cut groups and merge sigs. " alt="" coords="219,168,376,195"/><area shape="rect" id="node3" href="detect-engine-address_8h.html#a5f75b92b15c99ca3c2b8c8ec6a1401cd" title="Used to check if a DetectAddress list contains an instance with a similar DetectAddress. The comparison done is not the one that checks the memory for the same instance, but one that checks that the two instances hold the same content. " alt="" coords="617,63,799,89"/><area shape="rect" id="node11" href="detect-engine-address_8h.html#a301f4fcf203ac806f4f5eed16182a14c" title="Do a sorted insert, where the top of the list should be the biggest network/range. " alt="" coords="642,12,774,39"/><area shape="rect" id="node12" href="detect-engine-address_8h.html#a5f63946f5f3ce24870d1211b1f3bdeb0" title="Same as DetectAddressInsert, but then for inserting a address group object. This also makes sure SigG..." alt="" coords="425,161,567,188"/><area shape="rect" id="node14" href="detect-engine-address_8c.html#a69bbe731d2e859401b2d36174a8bebf2" title="Merge the + and the &#45; list (+ positive match, &#45; &#39;not&#39; match) " alt="" coords="866,215,1033,241"/><area shape="rect" id="node4" href="detect_8c.html#a0ff85d4d7e9776988c8fe1659f65db89" title="Build the destination address portion of the match tree. " alt="" coords="848,71,1051,97"/><area shape="rect" id="node10" href="detect_8c.html#aa3952cbb6c857eb9d1b9b2fa7689c0e4" title="BuildDestinationAddressHeads\lWithBothPorts" alt="" coords="848,5,1051,46"/><area shape="rect" id="node5" href="detect_8c.html#a72fc70b5d12e86ff5827d2d397233773" title="SigAddressPrepareStage3" alt="" coords="1099,71,1274,97"/><area shape="rect" id="node6" href="detect_8h.html#a5eab8b8beaf1cc85d8a25a309ea13124" title="Convert the signature list into the runtime match structure. " alt="" coords="1331,96,1437,123"/><area shape="rect" id="node7" href="detect_8h.html#a8b471081c75864d1c8d4bcb14eaebc3b" title="Load signatures. " alt="" coords="1493,96,1624,123"/><area shape="rect" id="node8" href="detect-engine_8h.html#aba0e2c94ab90c4390af30af806db271d" title="Reload the detection engine. " alt="" coords="1673,96,1815,123"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1864,96,1915,123"/><area shape="rect" id="node13" href="detect-engine-address_8c.html#a9329b113f0526a40f64cdf2031b46cd4" title="Setup a single address string, parse it and add the resulting Address&#45;Range(s) to the AddessHead(Dete..." alt="" coords="637,215,779,241"/><area shape="rect" id="node17" href="detect_8c.html#afc77848803e5fcaaf39f90ff860140dc" title="CreateGroupedAddrList" alt="" coords="629,113,787,140"/><area shape="rect" id="node15" href="detect-engine-address_8h.html#ab3a963e12de032ca4aa2c531a4a0f21d" title="Parses an address group sent as a character string and updates the DetectAddressHead sent as the argu..." alt="" coords="1115,215,1258,241"/><area shape="rect" id="node16" href="detect-parse_8c.html#a84a84c4f3fd51f473abc014096a35197" title="Parse address string and update signature. " alt="" coords="1323,215,1445,241"/><area shape="rect" id="node18" href="detect_8c.html#aabe6ab0213639a48e8560e510eb7ca02" title="Fill the global src group head, with the sigs included. " alt="" coords="1099,121,1274,148"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3c85b240c7c47383d2dbcffe36cdde8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DetectAddressCutIPv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> **&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cut groups and merge sigs. </p>
<pre class="fragment">  a = 1.2.3.4, b = 1.2.3.4-1.2.3.5
  must result in: a == 1.2.3.4, b == 1.2.3.5, c == NULL

  a = 1.2.3.4, b = 1.2.3.3-1.2.3.5
  must result in: a == 1.2.3.3, b == 1.2.3.4, c == 1.2.3.5

  a = 1.2.3.0/24 b = 1.2.3.128-1.2.4.10
  must result in: a == 1.2.3.0/24, b == 1.2.4.0-1.2.4.10, c == NULL

  a = 1.2.3.4, b = 1.2.3.0/24
  must result in: a == 1.2.3.0-1.2.3.3, b == 1.2.3.4, c == 1.2.3.5-1.2.3.255
</pre><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00113">113</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>References <a class="el" href="detect_8h_source.html#l00152">ADDRESS_EB</a>, <a class="el" href="detect_8h_source.html#l00151">ADDRESS_ES</a>, <a class="el" href="detect_8h_source.html#l00153">ADDRESS_GE</a>, <a class="el" href="detect_8h_source.html#l00149">ADDRESS_LE</a>, <a class="el" href="detect_8h_source.html#l00191">DetectAddress_::cnt</a>, <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00059">DetectAddressCmpIPv4()</a>, <a class="el" href="detect-engine-address_8c_source.html#l00094">DetectAddressFree()</a>, <a class="el" href="detect-engine-address_8c_source.html#l00074">DetectAddressInit()</a>, <a class="el" href="detect-engine-port_8c_source.html#l00245">DetectPortInsertCopy()</a>, <a class="el" href="decode_8h_source.html#l00104">Address_::family</a>, <a class="el" href="detect_8h_source.html#l00171">DetectAddress_::ip</a>, <a class="el" href="detect_8h_source.html#l00172">DetectAddress_::ip2</a>, <a class="el" href="detect_8h_source.html#l00250">DetectPort_::next</a>, <a class="el" href="detect_8h_source.html#l00177">DetectAddress_::port</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="detect_8h_source.html#l00181">DetectAddress_::sh</a>, <a class="el" href="detect-engine-siggroup_8c_source.html#l01066">SigGroupHeadClearSigs()</a>, and <a class="el" href="detect-engine-siggroup_8c_source.html#l01090">SigGroupHeadCopySigs()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h_a3c85b240c7c47383d2dbcffe36cdde8d_cgraph.png" border="0" usemap="#detect-engine-address-ipv4_8h_a3c85b240c7c47383d2dbcffe36cdde8d_cgraph" alt=""/></div>
<map name="detect-engine-address-ipv4_8h_a3c85b240c7c47383d2dbcffe36cdde8d_cgraph" id="detect-engine-address-ipv4_8h_a3c85b240c7c47383d2dbcffe36cdde8d_cgraph">
<area shape="rect" id="node2" href="detect-engine-address-ipv4_8c.html#ad9c0fa19660a8bd72cbad5a2f6f2f4e7" title="Compares 2 addresses(address ranges) and returns the relationship between the 2 addresses. " alt="" coords="211,91,375,118"/><area shape="rect" id="node3" href="detect-engine-address_8c.html#a93c2ac0d98f92485bd4697ce4d610344" title="Frees a DetectAddress instance. " alt="" coords="226,142,361,169"/><area shape="rect" id="node12" href="detect-engine-address_8c.html#aff647665ce1002cbdc788cb87470fdd2" title="Creates and returns a new instance of a DetectAddress. " alt="" coords="230,218,357,245"/><area shape="rect" id="node13" href="detect-engine-port_8c.html#a4a6689fa3d861de5b4d26b120d860d01" title="Copy and insert the new DetectPort, with a copy list of sigs. " alt="" coords="219,269,368,295"/><area shape="rect" id="node21" href="detect-engine-siggroup_8c.html#ac14faefddd493528527ecbf551ce3b8a" title="Clears the bitarray holding the sids for this SigGroupHead. " alt="" coords="211,319,375,346"/><area shape="rect" id="node16" href="detect-engine-siggroup_8c.html#a51eba76854157da0de4a460887ff391d" title="Copies the bitarray holding the sids from the source SigGroupHead to the destination SigGroupHead..." alt="" coords="653,421,817,447"/><area shape="rect" id="node4" href="detect-engine-siggroup_8c.html#a176702ac4621c9006d89a8d6801d7ce1" title="Free a SigGroupHead and its members. " alt="" coords="900,130,1033,157"/><area shape="rect" id="node7" href="detect-engine-address_8c.html#af82d16bf8b8d0d7ed63920cae0bc8959" title="Frees a DetectAddressHead instance. " alt="" coords="425,66,591,93"/><area shape="rect" id="node10" href="detect-engine-port_8c.html#aa96929b52a485980356a11188a6e9f16" title="Free a DetectPort list and each of its members. " alt="" coords="431,167,585,194"/><area shape="rect" id="node5" href="detect-engine-mpm_8c.html#a6a1c9264037c5fe5756ea28f6ddab251" title="PatternMatchDestroyGroup" alt="" coords="1104,105,1285,131"/><area shape="rect" id="node6" href="detect-engine-siggroup_8c.html#a6f6c71bc5fff7f350d164523257ebed1" title="SigGroupHeadInitDataFree" alt="" coords="1105,155,1284,182"/><area shape="rect" id="node8" href="detect-engine-address_8c.html#afb3ca9fc7da5b19ea07bb7943b9f9c09" title="Cleans a DetectAddressHead. The functions frees the 3 address group heads(any, ipv4 and ipv6) inside ..." alt="" coords="641,66,829,93"/><area shape="rect" id="node9" href="detect-engine-address_8c.html#a356dc6a3cd3b37b0756f67ef5347b958" title="Frees a list of DetectAddress instances. " alt="" coords="877,54,1056,81"/><area shape="rect" id="node11" href="detect-engine-port_8c.html#a336d41e96ce6898d02ebecc582cc1557" title="Free a DetectPort and its members. " alt="" coords="679,167,790,194"/><area shape="rect" id="node14" href="detect-engine-port_8c.html#ac8b4a84d18e06e0cd29d37d0799a94db" title="Function that return a copy of DetectPort src sigs. " alt="" coords="432,370,584,397"/><area shape="rect" id="node17" href="detect-engine-port_8c.html#a05bf13895dd5fc46b43c7ac182cb4561" title="function for inserting a port group object. This also makes sure SigGroupContainer lists are handled ..." alt="" coords="449,269,567,295"/><area shape="rect" id="node15" href="detect-engine-port_8c.html#a6d5934b74427fee3e9fc25e2070244f4" title="Alloc a DetectPort structure and update counters. " alt="" coords="683,370,786,397"/><area shape="rect" id="node18" href="detect-engine-port_8c.html#a99a3e1b81a12b2048ee19c49d3467369" title="Function that compare port groups. " alt="" coords="678,218,791,245"/><area shape="rect" id="node19" href="util-debug_8c.html#ab793aa1c0db8ab4c177d80f79c085297" title="Returns whether debug messages are enabled to be logged or not. " alt="" coords="661,269,808,295"/><area shape="rect" id="node20" href="detect-engine-port_8c.html#a5b98d8d3a7c3a879a0b7bc44b2370ac6" title="Helper function that print the DetectPort info. " alt="" coords="679,319,791,346"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8fb8ca03238582c65f0ee4b722730744"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DetectAddressCutNotIPv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> **&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cuts and returns an address range, which is the complement of the address range that is supplied as the argument. </p>
<pre class="fragment">   For example:

   If a = 0.0.0.0-1.2.3.4,
       then a = 1.2.3.4-255.255.255.255 and b = NULL
   If a = 1.2.3.4-255.255.255.255,
       then a = 0.0.0.0-1.2.3.4 and b = NULL
   If a = 1.2.3.4-192.168.1.1,
       then a = 0.0.0.0-1.2.3.3 and b = 192.168.1.2-255.255.255.255
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Pointer to an address range (DetectAddress) instance whose complement has to be returned in a and b. </td></tr>
    <tr><td class="paramname">b</td><td>Pointer to DetectAddress pointer, that will be supplied back with a new DetectAddress instance, if the complement demands so.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00526">526</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>References <a class="el" href="detect-engine-address_8c_source.html#l00074">DetectAddressInit()</a>, <a class="el" href="decode_8h_source.html#l00104">Address_::family</a>, <a class="el" href="detect_8h_source.html#l00171">DetectAddress_::ip</a>, and <a class="el" href="detect_8h_source.html#l00172">DetectAddress_::ip2</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h_a8fb8ca03238582c65f0ee4b722730744_cgraph.png" border="0" usemap="#detect-engine-address-ipv4_8h_a8fb8ca03238582c65f0ee4b722730744_cgraph" alt=""/></div>
<map name="detect-engine-address-ipv4_8h_a8fb8ca03238582c65f0ee4b722730744_cgraph" id="detect-engine-address-ipv4_8h_a8fb8ca03238582c65f0ee4b722730744_cgraph">
<area shape="rect" id="node2" href="detect-engine-address_8c.html#aff647665ce1002cbdc788cb87470fdd2" title="Creates and returns a new instance of a DetectAddress. " alt="" coords="233,5,359,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee01f4b8cac5c1f3fe3e54764407b799"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectAddressIPv4Tests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l01596">1596</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-address_8c_source.html#l05213">DetectAddressTests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h_aee01f4b8cac5c1f3fe3e54764407b799_icgraph.png" border="0" usemap="#detect-engine-address-ipv4_8h_aee01f4b8cac5c1f3fe3e54764407b799_icgraph" alt=""/></div>
<map name="detect-engine-address-ipv4_8h_aee01f4b8cac5c1f3fe3e54764407b799_icgraph" id="detect-engine-address-ipv4_8h_aee01f4b8cac5c1f3fe3e54764407b799_icgraph">
<area shape="rect" id="node2" href="detect-engine-address_8h.html#a04ba9edcc63f8762b9c03cf08ad0c900" title="DetectAddressTests" alt="" coords="225,31,367,57"/><area shape="rect" id="node3" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="416,31,515,57"/><area shape="rect" id="node4" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="563,5,712,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="760,31,811,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a237c0b35a4cf83da14cf9b406678795c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DetectAddressIsCompleteIPSpaceIPv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>ag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the address group list covers the complete IPv4 IP space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ag</td><td>Pointer to a DetectAddress list head, which has to be checked to see if the address ranges in it, cover the entire IPv4 IP space.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Yes, it covers the entire IPv4 address range. </td></tr>
    <tr><td class="paramname">0</td><td>No, it doesn't cover the entire IPv4 address range. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00472">472</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>References <a class="el" href="detect_8h_source.html#l00171">DetectAddress_::ip</a>, <a class="el" href="detect_8h_source.html#l00172">DetectAddress_::ip2</a>, and <a class="el" href="detect_8h_source.html#l00189">DetectAddress_::next</a>.</p>

</div>
</div>
<a class="anchor" id="aad6bac01b7f9087620caeaa81863b8b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DetectAddressJoinIPv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a589be32a0d47905458ef5bd83438187d">DetectAddress</a> *&#160;</td>
          <td class="paramname"><em>source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extends a target address range if the the source address range is wider than the target address range on either sides. </p>
<pre class="fragment">   Every address is a range, i.e. address-&gt;ip1....address-&gt;ip2.  For
   example 1.2.3.4 to 192.168.1.1.
   if source-&gt;ip1 is smaller than target-&gt;ip1, it indicates that the
   source's left address limit is greater(range wise) than the target's
   left address limit, and hence we reassign the target's left address
   limit to source's left address limit.
   Similary if source-&gt;ip2 is greater than target-&gt;ip2, it indicates that
   the source's right address limit is greater(range wise) than the
   target's right address limit, and hence we reassign the target's right
   address limit to source's right address limit.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Pointer to the detection engine context. </td></tr>
    <tr><td class="paramname">target</td><td>Pointer to the target DetectAddress instance that has to be updated. </td></tr>
    <tr><td class="paramname">source</td><td>Pointer to the source DetectAddress instance that is used to decided whether we extend the target's address range.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-address-ipv4_8c_source.html#l00587">587</a> of file <a class="el" href="detect-engine-address-ipv4_8c_source.html">detect-engine-address-ipv4.c</a>.</p>

<p>References <a class="el" href="detect_8h_source.html#l00171">DetectAddress_::ip</a>, and <a class="el" href="detect_8h_source.html#l00172">DetectAddress_::ip2</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-address_8c_source.html#l00522">DetectAddressJoin()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="detect-engine-address-ipv4_8h_aad6bac01b7f9087620caeaa81863b8b5_icgraph.png" border="0" usemap="#detect-engine-address-ipv4_8h_aad6bac01b7f9087620caeaa81863b8b5_icgraph" alt=""/></div>
<map name="detect-engine-address-ipv4_8h_aad6bac01b7f9087620caeaa81863b8b5_icgraph" id="detect-engine-address-ipv4_8h_aad6bac01b7f9087620caeaa81863b8b5_icgraph">
<area shape="rect" id="node2" href="detect-engine-address_8h.html#ac02d2217a26ec2e8f87de581bd0ef6c5" title="Join two addresses groups together. " alt="" coords="213,56,347,83"/><area shape="rect" id="node3" href="detect_8c.html#afc77848803e5fcaaf39f90ff860140dc" title="CreateGroupedAddrList" alt="" coords="395,56,554,83"/><area shape="rect" id="node4" href="detect_8c.html#aabe6ab0213639a48e8560e510eb7ca02" title="Fill the global src group head, with the sigs included. " alt="" coords="854,5,1029,32"/><area shape="rect" id="node9" href="detect_8c.html#a0ff85d4d7e9776988c8fe1659f65db89" title="Build the destination address portion of the match tree. " alt="" coords="603,56,805,83"/><area shape="rect" id="node11" href="detect_8c.html#aa3952cbb6c857eb9d1b9b2fa7689c0e4" title="BuildDestinationAddressHeads\lWithBothPorts" alt="" coords="603,107,805,149"/><area shape="rect" id="node5" href="detect_8h.html#a5eab8b8beaf1cc85d8a25a309ea13124" title="Convert the signature list into the runtime match structure. " alt="" coords="1078,31,1183,57"/><area shape="rect" id="node6" href="detect_8h.html#a8b471081c75864d1c8d4bcb14eaebc3b" title="Load signatures. " alt="" coords="1232,31,1363,57"/><area shape="rect" id="node7" href="detect-engine_8h.html#aba0e2c94ab90c4390af30af806db271d" title="Reload the detection engine. " alt="" coords="1411,31,1554,57"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1603,31,1653,57"/><area shape="rect" id="node10" href="detect_8c.html#a72fc70b5d12e86ff5827d2d397233773" title="SigAddressPrepareStage3" alt="" coords="854,56,1029,83"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="detect-engine-address-ipv4_8h.html">detect-engine-address-ipv4.h</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:04 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
