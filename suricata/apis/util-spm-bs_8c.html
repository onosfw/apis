<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/util-spm-bs.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util-spm-bs_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util-spm-bs.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-spm-bs_8h_source.html">util-spm-bs.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-spm-bs.c:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm-bs_8c__incl.png" border="0" usemap="#src_2util-spm-bs_8c" alt=""/></div>
<map name="src_2util-spm-bs_8c" id="src_2util-spm-bs_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="692,229,825,256"/><area shape="rect" id="node47" href="suricata_8h.html" title="suricata.h" alt="" coords="279,155,357,181"/><area shape="rect" id="node30" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="1005,453,1093,480"/><area shape="rect" id="node50" href="util-spm-bs_8h.html" title="util&#45;spm&#45;bs.h" alt="" coords="623,80,720,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="2194,304,2267,331"/><area shape="rect" id="node26" href="threads_8h.html" title="threads.h" alt="" coords="561,677,636,704"/><area shape="rect" id="node29" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="419,304,568,331"/><area shape="rect" id="node32" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="603,528,683,555"/><area shape="rect" id="node34" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="1071,603,1153,629"/><area shape="rect" id="node36" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="925,304,1064,331"/><area shape="rect" id="node44" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="593,304,695,331"/><area shape="rect" id="node45" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="719,304,797,331"/><area shape="rect" id="node46" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="822,304,900,331"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="2801,677,2884,704"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="2599,453,2653,480"/><area shape="rect" id="node15" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="2698,379,2797,405"/><area shape="rect" id="node16" href="htp__config_8h.html" title="htp_config.h" alt="" coords="1524,379,1617,405"/><area shape="rect" id="node17" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="1642,379,1805,405"/><area shape="rect" id="node18" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="1999,379,2145,405"/><area shape="rect" id="node20" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="1881,379,1975,405"/><area shape="rect" id="node14" href="htp__list_8h.html" title="htp_list.h" alt="" coords="2761,603,2836,629"/><area shape="rect" id="node21" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="2514,379,2621,405"/><area shape="rect" id="node22" href="htp__table_8h.html" title="htp_table.h" alt="" coords="2461,453,2547,480"/><area shape="rect" id="node23" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="2169,379,2292,405"/><area shape="rect" id="node24" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="2317,379,2437,405"/><area shape="rect" id="node25" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="1511,453,1644,480"/><area shape="rect" id="node13" href="bstr__builder_8h.html" title="bstr_builder.h" alt="" coords="2470,528,2569,555"/><area shape="rect" id="node27" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="561,752,636,779"/><area shape="rect" id="node31" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="758,528,844,555"/><area shape="rect" id="node33" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="869,528,995,555"/><area shape="rect" id="node35" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="1065,677,1159,704"/><area shape="rect" id="node37" href="decode_8h.html" title="decode.h" alt="" coords="271,528,345,555"/><area shape="rect" id="node42" href="detect_8h.html" title="detect.h" alt="" coords="960,379,1029,405"/><area shape="rect" id="node38" href="threadvars_8h.html" title="threadvars.h" alt="" coords="509,603,603,629"/><area shape="rect" id="node39" href="decode-events_8h.html" title="decode&#45;events.h" alt="" coords="118,603,236,629"/><area shape="rect" id="node40" href="source-nflog_8h.html" title="source&#45;nflog.h" alt="" coords="380,603,484,629"/><area shape="rect" id="node41" href="source-nfq_8h.html" title="source&#45;nfq.h" alt="" coords="261,603,355,629"/><area shape="rect" id="node43" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="131,453,241,480"/><area shape="rect" id="node48" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="94,229,191,256"/></map>
</div>
</div>
<p><a href="util-spm-bs_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8ed215597f32589d269f23b37a424cc5"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#a8ed215597f32589d269f23b37a424cc5">BasicSearch</a> (const uint8_t *haystack, uint32_t haystack_len, const uint8_t *needle, uint16_t needle_len)</td></tr>
<tr class="memdesc:a8ed215597f32589d269f23b37a424cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic search improved. Limits are better handled, so it doesn't start searches that wont fit in the remaining buffer.  <a href="#a8ed215597f32589d269f23b37a424cc5">More...</a><br/></td></tr>
<tr class="separator:a8ed215597f32589d269f23b37a424cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad618a842947e5964d363c4390208d10"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#aad618a842947e5964d363c4390208d10">BasicSearchNocase</a> (const uint8_t *haystack, uint32_t haystack_len, const uint8_t *needle, uint16_t needle_len)</td></tr>
<tr class="memdesc:aad618a842947e5964d363c4390208d10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic search case less.  <a href="#aad618a842947e5964d363c4390208d10">More...</a><br/></td></tr>
<tr class="separator:aad618a842947e5964d363c4390208d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3959b973ce99a9e8ebf0491ffc8790"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm-bs_8c.html#a3f3959b973ce99a9e8ebf0491ffc8790">BasicSearchInit</a> (void)</td></tr>
<tr class="separator:a3f3959b973ce99a9e8ebf0491ffc8790"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd>
<dd>
Pablo Rincon Crespo <a href="#" onclick="location.href='mai'+'lto:'+'pab'+'lo'+'.ri'+'nc'+'on.'+'cr'+'esp'+'o@'+'gma'+'il'+'.co'+'m'; return false;">pablo<span style="display: none;">.nosp@m.</span>.rin<span style="display: none;">.nosp@m.</span>con.c<span style="display: none;">.nosp@m.</span>resp<span style="display: none;">.nosp@m.</span>o@gma<span style="display: none;">.nosp@m.</span>il.c<span style="display: none;">.nosp@m.</span>om</a></dd></dl>
<p>bs is a bruteforce search. It will try to search the pattern from all characters until the available text len is less than the length of the pattern. It needs no context but it time cost is not good. </p>

<p>Definition in file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8ed215597f32589d269f23b37a424cc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* BasicSearch </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>haystack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>haystack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needle_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic search improved. Limits are better handled, so it doesn't start searches that wont fit in the remaining buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">haystack</td><td>pointer to the buffer to search in </td></tr>
    <tr><td class="paramname">haystack_len</td><td>length limit of the buffer </td></tr>
    <tr><td class="paramname">neddle</td><td>pointer to the pattern we ar searching for </td></tr>
    <tr><td class="paramname">needle_len</td><td>length limit of the needle</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>to start of the match; NULL if no match </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00048">48</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

<p>References <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>.</p>

</div>
</div>
<a class="anchor" id="a3f3959b973ce99a9e8ebf0491ffc8790"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BasicSearchInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00135">135</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

</div>
</div>
<a class="anchor" id="aad618a842947e5964d363c4390208d10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* BasicSearchNocase </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>haystack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>haystack_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needle_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic search case less. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">haystack</td><td>pointer to the buffer to search in </td></tr>
    <tr><td class="paramname">haystack_len</td><td>length limit of the buffer </td></tr>
    <tr><td class="paramname">neddle</td><td>pointer to the pattern we ar searching for </td></tr>
    <tr><td class="paramname">needle_len</td><td>length limit of the needle</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>to start of the match; NULL if no match </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm-bs_8c_source.html#l00102">102</a> of file <a class="el" href="util-spm-bs_8c_source.html">util-spm-bs.c</a>.</p>

<p>References <a class="el" href="suricata_8h_source.html#l00181">u8_tolower</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util-spm-bs_8c.html">util-spm-bs.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:17 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
