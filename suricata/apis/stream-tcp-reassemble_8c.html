<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/stream-tcp-reassemble.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('stream-tcp-reassemble_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stream-tcp-reassemble.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-pool_8h_source.html">util-pool.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-print_8h_source.html">util-print.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-host-os-info_8h_source.html">util-host-os-info.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest-helper_8h_source.html">util-unittest-helper.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-byte_8h_source.html">util-byte.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-inline_8h_source.html">stream-tcp-inline.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-util_8h_source.html">stream-tcp-util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-protos_8h_source.html">app-layer-protos.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer_8h_source.html">app-layer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-events_8h_source.html">app-layer-events.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp-reassemble.c:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c__incl.png" border="0" usemap="#src_2stream-tcp-reassemble_8c" alt=""/></div>
<map name="src_2stream-tcp-reassemble_8c" id="src_2stream-tcp-reassemble_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="1640,155,1773,181"/><area shape="rect" id="node26" href="suricata_8h.html" title="suricata.h" alt="" coords="1427,80,1505,107"/><area shape="rect" id="node29" href="debug_8h.html" title="debug.h" alt="" coords="1683,80,1751,107"/><area shape="rect" id="node12" href="detect_8h.html" title="detect.h" alt="" coords="1355,304,1424,331"/><area shape="rect" id="node13" href="flow_8h.html" title="flow.h" alt="" coords="454,379,511,405"/><area shape="rect" id="node5" href="threads_8h.html" title="threads.h" alt="" coords="1894,453,1969,480"/><area shape="rect" id="node30" href="conf_8h.html" title="conf.h" alt="" coords="1776,80,1835,107"/><area shape="rect" id="node31" href="flow-util_8h.html" title="flow&#45;util.h" alt="" coords="1910,80,1988,107"/><area shape="rect" id="node33" href="threadvars_8h.html" title="threadvars.h" alt="" coords="701,304,795,331"/><area shape="rect" id="node34" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="1798,155,1892,181"/><area shape="rect" id="node35" href="util-pool_8h.html" title="util&#45;pool.h" alt="" coords="598,304,676,331"/><area shape="rect" id="node36" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="2013,80,2109,107"/><area shape="rect" id="node37" href="util-print_8h.html" title="util&#45;print.h" alt="" coords="2134,80,2212,107"/><area shape="rect" id="node38" href="util-host-os-info_8h.html" title="util&#45;host&#45;os&#45;info.h" alt="" coords="2237,80,2360,107"/><area shape="rect" id="node39" href="util-unittest-helper_8h.html" title="util&#45;unittest&#45;helper.h" alt="" coords="2384,80,2520,107"/><area shape="rect" id="node40" href="util-byte_8h.html" title="util&#45;byte.h" alt="" coords="5,304,83,331"/><area shape="rect" id="node41" href="stream-tcp_8h.html" title="stream&#45;tcp.h" alt="" coords="277,80,371,107"/><area shape="rect" id="node42" href="stream-tcp-private_8h.html" title="stream&#45;tcp&#45;private.h" alt="" coords="571,229,709,256"/><area shape="rect" id="node44" href="stream-tcp-reassemble_8h.html" title="stream&#45;tcp&#45;reassemble.h" alt="" coords="362,155,528,181"/><area shape="rect" id="node45" href="stream-tcp-inline_8h.html" title="stream&#45;tcp&#45;inline.h" alt="" coords="879,155,1008,181"/><area shape="rect" id="node46" href="stream-tcp-util_8h.html" title="stream&#45;tcp&#45;util.h" alt="" coords="1033,155,1148,181"/><area shape="rect" id="node43" href="stream_8h.html" title="stream.h" alt="" coords="371,229,444,256"/><area shape="rect" id="node7" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="2093,379,2181,405"/><area shape="rect" id="node47" href="app-layer-protos_8h.html" title="app&#45;layer&#45;protos.h" alt="" coords="2545,80,2671,107"/><area shape="rect" id="node48" href="app-layer_8h.html" title="app&#45;layer.h" alt="" coords="625,80,711,107"/><area shape="rect" id="node50" href="app-layer-events_8h.html" title="app&#45;layer&#45;events.h" alt="" coords="2695,80,2824,107"/><area shape="rect" id="node32" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine. " alt="" coords="1968,155,2112,181"/><area shape="rect" id="node49" href="util-profiling_8h.html" title="util&#45;profiling.h" alt="" coords="756,155,855,181"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="1745,229,1817,256"/><area shape="rect" id="node6" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="2308,229,2457,256"/><area shape="rect" id="node9" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="2097,453,2177,480"/><area shape="rect" id="node10" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="1843,229,1925,256"/><area shape="rect" id="node11" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1529,229,1668,256"/><area shape="rect" id="node14" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="547,453,649,480"/><area shape="rect" id="node24" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="1950,229,2028,256"/><area shape="rect" id="node25" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="2053,229,2131,256"/><area shape="rect" id="node15" href="detect-engine-proto_8h.html" title="detect&#45;engine&#45;proto.h" alt="" coords="1636,379,1780,405"/><area shape="rect" id="node16" href="detect-reference_8h.html" title="detect&#45;reference.h" alt="" coords="1255,379,1381,405"/><area shape="rect" id="node17" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="1805,379,1915,405"/><area shape="rect" id="node18" href="util-mpm_8h.html" title="util&#45;mpm.h" alt="" coords="653,379,736,405"/><area shape="rect" id="node19" href="util-hash_8h.html" title="util&#45;hash.h" alt="" coords="1407,379,1489,405"/><area shape="rect" id="node20" href="util-hashlist_8h.html" title="util&#45;hashlist.h" alt="" coords="1513,379,1612,405"/><area shape="rect" id="node21" href="util-radix-tree_8h.html" title="util&#45;radix&#45;tree.h" alt="" coords="913,379,1020,405"/><area shape="rect" id="node22" href="util-file_8h.html" title="util&#45;file.h" alt="" coords="1045,379,1115,405"/><area shape="rect" id="node23" href="reputation_8h.html" title="reputation.h" alt="" coords="1140,379,1231,405"/><area shape="rect" id="node27" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="1709,304,1805,331"/></map>
</div>
</div>
<p><a href="stream-tcp-reassemble_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSegmentSizes__.html">SegmentSizes_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structReassembleData__.html">ReassembleData_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structReassembleRawData__.html">ReassembleRawData_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a33a955af14b861c57a5f451f9b3f9ab0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a33a955af14b861c57a5f451f9b3f9ab0">PSEUDO_PACKET_PAYLOAD_SIZE</a>&#160;&#160;&#160;65416 /* 64 Kb minus max IP and TCP header */</td></tr>
<tr class="separator:a33a955af14b861c57a5f451f9b3f9ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb43e28fee3d22afca24a8a18657174"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#abfb43e28fee3d22afca24a8a18657174">StreamTcpAppLayerSegmentProcessed</a>(ssn, stream, segment)</td></tr>
<tr class="memdesc:abfb43e28fee3d22afca24a8a18657174"><td class="mdescLeft">&#160;</td><td class="mdescRight">see if app layer is done with a segment  <a href="#abfb43e28fee3d22afca24a8a18657174">More...</a><br/></td></tr>
<tr class="separator:abfb43e28fee3d22afca24a8a18657174"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a48c87ce8b818a183c76b4cb1e9a0e6c6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSegmentSizes__.html">SegmentSizes_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a48c87ce8b818a183c76b4cb1e9a0e6c6">SegmentSizes</a></td></tr>
<tr class="separator:a48c87ce8b818a183c76b4cb1e9a0e6c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a076e93f531a2210612a4d5f95fc38d71"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structReassembleData__.html">ReassembleData_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a076e93f531a2210612a4d5f95fc38d71">ReassembleData</a></td></tr>
<tr class="separator:a076e93f531a2210612a4d5f95fc38d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c9b38342c075bbd90d1768acceba925"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structReassembleRawData__.html">ReassembleRawData_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a7c9b38342c075bbd90d1768acceba925">ReassembleRawData</a></td></tr>
<tr class="separator:a7c9b38342c075bbd90d1768acceba925"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a879a0399b47b9ecf4f72c0fdc3d30949"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a879a0399b47b9ecf4f72c0fdc3d30949">SC_ATOMIC_DECLARE</a> (uint64_t, ra_memuse)</td></tr>
<tr class="separator:a879a0399b47b9ecf4f72c0fdc3d30949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedffcca13ecfb7e75dab25d34f155575"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aedffcca13ecfb7e75dab25d34f155575">StreamTcpSegmentDataReplace</a> (<a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *dst_seg, <a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *src_seg, uint32_t start_point, uint16_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:aedffcca13ecfb7e75dab25d34f155575"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to replace the data from a specific point up to given length.  <a href="#aedffcca13ecfb7e75dab25d34f155575">More...</a><br/></td></tr>
<tr class="separator:aedffcca13ecfb7e75dab25d34f155575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac92d234d9e9d670f018955030d4e19e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ac92d234d9e9d670f018955030d4e19e0">StreamTcpSegmentDataCopy</a> (<a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *dst_seg, <a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *src_seg)</td></tr>
<tr class="memdesc:ac92d234d9e9d670f018955030d4e19e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to copy the data from src_seg to dst_seg.  <a href="#ac92d234d9e9d670f018955030d4e19e0">More...</a><br/></td></tr>
<tr class="separator:ac92d234d9e9d670f018955030d4e19e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41cf556eaddebb12df7460006cc9c988"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988">StreamTcpGetSegment</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, uint16_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="memdesc:a41cf556eaddebb12df7460006cc9c988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to get the segment of required length from the pool.  <a href="#a41cf556eaddebb12df7460006cc9c988">More...</a><br/></td></tr>
<tr class="separator:a41cf556eaddebb12df7460006cc9c988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad13ca18d0189118eca9aee4dfc9d11cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad13ca18d0189118eca9aee4dfc9d11cd">StreamTcpCreateTestPacket</a> (uint8_t *, uint8_t, uint8_t, uint8_t)</td></tr>
<tr class="separator:ad13ca18d0189118eca9aee4dfc9d11cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af046998a397130b34da08e7bae4bf2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a3af046998a397130b34da08e7bae4bf2">StreamTcpReassemblePseudoPacketCreate</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *)</td></tr>
<tr class="separator:a3af046998a397130b34da08e7bae4bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322cfd1d74e7cc11b4df7a01413b3ce3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a322cfd1d74e7cc11b4df7a01413b3ce3">StreamTcpReassembleConfigEnableOverlapCheck</a> (void)</td></tr>
<tr class="separator:a322cfd1d74e7cc11b4df7a01413b3ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0450f1665ff06a11cb08777c78eba9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b">StreamTcpReassembleIncrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:ae0450f1665ff06a11cb08777c78eba9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Increment the memory usage counter for the TCP reassembly segments.  <a href="#ae0450f1665ff06a11cb08777c78eba9b">More...</a><br/></td></tr>
<tr class="separator:ae0450f1665ff06a11cb08777c78eba9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1117512e3b998a56f41b4457da37c416"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416">StreamTcpReassembleDecrMemuse</a> (uint64_t size)</td></tr>
<tr class="memdesc:a1117512e3b998a56f41b4457da37c416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Decrease the memory usage counter for the TCP reassembly segments.  <a href="#a1117512e3b998a56f41b4457da37c416">More...</a><br/></td></tr>
<tr class="separator:a1117512e3b998a56f41b4457da37c416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f">StreamTcpReassembleMemuseGlobalCounter</a> (void)</td></tr>
<tr class="separator:a477c59db3b1fef12cb9b1e5e5de0f59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3131fef1b3b347c72077af35f3817ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea">StreamTcpReassembleCheckMemcap</a> (uint32_t size)</td></tr>
<tr class="memdesc:ab3131fef1b3b347c72077af35f3817ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP segments.  <a href="#ab3131fef1b3b347c72077af35f3817ea">More...</a><br/></td></tr>
<tr class="separator:ab3131fef1b3b347c72077af35f3817ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ebd7988b8a196ad81913e13f274c22"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22">TcpSegmentPoolAlloc</a> ()</td></tr>
<tr class="memdesc:ab4ebd7988b8a196ad81913e13f274c22"><td class="mdescLeft">&#160;</td><td class="mdescRight">alloc a tcp segment pool entry  <a href="#ab4ebd7988b8a196ad81913e13f274c22">More...</a><br/></td></tr>
<tr class="separator:ab4ebd7988b8a196ad81913e13f274c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1fb22e94e9c6df8a77e06699f6e86ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed">TcpSegmentPoolInit</a> (void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, void *payload_len)</td></tr>
<tr class="separator:aa1fb22e94e9c6df8a77e06699f6e86ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528a7185ada382fada458afd2fc961a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7">TcpSegmentPoolCleanup</a> (void *ptr)</td></tr>
<tr class="memdesc:a528a7185ada382fada458afd2fc961a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">clean up a tcp segment pool entry  <a href="#a528a7185ada382fada458afd2fc961a7">More...</a><br/></td></tr>
<tr class="separator:a528a7185ada382fada458afd2fc961a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00">StreamTcpSegmentReturntoPool</a> (<a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *seg)</td></tr>
<tr class="memdesc:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the segment back to the pool.  <a href="#a11fcdabd0f9f4889f7b15cd098e28c00">More...</a><br/></td></tr>
<tr class="separator:a11fcdabd0f9f4889f7b15cd098e28c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9e5351fc6f108c2c429436b49c8ace3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3">StreamTcpReturnStreamSegments</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream)</td></tr>
<tr class="memdesc:ad9e5351fc6f108c2c429436b49c8ace3"><td class="mdescLeft">&#160;</td><td class="mdescRight">return all segments in this stream into the pool(s)  <a href="#ad9e5351fc6f108c2c429436b49c8ace3">More...</a><br/></td></tr>
<tr class="separator:ad9e5351fc6f108c2c429436b49c8ace3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419339627115993b6ef9f55ebbd4365c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c">StreamTcpDisableAppLayer</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="separator:a419339627115993b6ef9f55ebbd4365c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34cbaa81da49c7656535cebbca45ff1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad34cbaa81da49c7656535cebbca45ff1">StreamTcpAppLayerIsDisabled</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="separator:ad34cbaa81da49c7656535cebbca45ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e2b5d05e1f2d5b39843319142e436f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0">StreamTcpReassemblyConfig</a> (char quiet)</td></tr>
<tr class="separator:a6e2b5d05e1f2d5b39843319142e436f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b178831cdeb029f02fd53f08f328cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#ad1b178831cdeb029f02fd53f08f328cf">StreamTcpReassembleInit</a> (char quiet)</td></tr>
<tr class="separator:ad1b178831cdeb029f02fd53f08f328cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa019dfbfe83315c6aab375311eecc36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#aaa019dfbfe83315c6aab375311eecc36">StreamTcpReassembleFree</a> (char quiet)</td></tr>
<tr class="separator:aaa019dfbfe83315c6aab375311eecc36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc1a2f2120af56ff09791171c822897"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a5dc1a2f2120af56ff09791171c822897">StreamTcpReassembleInitThreadCtx</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="separator:a5dc1a2f2120af56ff09791171c822897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a967e5a8d394fdac2878d63f01b9c87cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc">StreamTcpReassembleFreeThreadCtx</a> (<a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx)</td></tr>
<tr class="separator:a967e5a8d394fdac2878d63f01b9c87cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a8f87c06afcf81900e99924112ef89b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b">PrintList2</a> (<a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *seg)</td></tr>
<tr class="separator:a8a8f87c06afcf81900e99924112ef89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d81d5d4678c6234e27e051b90143b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8">PrintList</a> (<a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *seg)</td></tr>
<tr class="separator:af7d81d5d4678c6234e27e051b90143b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57183ba5a415fcc5c946937e68d610d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3">StreamTcpReassembleInsertSegment</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *seg, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:a57183ba5a415fcc5c946937e68d610d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de7491805a4a77ffda933d5fbf566e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a3de7491805a4a77ffda933d5fbf566e4">StreamTcpReassembleDepthReached</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a3de7491805a4a77ffda933d5fbf566e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if stream in pkt direction has depth reached  <a href="#a3de7491805a4a77ffda933d5fbf566e4">More...</a><br/></td></tr>
<tr class="separator:a3de7491805a4a77ffda933d5fbf566e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f">StreamTcpReassembleHandleSegmentHandleData</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a packets TCP data into the stream reassembly engine.  <a href="#a75ed0e6a51ad7ee4418623e1db12fc8f">More...</a><br/></td></tr>
<tr class="separator:a75ed0e6a51ad7ee4418623e1db12fc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe50d83dc6803121f9a01ed920e7f6b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1">StreamTcpPruneSession</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:afe50d83dc6803121f9a01ed920e7f6b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove idle TcpSegments from TcpSession.  <a href="#afe50d83dc6803121f9a01ed920e7f6b1">More...</a><br/></td></tr>
<tr class="separator:afe50d83dc6803121f9a01ed920e7f6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a401bd2a63bec40a406b0cf3e95d6415d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d">DoHandleGap</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *seg, <a class="el" href="stream-tcp-reassemble_8c.html#a076e93f531a2210612a4d5f95fc38d71">ReassembleData</a> *rd, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint32_t next_seq)</td></tr>
<tr class="separator:a401bd2a63bec40a406b0cf3e95d6415d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfcce88649a7bc46af58419da7fc5b28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28">StreamTcpReassembleAppLayer</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:acfcce88649a7bc46af58419da7fc5b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the stream reassembly upon receiving an ACK packet.  <a href="#acfcce88649a7bc46af58419da7fc5b28">More...</a><br/></td></tr>
<tr class="separator:acfcce88649a7bc46af58419da7fc5b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7f7667924193878624cfd69065b4a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4">StreamTcpReassembleHandleSegmentUpdateACK</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a6b7f7667924193878624cfd69065b4a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">update app layer and raw reassembly  <a href="#a6b7f7667924193878624cfd69065b4a4">More...</a><br/></td></tr>
<tr class="separator:a6b7f7667924193878624cfd69065b4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eaa63aa69d838e0db8634ee3d011d67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67">StreamTcpReassembleHandleSegment</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *ra_ctx, <a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn, <a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq)</td></tr>
<tr class="separator:a1eaa63aa69d838e0db8634ee3d011d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ad968d775653b4144a7685016349ad8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a7ad968d775653b4144a7685016349ad8">StreamTcpReassembleTriggerRawReassembly</a> (<a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *ssn)</td></tr>
<tr class="memdesc:a7ad968d775653b4144a7685016349ad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger RAW stream reassembly.  <a href="#a7ad968d775653b4144a7685016349ad8">More...</a><br/></td></tr>
<tr class="separator:a7ad968d775653b4144a7685016349ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4894f48885e4926013c260b03f68685f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f">StreamTcpReassembleRegisterTests</a> (void)</td></tr>
<tr class="memdesc:a4894f48885e4926013c260b03f68685f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Function Register the Unit tests to test the reassembly engine for various OS policies.  <a href="#a4894f48885e4926013c260b03f68685f">More...</a><br/></td></tr>
<tr class="separator:a4894f48885e4926013c260b03f68685f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span style="display: none;">.nosp@m.</span>nder<span style="display: none;">.nosp@m.</span>singh<span style="display: none;">.nosp@m.</span>dahi<span style="display: none;">.nosp@m.</span>ya@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a> </dd>
<dd>
Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a></dd></dl>
<p>Reference: Judy Novak, Steve Sturges: Target-Based TCP Stream Reassembly August, 2007 </p>

<p>Definition in file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a33a955af14b861c57a5f451f9b3f9ab0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PSEUDO_PACKET_PAYLOAD_SIZE&#160;&#160;&#160;65416 /* 64 Kb minus max IP and TCP header */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00066">66</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

</div>
</div>
<a class="anchor" id="abfb43e28fee3d22afca24a8a18657174"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define StreamTcpAppLayerSegmentProcessed</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ssn, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stream, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">segment&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(( ( (ssn)-&gt;<a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="stream-tcp-private_8h.html#ae735a4fb318471b3d22518bbfd30b1a0">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>) || \</div>
<div class="line">       ( (stream)-&gt;<a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="stream-tcp-private_8h.html#a596c6f9cb5d76b92cb5e8ce32955a510">STREAMTCP_STREAM_FLAG_GAP</a> ) || \</div>
<div class="line">       ( (segment)-&gt;<a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="stream-tcp-private_8h.html#a6c906ffb7cdbc867bd621851336d7459">SEGMENTTCP_FLAG_APPLAYER_PROCESSED</a> ) ? 1 :0 ))</div>
<div class="ttc" id="app-layer-dns-common_8h_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00039">app-layer-dns-common.h:39</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_a6c906ffb7cdbc867bd621851336d7459"><div class="ttname"><a href="stream-tcp-private_8h.html#a6c906ffb7cdbc867bd621851336d7459">SEGMENTTCP_FLAG_APPLAYER_PROCESSED</a></div><div class="ttdeci">#define SEGMENTTCP_FLAG_APPLAYER_PROCESSED</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00184">stream-tcp-private.h:184</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_a596c6f9cb5d76b92cb5e8ce32955a510"><div class="ttname"><a href="stream-tcp-private_8h.html#a596c6f9cb5d76b92cb5e8ce32955a510">STREAMTCP_STREAM_FLAG_GAP</a></div><div class="ttdeci">#define STREAMTCP_STREAM_FLAG_GAP</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00153">stream-tcp-private.h:153</a></div></div>
<div class="ttc" id="stream-tcp-private_8h_html_ae735a4fb318471b3d22518bbfd30b1a0"><div class="ttname"><a href="stream-tcp-private_8h.html#ae735a4fb318471b3d22518bbfd30b1a0">STREAMTCP_FLAG_APP_LAYER_DISABLED</a></div><div class="ttdeci">#define STREAMTCP_FLAG_APP_LAYER_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="stream-tcp-private_8h_source.html#l00146">stream-tcp-private.h:146</a></div></div>
</div><!-- fragment -->
<p>see if app layer is done with a segment </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>app layer is done with this segment </td></tr>
    <tr><td class="paramname">0</td><td>not done yet </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02084">2084</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a076e93f531a2210612a4d5f95fc38d71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structReassembleData__.html">ReassembleData_</a>  <a class="el" href="stream-tcp-reassemble_8c.html#a076e93f531a2210612a4d5f95fc38d71">ReassembleData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7c9b38342c075bbd90d1768acceba925"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structReassembleRawData__.html">ReassembleRawData_</a>  <a class="el" href="stream-tcp-reassemble_8c.html#a7c9b38342c075bbd90d1768acceba925">ReassembleRawData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a48c87ce8b818a183c76b4cb1e9a0e6c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSegmentSizes__.html">SegmentSizes_</a>  <a class="el" href="stream-tcp-reassemble_8c.html#a48c87ce8b818a183c76b4cb1e9a0e6c6">SegmentSizes</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a401bd2a63bec40a406b0cf3e95d6415d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DoHandleGap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8c.html#a076e93f531a2210612a4d5f95fc38d71">ReassembleData</a> *&#160;</td>
          <td class="paramname"><em>rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>next_seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02561">2561</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00055">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00083">AppLayerHandleTCPData()</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00061">TcpReassemblyThreadCtx_::counter_tcp_reass_gap</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02548">ReassembleData_::data</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02547">ReassembleData_::data_len</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02550">ReassembleData_::data_sent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02546">ReassembleData_::ra_base_seq</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00201">SEQ_GT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00218">TcpSession_::state</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="stream_8h_source.html#l00033">STREAM_GAP</a>, <a class="el" href="decode-events_8h_source.html#l00211">STREAM_REASSEMBLY_SEQ_GAP</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00153">STREAMTCP_STREAM_FLAG_GAP</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00106">TCP_CLOSED</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_cgraph" id="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="157,563,331,589"/><area shape="rect" id="node26" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="743,832,817,859"/><area shape="rect" id="node22" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="705,680,855,707"/><area shape="rect" id="node3" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="393,614,580,655"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="383,411,590,437"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="412,233,561,260"/><area shape="rect" id="node16" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="387,461,586,488"/><area shape="rect" id="node17" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="410,563,563,589"/><area shape="rect" id="node21" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="427,512,546,539"/><area shape="rect" id="node23" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="379,781,594,808"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="646,411,914,437"/><area shape="rect" id="node5" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1007,411,1158,437"/><area shape="rect" id="node7" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="698,259,862,285"/><area shape="rect" id="node9" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="699,56,861,83"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="693,157,867,184"/><area shape="rect" id="node10" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="987,81,1178,108"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="673,309,887,336"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="687,208,873,235"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="643,5,917,32"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="965,259,1200,285"/><area shape="rect" id="node18" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="683,512,877,539"/><area shape="rect" id="node19" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="997,512,1169,539"/><area shape="rect" id="node20" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="1249,505,1442,546"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="745,731,815,757"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="673,781,887,808"/><area shape="rect" id="node25" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="1044,731,1121,757"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1039,781,1126,808"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_icgraph" id="stream-tcp-reassemble_8c_a401bd2a63bec40a406b0cf3e95d6415d_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="158,56,373,83"/><area shape="rect" id="node3" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="435,5,608,32"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="421,57,621,98"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="669,86,869,127"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="918,93,1045,120"/><area shape="rect" id="node7" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1094,93,1181,120"/><area shape="rect" id="node8" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1230,93,1426,120"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1475,93,1610,120"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1659,93,1757,120"/><area shape="rect" id="node11" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2003,93,2053,120"/><area shape="rect" id="node12" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1805,119,1955,145"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af7d81d5d4678c6234e27e051b90143b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00646">646</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00061">TcpSegment_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00059">TcpSegment_::prev</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00598">PrintList2()</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00729">StreamTcpReassembleInsertSegment()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_cgraph" id="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="125,5,203,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_icgraph" id="stream-tcp-reassemble_8c_af7d81d5d4678c6234e27e051b90143b8_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="126,85,341,112"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8h.html#aff3c4ea45ef46a39eda09a7bda2150f6" title="StreamTcpReassembleInsert\lSegment" alt="" coords="137,166,329,207"/><area shape="rect" id="node3" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="403,5,576,32"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="389,107,589,149"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="637,166,837,207"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="685,31,789,57"/><area shape="rect" id="node7" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="886,173,1013,200"/><area shape="rect" id="node8" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1062,173,1149,200"/><area shape="rect" id="node9" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1198,173,1394,200"/><area shape="rect" id="node10" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1443,173,1578,200"/><area shape="rect" id="node11" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1627,173,1725,200"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1971,173,2021,200"/><area shape="rect" id="node13" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1773,199,1923,225"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="389,225,589,266"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a8f87c06afcf81900e99924112ef89b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintList2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00598">598</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00059">TcpSegment_::prev</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00646">PrintList()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a8a8f87c06afcf81900e99924112ef89b_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a8a8f87c06afcf81900e99924112ef89b_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a8a8f87c06afcf81900e99924112ef89b_icgraph" id="stream-tcp-reassemble_8c_a8a8f87c06afcf81900e99924112ef89b_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="131,129,202,156"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="251,85,466,112"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8h.html#aff3c4ea45ef46a39eda09a7bda2150f6" title="StreamTcpReassembleInsert\lSegment" alt="" coords="263,166,455,207"/><area shape="rect" id="node4" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="528,5,701,32"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="515,107,715,149"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="763,166,963,207"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="811,31,915,57"/><area shape="rect" id="node8" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1011,173,1138,200"/><area shape="rect" id="node9" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1187,173,1274,200"/><area shape="rect" id="node10" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1323,173,1519,200"/><area shape="rect" id="node11" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1569,173,1703,200"/><area shape="rect" id="node12" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1752,173,1851,200"/><area shape="rect" id="node13" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2096,173,2147,200"/><area shape="rect" id="node14" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1899,199,2048,225"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="515,225,715,266"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a879a0399b47b9ecf4f72c0fdc3d30949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ra_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad34cbaa81da49c7656535cebbca45ff1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpAppLayerIsDisabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00293">293</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00146">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>.</p>

</div>
</div>
<a class="anchor" id="ad13ca18d0189118eca9aee4dfc9d11cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpCreateTestPacket </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a419339627115993b6ef9f55ebbd4365c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDisableAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00281">281</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00241">StreamTcpDisableAppLayerReassembly</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00235">StreamTcpSetStreamFlagAppProtoDetectionCompleted</a>.</p>

<p>Referenced by <a class="el" href="app-layer-parser_8c_source.html#l00854">AppLayerParserParse()</a>, and <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_icgraph" id="stream-tcp-reassemble_8c_a419339627115993b6ef9f55ebbd4365c_icgraph">
<area shape="rect" id="node2" href="app-layer-parser_8h.html#a781eb6e91987a99a3b9fceb2e4af5806" title="AppLayerParserParse" alt="" coords="240,1175,389,1201"/><area shape="rect" id="node8" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1582,1204,1709,1231"/><area shape="rect" id="node3" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="437,1175,611,1201"/><area shape="rect" id="node15" href="app-layer_8h.html#aef5d5c65f7222215acfe0bcbcd2c8a6e" title="Handles an udp chunk. " alt="" coords="453,768,595,795"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="659,1237,763,1264"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="811,1179,1026,1205"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="1075,1171,1275,1213"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="1328,1197,1528,1238"/><area shape="rect" id="node9" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1803,1187,1890,1213"/><area shape="rect" id="node10" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="2003,1147,2199,1173"/><area shape="rect" id="node11" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2278,791,2413,817"/><area shape="rect" id="node12" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2476,791,2575,817"/><area shape="rect" id="node13" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2824,791,2875,817"/><area shape="rect" id="node14" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2627,816,2776,843"/><area shape="rect" id="node16" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="663,411,759,437"/><area shape="rect" id="node17" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="871,411,967,437"/><area shape="rect" id="node49" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="871,689,967,716"/><area shape="rect" id="node50" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="850,5,987,32"/><area shape="rect" id="node18" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1587,664,1703,691"/><area shape="rect" id="node39" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1124,461,1225,488"/><area shape="rect" id="node30" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1795,461,1898,488"/><area shape="rect" id="node41" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1127,259,1222,285"/><area shape="rect" id="node43" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1383,1069,1473,1096"/><area shape="rect" id="node44" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1598,867,1693,893"/><area shape="rect" id="node45" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1095,664,1255,691"/><area shape="rect" id="node48" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1598,968,1693,995"/><area shape="rect" id="node47" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1604,917,1687,944"/><area shape="rect" id="node26" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2048,563,2155,589"/><area shape="rect" id="node46" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1377,613,1479,640"/><area shape="rect" id="node19" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1800,917,1893,944"/><area shape="rect" id="node21" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1793,715,1901,741"/><area shape="rect" id="node23" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1794,765,1899,792"/><area shape="rect" id="node25" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1785,563,1908,589"/><area shape="rect" id="node31" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1798,1019,1895,1045"/><area shape="rect" id="node33" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1796,816,1897,843"/><area shape="rect" id="node35" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1785,664,1908,691"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1757,968,1936,995"/><area shape="rect" id="node20" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="2000,873,2203,900"/><area shape="rect" id="node22" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1992,715,2211,741"/><area shape="rect" id="node24" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1994,765,2209,792"/><area shape="rect" id="node27" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="2267,157,2423,184"/><area shape="rect" id="node28" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="2477,132,2573,159"/><area shape="rect" id="node29" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="2472,69,2579,96"/><area shape="rect" id="node32" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="1998,1012,2205,1039"/><area shape="rect" id="node34" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1996,816,2207,843"/><area shape="rect" id="node36" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1985,664,2218,691"/><area shape="rect" id="node38" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="1986,936,2217,963"/><area shape="rect" id="node40" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="1323,411,1533,437"/><area shape="rect" id="node42" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1325,208,1531,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a41cf556eaddebb12df7460006cc9c988"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> * StreamTcpGetSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to get the segment of required length from the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">len</td><td>Length which tells the required size of needed segment.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">seg</td><td>Segment from the pool or NULL </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03611">3611</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00057">TcpReassemblyThreadCtx_::counter_tcp_segment_memcap</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00061">TcpSegment_::flags</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="util-pool_8c_source.html#l00280">PoolGet()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00059">TcpSegment_::prev</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp_8h_source.html#l00052">TcpStreamCnf_::segment_init_flags</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, and <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l01883">StreamTcpReassembleHandleSegmentHandleData()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_cgraph" id="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="216,5,285,32"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="213,56,288,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_icgraph" id="stream-tcp-reassemble_8c_a41cf556eaddebb12df7460006cc9c988_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="213,5,413,46"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="461,5,661,46"/><area shape="rect" id="node4" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="710,12,837,39"/><area shape="rect" id="node5" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="886,12,973,39"/><area shape="rect" id="node6" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1022,12,1218,39"/><area shape="rect" id="node7" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1267,12,1402,39"/><area shape="rect" id="node8" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1451,12,1549,39"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1795,12,1845,39"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1597,37,1747,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afe50d83dc6803121f9a01ed920e7f6b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpPruneSession </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove idle TcpSegments from TcpSession. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow </td></tr>
    <tr><td class="paramname">flags</td><td>direction flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02473">2473</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00061">TcpSegment_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream_8h_source.html#l00032">STREAM_TOCLIENT</a>, <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">StreamTcpSegmentReturntoPool()</a>.</p>

<p>Referenced by <a class="el" href="tmqh-packetpool_8c_source.html#l00443">TmqhOutputPacketpool()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_cgraph" id="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="222,5,437,32"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="486,5,573,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_icgraph" id="stream-tcp-reassemble_8c_afe50d83dc6803121f9a01ed920e7f6b1_icgraph">
<area shape="rect" id="node2" href="tmqh-packetpool_8h.html#aecd391771695d5ca519b327487929be4" title="TmqhOutputPacketpool" alt="" coords="222,798,381,824"/><area shape="rect" id="node3" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="469,418,625,444"/><area shape="rect" id="node24" href="flow-timeout_8h.html#a3daade4969e76aa8d9cb8dce83f7d07e" title="FlowForceReassemblyForFlow" alt="" coords="445,519,648,546"/><area shape="rect" id="node25" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="507,671,586,698"/><area shape="rect" id="node29" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="479,620,615,647"/><area shape="rect" id="node30" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop. " alt="" coords="721,722,857,748"/><area shape="rect" id="node32" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="723,772,855,799"/><area shape="rect" id="node34" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="715,823,863,850"/><area shape="rect" id="node36" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="471,874,623,900"/><area shape="rect" id="node39" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="481,924,612,951"/><area shape="rect" id="node42" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="481,570,613,596"/><area shape="rect" id="node44" href="tm-threads_8h.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="712,1050,867,1076"/><area shape="rect" id="node45" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="965,1050,1096,1076"/><area shape="rect" id="node48" href="tmqh-packetpool_8h.html#a5bb62794ff6a8f547995c9128d5d8326" title="TmqhPacketpoolRegister . " alt="" coords="462,1139,631,1166"/><area shape="rect" id="node50" href="tmqh-packetpool_8h.html#a9f4e9d711280d1e9d5a1e6abef1f0def" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="430,1076,663,1103"/><area shape="rect" id="node4" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="983,316,1079,343"/><area shape="rect" id="node5" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1215,316,1311,343"/><area shape="rect" id="node22" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="736,418,843,444"/><area shape="rect" id="node6" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1739,316,1855,343"/><area shape="rect" id="node14" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1408,367,1509,394"/><area shape="rect" id="node12" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1914,468,2017,495"/><area shape="rect" id="node15" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1411,418,1506,444"/><area shape="rect" id="node16" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1593,63,1684,90"/><area shape="rect" id="node17" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1750,12,1845,39"/><area shape="rect" id="node18" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1379,266,1539,292"/><area shape="rect" id="node21" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1750,114,1845,140"/><area shape="rect" id="node20" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1756,164,1839,191"/><area shape="rect" id="node11" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2075,291,2181,318"/><area shape="rect" id="node19" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1587,239,1690,266"/><area shape="rect" id="node7" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1919,164,2012,191"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1911,367,2019,394"/><area shape="rect" id="node9" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1913,418,2018,444"/><area shape="rect" id="node10" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1904,316,2027,343"/><area shape="rect" id="node13" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1917,114,2014,140"/><area shape="rect" id="node23" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="983,418,1079,444"/><area shape="rect" id="node26" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="727,671,851,698"/><area shape="rect" id="node27" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="927,671,1134,698"/><area shape="rect" id="node28" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1195,772,1330,799"/><area shape="rect" id="node31" href="source-erf-file_8h.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module. " alt="" coords="921,722,1140,748"/><area shape="rect" id="node33" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="923,772,1138,799"/><area shape="rect" id="node35" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="915,823,1146,850"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="715,874,864,900"/><area shape="rect" id="node38" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="915,874,1146,900"/><area shape="rect" id="node40" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="725,924,853,951"/><area shape="rect" id="node41" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="925,924,1136,951"/><area shape="rect" id="node43" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="923,620,1138,647"/><area shape="rect" id="node46" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="1197,1050,1328,1076"/><area shape="rect" id="node47" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="1399,1050,1519,1076"/><area shape="rect" id="node49" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="745,1151,834,1178"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acfcce88649a7bc46af58419da7fc5b28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the stream reassembly upon receiving an ACK packet. </p>
<p>Stream is in the opposite direction of the packet, as the ACK-packet is ACK'ing the stream.</p>
<p>One of the utilities call by this function <a class="el" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. ">AppLayerHandleTCPData()</a>, has a feature where it will call this very same function for the stream opposing the stream it is called with. This shouldn't cause any issues, since processing of each stream is independent of the other stream.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000117">Todo:</a></b></dt><dd>this function is too long, we need to break it up. It needs it BAD </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">2878</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00055">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00083">AppLayerHandleTCPData()</a>, <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00061">TcpReassemblyThreadCtx_::counter_tcp_reass_gap</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02548">ReassembleData_::data</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02547">ReassembleData_::data_len</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02550">ReassembleData_::data_sent</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02561">DoHandleGap()</a>, <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00061">TcpSegment_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00071">TcpStream_::isn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02549">ReassembleData_::partial</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l01026">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00646">PrintList()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00082">TcpStream_::ra_app_base_seq</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02546">ReassembleData_::ra_base_seq</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00086">TcpStream_::seg_list_tail</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00184">SEGMENTTCP_FLAG_APPLAYER_PROCESSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00202">SEQ_GEQ</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00201">SEQ_GT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00218">TcpSession_::state</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="stream_8h_source.html#l00033">STREAM_GAP</a>, <a class="el" href="decode-events_8h_source.html#l00211">STREAM_REASSEMBLY_SEQ_GAP</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00146">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00153">STREAMTCP_STREAM_FLAG_GAP</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02084">StreamTcpAppLayerSegmentProcessed</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00237">StreamTcpIsSetStreamFlagAppProtoDetectionCompleted</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">StreamTcpSegmentReturntoPool()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00105">TCP_CLOSING</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00099">TCP_ESTABLISHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00101">TCP_FIN_WAIT2</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00075">TcpStream_::window</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00083">AppLayerHandleTCPData()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">StreamTcpReassembleHandleSegment()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l03387">StreamTcpReassembleHandleSegmentUpdateACK()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_cgraph" id="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="533,309,707,336"/><area shape="rect" id="node23" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="325,372,429,399"/><area shape="rect" id="node25" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="342,473,413,500"/><area shape="rect" id="node24" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="583,423,657,449"/><area shape="rect" id="node22" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="784,487,933,513"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="270,575,485,601"/><area shape="rect" id="node3" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="765,167,952,209"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="755,284,962,311"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="784,233,933,260"/><area shape="rect" id="node16" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="759,335,958,361"/><area shape="rect" id="node17" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="782,385,935,412"/><area shape="rect" id="node21" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="799,436,918,463"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1014,5,1282,32"/><area shape="rect" id="node5" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1375,436,1526,463"/><area shape="rect" id="node7" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1066,56,1230,83"/><area shape="rect" id="node9" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1067,259,1229,285"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1061,309,1235,336"/><area shape="rect" id="node10" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="1355,233,1546,260"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1041,411,1255,437"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1055,107,1241,133"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1011,157,1285,184"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="1333,56,1568,83"/><area shape="rect" id="node18" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1051,512,1245,539"/><area shape="rect" id="node19" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="1365,512,1537,539"/><area shape="rect" id="node20" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="1617,505,1810,546"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="581,473,659,500"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="577,575,663,601"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_icgraph" id="stream-tcp-reassemble_8c_acfcce88649a7bc46af58419da7fc5b28_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="269,55,443,81"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="1155,41,1355,82"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="907,99,1107,141"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="491,117,595,144"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="643,55,858,81"/><area shape="rect" id="node7" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1403,48,1530,75"/><area shape="rect" id="node8" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1579,48,1666,75"/><area shape="rect" id="node9" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1715,48,1911,75"/><area shape="rect" id="node10" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1961,48,2095,75"/><area shape="rect" id="node11" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2144,48,2243,75"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2488,48,2539,75"/><area shape="rect" id="node13" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2291,73,2440,100"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab3131fef1b3b347c72077af35f3817ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00152">152</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00049">TcpStreamCnf_::reassembly_memcap</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>.</p>

<p>Referenced by <a class="el" href="stream_8c_source.html#l00137">StreamMsgPoolAlloc()</a>, <a class="el" href="stream_8c_source.html#l00212">StreamMsgQueueGetNew()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">TcpSegmentPoolAlloc()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00175">TcpSegmentPoolInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ab3131fef1b3b347c72077af35f3817ea_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ab3131fef1b3b347c72077af35f3817ea_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ab3131fef1b3b347c72077af35f3817ea_icgraph" id="stream-tcp-reassemble_8c_ab3131fef1b3b347c72077af35f3817ea_icgraph">
<area shape="rect" id="node2" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="267,5,411,32"/><area shape="rect" id="node8" href="stream_8h.html#a0653021cbdad63e87b0a8590547c2521" title="alloc a stream msg queue " alt="" coords="251,56,426,83"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22" title="alloc a tcp segment pool entry " alt="" coords="475,107,626,133"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="481,157,621,184"/><area shape="rect" id="node3" href="stream_8h.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="475,31,627,57"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="675,107,872,133"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="921,107,1098,133"/><area shape="rect" id="node6" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="1147,107,1290,133"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1339,107,1389,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a322cfd1d74e7cc11b4df7a01413b3ce3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleConfigEnableOverlapCheck </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00109">109</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-event_8c_source.html#l00139">DetectEngineEventParse()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph" id="stream-tcp-reassemble_8c_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph">
<area shape="rect" id="node2" href="detect-engine-event_8c.html#a8929be678fb1e0471cd5599388f6cb99" title="This function is used to parse decoder events options passed via decode&#45;event: keyword. " alt="" coords="251,12,421,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1117512e3b998a56f41b4457da37c416"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Decrease the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00132">132</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>.</p>

<p>Referenced by <a class="el" href="stream_8c_source.html#l00167">StreamMsgPoolFree()</a>, <a class="el" href="stream_8c_source.html#l00231">StreamMsgQueueFree()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00209">TcpSegmentPoolCleanup()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph" id="stream-tcp-reassemble_8c_a1117512e3b998a56f41b4457da37c416_icgraph">
<area shape="rect" id="node2" href="stream_8c.html#a38c2100a3b1c2756eb194d50f0bd49f7" title="StreamMsgPoolFree" alt="" coords="297,5,439,32"/><area shape="rect" id="node8" href="stream_8h.html#a8d388402dcec490c7dd52214d2ab69d7" title="Free a StreamMsgQueue. " alt="" coords="291,56,445,83"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7" title="clean up a tcp segment pool entry " alt="" coords="493,81,664,108"/><area shape="rect" id="node3" href="stream_8h.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="503,19,655,45"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="712,51,909,77"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="958,51,1135,77"/><area shape="rect" id="node6" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="1185,51,1327,77"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1376,51,1427,77"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3de7491805a4a77ffda933d5fbf566e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleDepthReached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if stream in pkt direction has depth reached </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>packet with <em>LOCKED</em> flow</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>stream has depth reached </td></tr>
    <tr><td class="paramname">0</td><td>stream does not have depth reached </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01744">1744</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00159">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>.</p>

</div>
</div>
<a class="anchor" id="aaa019dfbfe83315c6aab375311eecc36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFree </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00527">527</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="util-pool_8c_source.html#l00225">PoolFree()</a>, <a class="el" href="util-pool_8c_source.html#l00377">PoolPrintSaturation()</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, and <a class="el" href="stream_8c_source.html#l00189">StreamMsgQueuesDeinit()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00620">StreamTcpFreeConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_cgraph" id="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="456,24,531,51"/><area shape="rect" id="node3" href="group__utilpool.html#ga06f51c149934cd93fb01a00f0ca27930" title="PoolPrintSaturation" alt="" coords="257,24,391,51"/><area shape="rect" id="node4" href="stream_8c.html#a8ebeba661601431d6ce3160ed95e95de" title="StreamMsgQueuesDeinit" alt="" coords="240,75,408,102"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_icgraph" id="stream-tcp-reassemble_8c_aaa019dfbfe83315c6aab375311eecc36_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a60b89bf8f2df825d7c19b400c8e2e2e8" title="StreamTcpFreeConfig" alt="" coords="241,5,391,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="440,5,491,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a967e5a8d394fdac2878d63f01b9c87cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleFreeThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00586">586</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00055">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00617">AppLayerDestroyCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05141">StreamTcpThreadDeinit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph" id="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="301,96,485,123"/><area shape="rect" id="node3" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="533,67,736,93"/><area shape="rect" id="node7" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="538,118,731,159"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="785,5,994,46"/><area shape="rect" id="node6" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="789,71,989,97"/><area shape="rect" id="node5" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1043,12,1194,39"/><area shape="rect" id="node8" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="852,125,927,152"/><area shape="rect" id="node9" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1070,125,1167,152"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph" id="stream-tcp-reassemble_8c_a967e5a8d394fdac2878d63f01b9c87cc_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a108137f5e3fa9caa0aab96a14df9b1cc" title="StreamTcpThreadDeinit" alt="" coords="301,5,461,32"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="510,5,706,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="755,5,890,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="939,5,1037,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1283,5,1333,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1085,31,1235,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1eaa63aa69d838e0db8634ee3d011d67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">3406</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00485">Packet_::payload_len</a>, <a class="el" href="decode_8h_source.html#l01022">PKT_STREAM_ADD</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l01883">StreamTcpReassembleHandleSegmentHandleData()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l03387">StreamTcpReassembleHandleSegmentUpdateACK()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_cgraph" id="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_cgraph">
<area shape="rect" id="node2" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="1321,55,1471,81"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="502,207,717,233"/><area shape="rect" id="node30" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="253,374,453,415"/><area shape="rect" id="node39" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="253,141,453,182"/><area shape="rect" id="node4" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1048,207,1221,233"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="821,144,925,171"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="838,421,909,448"/><area shape="rect" id="node25" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1097,295,1172,321"/><area shape="rect" id="node28" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="766,472,981,499"/><area shape="rect" id="node5" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="1303,521,1489,562"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="1586,232,1793,259"/><area shape="rect" id="node8" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1321,447,1471,473"/><area shape="rect" id="node18" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1297,156,1495,183"/><area shape="rect" id="node19" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="1319,105,1473,132"/><area shape="rect" id="node23" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="1337,207,1455,233"/><area shape="rect" id="node17" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1555,283,1823,309"/><area shape="rect" id="node7" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1917,283,2067,309"/><area shape="rect" id="node9" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1607,485,1771,512"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1608,536,1771,563"/><area shape="rect" id="node13" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1602,587,1777,613"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="1897,587,2087,613"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1582,333,1797,360"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1597,688,1782,715"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1552,435,1827,461"/><area shape="rect" id="node10" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="1875,485,2109,512"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1592,131,1787,157"/><area shape="rect" id="node21" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="1906,131,2078,157"/><area shape="rect" id="node22" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="2158,123,2351,165"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="1096,421,1173,448"/><area shape="rect" id="node29" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1091,472,1178,499"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988" title="Function to get the segment of required length from the pool. " alt="" coords="530,381,689,408"/><area shape="rect" id="node33" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3" title="StreamTcpReassembleInsert\lSegment" alt="" coords="513,454,705,495"/><area shape="rect" id="node32" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="839,523,908,549"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="793,624,954,651"/><area shape="rect" id="node35" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="1029,675,1240,701"/><area shape="rect" id="node37" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="1029,624,1240,651"/><area shape="rect" id="node36" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="1289,675,1503,701"/><area shape="rect" id="node38" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="1289,624,1503,651"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_icgraph" id="stream-tcp-reassemble_8c_a1eaa63aa69d838e0db8634ee3d011d67_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="254,12,381,39"/><area shape="rect" id="node3" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="430,12,517,39"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="566,12,762,39"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="811,12,946,39"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="995,12,1093,39"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1339,12,1389,39"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1141,37,1291,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a75ed0e6a51ad7ee4418623e1db12fc8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegmentHandleData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a packets TCP data into the stream reassembly engine. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>good segment, as far as we checked. </td></tr>
    <tr><td class="paramname">-1</td><td>badness, reason to drop in inline mode</td></tr>
  </table>
  </dd>
</dl>
<p>If the retval is 0 the segment is inserted correctly, or overlap is handled, or it wasn't added because of reassembly depth. </p>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l01883">1883</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00511">Packet_::app_layer_events</a>, <a class="el" href="app-layer-events_8h_source.html#l00048">APPLAYER_PROTO_DETECTION_SKIPPED</a>, <a class="el" href="app-layer-events_8c_source.html#l00069">AppLayerDecoderEventsSetEventRaw()</a>, <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00059">TcpReassemblyThreadCtx_::counter_tcp_stream_depth</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00220">TcpSession_::data_first_seen_dir</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00061">TcpSegment_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="decode_8h_source.html#l00484">Packet_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="decode_8h_source.html#l00485">Packet_::payload_len</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00184">SEGMENTTCP_FLAG_APPLAYER_PROCESSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00182">SEGMENTTCP_FLAG_RAW_PROCESSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="decode-events_8h_source.html#l00209">STREAM_REASSEMBLY_NO_SEGMENT</a>, <a class="el" href="stream_8h_source.html#l00032">STREAM_TOCLIENT</a>, <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00146">STREAMTCP_FLAG_APP_LAYER_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00169">STREAMTCP_STREAM_FLAG_APPPROTO_DETECTION_SKIPPED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00159">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00171">STREAMTCP_STREAM_FLAG_NEW_RAW_DISABLED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03611">StreamTcpGetSegment()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00729">StreamTcpReassembleInsertSegment()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, and <a class="el" href="decode-tcp_8h_source.html#l00103">TCP_GET_SEQ</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">StreamTcpReassembleHandleSegment()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph" id="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_cgraph">
<area shape="rect" id="node2" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="256,5,443,46"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="564,71,639,97"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988" title="Function to get the segment of required length from the pool. " alt="" coords="270,121,429,148"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3" title="StreamTcpReassembleInsert\lSegment" alt="" coords="253,194,445,235"/><area shape="rect" id="node5" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="567,121,636,148"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="566,172,637,199"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="521,223,682,249"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="494,285,709,312"/><area shape="rect" id="node8" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="824,159,901,185"/><area shape="rect" id="node10" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="757,209,968,236"/><area shape="rect" id="node12" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="757,260,968,287"/><area shape="rect" id="node11" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="1017,209,1231,236"/><area shape="rect" id="node13" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="1017,260,1231,287"/><area shape="rect" id="node15" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="819,311,906,337"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph" id="stream-tcp-reassemble_8c_a75ed0e6a51ad7ee4418623e1db12fc8f_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="253,5,453,46"/><area shape="rect" id="node3" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="502,12,629,39"/><area shape="rect" id="node4" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="678,12,765,39"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="814,12,1010,39"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1059,12,1194,39"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1243,12,1341,39"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1587,12,1637,39"/><area shape="rect" id="node9" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1389,37,1539,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6b7f7667924193878624cfd69065b4a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleHandleSegmentUpdateACK </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update app layer and raw reassembly </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">r</td><td>0 on success, -1 on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03387">3387</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">StreamTcpReassembleHandleSegment()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_cgraph" id="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_cgraph">
<area shape="rect" id="node2" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="1032,108,1181,135"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="254,183,469,210"/><area shape="rect" id="node4" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="781,268,955,295"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="573,276,677,303"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="590,50,661,76"/><area shape="rect" id="node25" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="831,324,905,351"/><area shape="rect" id="node28" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="518,100,733,127"/><area shape="rect" id="node5" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="1013,261,1200,302"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="1003,378,1210,404"/><area shape="rect" id="node8" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1032,530,1181,556"/><area shape="rect" id="node18" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1007,159,1206,186"/><area shape="rect" id="node19" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="1030,327,1183,354"/><area shape="rect" id="node23" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="1047,210,1166,236"/><area shape="rect" id="node17" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1262,758,1530,784"/><area shape="rect" id="node7" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1623,327,1774,354"/><area shape="rect" id="node9" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1314,454,1478,480"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1315,504,1477,531"/><area shape="rect" id="node13" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1309,555,1483,582"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="1603,580,1794,607"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1289,403,1503,430"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1303,606,1489,632"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1259,707,1533,734"/><area shape="rect" id="node10" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="1581,454,1816,480"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1299,251,1493,278"/><area shape="rect" id="node21" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="1613,251,1785,278"/><area shape="rect" id="node22" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="1865,244,2058,285"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="829,50,907,76"/><area shape="rect" id="node29" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="825,100,911,127"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_icgraph" id="stream-tcp-reassemble_8c_a6b7f7667924193878624cfd69065b4a4_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="253,5,453,46"/><area shape="rect" id="node3" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="502,12,629,39"/><area shape="rect" id="node4" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="678,12,765,39"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="814,12,1010,39"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1059,12,1194,39"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1243,12,1341,39"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1587,12,1637,39"/><area shape="rect" id="node9" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1389,37,1539,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0450f1665ff06a11cb08777c78eba9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to Increment the memory usage counter for the TCP reassembly segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Size of the TCP segment and its payload length memory allocated </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00120">120</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>.</p>

<p>Referenced by <a class="el" href="stream_8c_source.html#l00137">StreamMsgPoolAlloc()</a>, <a class="el" href="stream_8c_source.html#l00212">StreamMsgQueueGetNew()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00175">TcpSegmentPoolInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph" id="stream-tcp-reassemble_8c_ae0450f1665ff06a11cb08777c78eba9b_icgraph">
<area shape="rect" id="node2" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="301,5,445,32"/><area shape="rect" id="node8" href="stream_8h.html#a0653021cbdad63e87b0a8590547c2521" title="alloc a stream msg queue " alt="" coords="286,56,461,83"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="515,81,655,108"/><area shape="rect" id="node3" href="stream_8h.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="509,19,661,45"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="709,51,907,77"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="955,51,1133,77"/><area shape="rect" id="node6" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="1182,51,1325,77"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1373,51,1424,77"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad1b178831cdeb029f02fd53f08f328cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleInit </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">505</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="counters_8c_source.html#l00911">StatsRegisterGlobalCounter()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00138">StreamTcpReassembleMemuseGlobalCounter()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">StreamTcpReassemblyConfig()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_cgraph" id="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#a6e153d15fc6ea022e954f38fd80fbc0a" title="Registers a counter, which represents a global value. " alt="" coords="245,180,430,206"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title="StreamTcpReassembleMemuse\lGlobalCounter" alt="" coords="233,231,442,272"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="239,297,436,324"/><area shape="rect" id="node5" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="969,120,1071,146"/><area shape="rect" id="node6" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1187,69,1341,96"/><area shape="rect" id="node8" href="util-byte_8c.html#a9cc0b7c198843ccaebe904f4653fb154" title="ByteExtractStringUint16" alt="" coords="495,221,657,248"/><area shape="rect" id="node10" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="495,272,657,298"/><area shape="rect" id="node11" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="748,309,815,336"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22" title="alloc a tcp segment pool entry " alt="" coords="501,373,651,400"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="711,512,851,538"/><area shape="rect" id="node17" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7" title="clean up a tcp segment pool entry " alt="" coords="491,576,661,602"/><area shape="rect" id="node19" href="stream_8c.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="500,424,652,450"/><area shape="rect" id="node23" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer. " alt="" coords="533,120,619,146"/><area shape="rect" id="node7" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1233,120,1295,146"/><area shape="rect" id="node9" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="719,246,844,273"/><area shape="rect" id="node12" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="983,309,1057,336"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="921,403,1119,444"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments. " alt="" coords="905,500,1135,526"/><area shape="rect" id="node18" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments. " alt="" coords="901,576,1139,602"/><area shape="rect" id="node20" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="709,410,853,437"/><area shape="rect" id="node21" href="stream_8c.html#ad6cd583c3811736afb335193f3e703c4" title="StreamMsgInit" alt="" coords="728,461,835,488"/><area shape="rect" id="node22" href="stream_8c.html#a38c2100a3b1c2756eb194d50f0bd49f7" title="StreamMsgPoolFree" alt="" coords="711,562,852,589"/><area shape="rect" id="node24" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="746,120,817,146"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_icgraph" id="stream-tcp-reassemble_8c_ad1b178831cdeb029f02fd53f08f328cf_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="233,5,375,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="424,5,475,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5dc1a2f2120af56ff09791171c822897"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a>* StreamTcpReassembleInitThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00572">572</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8h_source.html#l00055">TcpReassemblyThreadCtx_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00595">AppLayerGetCtxThread()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_cgraph" id="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="294,128,453,155"/><area shape="rect" id="node3" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="504,128,688,155"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="739,71,944,97"/><area shape="rect" id="node13" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="501,179,691,221"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="740,128,943,155"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="745,179,938,221"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="993,122,1202,163"/><area shape="rect" id="node7" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="997,71,1197,97"/><area shape="rect" id="node6" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1251,71,1402,97"/><area shape="rect" id="node9" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="1060,188,1135,215"/><area shape="rect" id="node10" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1278,188,1375,215"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a2b0517e26b65ae0299677d4f097b223f" title="AppLayerParserGetProtocol\lParserLocalStorage" alt="" coords="1005,5,1189,46"/><area shape="rect" id="node14" href="util-mpm_8c.html#aef0b59171845a87218792da6eb8cdfea" title="Setup a pmq. " alt="" coords="800,245,883,272"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_icgraph" id="stream-tcp-reassemble_8c_a5dc1a2f2120af56ff09791171c822897_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="293,5,437,32"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="486,5,682,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="731,5,866,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="915,5,1013,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1259,5,1309,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1061,31,1211,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a57183ba5a415fcc5c946937e68d610d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassembleInsertSegment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-reassemble_8h.html#afe5e152dc70b1982fb358298b566c223">TcpReassemblyThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>ra_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00729">729</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00068">TcpStream_::os_policy</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="decode_8h_source.html#l00485">Packet_::payload_len</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00059">TcpSegment_::prev</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00646">PrintList()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00082">TcpStream_::ra_app_base_seq</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00086">TcpStream_::seg_list_tail</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00198">SEQ_EQ</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00202">SEQ_GEQ</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00201">SEQ_GT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00200">SEQ_LEQ</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>, <a class="el" href="decode-events_8h_source.html#l00208">STREAM_REASSEMBLY_SEGMENT_BEFORE_BASE_SEQ</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">StreamTcpSegmentReturntoPool()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp_8c_source.html#l00709">StreamTcpSetOSPolicy()</a>, <a class="el" href="decode-tcp_8h_source.html#l00103">TCP_GET_SEQ</a>, and <a class="el" href="suricata-common_8h_source.html#l00033">TRUE</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l01883">StreamTcpReassembleHandleSegmentHandleData()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_cgraph" id="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="318,5,389,32"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="246,56,461,83"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="273,107,434,133"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="576,5,653,32"/><area shape="rect" id="node5" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="571,56,658,83"/><area shape="rect" id="node7" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="509,107,720,133"/><area shape="rect" id="node9" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="509,157,720,184"/><area shape="rect" id="node8" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="769,107,983,133"/><area shape="rect" id="node10" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="769,157,983,184"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_icgraph" id="stream-tcp-reassemble_8c_a57183ba5a415fcc5c946937e68d610d3_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="245,5,445,46"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="493,5,693,46"/><area shape="rect" id="node4" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="742,12,869,39"/><area shape="rect" id="node5" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="918,12,1005,39"/><area shape="rect" id="node6" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1054,12,1250,39"/><area shape="rect" id="node7" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1299,12,1434,39"/><area shape="rect" id="node8" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1483,12,1581,39"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1827,12,1877,39"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1629,37,1779,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a477c59db3b1fef12cb9b1e5e5de0f59f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StreamTcpReassembleMemuseGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00138">138</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph" id="stream-tcp-reassemble_8c_a477c59db3b1fef12cb9b1e5e5de0f59f_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="265,12,442,39"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="491,12,634,39"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="683,12,733,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3af046998a397130b34da08e7bae4bf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassemblePseudoPacketCreate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a4894f48885e4926013c260b03f68685f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Function Register the Unit tests to test the reassembly engine for various OS policies. </p>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l08689">8689</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-inline_8c_source.html#l00645">StreamTcpInlineRegisterTests()</a>, and <a class="el" href="stream-tcp-util_8c_source.html#l00256">StreamTcpUtilRegisterTests()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l10738">StreamTcpRegisterTests()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph" id="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_cgraph">
<area shape="rect" id="node2" href="stream-tcp-inline_8c.html#ad01a33c39b0309dd536c8cf89f6cf83a" title="StreamTcpInlineRegisterTests" alt="" coords="262,5,461,32"/><area shape="rect" id="node3" href="stream-tcp-util_8c.html#a44bf885919a659b8132eaa84aefee888" title="StreamTcpUtilRegisterTests" alt="" coords="267,56,455,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_icgraph" id="stream-tcp-reassemble_8c_a4894f48885e4926013c260b03f68685f_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a47042a286da78d0a3ddd510991b3efcf" title="StreamTcpRegisterTests" alt="" coords="261,12,429,39"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="478,12,674,39"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="723,12,858,39"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="907,12,1005,39"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1251,12,1301,39"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1053,37,1203,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ad968d775653b4144a7685016349ad8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleTriggerRawReassembly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a3a41bd53539e58984dc63f6f006bb58f">TcpSession</a> *&#160;</td>
          <td class="paramname"><em>ssn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger RAW stream reassembly. </p>
<p>Used by AppLayerTriggerRawStreamReassembly to trigger RAW stream reassembly from the applayer, for example upon completion of a HTTP request.</p>
<p>Works by setting a flag in the TcpSession that is unset as soon as it's checked. Since everything happens when operating under a single lock period, no side effects are expected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>TcpSession </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03662">3662</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00139">STREAMTCP_FLAG_TRIGGER_RAW_REASSEMBLY</a>.</p>

<p>Referenced by <a class="el" href="app-layer-parser_8c_source.html#l01063">AppLayerParserTriggerRawStreamReassembly()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a7ad968d775653b4144a7685016349ad8_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a7ad968d775653b4144a7685016349ad8_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a7ad968d775653b4144a7685016349ad8_icgraph" id="stream-tcp-reassemble_8c_a7ad968d775653b4144a7685016349ad8_icgraph">
<area shape="rect" id="node2" href="app-layer-parser_8h.html#abcfb600d8cd04c53882a64d73cfd2485" title="AppLayerParserTriggerRaw\lStreamReassembly" alt="" coords="254,5,437,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e2b5d05e1f2d5b39843319142e436f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpReassemblyConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">316</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-byte_8c_source.html#l00217">ByteExtractStringUint16()</a>, <a class="el" href="util-byte_8c_source.html#l00196">ByteExtractStringUint32()</a>, <a class="el" href="conf_8c_source.html#l00380">ConfGetInt()</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="conf_8c_source.html#l00721">ConfNodeLookupChild()</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00304">SegmentSizes_::pktsize</a>, <a class="el" href="util-pool_8c_source.html#l00084">PoolInit()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00305">SegmentSizes_::prealloc</a>, <a class="el" href="util-error_8h_source.html#l00075">SC_ERR_INITIALIZATION</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="util-error_8h_source.html#l00031">SC_ERR_MEM_ALLOC</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00055">SCMutex</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream_8c_source.html#l00175">StreamMsgQueuesInit()</a>, <a class="el" href="queue_8h_source.html#l00344">TAILQ_FOREACH</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">TcpSegmentPoolAlloc()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00209">TcpSegmentPoolCleanup()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00175">TcpSegmentPoolInit()</a>, <a class="el" href="conf_8h_source.html#l00034">ConfNode_::val</a>, and <a class="el" href="stream-tcp_8h_source.html#l00054">TcpStreamCnf_::zero_copy_size</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_cgraph" id="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_cgraph">
<area shape="rect" id="node2" href="util-byte_8c.html#a9cc0b7c198843ccaebe904f4653fb154" title="ByteExtractStringUint16" alt="" coords="255,5,417,32"/><area shape="rect" id="node4" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="255,56,417,83"/><area shape="rect" id="node5" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer. " alt="" coords="293,157,379,184"/><area shape="rect" id="node7" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="729,157,831,184"/><area shape="rect" id="node8" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="947,107,1101,133"/><area shape="rect" id="node10" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="508,259,575,285"/><area shape="rect" id="node12" href="stream_8c.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="260,360,412,387"/><area shape="rect" id="node19" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22" title="alloc a tcp segment pool entry " alt="" coords="261,436,411,463"/><area shape="rect" id="node20" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7" title="clean up a tcp segment pool entry " alt="" coords="251,537,421,564"/><area shape="rect" id="node21" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="471,309,611,336"/><area shape="rect" id="node3" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="479,31,604,57"/><area shape="rect" id="node6" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="506,157,577,184"/><area shape="rect" id="node9" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="993,157,1055,184"/><area shape="rect" id="node11" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="743,259,817,285"/><area shape="rect" id="node13" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="469,411,613,437"/><area shape="rect" id="node16" href="stream_8c.html#ad6cd583c3811736afb335193f3e703c4" title="StreamMsgInit" alt="" coords="488,360,595,387"/><area shape="rect" id="node17" href="stream_8c.html#a38c2100a3b1c2756eb194d50f0bd49f7" title="StreamMsgPoolFree" alt="" coords="471,461,612,488"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="681,403,879,445"/><area shape="rect" id="node15" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments. " alt="" coords="665,331,895,357"/><area shape="rect" id="node18" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments. " alt="" coords="661,516,899,543"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_icgraph" id="stream-tcp-reassemble_8c_a6e2b5d05e1f2d5b39843319142e436f0_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="251,5,429,32"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="478,5,621,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="669,5,720,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad9e5351fc6f108c2c429436b49c8ace3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReturnStreamSegments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return all segments in this stream into the pool(s) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stream</td><td>the stream to cleanup </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">262</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00086">TcpStream_::seg_list_tail</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">StreamTcpSegmentReturntoPool()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, <a class="el" href="stream-tcp_8c_source.html#l00250">StreamTcpSessionPktFree()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph" id="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="281,5,495,32"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="545,5,631,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph" id="stream-tcp-reassemble_8c_ad9e5351fc6f108c2c429436b49c8ace3_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="302,5,466,32"/><area shape="rect" id="node5" href="stream-tcp_8h.html#a48310db5e37bea30b769a8d6af0dbb80" title="Function to return the stream segments back to the pool. " alt="" coords="295,107,473,133"/><area shape="rect" id="node12" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="281,56,487,83"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="537,5,679,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1693,56,1744,83"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="545,107,671,133"/><area shape="rect" id="node7" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="757,107,843,133"/><area shape="rect" id="node8" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="921,81,1117,108"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1166,81,1301,108"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1349,81,1448,108"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1496,56,1645,83"/><area shape="rect" id="node13" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="728,56,872,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac92d234d9e9d670f018955030d4e19e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSegmentDataCopy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>dst_seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>src_seg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to copy the data from src_seg to dst_seg. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_seg</td><td>Destination segment for copying the contents </td></tr>
    <tr><td class="paramname">src_seg</td><td>Source segment to copy its contents</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000120">Todo:</a></b></dt><dd>VJ wouldn't a memcpy be more appropriate here?</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Both segments need to be properly initialized. </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03573">3573</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00201">SEQ_GT</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>.</p>

</div>
</div>
<a class="anchor" id="aedffcca13ecfb7e75dab25d34f155575"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSegmentDataReplace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>dst_seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>src_seg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>start_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to replace the data from a specific point up to given length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_seg</td><td>Destination segment to replace the data </td></tr>
    <tr><td class="paramname">src_seg</td><td>Source segment of which data is to be written to destination </td></tr>
    <tr><td class="paramname">start_point</td><td>Starting point to replace the data onwards </td></tr>
    <tr><td class="paramname">len</td><td>Length up to which data is need to be replaced</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000119">Todo:</a></b></dt><dd><p class="startdd">VJ We can remove the abort()s later. </p>
<p class="enddd">VJ Why not memcpy? </p>
</dd></dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l03471">3471</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8c_source.html#l00597">SCLogDebugEnabled()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00201">SEQ_GT</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aedffcca13ecfb7e75dab25d34f155575_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_aedffcca13ecfb7e75dab25d34f155575_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_aedffcca13ecfb7e75dab25d34f155575_cgraph" id="stream-tcp-reassemble_8c_aedffcca13ecfb7e75dab25d34f155575_cgraph">
<area shape="rect" id="node2" href="util-debug_8c.html#ab793aa1c0db8ab4c177d80f79c085297" title="Returns whether debug messages are enabled to be logged or not. " alt="" coords="269,5,416,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a11fcdabd0f9f4889f7b15cd098e28c00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSegmentReturntoPool </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a7babb2b0cd0b95ab0aea16de43f79fc5">TcpSegment</a> *&#160;</td>
          <td class="paramname"><em>seg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the segment back to the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seg</td><td>Segment which will be returned back to the pool. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00235">235</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00056">TcpSegment_::pool_size</a>, <a class="el" href="util-pool_8c_source.html#l00337">PoolReturn()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00059">TcpSegment_::prev</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, and <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l02473">StreamTcpPruneSession()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00729">StreamTcpReassembleInsertSegment()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph" id="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="270,5,357,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph" id="stream-tcp-reassemble_8c_a11fcdabd0f9f4889f7b15cd098e28c00_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8h.html#a4c545cb0ef123eb3b19064c380f75a17" title="Remove idle TcpSegments from TcpSession. " alt="" coords="294,536,461,563"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="270,768,485,795"/><area shape="rect" id="node42" href="stream-tcp-reassemble_8h.html#aff3c4ea45ef46a39eda09a7bda2150f6" title="StreamTcpReassembleInsert\lSegment" alt="" coords="281,849,473,890"/><area shape="rect" id="node44" href="stream-tcp_8c.html#a96d6fa8305eedd10a095558194edf776" title="return all segments in this stream into the pool(s) " alt="" coords="533,973,760,1000"/><area shape="rect" id="node3" href="tmqh-packetpool_8h.html#aecd391771695d5ca519b327487929be4" title="TmqhOutputPacketpool" alt="" coords="567,384,726,411"/><area shape="rect" id="node4" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="847,283,1003,309"/><area shape="rect" id="node12" href="flow-timeout_8h.html#a3daade4969e76aa8d9cb8dce83f7d07e" title="FlowForceReassemblyForFlow" alt="" coords="824,333,1027,360"/><area shape="rect" id="node13" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="886,435,965,461"/><area shape="rect" id="node15" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="857,384,993,411"/><area shape="rect" id="node16" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop. " alt="" coords="857,485,993,512"/><area shape="rect" id="node18" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="859,536,991,563"/><area shape="rect" id="node20" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="851,587,999,613"/><area shape="rect" id="node22" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="849,637,1001,664"/><area shape="rect" id="node24" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="860,688,991,715"/><area shape="rect" id="node26" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="859,17,991,44"/><area shape="rect" id="node28" href="tm-threads_8h.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="1129,80,1284,107"/><area shape="rect" id="node29" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="1377,131,1508,157"/><area shape="rect" id="node31" href="tmqh-packetpool_8h.html#a5bb62794ff6a8f547995c9128d5d8326" title="TmqhPacketpoolRegister . " alt="" coords="841,181,1010,208"/><area shape="rect" id="node33" href="tmqh-packetpool_8h.html#a9f4e9d711280d1e9d5a1e6abef1f0def" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="809,131,1042,157"/><area shape="rect" id="node5" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1159,333,1255,360"/><area shape="rect" id="node6" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1395,283,1491,309"/><area shape="rect" id="node11" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1153,384,1260,411"/><area shape="rect" id="node7" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1603,257,1719,284"/><area shape="rect" id="node9" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1611,308,1712,335"/><area shape="rect" id="node8" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1809,257,1911,284"/><area shape="rect" id="node10" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1614,207,1709,233"/><area shape="rect" id="node14" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="1145,435,1269,461"/><area shape="rect" id="node17" href="source-erf-file_8h.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module. " alt="" coords="1097,485,1316,512"/><area shape="rect" id="node19" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="1099,536,1314,563"/><area shape="rect" id="node21" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="1091,587,1322,613"/><area shape="rect" id="node23" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="1132,637,1281,664"/><area shape="rect" id="node25" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="1143,688,1271,715"/><area shape="rect" id="node27" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="1099,5,1314,32"/><area shape="rect" id="node30" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="1596,131,1727,157"/><area shape="rect" id="node32" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="1162,181,1251,208"/><area shape="rect" id="node35" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="560,688,733,715"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="547,790,747,831"/><area shape="rect" id="node38" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="825,850,1025,891"/><area shape="rect" id="node36" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="873,739,977,765"/><area shape="rect" id="node39" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1143,920,1270,947"/><area shape="rect" id="node40" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1399,920,1486,947"/><area shape="rect" id="node41" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1563,945,1759,972"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="547,907,747,949"/><area shape="rect" id="node45" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="843,1021,1007,1048"/><area shape="rect" id="node48" href="stream-tcp_8h.html#a48310db5e37bea30b769a8d6af0dbb80" title="Function to return the stream segments back to the pool. " alt="" coords="836,920,1015,947"/><area shape="rect" id="node49" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="822,971,1029,997"/><area shape="rect" id="node46" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="1135,1021,1278,1048"/><area shape="rect" id="node47" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1417,1021,1468,1048"/><area shape="rect" id="node50" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="1371,971,1515,997"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab4ebd7988b8a196ad81913e13f274c22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* TcpSegmentPoolAlloc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>alloc a tcp segment pool entry </p>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00161">161</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00152">StreamTcpReassembleCheckMemcap()</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">StreamTcpReassemblyConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_cgraph" id="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="205,5,403,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_icgraph" id="stream-tcp-reassemble_8c_ab4ebd7988b8a196ad81913e13f274c22_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="205,5,403,32"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="451,5,629,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="678,5,821,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="869,5,920,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a528a7185ada382fada458afd2fc961a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TcpSegmentPoolCleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>clean up a tcp segment pool entry </p>

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00209">209</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00056">TcpSegment_::pool_size</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00132">StreamTcpReassembleDecrMemuse()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">StreamTcpReassemblyConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_cgraph" id="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments. " alt="" coords="224,5,461,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_icgraph" id="stream-tcp-reassemble_8c_a528a7185ada382fada458afd2fc961a7_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="224,5,421,32"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="470,5,647,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="697,5,839,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="888,5,939,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa1fb22e94e9c6df8a77e06699f6e86ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TcpSegmentPoolInit </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>payload_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00175">175</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00056">TcpSegment_::pool_size</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00152">StreamTcpReassembleCheckMemcap()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00120">StreamTcpReassembleIncrMemuse()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">StreamTcpReassemblyConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_cgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_cgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_cgraph" id="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="212,5,409,46"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#ae0450f1665ff06a11cb08777c78eba9b" title="Function to Increment the memory usage counter for the TCP reassembly segments. " alt="" coords="195,71,426,97"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_icgraph.png" border="0" usemap="#stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_icgraph" alt=""/></div>
<map name="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_icgraph" id="stream-tcp-reassemble_8c_aa1fb22e94e9c6df8a77e06699f6e86ed_icgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="195,5,392,32"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="441,5,618,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="667,5,810,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="859,5,909,32"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp-reassemble_8c.html">stream-tcp-reassemble.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:10 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
