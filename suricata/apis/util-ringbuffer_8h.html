<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/util-ringbuffer.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util-ringbuffer_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util-ringbuffer.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="util-atomic_8h_source.html">util-atomic.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-ringbuffer.h:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h__incl.png" border="0" usemap="#src_2util-ringbuffer_8h" alt=""/></div>
<map name="src_2util-ringbuffer_8h" id="src_2util-ringbuffer_8h">
<area shape="rect" id="node2" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="5,80,99,107"/><area shape="rect" id="node3" href="threads_8h.html" title="threads.h" alt="" coords="123,80,199,107"/><area shape="rect" id="node4" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="73,155,148,181"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h__dep__incl.png" border="0" usemap="#src_2util-ringbuffer_8hdep" alt=""/></div>
<map name="src_2util-ringbuffer_8hdep" id="src_2util-ringbuffer_8hdep">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html" title="src/tmqh&#45;ringbuffer.c" alt="" coords="5,80,147,107"/><area shape="rect" id="node3" href="util-ringbuffer_8c.html" title="src/util&#45;ringbuffer.c" alt="" coords="172,80,303,107"/></map>
</div>
</div>
<p><a href="util-ringbuffer_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structRingBuffer8__.html">RingBuffer8_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structRingBuffer16__.html">RingBuffer16_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac256d72067a8a4465569dc2d4ea9396d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ac256d72067a8a4465569dc2d4ea9396d">RING_BUFFER_8_SIZE</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ac256d72067a8a4465569dc2d4ea9396d"><td class="mdescLeft">&#160;</td><td class="mdescRight">ring buffer api  <a href="#ac256d72067a8a4465569dc2d4ea9396d">More...</a><br/></td></tr>
<tr class="separator:ac256d72067a8a4465569dc2d4ea9396d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fd6263b6b40fb32ddd739a4a0a4a1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ac1fd6263b6b40fb32ddd739a4a0a4a1d">RING_BUFFER_16_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:ac1fd6263b6b40fb32ddd739a4a0a4a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abb2617232adbf8748251b048ebc04ae6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structRingBuffer8__.html">RingBuffer8_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a></td></tr>
<tr class="separator:abb2617232adbf8748251b048ebc04ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c225cf41c2c691ed53b953cca7824a6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structRingBuffer16__.html">RingBuffer16_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a></td></tr>
<tr class="separator:a6c225cf41c2c691ed53b953cca7824a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8c9bd0d2554bd97dd580928082c311d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a8c9bd0d2554bd97dd580928082c311d7">RingBuffer8Init</a> (void)</td></tr>
<tr class="separator:a8c9bd0d2554bd97dd580928082c311d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9663acf8aa32ff2f2fc2fbbc3481d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a1a9663acf8aa32ff2f2fc2fbbc3481d8">RingBuffer8Destroy</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="separator:a1a9663acf8aa32ff2f2fc2fbbc3481d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5486c1beda57f408df0e40d5b2a54d12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a5486c1beda57f408df0e40d5b2a54d12">RingBufferInit</a> (void)</td></tr>
<tr class="separator:a5486c1beda57f408df0e40d5b2a54d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6315eeaf2a093eb3f6b99a7e87f3eec6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a6315eeaf2a093eb3f6b99a7e87f3eec6">RingBufferDestroy</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="separator:a6315eeaf2a093eb3f6b99a7e87f3eec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e71693fae015d90d95c66e0dd2c8cdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a3e71693fae015d90d95c66e0dd2c8cdf">RingBufferIsEmpty</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:a3e71693fae015d90d95c66e0dd2c8cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is empty (no data in it)  <a href="#a3e71693fae015d90d95c66e0dd2c8cdf">More...</a><br/></td></tr>
<tr class="separator:a3e71693fae015d90d95c66e0dd2c8cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d526d53bb5f786659b301fa7ca8cad3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a6d526d53bb5f786659b301fa7ca8cad3">RingBufferIsFull</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:a6d526d53bb5f786659b301fa7ca8cad3"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is full (no more data will fit)  <a href="#a6d526d53bb5f786659b301fa7ca8cad3">More...</a><br/></td></tr>
<tr class="separator:a6d526d53bb5f786659b301fa7ca8cad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c51795ba64ead3d25009b49d6bb3e6e"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a1c51795ba64ead3d25009b49d6bb3e6e">RingBufferSize</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:a1c51795ba64ead3d25009b49d6bb3e6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get number of items in the ringbuffer  <a href="#a1c51795ba64ead3d25009b49d6bb3e6e">More...</a><br/></td></tr>
<tr class="separator:a1c51795ba64ead3d25009b49d6bb3e6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c4afe0634e81770c334754200c1c27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a12c4afe0634e81770c334754200c1c27">RingBuffer8Shutdown</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="memdesc:a12c4afe0634e81770c334754200c1c27"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell the ringbuffer to shut down  <a href="#a12c4afe0634e81770c334754200c1c27">More...</a><br/></td></tr>
<tr class="separator:a12c4afe0634e81770c334754200c1c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc829bc8809a568c7e14618ebb4e554"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#aecc829bc8809a568c7e14618ebb4e554">RingBufferShutdown</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:aecc829bc8809a568c7e14618ebb4e554"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell the ringbuffer to shut down  <a href="#aecc829bc8809a568c7e14618ebb4e554">More...</a><br/></td></tr>
<tr class="separator:aecc829bc8809a568c7e14618ebb4e554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2456a2930a748c56ea058ea435396b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ae2456a2930a748c56ea058ea435396b4">RingBufferWait</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:ae2456a2930a748c56ea058ea435396b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait function for condition where ringbuffer is either full or empty.  <a href="#ae2456a2930a748c56ea058ea435396b4">More...</a><br/></td></tr>
<tr class="separator:ae2456a2930a748c56ea058ea435396b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1535e9f8144965b0c51d641534394b0"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ac1535e9f8144965b0c51d641534394b0">RingBufferSrSw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="separator:ac1535e9f8144965b0c51d641534394b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf6ad8f63187f474c1489679a7a6f2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#aaaf6ad8f63187f474c1489679a7a6f2f">RingBufferSrSw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *, void *)</td></tr>
<tr class="separator:aaaf6ad8f63187f474c1489679a7a6f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7652221568976da45a0c6d5dd0d8bfc"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ad7652221568976da45a0c6d5dd0d8bfc">RingBufferMrSw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="memdesc:ad7652221568976da45a0c6d5dd0d8bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#ad7652221568976da45a0c6d5dd0d8bfc">More...</a><br/></td></tr>
<tr class="separator:ad7652221568976da45a0c6d5dd0d8bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2e2a392ff1a89b05a816bc476c452b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ab2e2a392ff1a89b05a816bc476c452b7">RingBufferMrSw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *, void *)</td></tr>
<tr class="memdesc:ab2e2a392ff1a89b05a816bc476c452b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer  <a href="#ab2e2a392ff1a89b05a816bc476c452b7">More...</a><br/></td></tr>
<tr class="separator:ab2e2a392ff1a89b05a816bc476c452b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af460c39d2391b2d7dee5f906b7086055"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#af460c39d2391b2d7dee5f906b7086055">RingBufferMrSwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:af460c39d2391b2d7dee5f906b7086055"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#af460c39d2391b2d7dee5f906b7086055">More...</a><br/></td></tr>
<tr class="separator:af460c39d2391b2d7dee5f906b7086055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c021be0928c7717e36c425e1300fb5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ad3c021be0928c7717e36c425e1300fb5">RingBufferMrSwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *, void *)</td></tr>
<tr class="memdesc:ad3c021be0928c7717e36c425e1300fb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer  <a href="#ad3c021be0928c7717e36c425e1300fb5">More...</a><br/></td></tr>
<tr class="separator:ad3c021be0928c7717e36c425e1300fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6eded690c8338ac99b92e8243b4ce78"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#af6eded690c8338ac99b92e8243b4ce78">RingBufferSrSwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="separator:af6eded690c8338ac99b92e8243b4ce78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2258368f79b84b7f5711c1eecd8291ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a2258368f79b84b7f5711c1eecd8291ed">RingBufferSrSwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *, void *)</td></tr>
<tr class="separator:a2258368f79b84b7f5711c1eecd8291ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc7fc13b881a21e3eebad21296744286"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#abc7fc13b881a21e3eebad21296744286">RingBufferMrMw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="memdesc:abc7fc13b881a21e3eebad21296744286"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#abc7fc13b881a21e3eebad21296744286">More...</a><br/></td></tr>
<tr class="separator:abc7fc13b881a21e3eebad21296744286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6840b2e457b6b7c862db9c17071b17b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#ad6840b2e457b6b7c862db9c17071b17b">RingBufferMrMw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *, void *)</td></tr>
<tr class="memdesc:ad6840b2e457b6b7c862db9c17071b17b"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#ad6840b2e457b6b7c862db9c17071b17b">More...</a><br/></td></tr>
<tr class="separator:ad6840b2e457b6b7c862db9c17071b17b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31495babec59fe020731f89d67730dfe"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a31495babec59fe020731f89d67730dfe">RingBufferMrMwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:a31495babec59fe020731f89d67730dfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#a31495babec59fe020731f89d67730dfe">More...</a><br/></td></tr>
<tr class="separator:a31495babec59fe020731f89d67730dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6054c86624715bac4ccee983a148be"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#aaa6054c86624715bac4ccee983a148be">RingBufferMrMwGetNoWait</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *)</td></tr>
<tr class="memdesc:aaa6054c86624715bac4ccee983a148be"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#aaa6054c86624715bac4ccee983a148be">More...</a><br/></td></tr>
<tr class="separator:aaa6054c86624715bac4ccee983a148be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a0af2a1033b6accdcbaeff77f43db7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a99a0af2a1033b6accdcbaeff77f43db7">RingBufferMrMwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *, void *)</td></tr>
<tr class="memdesc:a99a0af2a1033b6accdcbaeff77f43db7"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#a99a0af2a1033b6accdcbaeff77f43db7">More...</a><br/></td></tr>
<tr class="separator:a99a0af2a1033b6accdcbaeff77f43db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007816b992596a769b6fab19a2e100db"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a007816b992596a769b6fab19a2e100db">RingBufferSrMw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *)</td></tr>
<tr class="separator:a007816b992596a769b6fab19a2e100db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a891cb839cbbf9d62ea2407a38e0f1e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a8a891cb839cbbf9d62ea2407a38e0f1e">RingBufferSrMw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *, void *)</td></tr>
<tr class="memdesc:a8a891cb839cbbf9d62ea2407a38e0f1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#a8a891cb839cbbf9d62ea2407a38e0f1e">More...</a><br/></td></tr>
<tr class="separator:a8a891cb839cbbf9d62ea2407a38e0f1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bf84ba3dce3bd69c97f8634368b104"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8h.html#a93bf84ba3dce3bd69c97f8634368b104">DetectRingBufferRegisterTests</a> (void)</td></tr>
<tr class="separator:a93bf84ba3dce3bd69c97f8634368b104"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a></dd></dl>
<p>See the .c file for a full explanation. </p>

<p>Definition in file <a class="el" href="util-ringbuffer_8h_source.html">util-ringbuffer.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac1fd6263b6b40fb32ddd739a4a0a4a1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RING_BUFFER_16_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8h_source.html#l00066">66</a> of file <a class="el" href="util-ringbuffer_8h_source.html">util-ringbuffer.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac256d72067a8a4465569dc2d4ea9396d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RING_BUFFER_8_SIZE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ring buffer api </p>
<p>When the ringbuffer is full we have two options, either we spin &amp; sleep or we use a pthread condition to wait.</p>
<dl class="section warning"><dt>Warning</dt><dd>this approach isn't working due to a race condition between the time it takes for a thread to enter the condwait and the signalling. I've obverved the following case: T1 sees that the ringbuffer is empty, so it decides to start the wait condition. While it is acquiring the lock and entering the wait, T0 puts a number of items in the buffer. For each of these it signals T1. However, as that thread isn't in the "wait" mode yet, the signals are lost. T0 now is done as well and enters it's own wait condition. T1 completes it's "wait" initialization. It waits for signals, but T0 won't be able to send them as it's waiting itself.Ring buffer api for a single writer and a single reader. It uses a read and write pointer. Only the read ptr needs atomic updating. </dd></dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8h_source.html#l00053">53</a> of file <a class="el" href="util-ringbuffer_8h_source.html">util-ringbuffer.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a6c225cf41c2c691ed53b953cca7824a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structRingBuffer16__.html">RingBuffer16_</a>  <a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abb2617232adbf8748251b048ebc04ae6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structRingBuffer8__.html">RingBuffer8_</a>  <a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a93bf84ba3dce3bd69c97f8634368b104"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectRingBufferRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l01078">1078</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a93bf84ba3dce3bd69c97f8634368b104_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a93bf84ba3dce3bd69c97f8634368b104_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a93bf84ba3dce3bd69c97f8634368b104_icgraph" id="util-ringbuffer_8h_a93bf84ba3dce3bd69c97f8634368b104_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="227,12,325,39"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="571,12,621,39"/><area shape="rect" id="node4" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="373,37,523,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a9663acf8aa32ff2f2fc2fbbc3481d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBuffer8Destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00527">527</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00085">SCCondDestroy</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00102">SCSpinDestroy</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00079">TmqhRingBufferDestroy()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a1a9663acf8aa32ff2f2fc2fbbc3481d8_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a1a9663acf8aa32ff2f2fc2fbbc3481d8_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a1a9663acf8aa32ff2f2fc2fbbc3481d8_icgraph" id="util-ringbuffer_8h_a1a9663acf8aa32ff2f2fc2fbbc3481d8_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8h.html#a8d2b93c65a0c553709d38b1ee4d2722f" title="TmqhRingBufferDestroy" alt="" coords="192,5,355,32"/><area shape="rect" id="node3" href="tm-queuehandlers_8h.html#aea1d15fe6fe83327a9b6086ba3037e9c" title="Clean up registration time allocs. " alt="" coords="403,5,506,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="555,5,605,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c9bd0d2554bd97dd580928082c311d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a>* RingBuffer8Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00507">507</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00083">SCCondInit</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00101">SCSpinInit</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00050">TmqhRingBufferRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a8c9bd0d2554bd97dd580928082c311d7_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a8c9bd0d2554bd97dd580928082c311d7_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a8c9bd0d2554bd97dd580928082c311d7_icgraph" id="util-ringbuffer_8h_a8c9bd0d2554bd97dd580928082c311d7_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="163,5,330,32"/><area shape="rect" id="node3" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="379,5,469,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a12c4afe0634e81770c334754200c1c27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBuffer8Shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tell the ringbuffer to shut down </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00099">99</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00087">TmqhInputRingBufferShutdownHandler()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a12c4afe0634e81770c334754200c1c27_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a12c4afe0634e81770c334754200c1c27_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a12c4afe0634e81770c334754200c1c27_icgraph" id="util-ringbuffer_8h_a12c4afe0634e81770c334754200c1c27_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ad6a7a3e20a7c011fa09a6de58fed404e" title="TmqhInputRingBufferShutdown\lHandler" alt="" coords="203,5,407,46"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="457,12,623,39"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="673,12,762,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6315eeaf2a093eb3f6b99a7e87f3eec6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00664">664</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00085">SCCondDestroy</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00102">SCSpinDestroy</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="a5486c1beda57f408df0e40d5b2a54d12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a>* RingBufferInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00644">644</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00083">SCCondInit</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00101">SCSpinInit</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a3e71693fae015d90d95c66e0dd2c8cdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferIsEmpty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is empty (no data in it) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00166">166</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="a6d526d53bb5f786659b301fa7ca8cad3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferIsFull </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is full (no more data will fit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00182">182</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="abc7fc13b881a21e3eebad21296744286"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Multiple Reader, Multi Writer ring buffer, fixed at 256 items so we can use unsigned char's that just wrap around</p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00550">550</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ad6840b2e457b6b7c862db9c17071b17b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrMw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00606">606</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="a31495babec59fe020731f89d67730dfe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Multiple Reader, Multi Writer ring buffer, fixed at 65536 items so we can use unsigned char's that just wrap around</p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00688">688</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="aaa6054c86624715bac4ccee983a148be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMwGetNoWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another.</p>
<p>This version does NOT enter a wait if the buffer is empty loop.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>pointer to the data, or NULL if buffer is empty </td></tr>
  </table>
  </dd>
</dl>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00737">737</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

</div>
</div>
<a class="anchor" id="a99a0af2a1033b6accdcbaeff77f43db7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrMwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00791">791</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="ad7652221568976da45a0c6d5dd0d8bfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrSw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Multiple Reader, Single Writer ring buffer, fixed at 256 items so we can use unsigned char's that just wrap around</p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00322">322</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00101">TmqhInputRingBufferMrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_ad7652221568976da45a0c6d5dd0d8bfc_icgraph.png" border="0" usemap="#util-ringbuffer_8h_ad7652221568976da45a0c6d5dd0d8bfc_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_ad7652221568976da45a0c6d5dd0d8bfc_icgraph" id="util-ringbuffer_8h_ad7652221568976da45a0c6d5dd0d8bfc_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a6fe4bab27eee8c75189b83314cbdc8cf" title="TmqhInputRingBufferMrSw" alt="" coords="201,5,381,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="430,5,597,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="646,5,735,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab2e2a392ff1a89b05a816bc476c452b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrSw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00364">364</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00112">TmqhOutputRingBufferMrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_ab2e2a392ff1a89b05a816bc476c452b7_icgraph.png" border="0" usemap="#util-ringbuffer_8h_ab2e2a392ff1a89b05a816bc476c452b7_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_ab2e2a392ff1a89b05a816bc476c452b7_icgraph" id="util-ringbuffer_8h_ab2e2a392ff1a89b05a816bc476c452b7_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ab6ca8f2aedefe7a7fa698be4d43610ce" title="TmqhOutputRingBufferMrSw" alt="" coords="201,5,391,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="441,5,607,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="657,5,746,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af460c39d2391b2d7dee5f906b7086055"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrSwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Multiple Reader, Single Writer ring buffer, fixed at 65536 items so we can use unsigned shorts that just wrap around</p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00396">396</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ad3c021be0928c7717e36c425e1300fb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrSwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00438">438</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="aecc829bc8809a568c7e14618ebb4e554"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferShutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tell the ringbuffer to shut down </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00143">143</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="a1c51795ba64ead3d25009b49d6bb3e6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t RingBufferSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get number of items in the ringbuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00152">152</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, and <a class="el" href="util-debug_8h_source.html#l00314">SCReturnUInt</a>.</p>

</div>
</div>
<a class="anchor" id="a007816b992596a769b6fab19a2e100db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrMw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00237">237</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00135">TmqhInputRingBufferSrMw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a007816b992596a769b6fab19a2e100db_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a007816b992596a769b6fab19a2e100db_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a007816b992596a769b6fab19a2e100db_icgraph" id="util-ringbuffer_8h_a007816b992596a769b6fab19a2e100db_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a735eb7a691b851c1269451cd730c99aa" title="TmqhInputRingBufferSrMw" alt="" coords="201,5,381,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="430,5,597,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="646,5,735,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8a891cb839cbbf9d62ea2407a38e0f1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrMw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00277">277</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00146">TmqhOutputRingBufferSrMw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_a8a891cb839cbbf9d62ea2407a38e0f1e_icgraph.png" border="0" usemap="#util-ringbuffer_8h_a8a891cb839cbbf9d62ea2407a38e0f1e_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_a8a891cb839cbbf9d62ea2407a38e0f1e_icgraph" id="util-ringbuffer_8h_a8a891cb839cbbf9d62ea2407a38e0f1e_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a33f77a32b182057d677167fd85d933c8" title="TmqhOutputRingBufferSrMw" alt="" coords="201,5,391,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="441,5,607,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="657,5,746,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac1535e9f8144965b0c51d641534394b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrSw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Reader, Single Writer ring buffer, fixed at 256 items so we can use unsigned char's that just wrap around </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00193">193</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00118">TmqhInputRingBufferSrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_ac1535e9f8144965b0c51d641534394b0_icgraph.png" border="0" usemap="#util-ringbuffer_8h_ac1535e9f8144965b0c51d641534394b0_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_ac1535e9f8144965b0c51d641534394b0_icgraph" id="util-ringbuffer_8h_ac1535e9f8144965b0c51d641534394b0_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a60d8febb3e99562c399a9cfb747ca64f" title="TmqhInputRingBufferSrSw" alt="" coords="197,5,376,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="425,5,591,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="641,5,730,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaaf6ad8f63187f474c1489679a7a6f2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrSw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00215">215</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00129">TmqhOutputRingBufferSrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8h_aaaf6ad8f63187f474c1489679a7a6f2f_icgraph.png" border="0" usemap="#util-ringbuffer_8h_aaaf6ad8f63187f474c1489679a7a6f2f_icgraph" alt=""/></div>
<map name="util-ringbuffer_8h_aaaf6ad8f63187f474c1489679a7a6f2f_icgraph" id="util-ringbuffer_8h_aaaf6ad8f63187f474c1489679a7a6f2f_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ad470e0f4c1340113cc579f58dd25b95d" title="TmqhOutputRingBufferSrSw" alt="" coords="198,5,386,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="435,5,602,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="651,5,741,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af6eded690c8338ac99b92e8243b4ce78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrSwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Reader, Single Writer ring buffer, fixed at 65536 items so we can use unsigned shorts that just wrap around </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00463">463</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="a2258368f79b84b7f5711c1eecd8291ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrSwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00485">485</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ae2456a2930a748c56ea058ea435396b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wait function for condition where ringbuffer is either full or empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<p>Based on RINGBUFFER_MUTEX_WAIT define, we either sleep and spin or use thread condition to wait. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00090">90</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util-ringbuffer_8h.html">util-ringbuffer.h</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:17 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
