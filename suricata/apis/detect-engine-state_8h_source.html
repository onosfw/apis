<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/detect-engine-state.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('detect-engine-state_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">detect-engine-state.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="detect-engine-state_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* Copyright (C) 2007-2013 Open Information Security Foundation</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * You can copy, redistribute or modify this Program under the terms of</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * the GNU General Public License version 2 as published by the Free</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Software Foundation.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * version 2 along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * 02110-1301, USA.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * \ingroup sigstate</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * @{</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * \file</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * \brief Data structures and function prototypes for keeping</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *        state for the detection engine.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * \author Victor Julien &lt;victor@inliniac.net&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * \author Anoop Saldanha &lt;anoopsaldanha@gmail.com&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* On DeState and locking.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * The DeState is part of a flow, but it can&#39;t be protected by the flow lock.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * Reason is we need to lock the DeState data for an entire detection run,</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * as we&#39;re looping through on &quot;continued&quot; detection and rely on only a single</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * detection instance setting it up on first run. We can&#39;t keep the entire flow</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * locked during detection for performance reasons, it would slow us down too</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * much.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * So a new lock was introduced. The only part of the process where we need</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * the flow lock is obviously when we&#39;re getting/setting the de_state ptr from</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * to the flow.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifndef __DETECT_ENGINE_STATE_H__</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define __DETECT_ENGINE_STATE_H__</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#ae2fb17a70404a1b57468e31add8615c8">   51</a></span>&#160;<span class="preprocessor">#define DETECT_ENGINE_INSPECT_SIG_NO_MATCH 0</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a1dc3b1e0169ed9d419ee6a20868f7785">   52</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DETECT_ENGINE_INSPECT_SIG_MATCH 1</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#ac47cb2e3306fa8ace203e1e2c9433d05">   53</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DETECT_ENGINE_INSPECT_SIG_CANT_MATCH 2</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a4ce41eb06742fefaa8f39dd1401295f8">   54</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DETECT_ENGINE_INSPECT_SIG_CANT_MATCH_FILESTORE 3</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/** number of DeStateStoreItem&#39;s in one DeStateStore object */</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a24a8a41cd2bd7055087476cef3a35d10">   57</a></span>&#160;<span class="preprocessor">#define DE_STATE_CHUNK_SIZE             15</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/* per sig flags */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a44a27946e688ca85a7cadf132fa38a59">   60</a></span>&#160;<span class="preprocessor">#define DE_STATE_FLAG_URI_INSPECT         (1)</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a934133006e62f911f1388a35cf17da8b">   61</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HRUD_INSPECT        (1 &lt;&lt; 1)</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a39829fd3be19eee9b31075679536707a">   62</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HCBD_INSPECT        (1 &lt;&lt; 2)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#aa4a9832420fcfdf8c57a539b5d3682db">   63</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HSBD_INSPECT        (1 &lt;&lt; 3)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a9da2e766a11ce4782eecd19693534be8">   64</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HHD_INSPECT         (1 &lt;&lt; 4)</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#af2caa64b497e7ffcc9f33e05f5f36b53">   65</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HRHD_INSPECT        (1 &lt;&lt; 5)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a2830408bfceaa4c66d92459873a3fe46">   66</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HHHD_INSPECT        (1 &lt;&lt; 6)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#aaf5986bc8c5bebe8b55731d8f358f878">   67</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HRHHD_INSPECT       (1 &lt;&lt; 7)</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a6dd902ac5ec255e1c7539c1a15133251">   68</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HUAD_INSPECT        (1 &lt;&lt; 8)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a328e91981d34343574e7309fb9d8e13e">   69</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HMD_INSPECT         (1 &lt;&lt; 9)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a2b46e58cbe593b7ed92118da7f0b6a02">   70</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HCD_INSPECT         (1 &lt;&lt; 10)</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a858ace0a591da92b5a6550c4f4c9411e">   71</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HSMD_INSPECT        (1 &lt;&lt; 11)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#acdc858a39c1d50f0d0eb106dcf8967df">   72</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HSCD_INSPECT        (1 &lt;&lt; 12)</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#aea73ac38c0abde8fce0f12b2a332103a">   73</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_FILE_TC_INSPECT     (1 &lt;&lt; 13)</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#ac9d13f32da3cd05cc44814794dec503d">   74</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_FILE_TS_INSPECT     (1 &lt;&lt; 14)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#af07a641d5b5d762f2b3cb7e0701e3684">   75</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_FULL_INSPECT        (1 &lt;&lt; 15)</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a7ed7e8b9cc06e329f282022c05cd5123">   76</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_SIG_CANT_MATCH      (1 &lt;&lt; 16)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#aa83a62b09bfef0b63bd959b2e33c6a9a">   77</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_DNSQUERYNAME_INSPECT (1 &lt;&lt; 17)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a035a4a3fe91b1b42a06446a959600904">   78</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_APP_EVENT_INSPECT   (1 &lt;&lt; 18)</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#ad2e82529bb0662f36c1bb0e2b027c2d3">   79</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_MODBUS_INSPECT      (1 &lt;&lt; 19)</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a6c3216b4be64b0102d5a44b3856fad3f">   80</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_HRL_INSPECT         (1 &lt;&lt; 20)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a7de4b77ed814f164bcc92d963f2f302d">   81</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_FD_SMTP_INSPECT     (1 &lt;&lt; 21)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a7a2fe099164f4e3c0af023af4ae22ba4">   82</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_DNSREQUEST_INSPECT  (1 &lt;&lt; 22)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a18e72ad68a83a106bcb9d79fda2cc196">   83</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_DNSRESPONSE_INSPECT (1 &lt;&lt; 23)</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a9ecdaddb12a9f44e1ee1706706fcaa6d">   84</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_FLAG_TEMPLATE_BUFFER_INSPECT (1 &lt;&lt; 24)</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/* state flags */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a177b848e3bddcc92d90d6741ae3193c6">   87</a></span>&#160;<span class="preprocessor">#define DETECT_ENGINE_STATE_FLAG_FILE_STORE_DISABLED 0x0001</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a5f2e072fb04f99dd6c69dced3ca0fe3a">   88</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DETECT_ENGINE_STATE_FLAG_FILE_TC_NEW         0x0002</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a54bd9342de29ce835e63646c5076bc9c">   89</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DETECT_ENGINE_STATE_FLAG_FILE_TS_NEW         0x0004</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/* We have 2 possible state values to be used by ContinueDetection() while</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> * trying to figure if we have fresh state to install or not.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * For tx based alprotos, we don&#39;t need to indicate the below values on a</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * per sig basis, but for non-tx based alprotos we do, since we might have</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> * new alstate coming in, and some sigs might have already matchced in</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * de_state and ContinueDetection needs to inform the detection filter that</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * it no longer needs to inspect this sig, since ContinueDetection would</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * handle it.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * Wrt tx based alprotos, if we have a new tx available apart from the one</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * currently being inspected(and also added to de_state), we continue with</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * the HAS_NEW_STATE flag, while if we don&#39;t have a new tx, we set</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * NO_NEW_STATE, to avoid getting the sig reinspected for the already</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * inspected tx. */</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#a3a09f44f844748b04692d8137c8e493a">  106</a></span>&#160;<span class="preprocessor">#define DE_STATE_MATCH_HAS_NEW_STATE 0x00</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="detect-engine-state_8h.html#af49521d5b186a7ee1a5fbd479f1deeff">  107</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DE_STATE_MATCH_NO_NEW_STATE  0x80</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">/* TX BASED (inspect engines) */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structDeStateStoreItem__.html">  111</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDeStateStoreItem__.html">DeStateStoreItem_</a> {</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structDeStateStoreItem__.html#a8abe6ebe84913135230499addebe0a08">  112</a></span>&#160;    uint32_t <a class="code" href="structDeStateStoreItem__.html#a8abe6ebe84913135230499addebe0a08">flags</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structDeStateStoreItem__.html#a7fd61a636e81efabbabfea9eb92a366c">  113</a></span>&#160;    <a class="code" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> <a class="code" href="structDeStateStoreItem__.html#a7fd61a636e81efabbabfea9eb92a366c">sid</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;} <a class="code" href="detect-engine-state_8h.html#ad99f58c3edea5cbbd2f3c4eeaa9d68a7">DeStateStoreItem</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structDeStateStore__.html">  116</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDeStateStore__.html">DeStateStore_</a> {</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structDeStateStore__.html#ad42ee1f947bc972922d2126b72ce87d7">  117</a></span>&#160;    <a class="code" href="structDeStateStoreItem__.html">DeStateStoreItem</a> <a class="code" href="structDeStateStore__.html#ad42ee1f947bc972922d2126b72ce87d7">store</a>[<a class="code" href="detect-engine-state_8h.html#a24a8a41cd2bd7055087476cef3a35d10">DE_STATE_CHUNK_SIZE</a>];</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="structDeStateStore__.html#abdf151660f51abe493974da6022ed9a3">  118</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structDeStateStore__.html">DeStateStore_</a> *<a class="code" href="structDeStateStore__.html#abdf151660f51abe493974da6022ed9a3">next</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;} <a class="code" href="detect-engine-state_8h.html#ab65c0a51c0b89637771948495df93509">DeStateStore</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html">  121</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDetectEngineStateDirection__.html">DetectEngineStateDirection_</a> {</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html#a1086d9f1b96b76ce30e32414443c0b49">  122</a></span>&#160;    <a class="code" href="structDeStateStore__.html">DeStateStore</a> *<a class="code" href="structDetectEngineStateDirection__.html#a1086d9f1b96b76ce30e32414443c0b49">head</a>;</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html#aea0f4c8ac5af013ef4fac0f8d2f6befa">  123</a></span>&#160;    <a class="code" href="structDeStateStore__.html">DeStateStore</a> *<a class="code" href="structDetectEngineStateDirection__.html#aea0f4c8ac5af013ef4fac0f8d2f6befa">tail</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html#a2347a9b8424a2a9570223c4d1a44596f">  124</a></span>&#160;    <a class="code" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> <a class="code" href="structDetectEngineStateDirection__.html#a2347a9b8424a2a9570223c4d1a44596f">cnt</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html#ae782c3f68a631e3a6d85074051fffcc7">  125</a></span>&#160;    uint16_t <a class="code" href="structDetectEngineStateDirection__.html#ae782c3f68a631e3a6d85074051fffcc7">filestore_cnt</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirection__.html#a0be0273f783201e42f3e532ae0c83d7c">  126</a></span>&#160;    uint8_t <a class="code" href="structDetectEngineStateDirection__.html#a0be0273f783201e42f3e532ae0c83d7c">flags</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;} <a class="code" href="detect-engine-state_8h.html#ab88b9759c0103260ed39981158159a42">DetectEngineStateDirection</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structDetectEngineState__.html">  129</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDetectEngineState__.html">DetectEngineState_</a> {</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structDetectEngineState__.html#a92b6aedf3dbd56c7cebc3b0f9be27aa3">  130</a></span>&#160;    <a class="code" href="structDetectEngineStateDirection__.html">DetectEngineStateDirection</a> <a class="code" href="structDetectEngineState__.html#a92b6aedf3dbd56c7cebc3b0f9be27aa3">dir_state</a>[2];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;} <a class="code" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/* FLOW BASED (AMATCH) */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRule__.html">  135</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDeStateStoreFlowRule__.html">DeStateStoreFlowRule_</a> {</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRule__.html#af0ac001a729ce03a645571664d6e1a18">  136</a></span>&#160;    <a class="code" href="structSigMatch__.html">SigMatch</a> *<a class="code" href="structDeStateStoreFlowRule__.html#af0ac001a729ce03a645571664d6e1a18">nm</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRule__.html#a38f47ac4fc2e3add44d4ccc89e6ed1c8">  137</a></span>&#160;    uint32_t <a class="code" href="structDeStateStoreFlowRule__.html#a38f47ac4fc2e3add44d4ccc89e6ed1c8">flags</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRule__.html#afc14499597cc3d81f06b1d799ffe31e6">  138</a></span>&#160;    <a class="code" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> <a class="code" href="structDeStateStoreFlowRule__.html#afc14499597cc3d81f06b1d799ffe31e6">sid</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;} <a class="code" href="detect-engine-state_8h.html#a906c801123599cc0c6b57c6161f04ce9">DeStateStoreFlowRule</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRules__.html">  141</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDeStateStoreFlowRules__.html">DeStateStoreFlowRules_</a> {</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRules__.html#a40baf9c98c150122c76dbbc57a179313">  142</a></span>&#160;    <a class="code" href="structDeStateStoreFlowRule__.html">DeStateStoreFlowRule</a> <a class="code" href="structDeStateStoreFlowRules__.html#a40baf9c98c150122c76dbbc57a179313">store</a>[<a class="code" href="detect-engine-state_8h.html#a24a8a41cd2bd7055087476cef3a35d10">DE_STATE_CHUNK_SIZE</a>];</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structDeStateStoreFlowRules__.html#a202b6bcdb4712dff4eff09b88101cc8b">  143</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structDeStateStoreFlowRules__.html">DeStateStoreFlowRules_</a> *<a class="code" href="structDeStateStoreFlowRules__.html#a202b6bcdb4712dff4eff09b88101cc8b">next</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;} <a class="code" href="detect-engine-state_8h.html#a501acaf61b460ac720d22241c221abc3">DeStateStoreFlowRules</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirectionFlow__.html">  146</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDetectEngineStateDirectionFlow__.html">DetectEngineStateDirectionFlow_</a> {</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirectionFlow__.html#a958705fa45cd888da56959782671324c">  147</a></span>&#160;    <a class="code" href="structDeStateStoreFlowRules__.html">DeStateStoreFlowRules</a> *<a class="code" href="structDetectEngineStateDirectionFlow__.html#a958705fa45cd888da56959782671324c">head</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirectionFlow__.html#a6a71f41eee76835fe65cbfb28bceb3fb">  148</a></span>&#160;    <a class="code" href="structDeStateStoreFlowRules__.html">DeStateStoreFlowRules</a> *<a class="code" href="structDetectEngineStateDirectionFlow__.html#a6a71f41eee76835fe65cbfb28bceb3fb">tail</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirectionFlow__.html#ad722aa48978a7c4d10f1ce4ad7dd4180">  149</a></span>&#160;    <a class="code" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> <a class="code" href="structDetectEngineStateDirectionFlow__.html#ad722aa48978a7c4d10f1ce4ad7dd4180">cnt</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structDetectEngineStateDirectionFlow__.html#a8bcb0d93c642d88a231c41aeb5ace56e">  150</a></span>&#160;    uint8_t <a class="code" href="structDetectEngineStateDirectionFlow__.html#a8bcb0d93c642d88a231c41aeb5ace56e">flags</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;} <a class="code" href="detect-engine-state_8h.html#aa4061e7270f08d98f773b21c27ddaad0">DetectEngineStateDirectionFlow</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="structDetectEngineStateFlow__.html">  153</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structDetectEngineStateFlow__.html">DetectEngineStateFlow_</a> {</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="structDetectEngineStateFlow__.html#a2c82fb9063d6b5e4205ac20bfc14f714">  154</a></span>&#160;    <a class="code" href="structDetectEngineStateDirectionFlow__.html">DetectEngineStateDirectionFlow</a> <a class="code" href="structDetectEngineStateFlow__.html#a2c82fb9063d6b5e4205ac20bfc14f714">dir_state</a>[2];</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;} <a class="code" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * \brief Alloc a DetectEngineState object.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * \retval Alloc&#39;d instance of DetectEngineState.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<a class="code" href="structDetectEngineState__.html">DetectEngineState</a> *<a class="code" href="group__sigstate.html#gada8ed9c30b08c405c5359cdfbe5815bb">DetectEngineStateAlloc</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * \brief Frees a DetectEngineState object.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * \param state DetectEngineState instance to free.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gad6fe68f13b5ffdcb71abd7c92676813d">DetectEngineStateFree</a>(<a class="code" href="structDetectEngineState__.html">DetectEngineState</a> *state);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">DetectEngineStateFlowFree</a>(<a class="code" href="structDetectEngineStateFlow__.html">DetectEngineStateFlow</a> *state);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> * \brief Check if a flow already contains(newly updated as well) de state.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> * \param f Pointer to the flow.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * \param alversino The alversion to check against de_state&#39;s.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * \param direction Direction to check.  0 - ts, 1 - tc.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> * \retval 1 Has state.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * \retval 0 Has no state.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__sigstate.html#gad37bfa7d57fcfc7c457a1028c0da4f80">DeStateFlowHasInspectableState</a>(<a class="code" href="structFlow__.html">Flow</a> *f, <a class="code" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, uint8_t alversion, uint8_t <a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * \brief Match app layer sig list against app state and store relevant match</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> *        information.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> * \param tv Pointer to the threadvars.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * \param de_ctx DetectEngineCtx instance.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> * \param det_ctx DetectEngineThreadCtx instance.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> * \param s Pointer to the signature.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * \param f Pointer to the flow.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * \param flags Flags.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * \param alproto App protocol.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> * \param alversion Current app layer version.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> * \retval &gt;= 0 An integer value indicating the no of matches.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keywordtype">int</span> <a class="code" href="group__sigstate.html#ga4cd5aba6758fd5795f477973b5f2fdfb">DeStateDetectStartDetection</a>(<a class="code" href="structThreadVars__.html">ThreadVars</a> *tv, <a class="code" href="structDetectEngineCtx__.html">DetectEngineCtx</a> *de_ctx,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                <a class="code" href="structDetectEngineThreadCtx__.html">DetectEngineThreadCtx</a> *det_ctx,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                <a class="code" href="structSignature__.html">Signature</a> *s, <a class="code" href="structPacket__.html">Packet</a> *p, <a class="code" href="structFlow__.html">Flow</a> *f, uint8_t <a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a>,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                <a class="code" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, uint8_t alversion);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> * \brief Continue DeState detection of the signatures stored in the state.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> * \param tv Pointer to the threadvars.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * \param de_ctx DetectEngineCtx instance.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * \param det_ctx DetectEngineThreadCtx instance.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * \param f Pointer to the flow.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * \param flags Flags.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * \param alproto App protocol.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> * \param alversion Current app layer version.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gaaea2ddcec2d9f3549aea0de468834039">DeStateDetectContinueDetection</a>(<a class="code" href="structThreadVars__.html">ThreadVars</a> *tv, <a class="code" href="structDetectEngineCtx__.html">DetectEngineCtx</a> *de_ctx,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                    <a class="code" href="structDetectEngineThreadCtx__.html">DetectEngineThreadCtx</a> *det_ctx,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                    <a class="code" href="structPacket__.html">Packet</a> *p, <a class="code" href="structFlow__.html">Flow</a> *f, uint8_t <a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                    <a class="code" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, uint8_t alversion);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> *  \brief Update the inspect id.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> *  \param f unlocked flow</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"> *  \param flags direction and disruption flags</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gad76e9cb6462b7784633d17b1347f771b">DeStateUpdateInspectTransactionId</a>(<a class="code" href="structFlow__.html">Flow</a> *f, <span class="keyword">const</span> uint8_t <a class="code" href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"> * \brief Reset a DetectEngineState state.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> * \param state     Pointer to the state(LOCKED).</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> * \param direction Direction flags - STREAM_TOSERVER or STREAM_TOCLIENT.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gae49e923c7e86601c4a96caf9ab2d4f24">DetectEngineStateReset</a>(<a class="code" href="structDetectEngineStateFlow__.html">DetectEngineStateFlow</a> *state, uint8_t direction);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#gabf15c37dbdf92918d6f107087ff082fb">DetectEngineStateResetTxs</a>(<a class="code" href="structFlow__.html">Flow</a> *f);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__sigstate.html#ga205034ae2733eb44d2ae6630026a34f6">DeStateRegisterTests</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* __DETECT_ENGINE_STATE_H__ */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> * @}</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> */</span></div>
<div class="ttc" id="structDetectEngineStateDirection___html_aea0f4c8ac5af013ef4fac0f8d2f6befa"><div class="ttname"><a href="structDetectEngineStateDirection__.html#aea0f4c8ac5af013ef4fac0f8d2f6befa">DetectEngineStateDirection_::tail</a></div><div class="ttdeci">DeStateStore * tail</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00123">detect-engine-state.h:123</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_a2814c2034561cbc8de035a12e19b732e"><div class="ttname"><a href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a></div><div class="ttdeci">struct DetectEngineStateFlow_ DetectEngineStateFlow</div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="app-layer-dns-common_8h.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00039">app-layer-dns-common.h:39</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRule___html"><div class="ttname"><a href="structDeStateStoreFlowRule__.html">DeStateStoreFlowRule_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00135">detect-engine-state.h:135</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRule___html_af0ac001a729ce03a645571664d6e1a18"><div class="ttname"><a href="structDeStateStoreFlowRule__.html#af0ac001a729ce03a645571664d6e1a18">DeStateStoreFlowRule_::nm</a></div><div class="ttdeci">SigMatch * nm</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00136">detect-engine-state.h:136</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRules___html_a202b6bcdb4712dff4eff09b88101cc8b"><div class="ttname"><a href="structDeStateStoreFlowRules__.html#a202b6bcdb4712dff4eff09b88101cc8b">DeStateStoreFlowRules_::next</a></div><div class="ttdeci">struct DeStateStoreFlowRules_ * next</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00143">detect-engine-state.h:143</a></div></div>
<div class="ttc" id="structDetectEngineStateDirectionFlow___html_a6a71f41eee76835fe65cbfb28bceb3fb"><div class="ttname"><a href="structDetectEngineStateDirectionFlow__.html#a6a71f41eee76835fe65cbfb28bceb3fb">DetectEngineStateDirectionFlow_::tail</a></div><div class="ttdeci">DeStateStoreFlowRules * tail</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00148">detect-engine-state.h:148</a></div></div>
<div class="ttc" id="group__sigstate_html_gad37bfa7d57fcfc7c457a1028c0da4f80"><div class="ttname"><a href="group__sigstate.html#gad37bfa7d57fcfc7c457a1028c0da4f80">DeStateFlowHasInspectableState</a></div><div class="ttdeci">int DeStateFlowHasInspectableState(Flow *f, AppProto alproto, const uint8_t alversion, uint8_t flags)</div><div class="ttdoc">Check if we need to inspect this state. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00376">detect-engine-state.c:376</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_aa4061e7270f08d98f773b21c27ddaad0"><div class="ttname"><a href="detect-engine-state_8h.html#aa4061e7270f08d98f773b21c27ddaad0">DetectEngineStateDirectionFlow</a></div><div class="ttdeci">struct DetectEngineStateDirectionFlow_ DetectEngineStateDirectionFlow</div></div>
<div class="ttc" id="structDeStateStoreFlowRule___html_afc14499597cc3d81f06b1d799ffe31e6"><div class="ttname"><a href="structDeStateStoreFlowRule__.html#afc14499597cc3d81f06b1d799ffe31e6">DeStateStoreFlowRule_::sid</a></div><div class="ttdeci">SigIntId sid</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00138">detect-engine-state.h:138</a></div></div>
<div class="ttc" id="group__sigstate_html_gacfef8e2bcb55dc6ec2788c418dc4a7d6"><div class="ttname"><a href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">DetectEngineStateFlowFree</a></div><div class="ttdeci">void DetectEngineStateFlowFree(DetectEngineStateFlow *state)</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00305">detect-engine-state.c:305</a></div></div>
<div class="ttc" id="structDetectEngineStateDirection___html_a2347a9b8424a2a9570223c4d1a44596f"><div class="ttname"><a href="structDetectEngineStateDirection__.html#a2347a9b8424a2a9570223c4d1a44596f">DetectEngineStateDirection_::cnt</a></div><div class="ttdeci">SigIntId cnt</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00124">detect-engine-state.h:124</a></div></div>
<div class="ttc" id="group__sigstate_html_gaaea2ddcec2d9f3549aea0de468834039"><div class="ttname"><a href="group__sigstate.html#gaaea2ddcec2d9f3549aea0de468834039">DeStateDetectContinueDetection</a></div><div class="ttdeci">void DeStateDetectContinueDetection(ThreadVars *tv, DetectEngineCtx *de_ctx, DetectEngineThreadCtx *det_ctx, Packet *p, Flow *f, uint8_t flags, AppProto alproto, const uint8_t alversion)</div><div class="ttdoc">Continue DeState detection of the signatures stored in the state. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00979">detect-engine-state.c:979</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_a906c801123599cc0c6b57c6161f04ce9"><div class="ttname"><a href="detect-engine-state_8h.html#a906c801123599cc0c6b57c6161f04ce9">DeStateStoreFlowRule</a></div><div class="ttdeci">struct DeStateStoreFlowRule_ DeStateStoreFlowRule</div></div>
<div class="ttc" id="structDetectEngineStateFlow___html"><div class="ttname"><a href="structDetectEngineStateFlow__.html">DetectEngineStateFlow_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00153">detect-engine-state.h:153</a></div></div>
<div class="ttc" id="structDetectEngineState___html_a92b6aedf3dbd56c7cebc3b0f9be27aa3"><div class="ttname"><a href="structDetectEngineState__.html#a92b6aedf3dbd56c7cebc3b0f9be27aa3">DetectEngineState_::dir_state</a></div><div class="ttdeci">DetectEngineStateDirection dir_state[2]</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00130">detect-engine-state.h:130</a></div></div>
<div class="ttc" id="group__sigstate_html_gad76e9cb6462b7784633d17b1347f771b"><div class="ttname"><a href="group__sigstate.html#gad76e9cb6462b7784633d17b1347f771b">DeStateUpdateInspectTransactionId</a></div><div class="ttdeci">void DeStateUpdateInspectTransactionId(Flow *f, const uint8_t flags)</div><div class="ttdoc">update flow&amp;#39;s inspection id&amp;#39;s </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l01103">detect-engine-state.c:1103</a></div></div>
<div class="ttc" id="structDetectEngineStateDirection___html"><div class="ttname"><a href="structDetectEngineStateDirection__.html">DetectEngineStateDirection_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00121">detect-engine-state.h:121</a></div></div>
<div class="ttc" id="structDeStateStoreItem___html_a8abe6ebe84913135230499addebe0a08"><div class="ttname"><a href="structDeStateStoreItem__.html#a8abe6ebe84913135230499addebe0a08">DeStateStoreItem_::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00112">detect-engine-state.h:112</a></div></div>
<div class="ttc" id="group__sigstate_html_gae49e923c7e86601c4a96caf9ab2d4f24"><div class="ttname"><a href="group__sigstate.html#gae49e923c7e86601c4a96caf9ab2d4f24">DetectEngineStateReset</a></div><div class="ttdeci">void DetectEngineStateReset(DetectEngineStateFlow *state, uint8_t direction)</div><div class="ttdoc">Reset a DetectEngineState state. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l01115">detect-engine-state.c:1115</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_ab65c0a51c0b89637771948495df93509"><div class="ttname"><a href="detect-engine-state_8h.html#ab65c0a51c0b89637771948495df93509">DeStateStore</a></div><div class="ttdeci">struct DeStateStore_ DeStateStore</div></div>
<div class="ttc" id="structDetectEngineStateDirectionFlow___html"><div class="ttname"><a href="structDetectEngineStateDirectionFlow__.html">DetectEngineStateDirectionFlow_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00146">detect-engine-state.h:146</a></div></div>
<div class="ttc" id="app-layer-protos_8h_html_a043448cc6c2d329e578b260150bc5bd0"><div class="ttname"><a href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a></div><div class="ttdeci">uint16_t AppProto</div><div class="ttdef"><b>Definition:</b> <a href="app-layer-protos_8h_source.html#l00058">app-layer-protos.h:58</a></div></div>
<div class="ttc" id="structDeStateStoreItem___html"><div class="ttname"><a href="structDeStateStoreItem__.html">DeStateStoreItem_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00111">detect-engine-state.h:111</a></div></div>
<div class="ttc" id="structSignature___html"><div class="ttname"><a href="structSignature__.html">Signature_</a></div><div class="ttdoc">Signature container. </div><div class="ttdef"><b>Definition:</b> <a href="detect_8h_source.html#l00371">detect.h:371</a></div></div>
<div class="ttc" id="structDetectEngineStateDirectionFlow___html_a8bcb0d93c642d88a231c41aeb5ace56e"><div class="ttname"><a href="structDetectEngineStateDirectionFlow__.html#a8bcb0d93c642d88a231c41aeb5ace56e">DetectEngineStateDirectionFlow_::flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00150">detect-engine-state.h:150</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRules___html_a40baf9c98c150122c76dbbc57a179313"><div class="ttname"><a href="structDeStateStoreFlowRules__.html#a40baf9c98c150122c76dbbc57a179313">DeStateStoreFlowRules_::store</a></div><div class="ttdeci">DeStateStoreFlowRule store[DE_STATE_CHUNK_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00142">detect-engine-state.h:142</a></div></div>
<div class="ttc" id="structDeStateStore___html_abdf151660f51abe493974da6022ed9a3"><div class="ttname"><a href="structDeStateStore__.html#abdf151660f51abe493974da6022ed9a3">DeStateStore_::next</a></div><div class="ttdeci">struct DeStateStore_ * next</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00118">detect-engine-state.h:118</a></div></div>
<div class="ttc" id="structDetectEngineCtx___html"><div class="ttname"><a href="structDetectEngineCtx__.html">DetectEngineCtx_</a></div><div class="ttdoc">main detection engine ctx </div><div class="ttdef"><b>Definition:</b> <a href="detect_8h_source.html#l00560">detect.h:560</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_ad99f58c3edea5cbbd2f3c4eeaa9d68a7"><div class="ttname"><a href="detect-engine-state_8h.html#ad99f58c3edea5cbbd2f3c4eeaa9d68a7">DeStateStoreItem</a></div><div class="ttdeci">struct DeStateStoreItem_ DeStateStoreItem</div></div>
<div class="ttc" id="structDetectEngineStateDirection___html_a1086d9f1b96b76ce30e32414443c0b49"><div class="ttname"><a href="structDetectEngineStateDirection__.html#a1086d9f1b96b76ce30e32414443c0b49">DetectEngineStateDirection_::head</a></div><div class="ttdeci">DeStateStore * head</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00122">detect-engine-state.h:122</a></div></div>
<div class="ttc" id="structDetectEngineStateDirectionFlow___html_ad722aa48978a7c4d10f1ce4ad7dd4180"><div class="ttname"><a href="structDetectEngineStateDirectionFlow__.html#ad722aa48978a7c4d10f1ce4ad7dd4180">DetectEngineStateDirectionFlow_::cnt</a></div><div class="ttdeci">SigIntId cnt</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00149">detect-engine-state.h:149</a></div></div>
<div class="ttc" id="group__sigstate_html_gad6fe68f13b5ffdcb71abd7c92676813d"><div class="ttname"><a href="group__sigstate.html#gad6fe68f13b5ffdcb71abd7c92676813d">DetectEngineStateFree</a></div><div class="ttdeci">void DetectEngineStateFree(DetectEngineState *state)</div><div class="ttdoc">Frees a DetectEngineState object. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00286">detect-engine-state.c:286</a></div></div>
<div class="ttc" id="structDeStateStore___html"><div class="ttname"><a href="structDeStateStore__.html">DeStateStore_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00116">detect-engine-state.h:116</a></div></div>
<div class="ttc" id="group__sigstate_html_gada8ed9c30b08c405c5359cdfbe5815bb"><div class="ttname"><a href="group__sigstate.html#gada8ed9c30b08c405c5359cdfbe5815bb">DetectEngineStateAlloc</a></div><div class="ttdeci">DetectEngineState * DetectEngineStateAlloc(void)</div><div class="ttdoc">Alloc a DetectEngineState object. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00266">detect-engine-state.c:266</a></div></div>
<div class="ttc" id="structPacket___html"><div class="ttname"><a href="structPacket__.html">Packet_</a></div><div class="ttdef"><b>Definition:</b> <a href="decode_8h_source.html#l00370">decode.h:370</a></div></div>
<div class="ttc" id="group__sigstate_html_gabf15c37dbdf92918d6f107087ff082fb"><div class="ttname"><a href="group__sigstate.html#gabf15c37dbdf92918d6f107087ff082fb">DetectEngineStateResetTxs</a></div><div class="ttdeci">void DetectEngineStateResetTxs(Flow *f)</div><div class="ttdoc">Reset de state for active tx&amp;#39; To be used on detect engine reload. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l01135">detect-engine-state.c:1135</a></div></div>
<div class="ttc" id="structDeStateStore___html_ad42ee1f947bc972922d2126b72ce87d7"><div class="ttname"><a href="structDeStateStore__.html#ad42ee1f947bc972922d2126b72ce87d7">DeStateStore_::store</a></div><div class="ttdeci">DeStateStoreItem store[DE_STATE_CHUNK_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00117">detect-engine-state.h:117</a></div></div>
<div class="ttc" id="structDetectEngineStateDirectionFlow___html_a958705fa45cd888da56959782671324c"><div class="ttname"><a href="structDetectEngineStateDirectionFlow__.html#a958705fa45cd888da56959782671324c">DetectEngineStateDirectionFlow_::head</a></div><div class="ttdeci">DeStateStoreFlowRules * head</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00147">detect-engine-state.h:147</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_a501acaf61b460ac720d22241c221abc3"><div class="ttname"><a href="detect-engine-state_8h.html#a501acaf61b460ac720d22241c221abc3">DeStateStoreFlowRules</a></div><div class="ttdeci">struct DeStateStoreFlowRules_ DeStateStoreFlowRules</div></div>
<div class="ttc" id="structDeStateStoreItem___html_a7fd61a636e81efabbabfea9eb92a366c"><div class="ttname"><a href="structDeStateStoreItem__.html#a7fd61a636e81efabbabfea9eb92a366c">DeStateStoreItem_::sid</a></div><div class="ttdeci">SigIntId sid</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00113">detect-engine-state.h:113</a></div></div>
<div class="ttc" id="structDetectEngineState___html"><div class="ttname"><a href="structDetectEngineState__.html">DetectEngineState_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00129">detect-engine-state.h:129</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRule___html_a38f47ac4fc2e3add44d4ccc89e6ed1c8"><div class="ttname"><a href="structDeStateStoreFlowRule__.html#a38f47ac4fc2e3add44d4ccc89e6ed1c8">DeStateStoreFlowRule_::flags</a></div><div class="ttdeci">uint32_t flags</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00137">detect-engine-state.h:137</a></div></div>
<div class="ttc" id="structDeStateStoreFlowRules___html"><div class="ttname"><a href="structDeStateStoreFlowRules__.html">DeStateStoreFlowRules_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00141">detect-engine-state.h:141</a></div></div>
<div class="ttc" id="group__sigstate_html_ga4cd5aba6758fd5795f477973b5f2fdfb"><div class="ttname"><a href="group__sigstate.html#ga4cd5aba6758fd5795f477973b5f2fdfb">DeStateDetectStartDetection</a></div><div class="ttdeci">int DeStateDetectStartDetection(ThreadVars *tv, DetectEngineCtx *de_ctx, DetectEngineThreadCtx *det_ctx, Signature *s, Packet *p, Flow *f, uint8_t flags, AppProto alproto, const uint8_t alversion)</div><div class="ttdoc">Match app layer sig list against app state and store relevant match information. </div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00476">detect-engine-state.c:476</a></div></div>
<div class="ttc" id="group__sigstate_html_ga205034ae2733eb44d2ae6630026a34f6"><div class="ttname"><a href="group__sigstate.html#ga205034ae2733eb44d2ae6630026a34f6">DeStateRegisterTests</a></div><div class="ttdeci">void DeStateRegisterTests(void)</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l02326">detect-engine-state.c:2326</a></div></div>
<div class="ttc" id="structThreadVars___html"><div class="ttname"><a href="structThreadVars__.html">ThreadVars_</a></div><div class="ttdoc">Per thread variable structure. </div><div class="ttdef"><b>Definition:</b> <a href="threadvars_8h_source.html#l00060">threadvars.h:60</a></div></div>
<div class="ttc" id="structDetectEngineThreadCtx___html"><div class="ttname"><a href="structDetectEngineThreadCtx__.html">DetectEngineThreadCtx_</a></div><div class="ttdef"><b>Definition:</b> <a href="detect_8h_source.html#l00759">detect.h:759</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_a37b174e37235e6bec575e889cc0b118e"><div class="ttname"><a href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a></div><div class="ttdeci">struct DetectEngineState_ DetectEngineState</div></div>
<div class="ttc" id="structDetectEngineStateDirection___html_ae782c3f68a631e3a6d85074051fffcc7"><div class="ttname"><a href="structDetectEngineStateDirection__.html#ae782c3f68a631e3a6d85074051fffcc7">DetectEngineStateDirection_::filestore_cnt</a></div><div class="ttdeci">uint16_t filestore_cnt</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00125">detect-engine-state.h:125</a></div></div>
<div class="ttc" id="structDetectEngineStateDirection___html_a0be0273f783201e42f3e532ae0c83d7c"><div class="ttname"><a href="structDetectEngineStateDirection__.html#a0be0273f783201e42f3e532ae0c83d7c">DetectEngineStateDirection_::flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00126">detect-engine-state.h:126</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_ab88b9759c0103260ed39981158159a42"><div class="ttname"><a href="detect-engine-state_8h.html#ab88b9759c0103260ed39981158159a42">DetectEngineStateDirection</a></div><div class="ttdeci">struct DetectEngineStateDirection_ DetectEngineStateDirection</div></div>
<div class="ttc" id="structFlow___html"><div class="ttname"><a href="structFlow__.html">Flow_</a></div><div class="ttdoc">Flow data structure. </div><div class="ttdef"><b>Definition:</b> <a href="flow_8h_source.html#l00300">flow.h:300</a></div></div>
<div class="ttc" id="suricata-common_8h_html_a39de57b58776de55c122cced7e65608c"><div class="ttname"><a href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a></div><div class="ttdeci">#define SigIntId</div><div class="ttdef"><b>Definition:</b> <a href="suricata-common_8h_source.html#l00230">suricata-common.h:230</a></div></div>
<div class="ttc" id="structSigMatch___html"><div class="ttname"><a href="structSigMatch__.html">SigMatch_</a></div><div class="ttdoc">a single match condition for a signature </div><div class="ttdef"><b>Definition:</b> <a href="detect_8h_source.html#l00354">detect.h:354</a></div></div>
<div class="ttc" id="structDetectEngineStateFlow___html_a2c82fb9063d6b5e4205ac20bfc14f714"><div class="ttname"><a href="structDetectEngineStateFlow__.html#a2c82fb9063d6b5e4205ac20bfc14f714">DetectEngineStateFlow_::dir_state</a></div><div class="ttdeci">DetectEngineStateDirectionFlow dir_state[2]</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00154">detect-engine-state.h:154</a></div></div>
<div class="ttc" id="detect-engine-state_8h_html_a24a8a41cd2bd7055087476cef3a35d10"><div class="ttname"><a href="detect-engine-state_8h.html#a24a8a41cd2bd7055087476cef3a35d10">DE_STATE_CHUNK_SIZE</a></div><div class="ttdeci">#define DE_STATE_CHUNK_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8h_source.html#l00057">detect-engine-state.h:57</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="detect-engine-state_8h.html">detect-engine-state.h</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:52:49 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
