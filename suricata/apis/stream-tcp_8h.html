<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/stream-tcp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('stream-tcp_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">stream-tcp.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-detect-proto_8h_source.html">app-layer-detect-proto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-mpm_8h_source.html">util-mpm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stream-tcp.h:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h__incl.png" border="0" usemap="#src_2stream-tcp_8h" alt=""/></div>
<map name="src_2stream-tcp_8h" id="src_2stream-tcp_8h">
<area shape="rect" id="node2" href="stream-tcp-private_8h.html" title="stream&#45;tcp&#45;private.h" alt="" coords="985,155,1124,181"/><area shape="rect" id="node47" href="app-layer-detect-proto_8h.html" title="app&#45;layer&#45;detect&#45;proto.h" alt="" coords="1149,155,1307,181"/><area shape="rect" id="node16" href="util-mpm_8h.html" title="util&#45;mpm.h" alt="" coords="232,528,315,555"/><area shape="rect" id="node48" href="stream_8h.html" title="stream.h" alt="" coords="1331,155,1404,181"/><area shape="rect" id="node50" href="stream-tcp-reassemble_8h.html" title="stream&#45;tcp&#45;reassemble.h" alt="" coords="1145,80,1311,107"/><area shape="rect" id="node3" href="decode_8h.html" title="decode.h" alt="" coords="1223,304,1297,331"/><area shape="rect" id="node45" href="util-pool_8h.html" title="util&#45;pool.h" alt="" coords="919,229,997,256"/><area shape="rect" id="node46" href="util-pool-thread_8h.html" title="util&#45;pool&#45;thread.h" alt="" coords="1022,229,1140,256"/><area shape="rect" id="node4" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="509,603,643,629"/><area shape="rect" id="node15" href="threadvars_8h.html" title="threadvars.h" alt="" coords="226,453,320,480"/><area shape="rect" id="node17" href="decode-events_8h.html" title="decode&#45;events.h" alt="" coords="601,453,719,480"/><area shape="rect" id="node18" href="source-nflog_8h.html" title="source&#45;nflog.h" alt="" coords="1297,379,1401,405"/><area shape="rect" id="node19" href="source-nfq_8h.html" title="source&#45;nfq.h" alt="" coords="22,528,116,555"/><area shape="rect" id="node20" href="source-ipfw_8h.html" title="source&#45;ipfw.h" alt="" coords="1426,379,1525,405"/><area shape="rect" id="node21" href="source-pcap_8h.html" title="source&#45;pcap.h" alt="" coords="1551,379,1655,405"/><area shape="rect" id="node22" href="source-af-packet_8h.html" title="source&#45;af&#45;packet.h" alt="" coords="1679,379,1809,405"/><area shape="rect" id="node23" href="source-mpipe_8h.html" title="source&#45;mpipe.h" alt="" coords="1834,379,1944,405"/><area shape="rect" id="node24" href="source-netmap_8h.html" title="source&#45;netmap.h" alt="" coords="1969,379,2087,405"/><area shape="rect" id="node25" href="action-globals_8h.html" title="action&#45;globals.h" alt="" coords="2111,379,2224,405"/><area shape="rect" id="node26" href="decode-erspan_8h.html" title="decode&#45;erspan.h" alt="" coords="355,379,473,405"/><area shape="rect" id="node27" href="decode-ethernet_8h.html" title="decode&#45;ethernet.h" alt="" coords="2249,379,2375,405"/><area shape="rect" id="node28" href="decode-gre_8h.html" title="decode&#45;gre.h" alt="" coords="94,379,191,405"/><area shape="rect" id="node29" href="decode-ppp_8h.html" title="decode&#45;ppp.h" alt="" coords="2399,379,2499,405"/><area shape="rect" id="node30" href="decode-pppoe_8h.html" title="decode&#45;pppoe.h" alt="" coords="216,379,331,405"/><area shape="rect" id="node31" href="decode-sll_8h.html" title="decode&#45;sll.h" alt="" coords="2523,379,2615,405"/><area shape="rect" id="node32" href="decode-ipv4_8h.html" title="decode&#45;ipv4.h" alt="" coords="743,453,845,480"/><area shape="rect" id="node33" href="decode-ipv6_8h.html" title="decode&#45;ipv6.h" alt="" coords="2233,453,2335,480"/><area shape="rect" id="node34" href="decode-icmpv4_8h.html" title="decode&#45;icmpv4.h" alt="" coords="955,379,1076,405"/><area shape="rect" id="node38" href="decode-icmpv6_8h.html" title="decode&#45;icmpv6.h" alt="" coords="1101,379,1221,405"/><area shape="rect" id="node35" href="decode-tcp_8h.html" title="decode&#45;tcp.h" alt="" coords="870,453,967,480"/><area shape="rect" id="node37" href="decode-udp_8h.html" title="decode&#45;udp.h" alt="" coords="1121,453,1220,480"/><area shape="rect" id="node36" href="decode-sctp_8h.html" title="decode&#45;sctp.h" alt="" coords="992,453,1096,480"/><area shape="rect" id="node39" href="decode-raw_8h.html" title="decode&#45;raw.h" alt="" coords="2639,379,2739,405"/><area shape="rect" id="node40" href="decode-null_8h.html" title="decode&#45;null.h" alt="" coords="2764,379,2863,405"/><area shape="rect" id="node41" href="decode-vlan_8h.html" title="decode&#45;vlan.h" alt="" coords="2887,379,2989,405"/><area shape="rect" id="node42" href="decode-mpls_8h.html" title="decode&#45;mpls.h" alt="" coords="3015,379,3121,405"/><area shape="rect" id="node43" href="detect-reference_8h.html" title="detect&#45;reference.h" alt="" coords="702,379,828,405"/><area shape="rect" id="node44" href="app-layer-protos_8h.html" title="app&#45;layer&#45;protos.h" alt="" coords="3146,379,3272,405"/><area shape="rect" id="node6" href="htp_8h.html" title="htp/htp.h" alt="" coords="645,677,717,704"/><area shape="rect" id="node7" href="threads_8h.html" title="threads.h" alt="" coords="169,752,244,779"/><area shape="rect" id="node8" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="743,677,892,704"/><area shape="rect" id="node9" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="531,677,620,704"/><area shape="rect" id="node10" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="759,752,839,779"/><area shape="rect" id="node11" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="269,677,352,704"/><area shape="rect" id="node12" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="967,677,1107,704"/><area shape="rect" id="node13" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="2246,677,2348,704"/><area shape="rect" id="node14" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="377,677,455,704"/><area shape="rect" id="node49" href="flow_8h.html" title="flow.h" alt="" coords="1339,229,1396,256"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h__dep__incl.png" border="0" usemap="#src_2stream-tcp_8hdep" alt=""/></div>
<map name="src_2stream-tcp_8hdep" id="src_2stream-tcp_8hdep">
<area shape="rect" id="node2" href="app-layer-dcerpc-udp_8c.html" title="src/app&#45;layer&#45;dcerpc\l&#45;udp.c" alt="" coords="5,81,144,122"/><area shape="rect" id="node3" href="app-layer-dcerpc_8c.html" title="src/app&#45;layer&#45;dcerpc.c" alt="" coords="169,88,319,115"/><area shape="rect" id="node4" href="app-layer-detect-proto_8c.html" title="src/app&#45;layer&#45;detect\l&#45;proto.c" alt="" coords="343,81,480,122"/><area shape="rect" id="node5" href="app-layer-dns-tcp_8c.html" title="src/app&#45;layer&#45;dns&#45;tcp.c" alt="" coords="505,88,660,115"/><area shape="rect" id="node6" href="app-layer-dns-udp_8c.html" title="src/app&#45;layer&#45;dns&#45;udp.c" alt="" coords="685,88,843,115"/><area shape="rect" id="node7" href="app-layer-ftp_8c.html" title="src/app&#45;layer&#45;ftp.c" alt="" coords="867,88,993,115"/><area shape="rect" id="node8" href="app-layer-htp-body_8c.html" title="src/app&#45;layer&#45;htp&#45;body.c" alt="" coords="1019,88,1181,115"/><area shape="rect" id="node9" href="app-layer-htp-file_8c.html" title="src/app&#45;layer&#45;htp&#45;file.c" alt="" coords="1206,88,1356,115"/><area shape="rect" id="node10" href="app-layer-htp_8c.html" title="src/app&#45;layer&#45;htp.c" alt="" coords="1381,88,1512,115"/><area shape="rect" id="node11" href="app-layer-parser_8c.html" title="src/app&#45;layer&#45;parser.c" alt="" coords="1537,88,1684,115"/><area shape="rect" id="node12" href="app-layer-smb_8c.html" title="SMBv1 parser/decoder. " alt="" coords="1709,88,1845,115"/><area shape="rect" id="node13" href="app-layer-smb2_8c.html" title="src/app&#45;layer&#45;smb2.c" alt="" coords="1871,88,2015,115"/><area shape="rect" id="node14" href="app-layer-smtp_8c.html" title="src/app&#45;layer&#45;smtp.c" alt="" coords="2039,88,2180,115"/><area shape="rect" id="node15" href="app-layer-ssh_8c.html" title="src/app&#45;layer&#45;ssh.c" alt="" coords="2204,88,2337,115"/><area shape="rect" id="node16" href="app-layer-ssl_8c.html" title="src/app&#45;layer&#45;ssl.c" alt="" coords="2362,88,2491,115"/><area shape="rect" id="node17" href="detect-dce-iface_8c.html" title="src/detect&#45;dce&#45;iface.c" alt="" coords="2515,88,2663,115"/><area shape="rect" id="node18" href="detect-dce-opnum_8c.html" title="src/detect&#45;dce&#45;opnum.c" alt="" coords="2687,88,2845,115"/><area shape="rect" id="node19" href="detect-dce-stub-data_8c.html" title="src/detect&#45;dce&#45;stub\l&#45;data.c" alt="" coords="2870,81,3004,122"/><area shape="rect" id="node20" href="detect-dns-query_8c.html" title="src/detect&#45;dns&#45;query.c" alt="" coords="3029,88,3181,115"/><area shape="rect" id="node21" href="detect-engine-dcepayload_8c.html" title="src/detect&#45;engine&#45;dcepayload.c" alt="" coords="3205,88,3408,115"/><area shape="rect" id="node22" href="detect-engine-event_8c.html" title="src/detect&#45;engine&#45;event.c" alt="" coords="3433,88,3601,115"/><area shape="rect" id="node23" href="detect-engine-file_8c.html" title="src/detect&#45;engine&#45;file.c" alt="" coords="3627,88,3781,115"/><area shape="rect" id="node24" href="detect-engine-filedata-smtp_8c.html" title="src/detect&#45;engine&#45;filedata\l&#45;smtp.c" alt="" coords="3805,81,3973,122"/><area shape="rect" id="node25" href="detect-engine-hcbd_8c.html" title="Handle HTTP request body match corresponding to http_client_body keyword. " alt="" coords="3997,88,4163,115"/><area shape="rect" id="node26" href="detect-engine-hcd_8c.html" title="Handle HTTP cookie match. " alt="" coords="4187,88,4345,115"/><area shape="rect" id="node27" href="detect-engine-hhd_8c.html" title="Handle HTTP header match. " alt="" coords="4370,88,4528,115"/><area shape="rect" id="node28" href="detect-engine-hhhd_8c.html" title="Handle HTTP host header. HHHD &#45; Http Host Header Data. " alt="" coords="4553,88,4719,115"/><area shape="rect" id="node29" href="detect-engine-hmd_8c.html" title="Handle HTTP method match. " alt="" coords="4743,88,4905,115"/><area shape="rect" id="node30" href="detect-engine-hrhd_8c.html" title="Handle HTTP raw header match. " alt="" coords="4929,88,5092,115"/><area shape="rect" id="node31" href="detect-engine-hrhhd_8c.html" title="Handle HTTP host header. HRHHD &#45; Http Raw Host Header Data. " alt="" coords="5117,88,5285,115"/><area shape="rect" id="node32" href="detect-engine-hrl_8c.html" title="src/detect&#45;engine&#45;hrl.c" alt="" coords="5310,88,5460,115"/><area shape="rect" id="node33" href="detect-engine-hrud_8c.html" title="Handle HTTP raw uri match. " alt="" coords="5485,88,5648,115"/><area shape="rect" id="node34" href="detect-engine-hsbd_8c.html" title="Handle HTTP response body match corresponding to http_server_body keyword. " alt="" coords="5672,88,5837,115"/><area shape="rect" id="node35" href="detect-engine-hscd_8c.html" title="src/detect&#45;engine&#45;hscd.c" alt="" coords="5861,88,6027,115"/><area shape="rect" id="node36" href="detect-engine-hsmd_8c.html" title="src/detect&#45;engine&#45;hsmd.c" alt="" coords="6051,88,6220,115"/><area shape="rect" id="node37" href="detect-engine-hua_8c.html" title="Handle HTTP user agent match. " alt="" coords="6245,88,6403,115"/><area shape="rect" id="node38" href="detect-engine-state_8c.html" title="State based signature handling. " alt="" coords="6427,88,6593,115"/><area shape="rect" id="node39" href="detect-engine-uri_8c.html" title="src/detect&#45;engine&#45;uri.c" alt="" coords="6618,88,6768,115"/><area shape="rect" id="node40" href="detect-fileext_8c.html" title="src/detect&#45;fileext.c" alt="" coords="6793,88,6924,115"/><area shape="rect" id="node41" href="detect-filemagic_8c.html" title="src/detect&#45;filemagic.c" alt="" coords="6948,88,7095,115"/><area shape="rect" id="node42" href="detect-filemd5_8c.html" title="src/detect&#45;filemd5.c" alt="" coords="7119,88,7256,115"/><area shape="rect" id="node43" href="detect-filename_8c.html" title="src/detect&#45;filename.c" alt="" coords="7281,88,7425,115"/><area shape="rect" id="node44" href="detect-filesize_8c.html" title="src/detect&#45;filesize.c" alt="" coords="7449,88,7585,115"/><area shape="rect" id="node45" href="detect-filestore_8c.html" title="src/detect&#45;filestore.c" alt="" coords="7609,88,7751,115"/><area shape="rect" id="node46" href="detect-ftpbounce_8c.html" title="src/detect&#45;ftpbounce.c" alt="" coords="7775,88,7927,115"/><area shape="rect" id="node47" href="detect-http-client-body_8c.html" title="src/detect&#45;http&#45;client\l&#45;body.c" alt="" coords="7951,81,8092,122"/><area shape="rect" id="node48" href="detect-http-cookie_8c.html" title="src/detect&#45;http&#45;cookie.c" alt="" coords="8117,88,8275,115"/><area shape="rect" id="node49" href="detect-http-header_8c.html" title="src/detect&#45;http&#45;header.c" alt="" coords="8300,88,8460,115"/><area shape="rect" id="node50" href="detect-http-hh_8c.html" title="src/detect&#45;http&#45;hh.c" alt="" coords="8485,88,8619,115"/></map>
</div>
</div>
<p><a href="stream-tcp_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTcpStreamCnf__.html">TcpStreamCnf_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structStreamTcpThread__.html">StreamTcpThread_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6e8b7e0809d859dfbb25638a7e0c592b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a6e8b7e0809d859dfbb25638a7e0c592b">COUNTER_STREAMTCP_STREAMS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a6e8b7e0809d859dfbb25638a7e0c592b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28a5ef79a3bc3d63c561cb091b40479d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a28a5ef79a3bc3d63c561cb091b40479d">STREAM_VERBOSE</a>&#160;&#160;&#160;<a class="el" href="suricata-common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td></tr>
<tr class="separator:a28a5ef79a3bc3d63c561cb091b40479d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae62fde89011d7fdbffad28dc9914c3e9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ae62fde89011d7fdbffad28dc9914c3e9">STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:ae62fde89011d7fdbffad28dc9914c3e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3cb392684ac8f21342886414ba5e5821"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structTcpStreamCnf__.html">TcpStreamCnf_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a3cb392684ac8f21342886414ba5e5821">TcpStreamCnf</a></td></tr>
<tr class="separator:a3cb392684ac8f21342886414ba5e5821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab44e7f889f8e413589bdd117667ef3cf"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structStreamTcpThread__.html">StreamTcpThread_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a></td></tr>
<tr class="separator:ab44e7f889f8e413589bdd117667ef3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a10e74d65d7876276a8f6061c71dcf469"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="stream-tcp_8h.html#a10e74d65d7876276a8f6061c71dcf469aba27ac45c11d3e241d54698b51190b41">STREAM_HAS_UNPROCESSED_SEGMENTS_NONE</a> = 0, 
<a class="el" href="stream-tcp_8h.html#a10e74d65d7876276a8f6061c71dcf469ac036b0d6996ef6ed36a65615a8c298f1">STREAM_HAS_UNPROCESSED_SEGMENTS_NEED_REASSEMBLY</a> = 1, 
<a class="el" href="stream-tcp_8h.html#a10e74d65d7876276a8f6061c71dcf469a71120762306238a3c73ecf41361b3932">STREAM_HAS_UNPROCESSED_SEGMENTS_NEED_ONLY_DETECTION</a> = 2
 }</td></tr>
<tr class="separator:a10e74d65d7876276a8f6061c71dcf469"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac7570830e107bef9adb9c4a729222114"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114">TmModuleStreamTcpRegister</a> (void)</td></tr>
<tr class="separator:ac7570830e107bef9adb9c4a729222114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02dc80698f907951c8c9dc972093fde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde">StreamTcpInitConfig</a> (char)</td></tr>
<tr class="memdesc:ae02dc80698f907951c8c9dc972093fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">To initialize the stream global configuration data.  <a href="#ae02dc80698f907951c8c9dc972093fde">More...</a><br/></td></tr>
<tr class="separator:ae02dc80698f907951c8c9dc972093fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b89bf8f2df825d7c19b400c8e2e2e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a60b89bf8f2df825d7c19b400c8e2e2e8">StreamTcpFreeConfig</a> (char)</td></tr>
<tr class="separator:a60b89bf8f2df825d7c19b400c8e2e2e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47042a286da78d0a3ddd510991b3efcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a47042a286da78d0a3ddd510991b3efcf">StreamTcpRegisterTests</a> (void)</td></tr>
<tr class="separator:a47042a286da78d0a3ddd510991b3efcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48310db5e37bea30b769a8d6af0dbb80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a48310db5e37bea30b769a8d6af0dbb80">StreamTcpSessionPktFree</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *)</td></tr>
<tr class="memdesc:a48310db5e37bea30b769a8d6af0dbb80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream segments back to the pool.  <a href="#a48310db5e37bea30b769a8d6af0dbb80">More...</a><br/></td></tr>
<tr class="separator:a48310db5e37bea30b769a8d6af0dbb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82137e8ff634b5efd815970ffde36d95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a82137e8ff634b5efd815970ffde36d95">StreamTcpIncrMemuse</a> (uint64_t)</td></tr>
<tr class="separator:a82137e8ff634b5efd815970ffde36d95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63161ecdaa009f5a3cda88f2c3268545"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a63161ecdaa009f5a3cda88f2c3268545">StreamTcpDecrMemuse</a> (uint64_t)</td></tr>
<tr class="separator:a63161ecdaa009f5a3cda88f2c3268545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcaf9ee674160c730aa31ca98bfd0c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#adfcaf9ee674160c730aa31ca98bfd0c9">StreamTcpCheckMemcap</a> (uint64_t)</td></tr>
<tr class="memdesc:adfcaf9ee674160c730aa31ca98bfd0c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if alloc'ing "size" would mean we're over memcap.  <a href="#adfcaf9ee674160c730aa31ca98bfd0c9">More...</a><br/></td></tr>
<tr class="separator:adfcaf9ee674160c730aa31ca98bfd0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160c3587cec73107189ae0e0913726bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf">StreamTcpPseudoSetup</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *, uint8_t *, uint32_t)</td></tr>
<tr class="memdesc:a160c3587cec73107189ae0e0913726bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream.  <a href="#a160c3587cec73107189ae0e0913726bf">More...</a><br/></td></tr>
<tr class="separator:a160c3587cec73107189ae0e0913726bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a85b1902bbd69d2620d60ce5e2cdfbdd3">StreamTcpSegmentForEach</a> (const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint8_t flag, <a class="el" href="stream_8h.html#af77f28d6baf7af12803dad7cd4b7084a">StreamSegmentCallback</a> CallbackFunc, void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="memdesc:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run callback function on each TCP segment.  <a href="#a85b1902bbd69d2620d60ce5e2cdfbdd3">More...</a><br/></td></tr>
<tr class="separator:a85b1902bbd69d2620d60ce5e2cdfbdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322cfd1d74e7cc11b4df7a01413b3ce3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a322cfd1d74e7cc11b4df7a01413b3ce3">StreamTcpReassembleConfigEnableOverlapCheck</a> (void)</td></tr>
<tr class="separator:a322cfd1d74e7cc11b4df7a01413b3ce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a4a607332f606574d63bd2ec158ebe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe">StreamTcpThreadInit</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *, void *, void **)</td></tr>
<tr class="separator:a92a4a607332f606574d63bd2ec158ebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a108137f5e3fa9caa0aab96a14df9b1cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a108137f5e3fa9caa0aab96a14df9b1cc">StreamTcpThreadDeinit</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="separator:a108137f5e3fa9caa0aab96a14df9b1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a248c85404fa06db3bc2b7d8d2f8de3a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0">StreamTcpPacket</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *stt, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq)</td></tr>
<tr class="separator:a248c85404fa06db3bc2b7d8d2f8de3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add92e80f13e88362630ba978ac24c241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241">StreamTcpSessionClear</a> (void *ssnptr)</td></tr>
<tr class="memdesc:add92e80f13e88362630ba978ac24c241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to return the stream back to the pool. It returns the segments in the stream to the segment pool.  <a href="#add92e80f13e88362630ba978ac24c241">More...</a><br/></td></tr>
<tr class="separator:add92e80f13e88362630ba978ac24c241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ac6eb354bf30fe61419200ddf1b0a2ee2">StreamTcpGetStreamSize</a> (<a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *stream)</td></tr>
<tr class="memdesc:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the size of a stream  <a href="#ac6eb354bf30fe61419200ddf1b0a2ee2">More...</a><br/></td></tr>
<tr class="separator:ac6eb354bf30fe61419200ddf1b0a2ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stream-tcp_8h.html#a3cb392684ac8f21342886414ba5e5821">TcpStreamCnf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="stream-tcp_8h.html#ac6bed017a2a4f7ef805bd3b51a251d68">stream_config</a></td></tr>
<tr class="separator:ac6bed017a2a4f7ef805bd3b51a251d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd>
<dd>
Gurvinder Singh <a href="#" onclick="location.href='mai'+'lto:'+'gur'+'vi'+'nde'+'rs'+'ing'+'hd'+'ahi'+'ya'+'@gm'+'ai'+'l.c'+'om'; return false;">gurvi<span style="display: none;">.nosp@m.</span>nder<span style="display: none;">.nosp@m.</span>singh<span style="display: none;">.nosp@m.</span>dahi<span style="display: none;">.nosp@m.</span>ya@gm<span style="display: none;">.nosp@m.</span>ail.<span style="display: none;">.nosp@m.</span>com</a> </dd></dl>

<p>Definition in file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a6e8b7e0809d859dfbb25638a7e0c592b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COUNTER_STREAMTCP_STREAMS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8h_source.html#l00030">30</a> of file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28a5ef79a3bc3d63c561cb091b40479d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAM_VERBOSE&#160;&#160;&#160;<a class="el" href="suricata-common_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8h_source.html#l00037">37</a> of file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ae62fde89011d7fdbffad28dc9914c3e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8h_source.html#l00040">40</a> of file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ab44e7f889f8e413589bdd117667ef3cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structStreamTcpThread__.html">StreamTcpThread_</a>  <a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3cb392684ac8f21342886414ba5e5821"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structTcpStreamCnf__.html">TcpStreamCnf_</a>  <a class="el" href="stream-tcp_8h.html#a3cb392684ac8f21342886414ba5e5821">TcpStreamCnf</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a10e74d65d7876276a8f6061c71dcf469"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a10e74d65d7876276a8f6061c71dcf469aba27ac45c11d3e241d54698b51190b41"></a>STREAM_HAS_UNPROCESSED_SEGMENTS_NONE</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a10e74d65d7876276a8f6061c71dcf469ac036b0d6996ef6ed36a65615a8c298f1"></a>STREAM_HAS_UNPROCESSED_SEGMENTS_NEED_REASSEMBLY</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a10e74d65d7876276a8f6061c71dcf469a71120762306238a3c73ecf41361b3932"></a>STREAM_HAS_UNPROCESSED_SEGMENTS_NEED_ONLY_DETECTION</em>&nbsp;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="stream-tcp_8h_source.html#l00188">188</a> of file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="adfcaf9ee674160c730aa31ca98bfd0c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if alloc'ing "size" would mean we're over memcap. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if in bounds </td></tr>
    <tr><td class="paramname">0</td><td>if not in bounds </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00161">161</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00048">TcpStreamCnf_::memcap</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, and <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_adfcaf9ee674160c730aa31ca98bfd0c9_icgraph.png" border="0" usemap="#stream-tcp_8h_adfcaf9ee674160c730aa31ca98bfd0c9_icgraph" alt=""/></div>
<map name="stream-tcp_8h_adfcaf9ee674160c730aa31ca98bfd0c9_icgraph" id="stream-tcp_8h_adfcaf9ee674160c730aa31ca98bfd0c9_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e" title="StreamTcp3whsQueueSynAck" alt="" coords="230,5,431,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="237,56,425,83"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="699,31,842,57"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="480,81,624,108"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1445,81,1496,108"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="673,81,869,108"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="918,81,1053,108"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1101,81,1200,108"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1248,132,1397,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a63161ecdaa009f5a3cda88f2c3268545"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpDecrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00143">143</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a63161ecdaa009f5a3cda88f2c3268545_icgraph.png" border="0" usemap="#stream-tcp_8h_a63161ecdaa009f5a3cda88f2c3268545_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a63161ecdaa009f5a3cda88f2c3268545_icgraph" id="stream-tcp_8h_a63161ecdaa009f5a3cda88f2c3268545_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="241,5,405,32"/><area shape="rect" id="node5" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="219,56,426,83"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="475,5,618,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1440,56,1491,83"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="475,56,619,83"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="667,56,863,83"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="913,56,1047,83"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1096,56,1195,83"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1243,107,1392,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a60b89bf8f2df825d7c19b400c8e2e2e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpFreeConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00620">620</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-pool-thread_8c_source.html#l00133">PoolThreadFree()</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00527">StreamTcpReassembleFree()</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_cgraph.png" border="0" usemap="#stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_cgraph" id="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="241,5,356,32"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#aaa019dfbfe83315c6aab375311eecc36" title="StreamTcpReassembleFree" alt="" coords="206,81,391,108"/><area shape="rect" id="node3" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="656,43,731,69"/><area shape="rect" id="node5" href="group__utilpool.html#ga06f51c149934cd93fb01a00f0ca27930" title="PoolPrintSaturation" alt="" coords="457,93,591,120"/><area shape="rect" id="node6" href="stream_8c.html#a8ebeba661601431d6ce3160ed95e95de" title="StreamMsgQueuesDeinit" alt="" coords="440,144,608,171"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_icgraph.png" border="0" usemap="#stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_icgraph" id="stream-tcp_8h_a60b89bf8f2df825d7c19b400c8e2e2e8_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="205,5,256,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6eb354bf30fe61419200ddf1b0a2ee2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t StreamTcpGetStreamSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stream-tcp-private_8h.html#a0ce53ab5d732ce0ac440db2b6e9c6388">TcpStream</a> *&#160;</td>
          <td class="paramname"><em>stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the size of a stream </p>
<dl class="section note"><dt>Note</dt><dd>this just calculates the diff between isn and last_ack and will not consider sequence wrap arounds (streams bigger than 4gb).</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">size</td><td>stream size </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00752">752</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00071">TcpStream_::isn</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>.</p>

</div>
</div>
<a class="anchor" id="a82137e8ff634b5efd815970ffde36d95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpIncrMemuse </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00137">137</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>, and <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a82137e8ff634b5efd815970ffde36d95_icgraph.png" border="0" usemap="#stream-tcp_8h_a82137e8ff634b5efd815970ffde36d95_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a82137e8ff634b5efd815970ffde36d95_icgraph" id="stream-tcp_8h_a82137e8ff634b5efd815970ffde36d95_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#a8bce056559e974e5f89cdf1f1fa7576e" title="StreamTcp3whsQueueSynAck" alt="" coords="214,5,415,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="226,56,403,83"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="683,31,826,57"/><area shape="rect" id="node6" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="464,81,608,108"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1429,81,1480,108"/><area shape="rect" id="node7" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="657,81,853,108"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="902,81,1037,108"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1085,81,1184,108"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1232,132,1381,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae02dc80698f907951c8c9dc972093fde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpInitConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To initialize the stream global configuration data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">quiet</td><td>It tells the mode of operation, if it is TRUE nothing will be get printed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00346">346</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00059">TcpStreamCnf_::async_oneside</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00442">ConfGetBool()</a>, <a class="el" href="conf_8c_source.html#l00380">ConfGetInt()</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="suricata_8c_source.html#l00243">EngineModeIsIPS()</a>, <a class="el" href="stream-tcp_8h_source.html#l00072">TcpStreamCnf_::flags</a>, <a class="el" href="flow_8h_source.html#l00171">FLOW_PKT_TOCLIENT</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8c_source.html#l00807">FlowSetProtoFreeFunc()</a>, <a class="el" href="stream-tcp_8h_source.html#l00073">TcpStreamCnf_::max_synack_queued</a>, <a class="el" href="stream-tcp_8h_source.html#l00048">TcpStreamCnf_::memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00058">TcpStreamCnf_::midstream</a>, <a class="el" href="util-misc_8c_source.html#l00156">ParseSizeStringU16()</a>, <a class="el" href="util-misc_8c_source.html#l00173">ParseSizeStringU32()</a>, <a class="el" href="util-misc_8c_source.html#l00190">ParseSizeStringU64()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00038">PoolThreadInit()</a>, <a class="el" href="stream-tcp_8h_source.html#l00057">TcpStreamCnf_::prealloc_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00060">TcpStreamCnf_::reassembly_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00049">TcpStreamCnf_::reassembly_memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00063">TcpStreamCnf_::reassembly_toclient_chunk_size</a>, <a class="el" href="stream-tcp_8h_source.html#l00062">TcpStreamCnf_::reassembly_toserver_chunk_size</a>, <a class="el" href="suricata_8c_source.html#l00263">RunmodeIsUnittests()</a>, <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-error_8h_source.html#l00230">SC_ERR_SIZE_PARSE</a>, <a class="el" href="util-error_8h_source.html#l00265">SC_WARN_OPTION_OBSOLETE</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00263">SCLogWarning</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="stream-tcp_8h_source.html#l00052">TcpStreamCnf_::segment_init_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00182">SEGMENTTCP_FLAG_RAW_PROCESSED</a>, <a class="el" href="stream-tcp_8h_source.html#l00051">TcpStreamCnf_::ssn_init_flags</a>, <a class="el" href="counters_8c_source.html#l00911">StatsRegisterGlobalCounter()</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp_8c_source.html#l00123">stream_inline</a>, <a class="el" href="stream_8c_source.html#l00237">StreamMsgQueueSetMinChunkLen()</a>, <a class="el" href="stream-tcp_8c_source.html#l00086">STREAMTCP_DEFAULT_MAX_SYNACK_QUEUED</a>, <a class="el" href="stream-tcp_8c_source.html#l00082">STREAMTCP_DEFAULT_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00081">STREAMTCP_DEFAULT_PREALLOC</a>, <a class="el" href="stream-tcp_8c_source.html#l00083">STREAMTCP_DEFAULT_REASSEMBLY_MEMCAP</a>, <a class="el" href="stream-tcp_8c_source.html#l00085">STREAMTCP_DEFAULT_TOCLIENT_CHUNK_SIZE</a>, <a class="el" href="stream-tcp_8c_source.html#l00084">STREAMTCP_DEFAULT_TOSERVER_CHUNK_SIZE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00124">STREAMTCP_FLAG_DISABLE_RAW</a>, <a class="el" href="stream-tcp_8h_source.html#l00040">STREAMTCP_INIT_FLAG_CHECKSUM_VALIDATION</a>, <a class="el" href="stream-tcp_8c_source.html#l00149">StreamTcpMemuseCounter()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>, <a class="el" href="stream-tcp_8c_source.html#l00178">StreamTcpSessionClear()</a>, <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>, <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>, <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>, and <a class="el" href="util-misc_8h_source.html#l00037">WarnInvalidConfEntry</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_cgraph.png" border="0" usemap="#stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_cgraph" alt=""/></div>
<map name="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_cgraph" id="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_cgraph">
<area shape="rect" id="node2" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="1051,126,1122,152"/><area shape="rect" id="node6" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="262,150,359,176"/><area shape="rect" id="node8" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer. " alt="" coords="811,151,898,178"/><area shape="rect" id="node3" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="1278,164,1381,191"/><area shape="rect" id="node9" href="suricata_8c.html#a4b40aa623a6feb122601951304064464" title="EngineModeIsIPS" alt="" coords="247,408,374,435"/><area shape="rect" id="node10" href="flow_8c.html#a05174d1570db7ee4b5a25f5ea7234e87" title="Function to set the function to get protocol specific flow state. " alt="" coords="233,459,389,486"/><area shape="rect" id="node12" href="util-misc_8c.html#ac799c82481f5e938b2ea704a014c6a0d" title="ParseSizeStringU16" alt="" coords="241,510,381,536"/><area shape="rect" id="node13" href="util-misc_8c.html#a4a65cb5e0f0109498b38fd1f9bd3a620" title="ParseSizeStringU32" alt="" coords="241,560,381,587"/><area shape="rect" id="node14" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title="ParseSizeStringU64" alt="" coords="241,611,381,638"/><area shape="rect" id="node15" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="801,252,908,279"/><area shape="rect" id="node19" href="suricata_8c.html#aea038f0105b5e6a67a1bf32d2ccf463c" title="RunmodeIsUnittests" alt="" coords="239,662,382,688"/><area shape="rect" id="node20" href="counters_8c.html#a6e153d15fc6ea022e954f38fd80fbc0a" title="Registers a counter, which represents a global value. " alt="" coords="493,419,678,446"/><area shape="rect" id="node21" href="stream_8c.html#a2c70f0a0aab3fabd48ddc16913683259" title="StreamMsgQueueSetMinChunkLen" alt="" coords="197,712,424,739"/><area shape="rect" id="node22" href="stream-tcp_8c.html#af03aa3237dccab0112a80bb24ded9e19" title="StreamTcpMemuseCounter" alt="" coords="219,763,402,790"/><area shape="rect" id="node23" href="stream-tcp-reassemble_8c.html#ad1b178831cdeb029f02fd53f08f328cf" title="StreamTcpReassembleInit" alt="" coords="222,307,399,334"/><area shape="rect" id="node38" href="stream-tcp_8c.html#add92e80f13e88362630ba978ac24c241" title="Function to return the stream back to the pool. It returns the segments in the stream to the segment ..." alt="" coords="229,864,393,891"/><area shape="rect" id="node46" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="217,927,405,954"/><area shape="rect" id="node48" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="207,814,414,840"/><area shape="rect" id="node49" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="222,1003,399,1030"/><area shape="rect" id="node4" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1497,462,1650,488"/><area shape="rect" id="node5" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1543,164,1604,191"/><area shape="rect" id="node7" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="532,99,639,126"/><area shape="rect" id="node11" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="510,470,661,496"/><area shape="rect" id="node16" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="1053,354,1120,380"/><area shape="rect" id="node18" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="1029,252,1144,279"/><area shape="rect" id="node17" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="1292,303,1367,330"/><area shape="rect" id="node24" href="stream-tcp-reassemble_8c.html#a477c59db3b1fef12cb9b1e5e5de0f59f" title="StreamTcpReassembleMemuse\lGlobalCounter" alt="" coords="481,302,690,344"/><area shape="rect" id="node25" href="stream-tcp-reassemble_8c.html#a6e2b5d05e1f2d5b39843319142e436f0" title="StreamTcpReassemblyConfig" alt="" coords="487,368,684,395"/><area shape="rect" id="node26" href="util-byte_8c.html#a9cc0b7c198843ccaebe904f4653fb154" title="ByteExtractStringUint16" alt="" coords="773,303,936,330"/><area shape="rect" id="node28" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="773,354,936,380"/><area shape="rect" id="node29" href="stream_8c.html#a8093091e96132a466a13758e52844d5e" title="StreamMsgQueuesInit" alt="" coords="779,506,931,532"/><area shape="rect" id="node35" href="stream-tcp-reassemble_8c.html#ab4ebd7988b8a196ad81913e13f274c22" title="alloc a tcp segment pool entry " alt="" coords="1011,607,1162,634"/><area shape="rect" id="node36" href="stream-tcp-reassemble_8c.html#a528a7185ada382fada458afd2fc961a7" title="clean up a tcp segment pool entry " alt="" coords="769,455,940,482"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#aa1fb22e94e9c6df8a77e06699f6e86ed" title="TcpSegmentPoolInit" alt="" coords="785,644,925,671"/><area shape="rect" id="node27" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="1024,303,1149,330"/><area shape="rect" id="node30" href="stream_8c.html#ad7541852302f86f4b50cb6e950939ae8" title="StreamMsgPoolAlloc" alt="" coords="1015,556,1159,583"/><area shape="rect" id="node32" href="stream_8c.html#ad6cd583c3811736afb335193f3e703c4" title="StreamMsgInit" alt="" coords="1033,506,1140,532"/><area shape="rect" id="node33" href="stream_8c.html#a38c2100a3b1c2756eb194d50f0bd49f7" title="StreamMsgPoolFree" alt="" coords="1016,455,1157,482"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#ab3131fef1b3b347c72077af35f3817ea" title="Function to Check the reassembly memory usage counter against the allowed max memory usgae for TCP se..." alt="" coords="1231,600,1428,641"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8c.html#a1117512e3b998a56f41b4457da37c416" title="Function to Decrease the memory usage counter for the TCP reassembly segments. " alt="" coords="1211,430,1448,456"/><area shape="rect" id="node39" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool " alt="" coords="791,890,918,916"/><area shape="rect" id="node41" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="501,814,670,840"/><area shape="rect" id="node42" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="503,712,667,739"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="472,763,699,790"/><area shape="rect" id="node45" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK list from a stream. " alt="" coords="504,864,667,891"/><area shape="rect" id="node40" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1043,814,1130,840"/><area shape="rect" id="node44" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="747,763,962,790"/><area shape="rect" id="node47" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="498,966,673,992"/><area shape="rect" id="node50" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="506,1016,665,1043"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_icgraph.png" border="0" usemap="#stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_icgraph" alt=""/></div>
<map name="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_icgraph" id="stream-tcp_8h_ae02dc80698f907951c8c9dc972093fde_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="197,5,248,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a248c85404fa06db3bc2b7d8d2f8de3a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpPacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream-tcp_8h.html#ab44e7f889f8e413589bdd117667ef3cf">StreamTcpThread</a> *&#160;</td>
          <td class="paramname"><em>stt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l04451">4451</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream-tcp_8h_source.html#l00108">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp_8h_source.html#l00104">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00106">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="util-validate_8h_source.html#l00103">DEBUG_ASSERT_FLOW_LOCKED</a>, <a class="el" href="decode_8h_source.html#l00925">DecodeSetNoPacketInspectionFlag</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00224">TcpSession_::flags</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="decode_8h_source.html#l00802">PACKET_DROP</a>, <a class="el" href="packet-queue_8c_source.html#l00164">PacketDequeue()</a>, <a class="el" href="packet-queue_8c_source.html#l00136">PacketEnqueue()</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="decode_8h_source.html#l00247">PKT_IS_TOCLIENT</a>, <a class="el" href="decode_8h_source.html#l00246">PKT_IS_TOSERVER</a>, <a class="el" href="decode_8h_source.html#l01026">PKT_PSEUDO_STREAM_END</a>, <a class="el" href="decode_8h_source.html#l01023">PKT_STREAM_EST</a>, <a class="el" href="decode_8h_source.html#l01027">PKT_STREAM_MODIFIED</a>, <a class="el" href="decode_8h_source.html#l01029">PKT_STREAM_NOPCAPLOG</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00088">StreamTcpThread_::pseudo_queue</a>, <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-checksum_8c_source.html#l00030">ReCalculateChecksum()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00218">TcpSession_::state</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, <a class="el" href="decode-events_8h_source.html#l00203">STREAM_PKT_BROKEN_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00118">STREAMTCP_FLAG_MIDSTREAM_SYNACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00159">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00155">STREAMTCP_STREAM_FLAG_NOREASSEMBLY</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00281">StreamTcpDisableAppLayer()</a>, <a class="el" href="stream-tcp-inline_8c_source.html#l00044">StreamTcpInlineMode()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03406">StreamTcpReassembleHandleSegment()</a>, <a class="el" href="stream-tcp_8c_source.html#l00250">StreamTcpSessionPktFree()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00211">StreamTcpSetEvent</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00104">TCP_CLOSE_WAIT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00106">TCP_CLOSED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00105">TCP_CLOSING</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00099">TCP_ESTABLISHED</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00100">TCP_FIN_WAIT1</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00101">TCP_FIN_WAIT2</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00069">TcpStream_::tcp_flags</a>, <a class="el" href="decode-tcp_8h_source.html#l00104">TCP_GET_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00103">TCP_LAST_ACK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00095">TCP_NONE</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00222">TcpSession_::tcp_packet_flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00098">TCP_SYN_RECV</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00097">TCP_SYN_SENT</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00102">TCP_TIME_WAIT</a>, <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>, <a class="el" href="decode-tcp_8h_source.html#l00039">TH_ACK</a>, <a class="el" href="decode-tcp_8h_source.html#l00037">TH_RST</a>, <a class="el" href="decode-tcp_8h_source.html#l00036">TH_SYN</a>, <a class="el" href="flow_8h_source.html#l00376">Flow_::thread_id</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph.png" border="0" usemap="#stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph" id="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_cgraph">
<area shape="rect" id="node2" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="224,5,339,32"/><area shape="rect" id="node3" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="224,56,339,83"/><area shape="rect" id="node4" href="util-checksum_8c.html#ab76beb6b62cf242b0fc2b4373fde7081" title="ReCalculateChecksum" alt="" coords="203,107,360,133"/><area shape="rect" id="node5" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1300,587,1375,613"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1799,107,1985,133"/><area shape="rect" id="node7" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="1524,309,1673,336"/><area shape="rect" id="node8" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67" title="StreamTcpReassembleHandle\lSegment" alt="" coords="181,333,381,374"/><area shape="rect" id="node44" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool. " alt="" coords="192,865,371,892"/><area shape="rect" id="node9" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="705,423,919,449"/><area shape="rect" id="node34" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="443,673,643,714"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="443,333,643,374"/><area shape="rect" id="node10" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1251,485,1424,512"/><area shape="rect" id="node29" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="1024,485,1128,512"/><area shape="rect" id="node30" href="stream-tcp-reassemble_8c.html#af7d81d5d4678c6234e27e051b90143b8" title="PrintList" alt="" coords="1041,789,1111,816"/><area shape="rect" id="node32" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="969,840,1183,867"/><area shape="rect" id="node11" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="1505,782,1692,823"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="1789,563,1995,589"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1524,360,1673,387"/><area shape="rect" id="node23" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1499,651,1698,677"/><area shape="rect" id="node24" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d" title="FlowCleanupAppLayer" alt="" coords="1522,600,1675,627"/><area shape="rect" id="node28" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="1539,448,1658,475"/><area shape="rect" id="node22" href="stream-tcp-reassemble_8h.html#aa7a2c8bcfd02ada1794f778c0614d5d1" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1758,512,2026,539"/><area shape="rect" id="node13" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="2119,487,2270,513"/><area shape="rect" id="node15" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1810,157,1974,184"/><area shape="rect" id="node17" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1811,309,1973,336"/><area shape="rect" id="node19" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1805,461,1979,488"/><area shape="rect" id="node18" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="2099,259,2290,285"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1785,360,1999,387"/><area shape="rect" id="node21" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1755,259,2029,285"/><area shape="rect" id="node16" href="app-layer-detect-proto_8c.html#a0e4d19271b37f02950a05c8114255b67" title="AppLayerProtoDetectGetProtoName" alt="" coords="2077,157,2312,184"/><area shape="rect" id="node25" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="1795,613,1989,640"/><area shape="rect" id="node26" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="2109,613,2281,640"/><area shape="rect" id="node27" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="2361,606,2554,647"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a8a8f87c06afcf81900e99924112ef89b" title="PrintList2" alt="" coords="1299,789,1376,816"/><area shape="rect" id="node33" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1294,840,1381,867"/><area shape="rect" id="node35" href="stream-tcp-reassemble_8c.html#a41cf556eaddebb12df7460006cc9c988" title="Function to get the segment of required length from the pool. " alt="" coords="733,637,891,664"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8c.html#a57183ba5a415fcc5c946937e68d610d3" title="StreamTcpReassembleInsert\lSegment" alt="" coords="716,807,908,849"/><area shape="rect" id="node36" href="group__utilpool.html#gafb7537cad310adc5646e13e362df5575" title="PoolGet" alt="" coords="1041,637,1111,664"/><area shape="rect" id="node38" href="stream-tcp-reassemble_8h.html#a025c6aeffa2046f8b39ee519edcfa8c1" title="Function to set the OS policy for the given stream based on the destination of the received packet..." alt="" coords="995,941,1157,968"/><area shape="rect" id="node39" href="util-host-os-info_8c.html#afe502ab3f4ddc5c0cc9a867fe276964f" title="Retrieves the host os flavour, given an ipv4 address in the raw address format. " alt="" coords="1232,992,1443,1019"/><area shape="rect" id="node41" href="util-host-os-info_8c.html#a23aa4d7afaf9a26cbfbbc248e6d31333" title="Retrieves the host os flavour, given an ipv6 address in the raw address format. " alt="" coords="1232,941,1443,968"/><area shape="rect" id="node40" href="util-radix-tree_8c.html#a9625ba8ce9baf67fc0254ff6136985cd" title="Checks if an IPV4 address is present in the tree under a netblock. " alt="" coords="1491,992,1706,1019"/><area shape="rect" id="node42" href="util-radix-tree_8c.html#a47b1ad27c8f067c5525cf9ecc2c24ff4" title="Checks if an IPV6 address is present in the tree under a netblock. " alt="" coords="1491,941,1706,968"/><area shape="rect" id="node45" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="429,903,656,929"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph.png" border="0" usemap="#stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph" id="stream-tcp_8h_a248c85404fa06db3bc2b7d8d2f8de3a0_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="182,5,269,32"/><area shape="rect" id="node3" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="318,5,514,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="563,5,698,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="747,5,845,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1091,5,1141,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="893,31,1043,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a160c3587cec73107189ae0e0913726bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* StreamTcpPseudoSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from the reassembled stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>Pointer to the parent of the pseudo packet </td></tr>
    <tr><td class="paramname">pkt</td><td>pointer to the raw packet of the parent </td></tr>
    <tr><td class="paramname">len</td><td>length of the packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>upon success returns the pointer to the new pseudo packet otherwise NULL </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05763">5763</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00518">Packet_::datalink</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="decode_8c_source.html#l00241">PacketCopyData()</a>, <a class="el" href="decode_8c_source.html#l00163">PacketGetFromQueueOrAlloc()</a>, <a class="el" href="decode_8h_source.html#l00385">Packet_::proto</a>, <a class="el" href="decode_8h_source.html#l00388">Packet_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00525">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>, <a class="el" href="decode_8h_source.html#l00849">SET_TUNNEL_PKT</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, and <a class="el" href="decode_8h_source.html#l00829">TUNNEL_INCR_PKT_TPR</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05856">StreamTcpPseudoPacketCreateStreamEndPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_cgraph.png" border="0" usemap="#stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_cgraph" id="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="255,5,377,32"/><area shape="rect" id="node4" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="219,56,413,83"/><area shape="rect" id="node3" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="462,5,621,32"/><area shape="rect" id="node5" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="466,56,617,83"/><area shape="rect" id="node6" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="470,107,613,133"/><area shape="rect" id="node7" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="670,107,759,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_icgraph.png" border="0" usemap="#stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_icgraph" id="stream-tcp_8h_a160c3587cec73107189ae0e0913726bf_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="219,5,429,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a322cfd1d74e7cc11b4df7a01413b3ce3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpReassembleConfigEnableOverlapCheck </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp-reassemble_8c_source.html#l00109">109</a> of file <a class="el" href="stream-tcp-reassemble_8c_source.html">stream-tcp-reassemble.c</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-event_8c_source.html#l00139">DetectEngineEventParse()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph.png" border="0" usemap="#stream-tcp_8h_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph" id="stream-tcp_8h_a322cfd1d74e7cc11b4df7a01413b3ce3_icgraph">
<area shape="rect" id="node2" href="detect-engine-event_8c.html#a8929be678fb1e0471cd5599388f6cb99" title="This function is used to parse decoder events options passed via decode&#45;event: keyword. " alt="" coords="251,12,421,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a47042a286da78d0a3ddd510991b3efcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l10738">10738</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-reassemble_8c_source.html#l08689">StreamTcpReassembleRegisterTests()</a>, and <a class="el" href="stream-tcp-sack_8c_source.html#l00928">StreamTcpSackRegisterTests()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_cgraph.png" border="0" usemap="#stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_cgraph" id="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f" title="The Function Register the Unit tests to test the reassembly engine for various OS policies..." alt="" coords="221,23,429,65"/><area shape="rect" id="node5" href="stream-tcp-sack_8c.html#a893ea33421ab3dff83dc070805d38376" title="StreamTcpSackRegisterTests" alt="" coords="226,89,425,116"/><area shape="rect" id="node3" href="stream-tcp-inline_8c.html#ad01a33c39b0309dd536c8cf89f6cf83a" title="StreamTcpInlineRegisterTests" alt="" coords="478,5,677,32"/><area shape="rect" id="node4" href="stream-tcp-util_8c.html#a44bf885919a659b8132eaa84aefee888" title="StreamTcpUtilRegisterTests" alt="" coords="483,56,671,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_icgraph.png" border="0" usemap="#stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_icgraph" id="stream-tcp_8h_a47042a286da78d0a3ddd510991b3efcf_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="222,5,418,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="467,5,602,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="651,5,749,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="995,5,1045,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="797,31,947,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85b1902bbd69d2620d60ce5e2cdfbdd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StreamTcpSegmentForEach </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stream_8h.html#af77f28d6baf7af12803dad7cd4b7084a">StreamSegmentCallback</a>&#160;</td>
          <td class="paramname"><em>CallbackFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run callback function on each TCP segment. </p>
<p>This function is used by StreamMsgForEach() which should be used directly.</p>
<dl class="section return"><dt>Returns</dt><dd>-1 in case of error, the number of segment in case of success </dd></dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05929">5929</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00207">FLOWLOCK_RDLOCK</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00073">TcpStream_::last_ack</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00058">TcpSegment_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00054">TcpSegment_::payload</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00055">TcpSegment_::payload_len</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00085">TcpStream_::seg_list</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00057">TcpSegment_::seq</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00199">SEQ_LT</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>.</p>

<p>Referenced by <a class="el" href="stream_8c_source.html#l00274">StreamSegmentForEach()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph.png" border="0" usemap="#stream-tcp_8h_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph" id="stream-tcp_8h_a85b1902bbd69d2620d60ce5e2cdfbdd3_icgraph">
<area shape="rect" id="node2" href="stream_8h.html#af1a6a686c53801b6b418efe258add530" title="Run callback for all segments. " alt="" coords="240,5,405,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="add92e80f13e88362630ba978ac24c241"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionClear </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ssnptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream back to the pool. It returns the segments in the stream to the segment pool. </p>
<p>This function is called when the flow is destroyed, so it should free <em>everything</em> related to the tcp session. So including the app layer data. We are guaranteed to only get here when the flow's use_cnt is 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssn</td><td>Void ptr to the ssn. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00178">178</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="stream_8h_source.html#l00037">StreamMsg_::next</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00044">TcpStateQueue_::next</a>, <a class="el" href="util-pool-thread_8c_source.html#l00172">PoolThreadReturn()</a>, <a class="el" href="stream_8h_source.html#l00038">StreamMsg_::prev</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00232">TcpSession_::queue</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00219">TcpSession_::queue_len</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream_8c_source.html#l00109">StreamMsgReturnToPool()</a>, <a class="el" href="stream-tcp_8c_source.html#l00143">StreamTcpDecrMemuse()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>, <a class="el" href="stream-tcp-sack_8c_source.html#l00338">StreamTcpSackFreeList()</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00229">TcpSession_::toclient_smsg_head</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00227">TcpSession_::toserver_smsg_head</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_cgraph.png" border="0" usemap="#stream-tcp_8h_add92e80f13e88362630ba978ac24c241_cgraph" alt=""/></div>
<map name="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_cgraph" id="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#gabe4882476fd4ad932ba6f76d7a7523a3" title="return data to thread pool " alt="" coords="538,5,665,32"/><area shape="rect" id="node4" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="517,56,686,83"/><area shape="rect" id="node5" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="250,107,414,133"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="219,157,445,184"/><area shape="rect" id="node8" href="stream-tcp-sack_8c.html#a51d26dd05d0291d0aade3b482c6326d8" title="Free SACK list from a stream. " alt="" coords="251,208,413,235"/><area shape="rect" id="node3" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="758,56,845,83"/><area shape="rect" id="node7" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="494,132,709,159"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_icgraph.png" border="0" usemap="#stream-tcp_8h_add92e80f13e88362630ba978ac24c241_icgraph" alt=""/></div>
<map name="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_icgraph" id="stream-tcp_8h_add92e80f13e88362630ba978ac24c241_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="219,5,362,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="411,5,461,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a48310db5e37bea30b769a8d6af0dbb80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StreamTcpSessionPktFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to return the stream segments back to the pool. </p>
<p>We don't clear out the app layer storage here as that is under protection of the "use_cnt" reference counter in the flow. This function is called when the use_cnt is always at least 1 (this pkt has incremented the flow use_cnt itself), so we don't bother.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Packet used to identify the stream. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00250">250</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00262">StreamTcpReturnStreamSegments()</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_cgraph.png" border="0" usemap="#stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_cgraph" id="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="232,5,459,32"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="507,5,722,32"/><area shape="rect" id="node4" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="771,5,858,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_icgraph.png" border="0" usemap="#stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_icgraph" id="stream-tcp_8h_a48310db5e37bea30b769a8d6af0dbb80_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="233,5,359,32"/><area shape="rect" id="node3" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="409,5,495,32"/><area shape="rect" id="node4" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="545,5,741,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="790,5,925,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="973,5,1072,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1317,5,1368,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1120,31,1269,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a108137f5e3fa9caa0aab96a14df9b1cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadDeinit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05141">5141</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00586">StreamTcpReassembleFreeThreadCtx()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph.png" border="0" usemap="#stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph" id="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_cgraph">
<area shape="rect" id="node2" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc" title="StreamTcpReassembleFreeThreadCtx" alt="" coords="214,96,461,123"/><area shape="rect" id="node3" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="509,96,693,123"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="741,67,944,93"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="746,118,939,159"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="993,5,1202,46"/><area shape="rect" id="node7" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="997,71,1197,97"/><area shape="rect" id="node6" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1251,12,1402,39"/><area shape="rect" id="node9" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="1060,125,1135,152"/><area shape="rect" id="node10" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1278,125,1375,152"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_icgraph.png" border="0" usemap="#stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_icgraph" id="stream-tcp_8h_a108137f5e3fa9caa0aab96a14df9b1cc_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="214,5,410,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="459,5,594,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="643,5,741,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="987,5,1037,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="789,31,939,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92a4a607332f606574d63bd2ec158ebe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> StreamTcpThreadInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l05074">5074</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="stream-tcp_8h_source.html#l00098">StreamTcpThread_::counter_tcp_invalid_checksum</a>, <a class="el" href="stream-tcp_8h_source.html#l00100">StreamTcpThread_::counter_tcp_no_flow</a>, <a class="el" href="stream-tcp_8h_source.html#l00094">StreamTcpThread_::counter_tcp_pseudo</a>, <a class="el" href="stream-tcp_8h_source.html#l00096">StreamTcpThread_::counter_tcp_pseudo_failed</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00061">TcpReassemblyThreadCtx_::counter_tcp_reass_gap</a>, <a class="el" href="stream-tcp_8h_source.html#l00108">StreamTcpThread_::counter_tcp_rst</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00057">TcpReassemblyThreadCtx_::counter_tcp_segment_memcap</a>, <a class="el" href="stream-tcp_8h_source.html#l00090">StreamTcpThread_::counter_tcp_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00092">StreamTcpThread_::counter_tcp_ssn_memcap</a>, <a class="el" href="stream-tcp-reassemble_8h_source.html#l00059">TcpReassemblyThreadCtx_::counter_tcp_stream_depth</a>, <a class="el" href="stream-tcp_8h_source.html#l00104">StreamTcpThread_::counter_tcp_syn</a>, <a class="el" href="stream-tcp_8h_source.html#l00106">StreamTcpThread_::counter_tcp_synack</a>, <a class="el" href="util-pool-thread_8c_source.html#l00088">PoolThreadGrow()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00038">PoolThreadInit()</a>, <a class="el" href="util-pool-thread_8c_source.html#l00126">PoolThreadSize()</a>, <a class="el" href="stream-tcp_8h_source.html#l00057">TcpStreamCnf_::prealloc_sessions</a>, <a class="el" href="stream-tcp_8h_source.html#l00111">StreamTcpThread_::ra_ctx</a>, <a class="el" href="stream-tcp_8h_source.html#l00081">StreamTcpThread_::runmode_flow_stream_async</a>, <a class="el" href="util-runmodes_8c_source.html#l00064">RunmodeGetFlowStreamAsync()</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="stream-tcp_8h_source.html#l00077">StreamTcpThread_::ssn_pool_id</a>, <a class="el" href="counters_8c_source.html#l00850">StatsRegisterCounter()</a>, <a class="el" href="stream-tcp_8h_source.html#l00114">stream_config</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00572">StreamTcpReassembleInitThreadCtx()</a>, <a class="el" href="stream-tcp_8c_source.html#l00267">StreamTcpSessionPoolAlloc()</a>, <a class="el" href="stream-tcp_8c_source.html#l00291">StreamTcpSessionPoolCleanup()</a>, <a class="el" href="stream-tcp_8c_source.html#l00281">StreamTcpSessionPoolInit()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00125">TmModuleStreamTcpRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_cgraph.png" border="0" usemap="#stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_cgraph" alt=""/></div>
<map name="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_cgraph" id="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_cgraph">
<area shape="rect" id="node2" href="group__utilpool.html#ga1262188db7dd25b18e1c4e58d8f6e59c" title="grow a thread pool by one " alt="" coords="258,5,377,32"/><area shape="rect" id="node5" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="264,56,371,83"/><area shape="rect" id="node7" href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce" title="get size of PoolThread (number of &#39;threads&#39;, so array elements) " alt="" coords="260,107,375,133"/><area shape="rect" id="node8" href="util-runmodes_8c.html#af065af67120665e6faa84ad4c184424b" title="RunmodeGetFlowStreamAsync" alt="" coords="214,157,421,184"/><area shape="rect" id="node9" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="243,208,391,235"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#a5dc1a2f2120af56ff09791171c822897" title="StreamTcpReassembleInitThreadCtx" alt="" coords="198,259,437,285"/><area shape="rect" id="node24" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="223,309,411,336"/><area shape="rect" id="node26" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="214,385,421,412"/><area shape="rect" id="node32" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="229,461,406,488"/><area shape="rect" id="node3" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="565,5,632,32"/><area shape="rect" id="node4" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="831,31,905,57"/><area shape="rect" id="node6" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="541,56,656,83"/><area shape="rect" id="node11" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="519,237,678,264"/><area shape="rect" id="node12" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="776,179,960,205"/><area shape="rect" id="node20" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="1024,229,1229,256"/><area shape="rect" id="node22" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="773,281,963,322"/><area shape="rect" id="node13" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="1025,175,1228,201"/><area shape="rect" id="node17" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="1030,281,1223,322"/><area shape="rect" id="node14" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="1278,109,1487,150"/><area shape="rect" id="node16" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="1283,175,1483,201"/><area shape="rect" id="node15" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1537,175,1687,201"/><area shape="rect" id="node18" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="1345,292,1420,319"/><area shape="rect" id="node19" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1563,292,1661,319"/><area shape="rect" id="node21" href="app-layer-parser_8c.html#a2b0517e26b65ae0299677d4f097b223f" title="AppLayerParserGetProtocol\lParserLocalStorage" alt="" coords="1291,226,1475,267"/><area shape="rect" id="node23" href="util-mpm_8c.html#aef0b59171845a87218792da6eb8cdfea" title="Setup a pmq. " alt="" coords="1085,347,1168,373"/><area shape="rect" id="node25" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="511,296,686,323"/><area shape="rect" id="node27" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="783,347,953,373"/><area shape="rect" id="node29" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="517,448,681,475"/><area shape="rect" id="node30" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="485,397,712,424"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1083,397,1170,424"/><area shape="rect" id="node31" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="761,397,975,424"/><area shape="rect" id="node33" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="519,499,678,525"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_icgraph.png" border="0" usemap="#stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_icgraph" alt=""/></div>
<map name="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_icgraph" id="stream-tcp_8h_a92a4a607332f606574d63bd2ec158ebe_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="198,5,394,32"/><area shape="rect" id="node3" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="443,5,578,32"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="627,5,725,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="971,5,1021,32"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="773,31,923,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac7570830e107bef9adb9c4a729222114"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmModuleStreamTcpRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8c_source.html#l00125">125</a> of file <a class="el" href="stream-tcp_8c_source.html">stream-tcp.c</a>.</p>

<p>References <a class="el" href="tm-modules_8h_source.html#l00060">TmModule_::cap_flags</a>, <a class="el" href="tm-modules_8h_source.html#l00063">TmModule_::flags</a>, <a class="el" href="tm-modules_8h_source.html#l00048">TmModule_::Func</a>, <a class="el" href="tm-modules_8h_source.html#l00040">TmModule_::name</a>, <a class="el" href="tm-modules_8h_source.html#l00058">TmModule_::RegisterTests</a>, <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>, <a class="el" href="stream-tcp_8c_source.html#l05161">StreamTcpExitPrintStats()</a>, <a class="el" href="stream-tcp_8c_source.html#l10738">StreamTcpRegisterTests()</a>, <a class="el" href="stream-tcp_8c_source.html#l05141">StreamTcpThreadDeinit()</a>, <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>, <a class="el" href="tm-modules_8h_source.html#l00045">TmModule_::ThreadDeinit</a>, <a class="el" href="tm-modules_8h_source.html#l00044">TmModule_::ThreadExitPrintStats</a>, <a class="el" href="tm-modules_8h_source.html#l00043">TmModule_::ThreadInit</a>, <a class="el" href="tm-modules_8h_source.html#l00033">TM_FLAG_STREAM_TM</a>, <a class="el" href="tm-modules_8h_source.html#l00068">tmm_modules</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00067">TMM_STREAMTCP</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l00802">RegisterAllModules()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_cgraph.png" border="0" usemap="#stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_cgraph" alt=""/></div>
<map name="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_cgraph" id="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_cgraph">
<area shape="rect" id="node2" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="291,416,378,443"/><area shape="rect" id="node20" href="stream-tcp_8c.html#abd3bdf46f5d8fcd8bf8ea644b3cc312e" title="StreamTcpExitPrintStats" alt="" coords="251,952,418,979"/><area shape="rect" id="node21" href="stream-tcp_8c.html#a47042a286da78d0a3ddd510991b3efcf" title="StreamTcpRegisterTests" alt="" coords="251,1057,419,1084"/><area shape="rect" id="node26" href="stream-tcp_8c.html#aec7b18dbcad0affb03714548e584c4ad" title="StreamTcpThreadDeinit" alt="" coords="255,901,415,928"/><area shape="rect" id="node31" href="stream-tcp_8c.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="263,771,407,797"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1871,93,1945,120"/><area shape="rect" id="node4" href="stream-tcp_8c.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="527,416,654,443"/><area shape="rect" id="node5" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="809,441,924,468"/><area shape="rect" id="node6" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="809,492,924,519"/><area shape="rect" id="node7" href="util-checksum_8c.html#ab76beb6b62cf242b0fc2b4373fde7081" title="ReCalculateChecksum" alt="" coords="788,543,945,569"/><area shape="rect" id="node8" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="774,593,959,620"/><area shape="rect" id="node9" href="stream-tcp-inline_8c.html#adb134a7f1f2b93a3e4c7ea551e10da69" title="See if stream engine is operating in inline mode. " alt="" coords="2043,321,2192,348"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#a1eaa63aa69d838e0db8634ee3d011d67" title="StreamTcpReassembleHandle\lSegment" alt="" coords="767,270,967,311"/><area shape="rect" id="node18" href="stream-tcp_8c.html#af9f131faa6d6c797ab5d639c88418a1e" title="Function to return the stream segments back to the pool. " alt="" coords="777,391,956,417"/><area shape="rect" id="node11" href="stream-tcp-reassemble_8c.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="1294,345,1509,372"/><area shape="rect" id="node16" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="1301,105,1501,146"/><area shape="rect" id="node17" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="1032,270,1232,311"/><area shape="rect" id="node12" href="app-layer_8c.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="1821,403,1995,429"/><area shape="rect" id="node13" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="1613,296,1717,323"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1558,524,1773,551"/><area shape="rect" id="node15" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1865,524,1951,551"/><area shape="rect" id="node19" href="stream-tcp-reassemble_8c.html#ad9e5351fc6f108c2c429436b49c8ace3" title="return all segments in this stream into the pool(s) " alt="" coords="1019,524,1245,551"/><area shape="rect" id="node22" href="stream-tcp-reassemble_8c.html#a4894f48885e4926013c260b03f68685f" title="The Function Register the Unit tests to test the reassembly engine for various OS policies..." alt="" coords="487,1050,695,1091"/><area shape="rect" id="node25" href="stream-tcp-sack_8c.html#a893ea33421ab3dff83dc070805d38376" title="StreamTcpSackRegisterTests" alt="" coords="491,1116,690,1143"/><area shape="rect" id="node23" href="stream-tcp-inline_8c.html#ad01a33c39b0309dd536c8cf89f6cf83a" title="StreamTcpInlineRegisterTests" alt="" coords="767,1032,966,1059"/><area shape="rect" id="node24" href="stream-tcp-util_8c.html#a44bf885919a659b8132eaa84aefee888" title="StreamTcpUtilRegisterTests" alt="" coords="773,1083,961,1109"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a967e5a8d394fdac2878d63f01b9c87cc" title="StreamTcpReassembleFreeThreadCtx" alt="" coords="467,999,714,1025"/><area shape="rect" id="node28" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="1040,855,1224,881"/><area shape="rect" id="node29" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="1300,855,1503,881"/><area shape="rect" id="node30" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="1305,789,1498,830"/><area shape="rect" id="node32" href="group__utilpool.html#ga1262188db7dd25b18e1c4e58d8f6e59c" title="grow a thread pool by one " alt="" coords="531,948,650,975"/><area shape="rect" id="node35" href="group__utilpool.html#ga47220da343f227646a7287f82e595b52" title="initialize a thread pool " alt="" coords="537,847,644,873"/><area shape="rect" id="node37" href="group__utilpool.html#gacbe5aa27b89cc62080896dc8889ae7ce" title="get size of PoolThread (number of &#39;threads&#39;, so array elements) " alt="" coords="533,897,648,924"/><area shape="rect" id="node38" href="util-runmodes_8c.html#af065af67120665e6faa84ad4c184424b" title="RunmodeGetFlowStreamAsync" alt="" coords="487,543,694,569"/><area shape="rect" id="node39" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="517,593,665,620"/><area shape="rect" id="node40" href="stream-tcp-reassemble_8c.html#a5dc1a2f2120af56ff09791171c822897" title="StreamTcpReassembleInitThreadCtx" alt="" coords="471,796,710,823"/><area shape="rect" id="node44" href="stream-tcp_8c.html#a149be8c880933a5c3d0e4a2de749977b" title="Stream alloc function for the Pool. " alt="" coords="497,695,685,721"/><area shape="rect" id="node46" href="stream-tcp_8c.html#aeb09a993ff83021bd05e01e8c8787937" title="Pool free function. " alt="" coords="763,644,970,671"/><area shape="rect" id="node49" href="stream-tcp_8c.html#a434ace0515e1fafb67276969b1e2a7d2" title="StreamTcpSessionPoolInit" alt="" coords="502,745,679,772"/><area shape="rect" id="node33" href="group__utilpool.html#gad3e9e2ebd42de98ba0e84ae2424c4111" title="Init a Pool. " alt="" coords="833,905,900,932"/><area shape="rect" id="node34" href="group__utilpool.html#ga2872120babab18bece5ce3499b4a3fe8" title="PoolFree" alt="" coords="1095,905,1169,932"/><area shape="rect" id="node36" href="group__utilpool.html#ga0cc1f2c68a31a118a91eeb9376075f4d" title="destroy the thread pool " alt="" coords="809,851,924,877"/><area shape="rect" id="node41" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="787,796,946,823"/><area shape="rect" id="node42" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="1029,737,1235,764"/><area shape="rect" id="node43" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="1037,789,1227,830"/><area shape="rect" id="node45" href="stream-tcp_8c.html#a89c9973d678db064e54f760cc1d372a8" title="Check if alloc&#39;ing &quot;size&quot; would mean we&#39;re over memcap. " alt="" coords="779,695,954,721"/><area shape="rect" id="node47" href="stream_8c.html#a33609da2b57ba141192a381cd168f3f0" title="StreamMsgReturnToPool" alt="" coords="1581,577,1750,604"/><area shape="rect" id="node48" href="stream-tcp_8c.html#a73b0702f9f4d8ac41c5c439c4bc49c64" title="StreamTcpDecrMemuse" alt="" coords="1050,644,1214,671"/><area shape="rect" id="node50" href="stream-tcp_8c.html#a59514802880d4d9475c3cffb5d3a7716" title="StreamTcpIncrMemuse" alt="" coords="787,745,946,772"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_icgraph.png" border="0" usemap="#stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_icgraph" alt=""/></div>
<map name="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_icgraph" id="stream-tcp_8h_ac7570830e107bef9adb9c4a729222114_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="251,5,386,32"/><area shape="rect" id="node3" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="435,5,533,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="779,5,829,32"/><area shape="rect" id="node5" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="581,31,731,57"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac6bed017a2a4f7ef805bd3b51a251d68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stream-tcp_8h.html#a3cb392684ac8f21342886414ba5e5821">TcpStreamCnf</a> stream_config</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="stream-tcp_8h_source.html#l00114">114</a> of file <a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>, <a class="el" href="stream-tcp_8c_source.html#l01121">StreamTcp3whsQueueSynAck()</a>, <a class="el" href="stream-tcp_8c_source.html#l00161">StreamTcpCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03611">StreamTcpGetSegment()</a>, <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, <a class="el" href="stream-tcp_8c_source.html#l00642">StreamTcpNewSession()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00152">StreamTcpReassembleCheckMemcap()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l00316">StreamTcpReassemblyConfig()</a>, <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>, and <a class="el" href="stream-tcp_8c_source.html#l04855">TcpSessionReuseDoneEnough()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="stream-tcp_8h.html">stream-tcp.h</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:10 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
