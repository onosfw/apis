<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/util-mpm-ac.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util-mpm-ac_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util-mpm-ac.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect-parse_8h_source.html">detect-parse.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect-engine_8h_source.html">detect-engine.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest-helper_8h_source.html">util-unittest-helper.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-memcmp_8h_source.html">util-memcmp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-mpm-ac_8h_source.html">util-mpm-ac.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-memcpy_8h_source.html">util-memcpy.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-mpm-ac.c:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c__incl.png" border="0" usemap="#src_2util-mpm-ac_8c" alt=""/></div>
<map name="src_2util-mpm-ac_8c" id="src_2util-mpm-ac_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="925,155,1059,181"/><area shape="rect" id="node37" href="suricata_8h.html" title="suricata.h" alt="" coords="953,80,1031,107"/><area shape="rect" id="node21" href="detect_8h.html" title="detect.h" alt="" coords="1456,304,1525,331"/><area shape="rect" id="node40" href="detect-parse_8h.html" title="detect&#45;parse.h" alt="" coords="1347,80,1452,107"/><area shape="rect" id="node41" href="detect-engine_8h.html" title="detect&#45;engine.h" alt="" coords="1529,80,1639,107"/><area shape="rect" id="node44" href="conf_8h.html" title="conf.h" alt="" coords="1664,80,1723,107"/><area shape="rect" id="node15" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="915,379,1004,405"/><area shape="rect" id="node46" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="1747,80,1844,107"/><area shape="rect" id="node47" href="util-unittest-helper_8h.html" title="util&#45;unittest&#45;helper.h" alt="" coords="1869,80,2005,107"/><area shape="rect" id="node48" href="util-memcmp_8h.html" title="util&#45;memcmp.h" alt="" coords="2259,229,2367,256"/><area shape="rect" id="node49" href="util-mpm-ac_8h.html" title="util&#45;mpm&#45;ac.h" alt="" coords="2080,80,2181,107"/><area shape="rect" id="node50" href="util-memcpy_8h.html" title="util&#45;memcpy.h" alt="" coords="2205,80,2309,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="645,229,717,256"/><area shape="rect" id="node13" href="threads_8h.html" title="threads.h" alt="" coords="785,528,860,555"/><area shape="rect" id="node14" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="1564,229,1713,256"/><area shape="rect" id="node17" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="1072,453,1152,480"/><area shape="rect" id="node19" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="333,528,416,555"/><area shape="rect" id="node20" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1081,229,1220,256"/><area shape="rect" id="node23" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="2481,453,2583,480"/><area shape="rect" id="node35" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="67,229,145,256"/><area shape="rect" id="node36" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="170,229,248,256"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="528,304,611,331"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="678,379,732,405"/><area shape="rect" id="node11" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="753,304,852,331"/><area shape="rect" id="node12" href="htp__config_8h.html" title="htp_config.h" alt="" coords="635,304,728,331"/><area shape="rect" id="node16" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="910,453,996,480"/><area shape="rect" id="node18" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="760,453,885,480"/><area shape="rect" id="node22" href="flow_8h.html" title="flow.h" alt="" coords="2437,379,2493,405"/><area shape="rect" id="node24" href="detect-engine-proto_8h.html" title="detect&#45;engine&#45;proto.h" alt="" coords="1660,379,1804,405"/><area shape="rect" id="node25" href="detect-reference_8h.html" title="detect&#45;reference.h" alt="" coords="1829,379,1955,405"/><area shape="rect" id="node26" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="1081,379,1191,405"/><area shape="rect" id="node27" href="util-mpm_8h.html" title="util&#45;mpm.h" alt="" coords="757,379,840,405"/><area shape="rect" id="node28" href="util-hash_8h.html" title="util&#45;hash.h" alt="" coords="1980,379,2063,405"/><area shape="rect" id="node29" href="util-hashlist_8h.html" title="util&#45;hashlist.h" alt="" coords="2087,379,2185,405"/><area shape="rect" id="node30" href="util-radix-tree_8h.html" title="util&#45;radix&#45;tree.h" alt="" coords="2210,379,2317,405"/><area shape="rect" id="node31" href="util-file_8h.html" title="util&#45;file.h" alt="" coords="2342,379,2412,405"/><area shape="rect" id="node32" href="reputation_8h.html" title="reputation.h" alt="" coords="1267,379,1357,405"/><area shape="rect" id="node33" href="detect-mark_8h.html" title="detect&#45;mark.h" alt="" coords="1382,379,1484,405"/><area shape="rect" id="node34" href="detect-threshold_8h.html" title="detect&#45;threshold.h" alt="" coords="1509,379,1635,405"/><area shape="rect" id="node38" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="361,155,457,181"/><area shape="rect" id="node42" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="1653,155,1747,181"/><area shape="rect" id="node43" href="flow-private_8h.html" title="flow&#45;private.h" alt="" coords="1529,155,1628,181"/><area shape="rect" id="node45" href="queue_8h.html" title="queue.h" alt="" coords="1823,155,1891,181"/></map>
</div>
</div>
<p><a href="util-mpm-ac_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structStateQueue__.html">StateQueue_</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper structure used by AC during state table creation.  <a href="structStateQueue__.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a66189246849ead6eee142bf807dc0e55"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a66189246849ead6eee142bf807dc0e55">SC_AC_FAIL</a>&#160;&#160;&#160;(-1)</td></tr>
<tr class="separator:a66189246849ead6eee142bf807dc0e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3fe065ee0fd6bf8f698ca709374da5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#ace3fe065ee0fd6bf8f698ca709374da5">INIT_HASH_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:ace3fe065ee0fd6bf8f698ca709374da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac087ec7faf31ed5ff7dad2c7b2cf4bae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#ac087ec7faf31ed5ff7dad2c7b2cf4bae">STATE_QUEUE_CONTAINER_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:ac087ec7faf31ed5ff7dad2c7b2cf4bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a976880f3224540726c6e8c67650e3a54"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structStateQueue__.html">StateQueue_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a976880f3224540726c6e8c67650e3a54">StateQueue</a></td></tr>
<tr class="memdesc:a976880f3224540726c6e8c67650e3a54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper structure used by AC during state table creation.  <a href="#a976880f3224540726c6e8c67650e3a54">More...</a><br/></td></tr>
<tr class="separator:a976880f3224540726c6e8c67650e3a54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae04a4fce1633a2e9b1d7559bb8530a44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#ae04a4fce1633a2e9b1d7559bb8530a44">SCACInitCtx</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx)</td></tr>
<tr class="memdesc:ae04a4fce1633a2e9b1d7559bb8530a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the AC context.  <a href="#ae04a4fce1633a2e9b1d7559bb8530a44">More...</a><br/></td></tr>
<tr class="separator:ae04a4fce1633a2e9b1d7559bb8530a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d392fdd517fc72b33aebf310a4094a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a90d392fdd517fc72b33aebf310a4094a">SCACInitThreadCtx</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx, <a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *mpm_thread_ctx, uint32_t matchsize)</td></tr>
<tr class="memdesc:a90d392fdd517fc72b33aebf310a4094a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the mpm thread context.  <a href="#a90d392fdd517fc72b33aebf310a4094a">More...</a><br/></td></tr>
<tr class="separator:a90d392fdd517fc72b33aebf310a4094a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb2738efaacd0beaa79d7977168ca40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a3fb2738efaacd0beaa79d7977168ca40">SCACDestroyCtx</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx)</td></tr>
<tr class="memdesc:a3fb2738efaacd0beaa79d7977168ca40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the mpm context.  <a href="#a3fb2738efaacd0beaa79d7977168ca40">More...</a><br/></td></tr>
<tr class="separator:a3fb2738efaacd0beaa79d7977168ca40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9685cf4dfb44dc529e2eec05d685375f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a9685cf4dfb44dc529e2eec05d685375f">SCACDestroyThreadCtx</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx, <a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *mpm_thread_ctx)</td></tr>
<tr class="memdesc:a9685cf4dfb44dc529e2eec05d685375f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the mpm thread context.  <a href="#a9685cf4dfb44dc529e2eec05d685375f">More...</a><br/></td></tr>
<tr class="separator:a9685cf4dfb44dc529e2eec05d685375f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a718d6e498016a625ba2e32a8f9fdad49"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a718d6e498016a625ba2e32a8f9fdad49">SCACAddPatternCI</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx, uint8_t *pat, uint16_t patlen, uint16_t offset, uint16_t depth, uint32_t pid, <a class="el" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> sid, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:a718d6e498016a625ba2e32a8f9fdad49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a case insensitive pattern. Although we have different calls for adding case sensitive and insensitive patterns, we make a single call for either case. No special treatment for either case.  <a href="#a718d6e498016a625ba2e32a8f9fdad49">More...</a><br/></td></tr>
<tr class="separator:a718d6e498016a625ba2e32a8f9fdad49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafa7a898c9323f195c065038619371e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#aafa7a898c9323f195c065038619371e4">SCACAddPatternCS</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx, uint8_t *pat, uint16_t patlen, uint16_t offset, uint16_t depth, uint32_t pid, <a class="el" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a> sid, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:aafa7a898c9323f195c065038619371e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a case sensitive pattern. Although we have different calls for adding case sensitive and insensitive patterns, we make a single call for either case. No special treatment for either case.  <a href="#aafa7a898c9323f195c065038619371e4">More...</a><br/></td></tr>
<tr class="separator:aafa7a898c9323f195c065038619371e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa20e06b0c34cfad5e613b97b926e8a0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#aa20e06b0c34cfad5e613b97b926e8a0d">SCACPreparePatterns</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx)</td></tr>
<tr class="memdesc:aa20e06b0c34cfad5e613b97b926e8a0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the patterns added to the mpm, and create the internal tables.  <a href="#aa20e06b0c34cfad5e613b97b926e8a0d">More...</a><br/></td></tr>
<tr class="separator:aa20e06b0c34cfad5e613b97b926e8a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa288caea35ffe91f4265c20e479473a9"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#aa288caea35ffe91f4265c20e479473a9">SCACSearch</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx, <a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *mpm_thread_ctx, <a class="el" href="util-mpm_8h.html#ab81c23a74b2079a72ce7cb3eeec7ad6e">PatternMatcherQueue</a> *pmq, uint8_t *buf, uint16_t buflen)</td></tr>
<tr class="memdesc:aa288caea35ffe91f4265c20e479473a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The aho corasick search function.  <a href="#aa288caea35ffe91f4265c20e479473a9">More...</a><br/></td></tr>
<tr class="separator:aa288caea35ffe91f4265c20e479473a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b26b18ade3acfc92a98cca6ac159d7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a2b26b18ade3acfc92a98cca6ac159d7e">SCACPrintInfo</a> (<a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *mpm_ctx)</td></tr>
<tr class="separator:a2b26b18ade3acfc92a98cca6ac159d7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77c304a21a3f4072464bccd1a6a6bfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#ac77c304a21a3f4072464bccd1a6a6bfb">SCACPrintSearchStats</a> (<a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *mpm_thread_ctx)</td></tr>
<tr class="separator:ac77c304a21a3f4072464bccd1a6a6bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c52c037fa23ab1b557b0468f9519a01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a9c52c037fa23ab1b557b0468f9519a01">SCACRegisterTests</a> (void)</td></tr>
<tr class="separator:a9c52c037fa23ab1b557b0468f9519a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba1adcb60b0bb61538bb6e8420a9def"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-mpm-ac_8c.html#a5ba1adcb60b0bb61538bb6e8420a9def">MpmACRegister</a> (void)</td></tr>
<tr class="memdesc:a5ba1adcb60b0bb61538bb6e8420a9def"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register the aho-corasick mpm.  <a href="#a5ba1adcb60b0bb61538bb6e8420a9def">More...</a><br/></td></tr>
<tr class="separator:a5ba1adcb60b0bb61538bb6e8420a9def"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Anoop Saldanha <a href="#" onclick="location.href='mai'+'lto:'+'ano'+'op'+'sal'+'da'+'nha'+'@g'+'mai'+'l.'+'com'; return false;">anoop<span style="display: none;">.nosp@m.</span>sald<span style="display: none;">.nosp@m.</span>anha@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> <pre class="fragment">    First iteration of aho-corasick MPM from -

    Efficient String Matching: An Aid to Bibliographic Search
    Alfred V. Aho and Margaret J. Corasick

    - Uses the delta table for calculating transitions, instead of having
      separate goto and failure transitions.
    - If we cross 2 ** 16 states, we use 4 bytes in the transition table
      to hold each state, otherwise we use 2 bytes.
    - This version of the MPM is heavy on memory, but it performs well.
      If you can fit the ruleset with this mpm on your box without hitting
      swap, this is the MPM to go for.
</pre></dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000149">Todo:</a></b></dt><dd><ul>
<li>Do a proper analyis of our existing MPMs and suggest a good one based on the pattern distribution and the expected traffic(say http).<ul>
<li>Tried out loop unrolling without any perf increase. Need to dig deeper.</li>
<li>Irrespective of whether we cross 2 ** 16 states or not,shift to using uint32_t for state type, so that we can integrate it's status as a final state or not in the topmost byte. We are already doing it if state_count is &gt; 2 ** 16.</li>
<li>Test case-senstive patterns if they have any ascii chars. If they don't treat them as nocase.</li>
<li>Carry out other optimizations we are working on. hashes, compression. </li>
</ul>
</li>
</ul>
</dd></dl>

<p>Definition in file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ace3fe065ee0fd6bf8f698ca709374da5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INIT_HASH_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l00090">90</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l01221">SCACDestroyCtx()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01167">SCACInitCtx()</a>, and <a class="el" href="util-mpm-ac_8c_source.html#l01035">SCACPreparePatterns()</a>.</p>

</div>
</div>
<a class="anchor" id="a66189246849ead6eee142bf807dc0e55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SC_AC_FAIL&#160;&#160;&#160;(-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l00088">88</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac087ec7faf31ed5ff7dad2c7b2cf4bae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_QUEUE_CONTAINER_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l00092">92</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a976880f3224540726c6e8c67650e3a54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structStateQueue__.html">StateQueue_</a>  <a class="el" href="util-mpm-ac-bs_8c.html#a976880f3224540726c6e8c67650e3a54">StateQueue</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper structure used by AC during state table creation. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5ba1adcb60b0bb61538bb6e8420a9def"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MpmACRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register the aho-corasick mpm. </p>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l02226">2226</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00202">MpmTableElmt_::AddPattern</a>, <a class="el" href="util-mpm_8h_source.html#l00203">MpmTableElmt_::AddPatternNocase</a>, <a class="el" href="util-mpm_8h_source.html#l00206">MpmTableElmt_::Cleanup</a>, <a class="el" href="util-mpm_8h_source.html#l00188">MpmTableElmt_::DestroyCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00189">MpmTableElmt_::DestroyThreadCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00186">MpmTableElmt_::InitCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00187">MpmTableElmt_::InitThreadCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00185">MpmTableElmt_::max_pattern_length</a>, <a class="el" href="util-mpm_8h_source.html#l00077">MPM_AC</a>, <a class="el" href="util-mpm_8h_source.html#l00213">mpm_table</a>, <a class="el" href="util-mpm_8h_source.html#l00184">MpmTableElmt_::name</a>, <a class="el" href="util-mpm_8h_source.html#l00204">MpmTableElmt_::Prepare</a>, <a class="el" href="util-mpm_8h_source.html#l00207">MpmTableElmt_::PrintCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00208">MpmTableElmt_::PrintThreadCtx</a>, <a class="el" href="util-mpm_8h_source.html#l00209">MpmTableElmt_::RegisterUnittests</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01429">SCACAddPatternCI()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01454">SCACAddPatternCS()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01221">SCACDestroyCtx()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01202">SCACDestroyThreadCtx()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01167">SCACInitCtx()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01147">SCACInitThreadCtx()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01035">SCACPreparePatterns()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01474">SCACPrintInfo()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01461">SCACPrintSearchStats()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l03305">SCACRegisterTests()</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01305">SCACSearch()</a>, and <a class="el" href="util-mpm_8h_source.html#l00205">MpmTableElmt_::Search</a>.</p>

<p>Referenced by <a class="el" href="util-mpm_8c_source.html#l00666">MpmTableSetup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_cgraph.png" border="0" usemap="#util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_cgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_cgraph" id="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_cgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8c.html#a718d6e498016a625ba2e32a8f9fdad49" title="Add a case insensitive pattern. Although we have different calls for adding case sensitive and insens..." alt="" coords="188,5,327,32"/><area shape="rect" id="node3" href="util-mpm-ac_8c.html#aafa7a898c9323f195c065038619371e4" title="Add a case sensitive pattern. Although we have different calls for adding case sensitive and insensit..." alt="" coords="185,56,329,83"/><area shape="rect" id="node4" href="util-mpm-ac_8c.html#a3fb2738efaacd0beaa79d7977168ca40" title="Destroy the mpm context. " alt="" coords="194,107,321,133"/><area shape="rect" id="node5" href="util-mpm-ac_8c.html#a9685cf4dfb44dc529e2eec05d685375f" title="Destroy the mpm thread context. " alt="" coords="174,157,341,184"/><area shape="rect" id="node7" href="util-mpm-ac_8c.html#ae04a4fce1633a2e9b1d7559bb8530a44" title="Initialize the AC context. " alt="" coords="208,208,307,235"/><area shape="rect" id="node8" href="util-mpm-ac_8c.html#a90d392fdd517fc72b33aebf310a4094a" title="Init the mpm thread context. " alt="" coords="188,259,327,285"/><area shape="rect" id="node9" href="util-mpm-ac_8c.html#aa20e06b0c34cfad5e613b97b926e8a0d" title="Process the patterns added to the mpm, and create the internal tables. " alt="" coords="180,309,335,336"/><area shape="rect" id="node10" href="util-mpm-ac_8c.html#a2b26b18ade3acfc92a98cca6ac159d7e" title="SCACPrintInfo" alt="" coords="203,360,312,387"/><area shape="rect" id="node6" href="util-mpm-ac_8c.html#ac77c304a21a3f4072464bccd1a6a6bfb" title="SCACPrintSearchStats" alt="" coords="390,284,549,311"/><area shape="rect" id="node11" href="util-mpm-ac_8c.html#a9c52c037fa23ab1b557b0468f9519a01" title="SCACRegisterTests" alt="" coords="186,461,329,488"/><area shape="rect" id="node12" href="util-mpm-ac_8c.html#aa288caea35ffe91f4265c20e479473a9" title="The aho corasick search function. " alt="" coords="207,512,308,539"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_icgraph" id="util-mpm-ac_8c_a5ba1adcb60b0bb61538bb6e8420a9def_icgraph">
<area shape="rect" id="node2" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="173,56,291,83"/><area shape="rect" id="node3" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="367,5,465,32"/><area shape="rect" id="node6" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="365,56,467,83"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="339,107,493,133"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="739,31,789,57"/><area shape="rect" id="node5" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="541,56,691,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a718d6e498016a625ba2e32a8f9fdad49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SCACAddPatternCI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>patlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a>&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a case insensitive pattern. Although we have different calls for adding case sensitive and insensitive patterns, we make a single call for either case. No special treatment for either case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
    <tr><td class="paramname">pat</td><td>The pattern to add. </td></tr>
    <tr><td class="paramname">patnen</td><td>The pattern length. </td></tr>
    <tr><td class="paramname">offset</td><td>Ignored. </td></tr>
    <tr><td class="paramname">depth</td><td>Ignored. </td></tr>
    <tr><td class="paramname">pid</td><td>The pattern id. </td></tr>
    <tr><td class="paramname">sid</td><td>Ignored. </td></tr>
    <tr><td class="paramname">flags</td><td>Flags associated with this pattern.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01429">1429</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00173">MPM_PATTERN_FLAG_NOCASE</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a718d6e498016a625ba2e32a8f9fdad49_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a718d6e498016a625ba2e32a8f9fdad49_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a718d6e498016a625ba2e32a8f9fdad49_icgraph" id="util-mpm-ac_8c_a718d6e498016a625ba2e32a8f9fdad49_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="193,56,311,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="360,56,477,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="553,5,652,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="552,56,653,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="526,107,679,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="925,31,976,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="728,56,877,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aafa7a898c9323f195c065038619371e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SCACAddPatternCS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>patlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="suricata-common_8h.html#a39de57b58776de55c122cced7e65608c">SigIntId</a>&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a case sensitive pattern. Although we have different calls for adding case sensitive and insensitive patterns, we make a single call for either case. No special treatment for either case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
    <tr><td class="paramname">pat</td><td>The pattern to add. </td></tr>
    <tr><td class="paramname">patnen</td><td>The pattern length. </td></tr>
    <tr><td class="paramname">offset</td><td>Ignored. </td></tr>
    <tr><td class="paramname">depth</td><td>Ignored. </td></tr>
    <tr><td class="paramname">pid</td><td>The pattern id. </td></tr>
    <tr><td class="paramname">sid</td><td>Ignored. </td></tr>
    <tr><td class="paramname">flags</td><td>Flags associated with this pattern.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>On success. </td></tr>
    <tr><td class="paramname">-1</td><td>On failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01454">1454</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_aafa7a898c9323f195c065038619371e4_icgraph.png" border="0" usemap="#util-mpm-ac_8c_aafa7a898c9323f195c065038619371e4_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_aafa7a898c9323f195c065038619371e4_icgraph" id="util-mpm-ac_8c_aafa7a898c9323f195c065038619371e4_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="198,56,317,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="365,56,483,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="559,5,657,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="557,56,659,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="531,107,685,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="931,31,981,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="733,56,883,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fb2738efaacd0beaa79d7977168ca40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACDestroyCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the mpm context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01221">1221</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm-ac_8h_source.html#l00063">SCACPatternList_::cs</a>, <a class="el" href="util-mpm_8h_source.html#l00134">MpmCtx_::ctx</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00080">SCACCtx_::init_hash</a>, <a class="el" href="util-mpm-ac_8c_source.html#l00090">INIT_HASH_SIZE</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00101">SCACCtx_::max_pat_id</a>, <a class="el" href="util-mpm_8h_source.html#l00149">MpmCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00150">MpmCtx_::memory_size</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00096">SCACCtx_::output_table</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00083">SCACCtx_::parray</a>, <a class="el" href="util-mpm_8h_source.html#l00144">MpmCtx_::pattern_cnt</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00097">SCACCtx_::pid_pat_list</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00073">SCACOutputTable_::pids</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00028">SC_AC_STATE_TYPE_U16</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00029">SC_AC_STATE_TYPE_U32</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00068">SCACPatternList_::sids</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00086">SCACCtx_::state_count</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00088">SCACCtx_::state_table_u16</a>, and <a class="el" href="util-mpm-ac_8h_source.html#l00090">SCACCtx_::state_table_u32</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a3fb2738efaacd0beaa79d7977168ca40_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a3fb2738efaacd0beaa79d7977168ca40_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a3fb2738efaacd0beaa79d7977168ca40_icgraph" id="util-mpm-ac_8c_a3fb2738efaacd0beaa79d7977168ca40_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="182,56,301,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="349,56,467,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="543,5,641,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="541,56,643,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="515,107,669,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="915,31,965,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="717,56,867,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9685cf4dfb44dc529e2eec05d685375f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACDestroyThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_thread_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the mpm thread context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
    <tr><td class="paramname">mpm_thread_ctx</td><td>Pointer to the mpm thread context. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01202">1202</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00103">MpmThreadCtx_::ctx</a>, <a class="el" href="util-mpm_8h_source.html#l00105">MpmThreadCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00106">MpmThreadCtx_::memory_size</a>, <a class="el" href="util-mpm-ac_8c_source.html#l01461">SCACPrintSearchStats()</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_cgraph.png" border="0" usemap="#util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_cgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_cgraph" id="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_cgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8c.html#ac77c304a21a3f4072464bccd1a6a6bfb" title="SCACPrintSearchStats" alt="" coords="222,5,381,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_icgraph" id="util-mpm-ac_8c_a9685cf4dfb44dc529e2eec05d685375f_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="222,56,341,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="389,56,507,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="583,5,681,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="581,56,683,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="555,107,709,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="955,31,1005,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="757,56,907,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae04a4fce1633a2e9b1d7559bb8530a44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACInitCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the AC context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Mpm context. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01167">1167</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00134">MpmCtx_::ctx</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00080">SCACCtx_::init_hash</a>, <a class="el" href="util-mpm-ac_8c_source.html#l00090">INIT_HASH_SIZE</a>, <a class="el" href="util-mpm_8h_source.html#l00149">MpmCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00150">MpmCtx_::memory_size</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, and <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_ae04a4fce1633a2e9b1d7559bb8530a44_icgraph.png" border="0" usemap="#util-mpm-ac_8c_ae04a4fce1633a2e9b1d7559bb8530a44_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_ae04a4fce1633a2e9b1d7559bb8530a44_icgraph" id="util-mpm-ac_8c_ae04a4fce1633a2e9b1d7559bb8530a44_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="153,56,271,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="320,56,437,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="513,5,612,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="512,56,613,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="486,107,639,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="885,31,936,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="688,56,837,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a90d392fdd517fc72b33aebf310a4094a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACInitThreadCtx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_thread_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>matchsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the mpm thread context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
    <tr><td class="paramname">mpm_thread_ctx</td><td>Pointer to the mpm thread context. </td></tr>
    <tr><td class="paramname">matchsize</td><td>We don't need this. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01147">1147</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00103">MpmThreadCtx_::ctx</a>, <a class="el" href="util-mpm_8h_source.html#l00105">MpmThreadCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00106">MpmThreadCtx_::memory_size</a>, and <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a90d392fdd517fc72b33aebf310a4094a_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a90d392fdd517fc72b33aebf310a4094a_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a90d392fdd517fc72b33aebf310a4094a_icgraph" id="util-mpm-ac_8c_a90d392fdd517fc72b33aebf310a4094a_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="193,56,311,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="360,56,477,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="553,5,652,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="552,56,653,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="526,107,679,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="925,31,976,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="728,56,877,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa20e06b0c34cfad5e613b97b926e8a0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SCACPreparePatterns </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process the patterns added to the mpm, and create the internal tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01035">1035</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm-ac_8h_source.html#l00063">SCACPatternList_::cs</a>, <a class="el" href="util-mpm_8h_source.html#l00134">MpmCtx_::ctx</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00045">SCACPattern_::flags</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00053">SCACPattern_::id</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00080">SCACCtx_::init_hash</a>, <a class="el" href="util-mpm-ac_8c_source.html#l00090">INIT_HASH_SIZE</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00043">SCACPattern_::len</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00101">SCACCtx_::max_pat_id</a>, <a class="el" href="util-mpm_8h_source.html#l00149">MpmCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00150">MpmCtx_::memory_size</a>, <a class="el" href="util-mpm_8h_source.html#l00173">MPM_PATTERN_FLAG_NOCASE</a>, <a class="el" href="util-mpm_8h_source.html#l00135">MpmCtx_::mpm_type</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00059">SCACPattern_::next</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00047">SCACPattern_::original_pat</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00083">SCACCtx_::parray</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00064">SCACPatternList_::patlen</a>, <a class="el" href="util-mpm_8h_source.html#l00144">MpmCtx_::pattern_cnt</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00097">SCACCtx_::pid_pat_list</a>, <a class="el" href="util-error_8h_source.html#l00168">SC_ERR_AC_CUDA_ERROR</a>, <a class="el" href="util-error_8h_source.html#l00031">SC_ERR_MEM_ALLOC</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00057">SCACPattern_::sids</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00068">SCACPatternList_::sids</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00056">SCACPattern_::sids_size</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00067">SCACPatternList_::sids_size</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00100">SCACCtx_::single_state_size</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00086">SCACCtx_::state_count</a>, and <a class="el" href="util-mpm-ac_8h_source.html#l00090">SCACCtx_::state_table_u32</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_aa20e06b0c34cfad5e613b97b926e8a0d_icgraph.png" border="0" usemap="#util-mpm-ac_8c_aa20e06b0c34cfad5e613b97b926e8a0d_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_aa20e06b0c34cfad5e613b97b926e8a0d_icgraph" id="util-mpm-ac_8c_aa20e06b0c34cfad5e613b97b926e8a0d_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="209,56,327,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="376,56,493,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="569,5,668,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="568,56,669,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="542,107,695,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="941,31,992,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="744,56,893,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2b26b18ade3acfc92a98cca6ac159d7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACPrintInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01474">1474</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00134">MpmCtx_::ctx</a>, <a class="el" href="util-mpm_8h_source.html#l00147">MpmCtx_::maxlen</a>, <a class="el" href="util-mpm_8h_source.html#l00149">MpmCtx_::memory_cnt</a>, <a class="el" href="util-mpm_8h_source.html#l00150">MpmCtx_::memory_size</a>, <a class="el" href="util-mpm_8h_source.html#l00146">MpmCtx_::minlen</a>, <a class="el" href="util-mpm_8h_source.html#l00144">MpmCtx_::pattern_cnt</a>, and <a class="el" href="util-mpm-ac_8h_source.html#l00086">SCACCtx_::state_count</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a2b26b18ade3acfc92a98cca6ac159d7e_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a2b26b18ade3acfc92a98cca6ac159d7e_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a2b26b18ade3acfc92a98cca6ac159d7e_icgraph" id="util-mpm-ac_8c_a2b26b18ade3acfc92a98cca6ac159d7e_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="163,56,282,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="331,56,448,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="524,5,623,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="523,56,624,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="497,107,650,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="896,31,947,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="699,56,848,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac77c304a21a3f4072464bccd1a6a6bfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACPrintSearchStats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_thread_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01461">1461</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00103">MpmThreadCtx_::ctx</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00113">SCACThreadCtx_::total_calls</a>, and <a class="el" href="util-mpm-ac_8h_source.html#l00115">SCACThreadCtx_::total_matches</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>, and <a class="el" href="util-mpm-ac_8c_source.html#l01202">SCACDestroyThreadCtx()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_ac77c304a21a3f4072464bccd1a6a6bfb_icgraph.png" border="0" usemap="#util-mpm-ac_8c_ac77c304a21a3f4072464bccd1a6a6bfb_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_ac77c304a21a3f4072464bccd1a6a6bfb_icgraph" id="util-mpm-ac_8c_ac77c304a21a3f4072464bccd1a6a6bfb_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="430,56,549,83"/><area shape="rect" id="node9" href="util-mpm-ac_8c.html#a9685cf4dfb44dc529e2eec05d685375f" title="Destroy the mpm thread context. " alt="" coords="214,81,381,108"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="597,56,715,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="791,5,889,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="789,56,891,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="763,107,917,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1163,31,1213,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="965,56,1115,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c52c037fa23ab1b557b0468f9519a01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SCACRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l03305">3305</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_a9c52c037fa23ab1b557b0468f9519a01_icgraph.png" border="0" usemap="#util-mpm-ac_8c_a9c52c037fa23ab1b557b0468f9519a01_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_a9c52c037fa23ab1b557b0468f9519a01_icgraph" id="util-mpm-ac_8c_a9c52c037fa23ab1b557b0468f9519a01_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="198,56,317,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="365,56,483,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="559,5,657,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="557,56,659,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="531,107,685,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="931,31,981,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="733,56,883,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa288caea35ffe91f4265c20e479473a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t SCACSearch </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ad93b9871b43b9a54fe296a3c6e5504a3">MpmCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ac7380e5a7fd2c602bc3b3e76cda2fab9">MpmThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>mpm_thread_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="util-mpm_8h.html#ab81c23a74b2079a72ce7cb3eeec7ad6e">PatternMatcherQueue</a> *&#160;</td>
          <td class="paramname"><em>pmq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The aho corasick search function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mpm_ctx</td><td>Pointer to the mpm context. </td></tr>
    <tr><td class="paramname">mpm_thread_ctx</td><td>Pointer to the mpm thread context. </td></tr>
    <tr><td class="paramname">pmq</td><td>Pointer to the Pattern Matcher Queue to hold search matches. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer to be searched. </td></tr>
    <tr><td class="paramname">buflen</td><td>Buffer length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">matches</td><td>Match count. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-mpm-ac_8c_source.html#l01305">1305</a> of file <a class="el" href="util-mpm-ac_8c_source.html">util-mpm-ac.c</a>.</p>

<p>References <a class="el" href="util-mpm_8h_source.html#l00134">MpmCtx_::ctx</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00075">SCACOutputTable_::no_of_entries</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00096">SCACCtx_::output_table</a>, <a class="el" href="util-mpm_8h_source.html#l00120">PatternMatcherQueue_::pattern_id_bitarray</a>, <a class="el" href="util-mpm_8h_source.html#l00121">PatternMatcherQueue_::pattern_id_bitarray_size</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00097">SCACCtx_::pid_pat_list</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00073">SCACOutputTable_::pids</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00028">SC_AC_STATE_TYPE_U16</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00029">SC_AC_STATE_TYPE_U32</a>, <a class="el" href="util-memcmp_8h_source.html#l00490">SCMemcmp</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00086">SCACCtx_::state_count</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00088">SCACCtx_::state_table_u16</a>, <a class="el" href="util-mpm-ac_8h_source.html#l00090">SCACCtx_::state_table_u32</a>, and <a class="el" href="suricata_8h_source.html#l00181">u8_tolower</a>.</p>

<p>Referenced by <a class="el" href="util-mpm-ac_8c_source.html#l02226">MpmACRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-mpm-ac_8c_aa288caea35ffe91f4265c20e479473a9_icgraph.png" border="0" usemap="#util-mpm-ac_8c_aa288caea35ffe91f4265c20e479473a9_icgraph" alt=""/></div>
<map name="util-mpm-ac_8c_aa288caea35ffe91f4265c20e479473a9_icgraph" id="util-mpm-ac_8c_aa288caea35ffe91f4265c20e479473a9_icgraph">
<area shape="rect" id="node2" href="util-mpm-ac_8h.html#a5ba1adcb60b0bb61538bb6e8420a9def" title="Register the aho&#45;corasick mpm. " alt="" coords="155,56,274,83"/><area shape="rect" id="node3" href="util-mpm_8h.html#a5f2c4e8d699ef7a5562674a6de86a66e" title="MpmTableSetup" alt="" coords="323,56,440,83"/><area shape="rect" id="node4" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="516,5,615,32"/><area shape="rect" id="node7" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="515,56,616,83"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="489,107,642,133"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="888,31,939,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="691,56,840,83"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util-mpm-ac_8c.html">util-mpm-ac.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:16 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
