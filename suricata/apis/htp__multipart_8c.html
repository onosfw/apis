<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: libhtp/htp/htp_multipart.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('htp__multipart_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">htp_multipart.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="htp__config__auto_8h_source.html">htp_config_auto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="htp__private_8h_source.html">htp_private.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for htp_multipart.c:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c__incl.png" border="0" usemap="#libhtp_2htp_2htp__multipart_8c" alt=""/></div>
<map name="libhtp_2htp_2htp__multipart_8c" id="libhtp_2htp_2htp__multipart_8c">
<area shape="rect" id="node2" href="htp__config__auto_8h.html" title="htp_config_auto.h" alt="" coords="749,80,875,107"/><area shape="rect" id="node3" href="htp__private_8h.html" title="htp_private.h" alt="" coords="899,80,996,107"/><area shape="rect" id="node14" href="htp_8h.html" title="htp.h" alt="" coords="1364,155,1415,181"/><area shape="rect" id="node34" href="htp__config__private_8h.html" title="htp_config_private.h" alt="" coords="1439,155,1577,181"/><area shape="rect" id="node35" href="htp__connection__parser__private_8h.html" title="htp_connection_parser\l_private.h" alt="" coords="2193,454,2345,495"/><area shape="rect" id="node36" href="htp__connection__private_8h.html" title="htp_connection_private.h" alt="" coords="1781,155,1947,181"/><area shape="rect" id="node37" href="htp__list__private_8h.html" title="htp_list_private.h" alt="" coords="2262,304,2383,331"/><area shape="rect" id="node38" href="htp__multipart__private_8h.html" title="htp_multipart_private.h" alt="" coords="1601,155,1756,181"/><area shape="rect" id="node39" href="htp__table__private_8h.html" title="htp_table_private.h" alt="" coords="2201,229,2332,256"/><area shape="rect" id="node17" href="htp__core_8h.html" title="htp_core.h" alt="" coords="1937,544,2020,571"/><area shape="rect" id="node18" href="bstr_8h.html" title="bstr.h" alt="" coords="1598,304,1652,331"/><area shape="rect" id="node23" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="1203,229,1303,256"/><area shape="rect" id="node24" href="htp__config_8h.html" title="htp_config.h" alt="" coords="1848,229,1941,256"/><area shape="rect" id="node25" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="619,229,783,256"/><area shape="rect" id="node26" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="808,229,955,256"/><area shape="rect" id="node28" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="979,229,1072,256"/><area shape="rect" id="node22" href="htp__list_8h.html" title="htp_list.h" alt="" coords="1941,461,2016,488"/><area shape="rect" id="node29" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="2017,229,2124,256"/><area shape="rect" id="node30" href="htp__table_8h.html" title="htp_table.h" alt="" coords="2099,304,2185,331"/><area shape="rect" id="node31" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="1328,229,1451,256"/><area shape="rect" id="node32" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="1475,229,1596,256"/><area shape="rect" id="node33" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="1749,304,1883,331"/><area shape="rect" id="node21" href="bstr__builder_8h.html" title="bstr_builder.h" alt="" coords="1575,379,1675,405"/></map>
</div>
</div>
<p><a href="htp__multipart_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a92b1e30aed18fe59ec122fb65519d526"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhtp__multipart__t.html">htp_multipart_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a92b1e30aed18fe59ec122fb65519d526">htp_mpartp_get_multipart</a> (<a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *parser)</td></tr>
<tr class="separator:a92b1e30aed18fe59ec122fb65519d526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac51272765ee1a5c1b70980a0b96d4ece"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#ac51272765ee1a5c1b70980a0b96d4ece">htp_mpart_part_parse_c_d</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part)</td></tr>
<tr class="separator:ac51272765ee1a5c1b70980a0b96d4ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6acf2acff1d8828fba0df30a9397108c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a6acf2acff1d8828fba0df30a9397108c">htp_mpart_part_process_headers</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part)</td></tr>
<tr class="separator:a6acf2acff1d8828fba0df30a9397108c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5c03a799c0f5af2319900fe78a98e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#ade5c03a799c0f5af2319900fe78a98e0">htp_mpartp_parse_header</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part, const unsigned char *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, size_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:ade5c03a799c0f5af2319900fe78a98e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a852a6833ffbaf5dfd8577aaba8cdcef6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a852a6833ffbaf5dfd8577aaba8cdcef6">htp_mpart_part_create</a> (<a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *parser)</td></tr>
<tr class="separator:a852a6833ffbaf5dfd8577aaba8cdcef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc3a6b77b984cb093dbcd6370c42b887"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#afc3a6b77b984cb093dbcd6370c42b887">htp_mpart_part_destroy</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part, int gave_up_data)</td></tr>
<tr class="separator:afc3a6b77b984cb093dbcd6370c42b887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf2e99c5087b2ec07b11bf4df9e2073f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#adf2e99c5087b2ec07b11bf4df9e2073f">htp_mpart_part_finalize_data</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part)</td></tr>
<tr class="separator:adf2e99c5087b2ec07b11bf4df9e2073f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b162a6bdf6226c5181a15ddf28ee41"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a72b162a6bdf6226c5181a15ddf28ee41">htp_mpartp_run_request_file_data_hook</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part, const unsigned char *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, size_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:a72b162a6bdf6226c5181a15ddf28ee41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a368c461de4ad8f9d864f5c29968e6f4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a368c461de4ad8f9d864f5c29968e6f4a">htp_mpart_part_handle_data</a> (<a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *part, const unsigned char *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, size_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, int is_line)</td></tr>
<tr class="separator:a368c461de4ad8f9d864f5c29968e6f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c3b3a82d145b68e450333c6e0c19ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a33c3b3a82d145b68e450333c6e0c19ac">htp_mpartp_create</a> (<a class="el" href="structhtp__cfg__t.html">htp_cfg_t</a> *cfg, <a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> *boundary, uint64_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="separator:a33c3b3a82d145b68e450333c6e0c19ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed39a287d90d4fa9ab464444c77697c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#aed39a287d90d4fa9ab464444c77697c4">htp_mpartp_destroy</a> (<a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *parser)</td></tr>
<tr class="separator:aed39a287d90d4fa9ab464444c77697c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116c58436d2cbd3fdae8eba1f39d808c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a116c58436d2cbd3fdae8eba1f39d808c">htp_mpartp_finalize</a> (<a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *parser)</td></tr>
<tr class="separator:a116c58436d2cbd3fdae8eba1f39d808c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f343a477e74a4e91636763f3c74129d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a4f343a477e74a4e91636763f3c74129d">htp_mpartp_parse</a> (<a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *parser, const void *_data, size_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>)</td></tr>
<tr class="separator:a4f343a477e74a4e91636763f3c74129d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25467cb2d2fde659bd4536e795f9873e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="htp__multipart_8c.html#a25467cb2d2fde659bd4536e795f9873e">htp_mpartp_find_boundary</a> (<a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> *content_type, <a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> **boundary, uint64_t *<a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="separator:a25467cb2d2fde659bd4536e795f9873e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Ivan Ristic <a href="#" onclick="location.href='mai'+'lto:'+'iva'+'nr'+'@we'+'bk'+'rea'+'to'+'r.c'+'om'; return false;">ivanr<span style="display: none;">.nosp@m.</span>@web<span style="display: none;">.nosp@m.</span>kreat<span style="display: none;">.nosp@m.</span>or.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p>Definition in file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a852a6833ffbaf5dfd8577aaba8cdcef6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a>* htp_mpart_part_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td>
          <td class="paramname"><em>parser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new Multipart part.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parser</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New part instance, or NULL on memory allocation failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00454">454</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr__builder_8c_source.html#l00058">bstr_builder_clear()</a>, <a class="el" href="htp__multipart_8h_source.html#l00273">htp_multipart_part_t::headers</a>, <a class="el" href="htp__table_8c_source.html#l00150">htp_table_create()</a>, <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00154">htp_mpartp_t::part_data_pieces</a>, and <a class="el" href="htp__multipart__private_8h_source.html#l00145">htp_mpartp_t::part_header_pieces</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a852a6833ffbaf5dfd8577aaba8cdcef6_cgraph.png" border="0" usemap="#htp__multipart_8c_a852a6833ffbaf5dfd8577aaba8cdcef6_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a852a6833ffbaf5dfd8577aaba8cdcef6_cgraph" id="htp__multipart_8c_a852a6833ffbaf5dfd8577aaba8cdcef6_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a1b2387b545c3ebc9cfbeae4c3ede3e8b" title="bstr_builder_clear" alt="" coords="206,5,330,32"/><area shape="rect" id="node4" href="htp__table_8c.html#a4eb7f8a9d51ad2d6358c87162b7585d4" title="htp_table_create" alt="" coords="209,56,327,83"/><area shape="rect" id="node3" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="414,5,487,32"/><area shape="rect" id="node5" href="htp__list_8c.html#a03714eb8cf358dd34b29cdb36061af79" title="htp_list_array_create" alt="" coords="379,56,522,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afc3a6b77b984cb093dbcd6370c42b887"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htp_mpart_part_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gave_up_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys a part.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gave_up_data</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00477">477</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr_8c_source.html#l00281">bstr_free()</a>, <a class="el" href="htp__multipart_8h_source.html#l00270">htp_multipart_part_t::content_type</a>, <a class="el" href="htp__multipart_8h_source.html#l00276">htp_multipart_part_t::file</a>, <a class="el" href="htp_8h_source.html#l00116">htp_file_t::filename</a>, <a class="el" href="htp__multipart_8h_source.html#l00273">htp_multipart_part_t::headers</a>, <a class="el" href="htp__table_8c_source.html#l00168">htp_table_destroy()</a>, <a class="el" href="htp__table_8c_source.html#l00221">htp_table_get_index()</a>, <a class="el" href="htp__table_8c_source.html#l00249">htp_table_size()</a>, <a class="el" href="htp__multipart_8h_source.html#l00205">MULTIPART_PART_TEXT</a>, <a class="el" href="htp_8h_source.html#l00173">htp_header_t::name</a>, <a class="el" href="htp__multipart_8h_source.html#l00259">htp_multipart_part_t::name</a>, <a class="el" href="htp_8h_source.html#l00122">htp_file_t::tmpname</a>, <a class="el" href="htp__multipart_8h_source.html#l00253">htp_multipart_part_t::type</a>, <a class="el" href="htp_8h_source.html#l00176">htp_header_t::value</a>, and <a class="el" href="htp__multipart_8h_source.html#l00267">htp_multipart_part_t::value</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00944">htp_mpartp_destroy()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_cgraph.png" border="0" usemap="#htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_cgraph" alt=""/></div>
<map name="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_cgraph" id="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_cgraph">
<area shape="rect" id="node2" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="561,6,634,33"/><area shape="rect" id="node3" href="htp__table_8c.html#a408659a54a7dd0e715be8bab67a107e6" title="htp_table_destroy" alt="" coords="220,32,345,58"/><area shape="rect" id="node5" href="htp__table_8c.html#aa2c2702311ce4bbb7614133098c50b4e" title="htp_table_get_index" alt="" coords="213,82,352,109"/><area shape="rect" id="node6" href="htp__table_8c.html#aa1f72cd85c808b758b6efd6ea0351524" title="htp_table_size" alt="" coords="229,133,336,160"/><area shape="rect" id="node4" href="htp__table_8c.html#ac14ab63ac2bc19ac3f61d324b484dd2e" title="htp_table_clear" alt="" coords="401,32,511,58"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_icgraph.png" border="0" usemap="#htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_icgraph" alt=""/></div>
<map name="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_icgraph" id="htp__multipart_8c_afc3a6b77b984cb093dbcd6370c42b887_icgraph">
<area shape="rect" id="node2" href="htp__multipart_8h.html#aed39a287d90d4fa9ab464444c77697c4" title="htp_mpartp_destroy" alt="" coords="214,297,351,324"/><area shape="rect" id="node3" href="htp__multipart_8h.html#a33c3b3a82d145b68e450333c6e0c19ac" title="htp_mpartp_create" alt="" coords="424,257,555,284"/><area shape="rect" id="node6" href="htp__transaction_8c.html#a0d9bedcb7fd819340ebd8e8271263191" title="htp_tx_destroy_incomplete" alt="" coords="400,337,579,364"/><area shape="rect" id="node4" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="627,235,800,277"/><area shape="rect" id="node5" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="858,235,990,277"/><area shape="rect" id="node7" href="htp__connection__private_8h.html#a9c3166bd9ba64e90d9b3cf98ebb61a8d" title="htp_conn_destroy" alt="" coords="651,301,776,328"/><area shape="rect" id="node16" href="htp__transaction_8h.html#a38191123e58ad54c815b5291b38ae1ae" title="htp_tx_create" alt="" coords="663,352,764,379"/><area shape="rect" id="node49" href="htp__transaction_8h.html#a92daf5a21d1005ed658239203bab72e2" title="htp_tx_destroy" alt="" coords="659,627,767,653"/><area shape="rect" id="node8" href="htp__connection__parser_8h.html#a8716f61f158d3d39552dbdaccc4157f2" title="htp_connp_destroy_all" alt="" coords="848,301,1000,328"/><area shape="rect" id="node9" href="group__httplayer.html#ga4d27f058e59815cc3ed5ba1d7f8acf61" title="Function to frees the HTTP state memory and also frees the HTTP connection parser memory which was us..." alt="" coords="1072,200,1179,227"/><area shape="rect" id="node10" href="group__httplayer.html#ga23aaf4c00574fa636459e4377429ac13" title="Register the HTTP protocol and state handling functions to APP layer of the engine. " alt="" coords="1251,97,1394,124"/><area shape="rect" id="node11" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="1443,81,1655,122"/><area shape="rect" id="node12" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="1745,67,1855,93"/><area shape="rect" id="node13" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1991,56,2089,83"/><area shape="rect" id="node14" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1989,107,2091,133"/><area shape="rect" id="node15" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="1963,5,2117,32"/><area shape="rect" id="node17" href="htp__connection__parser_8h.html#ae9f11134051280a0127eaa26c63b0c4d" title="htp_connp_tx_create" alt="" coords="853,352,995,379"/><area shape="rect" id="node18" href="htp__request_8c.html#ae4a3e37c2a1e728db9f80cca8e53c6fa" title="htp_connp_REQ_IDLE" alt="" coords="1048,352,1203,379"/><area shape="rect" id="node19" href="htp__connection__parser_8h.html#af87403d33d361ee171e6e098a233ef3d" title="htp_connp_create" alt="" coords="3705,648,3831,675"/><area shape="rect" id="node20" href="htp__request_8c.html#a9bb99f12643c2be1ff5a74bce80aab47" title="htp_connp_REQ_CONNECT\l_PROBE_DATA" alt="" coords="1453,345,1645,386"/><area shape="rect" id="node28" href="htp__request_8c.html#a2212edc93dc47fd615a30297f8faad60" title="htp_connp_req_data" alt="" coords="3293,476,3432,503"/><area shape="rect" id="node46" href="htp__transaction_8h.html#a6b642aabfa0688477a73138803e8a96c" title="htp_tx_state_request\l_complete" alt="" coords="1251,843,1395,885"/><area shape="rect" id="node27" href="htp__util_8c.html#a81fca26cac57032120c6796bda2a660c" title="htp_connp_in_state\l_as_string" alt="" coords="3093,469,3227,510"/><area shape="rect" id="node21" href="htp__request_8c.html#ac6178cc04104e5e5e469489f5e77c04d" title="htp_connp_REQ_CONNECT\l_WAIT_RESPONSE" alt="" coords="1704,345,1896,386"/><area shape="rect" id="node22" href="htp__request_8c.html#a3e8c194c19ebdaaa21fe107e328e3a75" title="htp_connp_REQ_CONNECT\l_CHECK" alt="" coords="1944,345,2136,386"/><area shape="rect" id="node23" href="htp__transaction_8h.html#aed95ccccf477ee8adeb83291a2104156" title="htp_tx_state_request\l_headers" alt="" coords="2184,550,2328,591"/><area shape="rect" id="node24" href="htp__request_8c.html#af7b83f68a53afa0a16e0d78300b63a46" title="htp_connp_REQ_HEADERS" alt="" coords="2377,576,2567,603"/><area shape="rect" id="node25" href="htp__request_8c.html#a78975b59c610a8b5cd834b6c7ad7524b" title="htp_connp_REQ_BODY\l_CHUNKED_LENGTH" alt="" coords="2635,527,2797,569"/><area shape="rect" id="node30" href="htp__request_8c.html#a801f66183cf5693361eca92d66607314" title="htp_connp_REQ_PROTOCOL" alt="" coords="2617,695,2815,721"/><area shape="rect" id="node26" href="htp__request_8c.html#ad207aff5c7e4a68d2a539ffd9e3fd623" title="htp_connp_REQ_BODY\l_DETERMINE" alt="" coords="2868,410,3031,451"/><area shape="rect" id="node29" href="htp__connection__parser_8h.html#acc7723b7ab867bfde9d5ef78c1faf446" title="htp_connp_close" alt="" coords="5421,617,5541,644"/><area shape="rect" id="node31" href="htp__transaction_8h.html#aaaf7174643f67cdb075d45333b6fd7b5" title="htp_tx_state_request_line" alt="" coords="2864,741,3035,768"/><area shape="rect" id="node32" href="htp__request_8c.html#af6eee641bbe7ef5f73ebc1288f1450ad" title="htp_connp_REQ_LINE\l_complete" alt="" coords="3083,865,3237,906"/><area shape="rect" id="node33" href="htp__transaction_8h.html#a524d59cd184104370ade58fb200f2379" title="htp_tx_state_response\l_start" alt="" coords="3285,875,3440,917"/><area shape="rect" id="node34" href="htp__response_8c.html#a1b95d113c24de4c93db72889c738275d" title="htp_connp_RES_IDLE" alt="" coords="3488,843,3643,869"/><area shape="rect" id="node35" href="htp__response_8c.html#a7bf7c40f55013deddf338b903e4310a4" title="htp_connp_res_data" alt="" coords="5235,699,5373,725"/><area shape="rect" id="node36" href="htp__transaction_8c.html#a76675e7e250e24c1ac47c49b4181aff8" title="htp_tx_state_response\l_complete_ex" alt="" coords="3691,1003,3845,1045"/><area shape="rect" id="node42" href="htp__util_8c.html#af31ead38ae0851c906b72d93d9a29d5a" title="htp_connp_out_state\l_as_string" alt="" coords="5043,963,5186,1005"/><area shape="rect" id="node37" href="htp__response_8c.html#a779958ef7d3b3742be8b13170c0a8977" title="htp_connp_RES_FINALIZE" alt="" coords="3894,1069,4077,1096"/><area shape="rect" id="node45" href="htp__transaction_8h.html#adcbbf6a88718344b9cbe0c5f508a07ce" title="htp_tx_state_response\l_complete" alt="" coords="3908,1003,4063,1045"/><area shape="rect" id="node38" href="htp__response_8c.html#a35978034dd65239e911dd33f7c751332" title="htp_connp_RES_BODY\l_IDENTITY_CL_KNOWN" alt="" coords="4142,1003,4317,1045"/><area shape="rect" id="node44" href="htp__response_8c.html#a2c9732ce72c12038353a4483475e180c" title="htp_connp_RES_BODY\l_IDENTITY_STREAM_CLOSE" alt="" coords="4126,886,4333,927"/><area shape="rect" id="node39" href="htp__response_8c.html#a5bf0430de9af721db6e03c90ec63adf6" title="htp_connp_RES_BODY\l_DETERMINE" alt="" coords="4381,1054,4544,1095"/><area shape="rect" id="node40" href="htp__response_8c.html#a92faf3d17df2d54dd67bd7fbe80fb525" title="htp_connp_RES_HEADERS" alt="" coords="4593,1155,4783,1181"/><area shape="rect" id="node41" href="htp__response_8c.html#ab601564fadb2bb9ff37cd75b448a03d7" title="htp_connp_RES_BODY\l_CHUNKED_LENGTH" alt="" coords="4832,1093,4995,1134"/><area shape="rect" id="node43" href="htp__response_8c.html#a45043cdc1b581e62abbf2423be76ea2a" title="htp_connp_RES_LINE" alt="" coords="4836,971,4991,997"/><area shape="rect" id="node47" href="htp__request_8c.html#a2702260435d65d58ff1ef824cfdc1091" title="htp_connp_REQ_FINALIZE" alt="" coords="1457,557,1641,584"/><area shape="rect" id="node48" href="htp__request_8c.html#aa5ab1e26414167266d8d0b98eb712723" title="htp_connp_REQ_BODY\l_IDENTITY" alt="" coords="2635,462,2797,503"/><area shape="rect" id="node50" href="htp__transaction_8c.html#a9256c1eaab954ec27241d1ad51067b55" title="htp_tx_finalize" alt="" coords="1072,851,1179,877"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf2e99c5087b2ec07b11bf4df9e2073f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpart_part_finalize_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finalizes part processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00520">520</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr__builder_8c_source.html#l00058">bstr_builder_clear()</a>, <a class="el" href="bstr__builder_8c_source.html#l00097">bstr_builder_size()</a>, <a class="el" href="bstr__builder_8c_source.html#l00101">bstr_builder_to_str()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00120">htp_mpartp_t::current_part</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00135">htp_mpartp_t::current_part_mode</a>, <a class="el" href="htp_8h_source.html#l00125">htp_file_t::fd</a>, <a class="el" href="htp__multipart_8h_source.html#l00276">htp_multipart_part_t::file</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__multipart_8c_source.html#l00574">htp_mpartp_run_request_file_data_hook()</a>, <a class="el" href="htp__multipart_8h_source.html#l00077">HTP_MULTIPART_HAS_EPILOGUE</a>, <a class="el" href="htp__multipart_8h_source.html#l00091">HTP_MULTIPART_PART_AFTER_LAST_BOUNDARY</a>, <a class="el" href="htp__multipart_8h_source.html#l00152">HTP_MULTIPART_PART_INCOMPLETE</a>, <a class="el" href="htp__multipart_8h_source.html#l00124">HTP_MULTIPART_PART_UNKNOWN</a>, <a class="el" href="htp__multipart_8h_source.html#l00085">HTP_MULTIPART_SEEN_LAST_BOUNDARY</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00059">MODE_DATA</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart_8h_source.html#l00214">MULTIPART_PART_EPILOGUE</a>, <a class="el" href="htp__multipart_8h_source.html#l00208">MULTIPART_PART_FILE</a>, <a class="el" href="htp__multipart_8h_source.html#l00202">MULTIPART_PART_UNKNOWN</a>, <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00154">htp_mpartp_t::part_data_pieces</a>, <a class="el" href="htp__multipart_8h_source.html#l00253">htp_multipart_part_t::type</a>, and <a class="el" href="htp__multipart_8h_source.html#l00267">htp_multipart_part_t::value</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l01080">htp_mpartp_finalize()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_cgraph.png" border="0" usemap="#htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_cgraph" alt=""/></div>
<map name="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_cgraph" id="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a1b2387b545c3ebc9cfbeae4c3ede3e8b" title="bstr_builder_clear" alt="" coords="262,5,386,32"/><area shape="rect" id="node4" href="bstr__builder_8c.html#a015b1e7016ec84c36209f03ec96a7a49" title="bstr_builder_size" alt="" coords="264,56,384,83"/><area shape="rect" id="node5" href="bstr__builder_8c.html#aa20111ccd65d633649a4b4cf9b711954" title="bstr_builder_to_str" alt="" coords="259,107,389,133"/><area shape="rect" id="node10" href="htp__multipart_8c.html#a72b162a6bdf6226c5181a15ddf28ee41" title="htp_mpartp_run_request\l_file_data_hook" alt="" coords="243,158,405,199"/><area shape="rect" id="node3" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="477,5,550,32"/><area shape="rect" id="node6" href="bstr_8c.html#acbbec871f8fd06709d92af6892b264a2" title="bstr_add_noex" alt="" coords="460,60,567,87"/><area shape="rect" id="node9" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="474,111,553,137"/><area shape="rect" id="node7" href="bstr_8c.html#a5dc5d24b60cf123df96b274b7d5bb567" title="bstr_add_mem_noex" alt="" coords="622,60,765,87"/><area shape="rect" id="node8" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="814,60,925,87"/><area shape="rect" id="node11" href="htp__hooks_8c.html#a8981d368a73f78ddfb4ad1de1f4a5fc2" title="htp_hook_run_all" alt="" coords="453,165,573,192"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_icgraph.png" border="0" usemap="#htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_icgraph" alt=""/></div>
<map name="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_icgraph" id="htp__multipart_8c_adf2e99c5087b2ec07b11bf4df9e2073f_icgraph">
<area shape="rect" id="node2" href="htp__multipart_8h.html#a116c58436d2cbd3fdae8eba1f39d808c" title="htp_mpartp_finalize" alt="" coords="243,12,378,39"/><area shape="rect" id="node3" href="htp__private_8h.html#a7ec64e252d77945deded415a91bae392" title="htp_ch_multipart_callback\l_request_body_data" alt="" coords="427,5,600,46"/><area shape="rect" id="node4" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="648,5,821,46"/><area shape="rect" id="node5" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="870,5,1002,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a368c461de4ad8f9d864f5c29968e6f4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpart_part_handle_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles part data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_line</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00602">602</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr_8c_source.html#l00066">bstr_add_mem()</a>, <a class="el" href="bstr__builder_8c_source.html#l00052">bstr_builder_append_mem()</a>, <a class="el" href="bstr__builder_8c_source.html#l00058">bstr_builder_clear()</a>, <a class="el" href="bstr__builder_8c_source.html#l00097">bstr_builder_size()</a>, <a class="el" href="bstr__builder_8c_source.html#l00101">bstr_builder_to_str()</a>, <a class="el" href="bstr_8c_source.html#l00254">bstr_dup_mem()</a>, <a class="el" href="bstr_8c_source.html#l00281">bstr_free()</a>, <a class="el" href="bstr_8h_source.html#l00077">bstr_len</a>, <a class="el" href="bstr_8h_source.html#l00079">bstr_ptr</a>, <a class="el" href="util-decode-mime_8c_source.html#l00036">CR</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00135">htp_mpartp_t::current_part_mode</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00094">htp_mpartp_t::extract_dir</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00090">htp_mpartp_t::extract_files</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00092">htp_mpartp_t::extract_limit</a>, <a class="el" href="htp_8h_source.html#l00125">htp_file_t::fd</a>, <a class="el" href="htp__multipart_8h_source.html#l00276">htp_multipart_part_t::file</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00096">htp_mpartp_t::file_count</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__util_8c_source.html#l02051">fprint_raw_data()</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__multipart_8c_source.html#l00297">htp_mpart_part_process_headers()</a>, <a class="el" href="htp__multipart_8c_source.html#l00312">htp_mpartp_parse_header()</a>, <a class="el" href="htp__multipart_8c_source.html#l00574">htp_mpartp_run_request_file_data_hook()</a>, <a class="el" href="htp__multipart_8h_source.html#l00118">HTP_MULTIPART_PART_HEADER_FOLDING</a>, <a class="el" href="htp__multipart_8h_source.html#l00085">HTP_MULTIPART_SEEN_LAST_BOUNDARY</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, <a class="el" href="htp__multipart_8h_source.html#l00256">htp_multipart_part_t::len</a>, <a class="el" href="util-decode-mime_8c_source.html#l00037">LF</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00059">MODE_DATA</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00056">MODE_LINE</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart_8h_source.html#l00214">MULTIPART_PART_EPILOGUE</a>, <a class="el" href="htp__multipart_8h_source.html#l00208">MULTIPART_PART_FILE</a>, <a class="el" href="htp__multipart_8h_source.html#l00211">MULTIPART_PART_PREAMBLE</a>, <a class="el" href="htp__multipart_8h_source.html#l00205">MULTIPART_PART_TEXT</a>, <a class="el" href="htp__multipart_8h_source.html#l00202">MULTIPART_PART_UNKNOWN</a>, <a class="el" href="htp__multipart_8h_source.html#l00259">htp_multipart_part_t::name</a>, <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00154">htp_mpartp_t::part_data_pieces</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00145">htp_mpartp_t::part_header_pieces</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00147">htp_mpartp_t::pending_header_line</a>, <a class="el" href="htp_8h_source.html#l00122">htp_file_t::tmpname</a>, and <a class="el" href="htp__multipart_8h_source.html#l00253">htp_multipart_part_t::type</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a368c461de4ad8f9d864f5c29968e6f4a_cgraph.png" border="0" usemap="#htp__multipart_8c_a368c461de4ad8f9d864f5c29968e6f4a_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a368c461de4ad8f9d864f5c29968e6f4a_cgraph" id="htp__multipart_8c_a368c461de4ad8f9d864f5c29968e6f4a_cgraph">
<area shape="rect" id="node2" href="bstr_8c.html#a87094fb0fdfd15f430caa0e91d091511" title="bstr_add_mem" alt="" coords="274,337,382,364"/><area shape="rect" id="node6" href="bstr__builder_8c.html#a1d3f608e4787b2e01540b2e675fd3565" title="bstr_builder_append_mem" alt="" coords="241,100,415,126"/><area shape="rect" id="node9" href="bstr__builder_8c.html#a1b2387b545c3ebc9cfbeae4c3ede3e8b" title="bstr_builder_clear" alt="" coords="266,638,390,665"/><area shape="rect" id="node11" href="bstr__builder_8c.html#a015b1e7016ec84c36209f03ec96a7a49" title="bstr_builder_size" alt="" coords="268,841,388,868"/><area shape="rect" id="node12" href="bstr__builder_8c.html#aa20111ccd65d633649a4b4cf9b711954" title="bstr_builder_to_str" alt="" coords="263,286,393,313"/><area shape="rect" id="node7" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="706,81,814,108"/><area shape="rect" id="node10" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="723,740,797,766"/><area shape="rect" id="node15" href="htp__private_8h.html#a0ec8330cb428004d467f69e7c6acdb84" title="fprint_raw_data" alt="" coords="273,892,383,918"/><area shape="rect" id="node18" href="htp__multipart_8c.html#a6acf2acff1d8828fba0df30a9397108c" title="htp_mpart_part_process\l_headers" alt="" coords="247,196,409,238"/><area shape="rect" id="node26" href="htp__multipart_8c.html#ade5c03a799c0f5af2319900fe78a98e0" title="htp_mpartp_parse_header" alt="" coords="242,461,414,488"/><area shape="rect" id="node36" href="htp__multipart_8c.html#a72b162a6bdf6226c5181a15ddf28ee41" title="htp_mpartp_run_request\l_file_data_hook" alt="" coords="247,943,409,984"/><area shape="rect" id="node3" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="1105,237,1215,264"/><area shape="rect" id="node4" href="bstr_8c.html#a51bc377ac30a1092e84a4c3ab3d289f9" title="bstr_expand" alt="" coords="505,258,599,285"/><area shape="rect" id="node5" href="bstr_8c.html#ac28786b1f330ae5992293ba028db9936" title="bstr_adjust_size" alt="" coords="701,309,819,336"/><area shape="rect" id="node8" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="1121,56,1199,82"/><area shape="rect" id="node13" href="bstr_8c.html#acbbec871f8fd06709d92af6892b264a2" title="bstr_add_noex" alt="" coords="499,309,605,336"/><area shape="rect" id="node14" href="bstr_8c.html#a5dc5d24b60cf123df96b274b7d5bb567" title="bstr_add_mem_noex" alt="" coords="689,360,831,386"/><area shape="rect" id="node16" href="htp__private_8h.html#a9bd7382b55286e62a10aac00bc630af1" title="fprint_raw_data_ex" alt="" coords="486,892,618,918"/><area shape="rect" id="node17" href="suricata-common_8h.html#a7e9938e922f1dfd71bc01995bc2b7777" title="strlcat" alt="" coords="731,892,789,918"/><area shape="rect" id="node19" href="htp__multipart_8c.html#ac51272765ee1a5c1b70980a0b96d4ece" title="htp_mpart_part_parse_c_d" alt="" coords="464,157,640,184"/><area shape="rect" id="node20" href="htp__table_8c.html#ab9af397f9e822cad4b9cd89c46ff0391" title="htp_table_get_c" alt="" coords="703,258,817,285"/><area shape="rect" id="node23" href="bstr_8c.html#a551bf6b9c6e525d0dab1f88333282e49" title="bstr_index_of_c" alt="" coords="703,157,817,184"/><area shape="rect" id="node21" href="bstr_8c.html#a37ec2adc98a8251ee1ab49cf9f6f5050" title="bstr_cmp_c_nocase" alt="" coords="880,562,1019,589"/><area shape="rect" id="node22" href="bstr_8c.html#a8b64cdb63293a1ca608bc2c735c20e7d" title="bstr_util_cmp_mem_nocase" alt="" coords="1067,588,1253,614"/><area shape="rect" id="node24" href="bstr_8c.html#aa238aa33ea17945c0c9a39edb92b5aca" title="bstr_index_of_mem" alt="" coords="881,157,1017,184"/><area shape="rect" id="node25" href="bstr_8c.html#ab4b59f20a0dd5394b5d473489266876e" title="bstr_util_mem_index\l_of_mem" alt="" coords="1089,150,1231,191"/><area shape="rect" id="node27" href="htp__private_8h.html#a8154aaa13d12e1fea9b066e0881bd125" title="htp_is_space" alt="" coords="503,360,601,386"/><area shape="rect" id="node28" href="htp__private_8h.html#a01068fcd4418a90ea81a2ad5e4eb8c81" title="htp_is_lws" alt="" coords="510,461,594,488"/><area shape="rect" id="node29" href="htp__private_8h.html#a7a0e47fdda476b38045a7d3406fb51ee" title="htp_is_token" alt="" coords="504,512,600,538"/><area shape="rect" id="node31" href="htp__table_8c.html#ac852ef60754016fac1c214ea1d771025" title="htp_table_get" alt="" coords="710,613,810,640"/><area shape="rect" id="node33" href="htp__table_8c.html#a80ff6b5f23273fa08d13d8d2d0efc4a0" title="htp_table_add" alt="" coords="501,664,603,690"/><area shape="rect" id="node30" href="htp__private_8h.html#a238c39a6d7fd7f35735f9c97a1b2aa66" title="htp_is_separator" alt="" coords="701,512,819,538"/><area shape="rect" id="node32" href="bstr_8c.html#a4d6765fb2a88a0f2bac4e41bee24c294" title="bstr_cmp_nocase" alt="" coords="887,613,1012,640"/><area shape="rect" id="node34" href="bstr_8c.html#ab4fc824d8df74ad6863a085f3901d30f" title="bstr_dup" alt="" coords="724,664,796,690"/><area shape="rect" id="node35" href="bstr_8c.html#abaf68b4b27be54655cba0d74c24646c1" title="bstr_dup_ex" alt="" coords="903,309,996,336"/><area shape="rect" id="node37" href="htp__hooks_8c.html#a8981d368a73f78ddfb4ad1de1f4a5fc2" title="htp_hook_run_all" alt="" coords="492,950,612,977"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac51272765ee1a5c1b70980a0b96d4ece"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpart_part_parse_c_d </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses the Content-Disposition part header.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success (header found and parsed), HTP_DECLINED if there is no C-D header or if it could not be processed, and HTP_ERROR on fatal error. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00101">101</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr_8c_source.html#l00254">bstr_dup_mem()</a>, <a class="el" href="bstr_8c_source.html#l00290">bstr_index_of_c()</a>, <a class="el" href="bstr_8h_source.html#l00077">bstr_len</a>, <a class="el" href="bstr_8h_source.html#l00079">bstr_ptr</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00050">CD_PARAM_FILENAME</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00049">CD_PARAM_NAME</a>, <a class="el" href="htp_8h_source.html#l00125">htp_file_t::fd</a>, <a class="el" href="htp__multipart_8h_source.html#l00276">htp_multipart_part_t::file</a>, <a class="el" href="htp_8h_source.html#l00116">htp_file_t::filename</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__multipart_8h_source.html#l00273">htp_multipart_part_t::headers</a>, <a class="el" href="htp__core_8h_source.html#l00078">HTP_DECLINED</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__core_8h_source.html#l00183">HTP_FILE_MULTIPART</a>, <a class="el" href="htp__multipart_8h_source.html#l00139">HTP_MULTIPART_CD_PARAM_REPEATED</a>, <a class="el" href="htp__multipart_8h_source.html#l00142">HTP_MULTIPART_CD_PARAM_UNKNOWN</a>, <a class="el" href="htp__multipart_8h_source.html#l00145">HTP_MULTIPART_CD_SYNTAX_INVALID</a>, <a class="el" href="htp__multipart_8h_source.html#l00124">HTP_MULTIPART_PART_UNKNOWN</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="htp__table_8c_source.html#l00205">htp_table_get_c()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart_8h_source.html#l00259">htp_multipart_part_t::name</a>, <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>, <a class="el" href="htp_8h_source.html#l00113">htp_file_t::source</a>, and <a class="el" href="htp_8h_source.html#l00176">htp_header_t::value</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00297">htp_mpart_part_process_headers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_cgraph.png" border="0" usemap="#htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_cgraph" alt=""/></div>
<map name="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_cgraph" id="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_cgraph">
<area shape="rect" id="node2" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="233,56,341,83"/><area shape="rect" id="node5" href="bstr_8c.html#a551bf6b9c6e525d0dab1f88333282e49" title="bstr_index_of_c" alt="" coords="229,107,344,133"/><area shape="rect" id="node8" href="htp__table_8c.html#ab9af397f9e822cad4b9cd89c46ff0391" title="htp_table_get_c" alt="" coords="229,159,344,185"/><area shape="rect" id="node3" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="406,5,517,32"/><area shape="rect" id="node4" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="422,56,501,83"/><area shape="rect" id="node6" href="bstr_8c.html#aa238aa33ea17945c0c9a39edb92b5aca" title="bstr_index_of_mem" alt="" coords="393,107,529,133"/><area shape="rect" id="node7" href="bstr_8c.html#ab4b59f20a0dd5394b5d473489266876e" title="bstr_util_mem_index\l_of_mem" alt="" coords="601,98,743,139"/><area shape="rect" id="node9" href="bstr_8c.html#a37ec2adc98a8251ee1ab49cf9f6f5050" title="bstr_cmp_c_nocase" alt="" coords="392,160,531,187"/><area shape="rect" id="node10" href="bstr_8c.html#a8b64cdb63293a1ca608bc2c735c20e7d" title="bstr_util_cmp_mem_nocase" alt="" coords="579,164,765,191"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_icgraph.png" border="0" usemap="#htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_icgraph" alt=""/></div>
<map name="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_icgraph" id="htp__multipart_8c_ac51272765ee1a5c1b70980a0b96d4ece_icgraph">
<area shape="rect" id="node2" href="htp__multipart__private_8h.html#a6acf2acff1d8828fba0df30a9397108c" title="htp_mpart_part_process\l_headers" alt="" coords="229,5,392,46"/><area shape="rect" id="node3" href="htp__multipart__private_8h.html#a368c461de4ad8f9d864f5c29968e6f4a" title="htp_mpart_part_handle_data" alt="" coords="440,12,627,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6acf2acff1d8828fba0df30a9397108c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpart_part_process_headers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processes part headers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00297">297</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__multipart_8c_source.html#l00101">htp_mpart_part_parse_c_d()</a>, and <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00602">htp_mpart_part_handle_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_cgraph.png" border="0" usemap="#htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_cgraph" id="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_cgraph">
<area shape="rect" id="node2" href="htp__multipart_8c.html#ac51272765ee1a5c1b70980a0b96d4ece" title="htp_mpart_part_parse_c_d" alt="" coords="216,107,392,133"/><area shape="rect" id="node3" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="443,56,551,83"/><area shape="rect" id="node6" href="bstr_8c.html#a551bf6b9c6e525d0dab1f88333282e49" title="bstr_index_of_c" alt="" coords="440,107,555,133"/><area shape="rect" id="node9" href="htp__table_8c.html#ab9af397f9e822cad4b9cd89c46ff0391" title="htp_table_get_c" alt="" coords="440,159,555,185"/><area shape="rect" id="node4" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="617,5,727,32"/><area shape="rect" id="node5" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="633,56,711,83"/><area shape="rect" id="node7" href="bstr_8c.html#aa238aa33ea17945c0c9a39edb92b5aca" title="bstr_index_of_mem" alt="" coords="604,107,740,133"/><area shape="rect" id="node8" href="bstr_8c.html#ab4b59f20a0dd5394b5d473489266876e" title="bstr_util_mem_index\l_of_mem" alt="" coords="811,98,954,139"/><area shape="rect" id="node10" href="bstr_8c.html#a37ec2adc98a8251ee1ab49cf9f6f5050" title="bstr_cmp_c_nocase" alt="" coords="603,160,741,187"/><area shape="rect" id="node11" href="bstr_8c.html#a8b64cdb63293a1ca608bc2c735c20e7d" title="bstr_util_cmp_mem_nocase" alt="" coords="790,164,975,191"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_icgraph.png" border="0" usemap="#htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_icgraph" id="htp__multipart_8c_a6acf2acff1d8828fba0df30a9397108c_icgraph">
<area shape="rect" id="node2" href="htp__multipart__private_8h.html#a368c461de4ad8f9d864f5c29968e6f4a" title="htp_mpart_part_handle_data" alt="" coords="216,12,403,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33c3b3a82d145b68e450333c6e0c19ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a>* htp_mpartp_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__cfg__t.html">htp_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> *&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new multipart/form-data parser. On a successful invocation, the ownership of the boundary parameter is transferred to the parser.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cfg</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boundary</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New parser instance, or NULL on memory allocation failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00885">885</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart__private_8h_source.html#l00143">htp_mpartp_t::boundary_pieces</a>, <a class="el" href="bstr__builder_8c_source.html#l00070">bstr_builder_create()</a>, <a class="el" href="bstr_8c_source.html#l00281">bstr_free()</a>, <a class="el" href="bstr_8h_source.html#l00077">bstr_len</a>, <a class="el" href="bstr_8h_source.html#l00079">bstr_ptr</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00088">htp_mpartp_t::cfg</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00052">DEFAULT_FILE_EXTRACT_LIMIT</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00094">htp_mpartp_t::extract_dir</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00090">htp_mpartp_t::extract_files</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00092">htp_mpartp_t::extract_limit</a>, <a class="el" href="htp__config__private_8h_source.html#l00191">htp_cfg_t::extract_request_files</a>, <a class="el" href="htp__config__private_8h_source.html#l00194">htp_cfg_t::extract_request_files_limit</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">flags</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00102">htp_mpartp_t::handle_boundary</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00100">htp_mpartp_t::handle_data</a>, <a class="el" href="htp__list_8h_source.html#l00050">htp_list_create</a>, <a class="el" href="htp__multipart_8c_source.html#l00944">htp_mpartp_destroy()</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00109">htp_mpartp_t::parser_state</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00154">htp_mpartp_t::part_data_pieces</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00145">htp_mpartp_t::part_header_pieces</a>, <a class="el" href="htp__multipart_8h_source.html#l00239">htp_multipart_t::parts</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00064">STATE_INIT</a>, and <a class="el" href="htp__config__private_8h_source.html#l00197">htp_cfg_t::tmpdir</a>.</p>

<p>Referenced by <a class="el" href="htp__content__handlers_8c_source.html#l00244">htp_ch_multipart_callback_request_headers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_cgraph.png" border="0" usemap="#htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_cgraph" id="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a6cda5d2f8e4a0529b31f67eff4f65a51" title="bstr_builder_create" alt="" coords="187,5,319,32"/><area shape="rect" id="node3" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="953,157,1026,184"/><area shape="rect" id="node4" href="htp__multipart_8c.html#aed39a287d90d4fa9ab464444c77697c4" title="htp_mpartp_destroy" alt="" coords="185,132,322,159"/><area shape="rect" id="node5" href="bstr__builder_8c.html#a4c90e3030e9ab7bf81caf09a76c57ec9" title="bstr_builder_destroy" alt="" coords="765,107,904,133"/><area shape="rect" id="node6" href="htp__multipart_8c.html#afc3a6b77b984cb093dbcd6370c42b887" title="htp_mpart_part_destroy" alt="" coords="371,259,530,285"/><area shape="rect" id="node7" href="htp__table_8c.html#a408659a54a7dd0e715be8bab67a107e6" title="htp_table_destroy" alt="" coords="585,259,711,285"/><area shape="rect" id="node9" href="htp__table_8c.html#aa2c2702311ce4bbb7614133098c50b4e" title="htp_table_get_index" alt="" coords="579,309,717,336"/><area shape="rect" id="node10" href="htp__table_8c.html#aa1f72cd85c808b758b6efd6ea0351524" title="htp_table_size" alt="" coords="595,360,701,387"/><area shape="rect" id="node8" href="htp__table_8c.html#ac14ab63ac2bc19ac3f61d324b484dd2e" title="htp_table_clear" alt="" coords="779,259,890,285"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_icgraph.png" border="0" usemap="#htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_icgraph" id="htp__multipart_8c_a33c3b3a82d145b68e450333c6e0c19ac_icgraph">
<area shape="rect" id="node2" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="184,5,357,46"/><area shape="rect" id="node3" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="406,5,538,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aed39a287d90d4fa9ab464444c77697c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void htp_mpartp_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td>
          <td class="paramname"><em>parser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys the provided parser.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parser</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00944">944</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart_8h_source.html#l00230">htp_multipart_t::boundary</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00143">htp_mpartp_t::boundary_pieces</a>, <a class="el" href="bstr__builder_8c_source.html#l00083">bstr_builder_destroy()</a>, <a class="el" href="bstr_8c_source.html#l00281">bstr_free()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00178">htp_mpartp_t::gave_up_data</a>, <a class="el" href="htp__list_8h_source.html#l00052">htp_list_destroy</a>, <a class="el" href="htp__list_8h_source.html#l00053">htp_list_get</a>, <a class="el" href="htp__list_8h_source.html#l00057">htp_list_size</a>, <a class="el" href="htp__multipart_8c_source.html#l00477">htp_mpart_part_destroy()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00154">htp_mpartp_t::part_data_pieces</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00145">htp_mpartp_t::part_header_pieces</a>, <a class="el" href="htp__multipart_8h_source.html#l00239">htp_multipart_t::parts</a>, and <a class="el" href="htp__multipart__private_8h_source.html#l00147">htp_mpartp_t::pending_header_line</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00885">htp_mpartp_create()</a>, and <a class="el" href="htp__transaction_8c_source.html#l00118">htp_tx_destroy_incomplete()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_cgraph.png" border="0" usemap="#htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_cgraph" alt=""/></div>
<map name="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_cgraph" id="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a4c90e3030e9ab7bf81caf09a76c57ec9" title="bstr_builder_destroy" alt="" coords="587,5,725,32"/><area shape="rect" id="node3" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="774,81,847,108"/><area shape="rect" id="node4" href="htp__multipart_8c.html#afc3a6b77b984cb093dbcd6370c42b887" title="htp_mpart_part_destroy" alt="" coords="193,157,351,184"/><area shape="rect" id="node5" href="htp__table_8c.html#a408659a54a7dd0e715be8bab67a107e6" title="htp_table_destroy" alt="" coords="407,157,532,184"/><area shape="rect" id="node7" href="htp__table_8c.html#aa2c2702311ce4bbb7614133098c50b4e" title="htp_table_get_index" alt="" coords="400,208,539,235"/><area shape="rect" id="node8" href="htp__table_8c.html#aa1f72cd85c808b758b6efd6ea0351524" title="htp_table_size" alt="" coords="416,259,523,285"/><area shape="rect" id="node6" href="htp__table_8c.html#ac14ab63ac2bc19ac3f61d324b484dd2e" title="htp_table_clear" alt="" coords="601,157,711,184"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_icgraph.png" border="0" usemap="#htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_icgraph" alt=""/></div>
<map name="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_icgraph" id="htp__multipart_8c_aed39a287d90d4fa9ab464444c77697c4_icgraph">
<area shape="rect" id="node2" href="htp__multipart_8h.html#a33c3b3a82d145b68e450333c6e0c19ac" title="htp_mpartp_create" alt="" coords="216,198,347,225"/><area shape="rect" id="node5" href="htp__transaction_8c.html#a0d9bedcb7fd819340ebd8e8271263191" title="htp_tx_destroy_incomplete" alt="" coords="192,278,371,305"/><area shape="rect" id="node3" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="419,176,592,217"/><area shape="rect" id="node4" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="650,176,782,217"/><area shape="rect" id="node6" href="htp__connection__private_8h.html#a9c3166bd9ba64e90d9b3cf98ebb61a8d" title="htp_conn_destroy" alt="" coords="443,242,568,269"/><area shape="rect" id="node15" href="htp__transaction_8h.html#a38191123e58ad54c815b5291b38ae1ae" title="htp_tx_create" alt="" coords="455,367,556,394"/><area shape="rect" id="node49" href="htp__transaction_8h.html#a92daf5a21d1005ed658239203bab72e2" title="htp_tx_destroy" alt="" coords="451,293,559,319"/><area shape="rect" id="node7" href="htp__connection__parser_8h.html#a8716f61f158d3d39552dbdaccc4157f2" title="htp_connp_destroy_all" alt="" coords="640,242,792,269"/><area shape="rect" id="node8" href="group__httplayer.html#ga4d27f058e59815cc3ed5ba1d7f8acf61" title="Function to frees the HTTP state memory and also frees the HTTP connection parser memory which was us..." alt="" coords="864,211,971,238"/><area shape="rect" id="node9" href="group__httplayer.html#ga23aaf4c00574fa636459e4377429ac13" title="Register the HTTP protocol and state handling functions to APP layer of the engine. " alt="" coords="1043,195,1186,222"/><area shape="rect" id="node10" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="1235,173,1447,215"/><area shape="rect" id="node11" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="1537,159,1647,186"/><area shape="rect" id="node12" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1783,149,1881,175"/><area shape="rect" id="node13" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1781,199,1883,226"/><area shape="rect" id="node14" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="1755,98,1909,125"/><area shape="rect" id="node16" href="htp__connection__parser_8h.html#ae9f11134051280a0127eaa26c63b0c4d" title="htp_connp_tx_create" alt="" coords="645,429,787,455"/><area shape="rect" id="node17" href="htp__request_8c.html#ae4a3e37c2a1e728db9f80cca8e53c6fa" title="htp_connp_REQ_IDLE" alt="" coords="840,459,995,486"/><area shape="rect" id="node18" href="htp__connection__parser_8h.html#af87403d33d361ee171e6e098a233ef3d" title="htp_connp_create" alt="" coords="3497,318,3623,345"/><area shape="rect" id="node19" href="htp__request_8c.html#a9bb99f12643c2be1ff5a74bce80aab47" title="htp_connp_REQ_CONNECT\l_PROBE_DATA" alt="" coords="1245,589,1437,631"/><area shape="rect" id="node27" href="htp__request_8c.html#a2212edc93dc47fd615a30297f8faad60" title="htp_connp_req_data" alt="" coords="3085,646,3224,673"/><area shape="rect" id="node46" href="htp__transaction_8h.html#a6b642aabfa0688477a73138803e8a96c" title="htp_tx_state_request\l_complete" alt="" coords="1043,301,1187,343"/><area shape="rect" id="node26" href="htp__util_8c.html#a81fca26cac57032120c6796bda2a660c" title="htp_connp_in_state\l_as_string" alt="" coords="2885,639,3019,680"/><area shape="rect" id="node20" href="htp__request_8c.html#ac6178cc04104e5e5e469489f5e77c04d" title="htp_connp_REQ_CONNECT\l_WAIT_RESPONSE" alt="" coords="1496,644,1688,685"/><area shape="rect" id="node21" href="htp__request_8c.html#a3e8c194c19ebdaaa21fe107e328e3a75" title="htp_connp_REQ_CONNECT\l_CHECK" alt="" coords="1736,645,1928,687"/><area shape="rect" id="node22" href="htp__transaction_8h.html#aed95ccccf477ee8adeb83291a2104156" title="htp_tx_state_request\l_headers" alt="" coords="1976,588,2120,629"/><area shape="rect" id="node23" href="htp__request_8c.html#af7b83f68a53afa0a16e0d78300b63a46" title="htp_connp_REQ_HEADERS" alt="" coords="2169,595,2359,622"/><area shape="rect" id="node24" href="htp__request_8c.html#a78975b59c610a8b5cd834b6c7ad7524b" title="htp_connp_REQ_BODY\l_CHUNKED_LENGTH" alt="" coords="2427,588,2589,629"/><area shape="rect" id="node29" href="htp__request_8c.html#a801f66183cf5693361eca92d66607314" title="htp_connp_REQ_PROTOCOL" alt="" coords="2409,369,2607,395"/><area shape="rect" id="node25" href="htp__request_8c.html#ad207aff5c7e4a68d2a539ffd9e3fd623" title="htp_connp_REQ_BODY\l_DETERMINE" alt="" coords="2660,580,2823,621"/><area shape="rect" id="node28" href="htp__connection__parser_8h.html#acc7723b7ab867bfde9d5ef78c1faf446" title="htp_connp_close" alt="" coords="5437,565,5557,591"/><area shape="rect" id="node30" href="htp__transaction_8h.html#aaaf7174643f67cdb075d45333b6fd7b5" title="htp_tx_state_request_line" alt="" coords="2656,369,2827,395"/><area shape="rect" id="node31" href="htp__request_8c.html#af6eee641bbe7ef5f73ebc1288f1450ad" title="htp_connp_REQ_LINE\l_complete" alt="" coords="2875,380,3029,421"/><area shape="rect" id="node32" href="htp__transaction_8h.html#a524d59cd184104370ade58fb200f2379" title="htp_tx_state_response\l_start" alt="" coords="3077,401,3232,443"/><area shape="rect" id="node33" href="htp__response_8c.html#a1b95d113c24de4c93db72889c738275d" title="htp_connp_RES_IDLE" alt="" coords="3280,470,3435,497"/><area shape="rect" id="node34" href="htp__response_8c.html#a7bf7c40f55013deddf338b903e4310a4" title="htp_connp_res_data" alt="" coords="5251,521,5389,547"/><area shape="rect" id="node35" href="htp__transaction_8c.html#a76675e7e250e24c1ac47c49b4181aff8" title="htp_tx_state_response\l_complete_ex" alt="" coords="3483,243,3637,284"/><area shape="rect" id="node42" href="htp__util_8c.html#af31ead38ae0851c906b72d93d9a29d5a" title="htp_connp_out_state\l_as_string" alt="" coords="5059,235,5202,276"/><area shape="rect" id="node36" href="htp__response_8c.html#a779958ef7d3b3742be8b13170c0a8977" title="htp_connp_RES_FINALIZE" alt="" coords="3686,250,3869,277"/><area shape="rect" id="node45" href="htp__transaction_8h.html#adcbbf6a88718344b9cbe0c5f508a07ce" title="htp_tx_state_response\l_complete" alt="" coords="3700,184,3855,225"/><area shape="rect" id="node37" href="htp__response_8c.html#a35978034dd65239e911dd33f7c751332" title="htp_connp_RES_BODY\l_IDENTITY_CL_KNOWN" alt="" coords="3934,137,4109,179"/><area shape="rect" id="node44" href="htp__response_8c.html#a2c9732ce72c12038353a4483475e180c" title="htp_connp_RES_BODY\l_IDENTITY_STREAM_CLOSE" alt="" coords="3918,311,4125,352"/><area shape="rect" id="node38" href="htp__response_8c.html#a5bf0430de9af721db6e03c90ec63adf6" title="htp_connp_RES_BODY\l_DETERMINE" alt="" coords="4173,188,4336,229"/><area shape="rect" id="node39" href="htp__response_8c.html#a92faf3d17df2d54dd67bd7fbe80fb525" title="htp_connp_RES_HEADERS" alt="" coords="4385,217,4575,243"/><area shape="rect" id="node40" href="htp__response_8c.html#ab601564fadb2bb9ff37cd75b448a03d7" title="htp_connp_RES_BODY\l_CHUNKED_LENGTH" alt="" coords="4624,180,4787,221"/><area shape="rect" id="node43" href="htp__response_8c.html#a45043cdc1b581e62abbf2423be76ea2a" title="htp_connp_RES_LINE" alt="" coords="4628,318,4783,345"/><area shape="rect" id="node41" href="htp__response_8c.html#a028530726a98edc10fc5adf8a050b349" title="htp_connp_RES_BODY\l_CHUNKED_DATA_END" alt="" coords="4835,151,5011,192"/><area shape="rect" id="node47" href="htp__request_8c.html#a2702260435d65d58ff1ef824cfdc1091" title="htp_connp_REQ_FINALIZE" alt="" coords="1249,486,1433,513"/><area shape="rect" id="node48" href="htp__request_8c.html#aa5ab1e26414167266d8d0b98eb712723" title="htp_connp_REQ_BODY\l_IDENTITY" alt="" coords="2427,420,2589,461"/><area shape="rect" id="node50" href="htp__transaction_8c.html#a9256c1eaab954ec27241d1ad51067b55" title="htp_tx_finalize" alt="" coords="864,293,971,319"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a116c58436d2cbd3fdae8eba1f39d808c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpartp_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td>
          <td class="paramname"><em>parser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finalize parsing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parser</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l01080">1080</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart__private_8h_source.html#l00143">htp_mpartp_t::boundary_pieces</a>, <a class="el" href="bstr__builder_8c_source.html#l00058">bstr_builder_clear()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00120">htp_mpartp_t::current_part</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__multipart_8c_source.html#l00520">htp_mpart_part_finalize_data()</a>, <a class="el" href="htp__multipart_8h_source.html#l00099">HTP_MULTIPART_INCOMPLETE</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart_8h_source.html#l00214">MULTIPART_PART_EPILOGUE</a>, and <a class="el" href="htp__multipart_8h_source.html#l00253">htp_multipart_part_t::type</a>.</p>

<p>Referenced by <a class="el" href="htp__content__handlers_8c_source.html#l00193">htp_ch_multipart_callback_request_body_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_cgraph.png" border="0" usemap="#htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_cgraph" id="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a1b2387b545c3ebc9cfbeae4c3ede3e8b" title="bstr_builder_clear" alt="" coords="446,5,570,32"/><area shape="rect" id="node4" href="htp__multipart_8c.html#adf2e99c5087b2ec07b11bf4df9e2073f" title="htp_mpart_part_finalize_data" alt="" coords="189,56,379,83"/><area shape="rect" id="node3" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="661,5,734,32"/><area shape="rect" id="node5" href="bstr__builder_8c.html#a015b1e7016ec84c36209f03ec96a7a49" title="bstr_builder_size" alt="" coords="448,56,568,83"/><area shape="rect" id="node6" href="bstr__builder_8c.html#aa20111ccd65d633649a4b4cf9b711954" title="bstr_builder_to_str" alt="" coords="443,107,573,133"/><area shape="rect" id="node11" href="htp__multipart_8c.html#a72b162a6bdf6226c5181a15ddf28ee41" title="htp_mpartp_run_request\l_file_data_hook" alt="" coords="427,158,589,199"/><area shape="rect" id="node7" href="bstr_8c.html#acbbec871f8fd06709d92af6892b264a2" title="bstr_add_noex" alt="" coords="644,60,751,87"/><area shape="rect" id="node10" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="658,111,737,137"/><area shape="rect" id="node8" href="bstr_8c.html#a5dc5d24b60cf123df96b274b7d5bb567" title="bstr_add_mem_noex" alt="" coords="806,60,949,87"/><area shape="rect" id="node9" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="998,60,1109,87"/><area shape="rect" id="node12" href="htp__hooks_8c.html#a8981d368a73f78ddfb4ad1de1f4a5fc2" title="htp_hook_run_all" alt="" coords="637,165,757,192"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_icgraph.png" border="0" usemap="#htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_icgraph" id="htp__multipart_8c_a116c58436d2cbd3fdae8eba1f39d808c_icgraph">
<area shape="rect" id="node2" href="htp__private_8h.html#a7ec64e252d77945deded415a91bae392" title="htp_ch_multipart_callback\l_request_body_data" alt="" coords="189,5,363,46"/><area shape="rect" id="node3" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="411,5,584,46"/><area shape="rect" id="node4" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="633,5,765,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a25467cb2d2fde659bd4536e795f9873e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpartp_find_boundary </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> *&#160;</td>
          <td class="paramname"><em>content_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bstr_8h.html#ad24e3759c8d17c13ae2f05d9dde4d0b6">bstr</a> **&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>multipart_flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Looks for boundary in the supplied Content-Type request header. The extracted boundary will be allocated on the heap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">content_type</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">boundary</td><td></td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">multipart_flags</td><td>Multipart flags, which are not compatible from general LibHTP flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success (boundary found), HTP_DECLINED if boundary was not found, and HTP_ERROR on failure. Flags may be set on HTP_OK and HTP_DECLINED. For example, if a boundary could not be extracted but there is indication that one is present, HTP_MULTIPART_HBOUNDARY_INVALID will be set. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l01472">1472</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr_8c_source.html#l00118">bstr_begins_with_c()</a>, <a class="el" href="bstr_8c_source.html#l00254">bstr_dup_mem()</a>, <a class="el" href="bstr_8c_source.html#l00294">bstr_index_of_c_nocase()</a>, <a class="el" href="bstr_8h_source.html#l00077">bstr_len</a>, <a class="el" href="bstr_8h_source.html#l00079">bstr_ptr</a>, <a class="el" href="htp__util_8c_source.html#l02039">fprint_bstr()</a>, <a class="el" href="htp__core_8h_source.html#l00078">HTP_DECLINED</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__util_8c_source.html#l00154">htp_is_space()</a>, <a class="el" href="htp__multipart_8h_source.html#l00102">HTP_MULTIPART_HBOUNDARY_INVALID</a>, <a class="el" href="htp__multipart_8h_source.html#l00109">HTP_MULTIPART_HBOUNDARY_UNUSUAL</a>, and <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>.</p>

<p>Referenced by <a class="el" href="htp__content__handlers_8c_source.html#l00244">htp_ch_multipart_callback_request_headers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_cgraph.png" border="0" usemap="#htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_cgraph" id="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_cgraph">
<area shape="rect" id="node2" href="bstr_8c.html#a4bff516fbecb8a3863502a8dfd95f50b" title="bstr_begins_with_c" alt="" coords="243,31,378,57"/><area shape="rect" id="node4" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="257,107,365,133"/><area shape="rect" id="node7" href="bstr_8c.html#a6b6507af551bc83e9b7deed498b05a6d" title="bstr_index_of_c_nocase" alt="" coords="229,157,392,184"/><area shape="rect" id="node10" href="htp__private_8h.html#a1dfe07ee3d981b6bfaaf6c88d01224b0" title="fprint_bstr" alt="" coords="271,208,351,235"/><area shape="rect" id="node13" href="htp__private_8h.html#a8154aaa13d12e1fea9b066e0881bd125" title="htp_is_space" alt="" coords="261,259,360,285"/><area shape="rect" id="node3" href="bstr_8c.html#ab7d6c173fd90255dffac7bd702048563" title="bstr_begins_with_mem" alt="" coords="455,5,611,32"/><area shape="rect" id="node5" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="478,56,589,83"/><area shape="rect" id="node6" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="494,107,573,133"/><area shape="rect" id="node8" href="bstr_8c.html#a14a2c058f22c778fe533be58c1bf5513" title="bstr_index_of_mem_nocase" alt="" coords="441,157,626,184"/><area shape="rect" id="node9" href="bstr_8c.html#aad332cef17534e512e8cffa83a504b3b" title="bstr_util_mem_index\l_of_mem_nocase" alt="" coords="675,147,818,189"/><area shape="rect" id="node11" href="htp__private_8h.html#a9bd7382b55286e62a10aac00bc630af1" title="fprint_raw_data_ex" alt="" coords="467,209,599,236"/><area shape="rect" id="node12" href="suricata-common_8h.html#a7e9938e922f1dfd71bc01995bc2b7777" title="strlcat" alt="" coords="717,213,776,240"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_icgraph.png" border="0" usemap="#htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_icgraph" id="htp__multipart_8c_a25467cb2d2fde659bd4536e795f9873e_icgraph">
<area shape="rect" id="node2" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="229,5,403,46"/><area shape="rect" id="node3" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="451,5,583,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92b1e30aed18fe59ec122fb65519d526"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhtp__multipart__t.html">htp_multipart_t</a>* htp_mpartp_get_multipart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td>
          <td class="paramname"><em>parser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the multipart structure created by the parser.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parser</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The main multipart structure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00061">61</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>.</p>

<p>Referenced by <a class="el" href="htp__content__handlers_8c_source.html#l00193">htp_ch_multipart_callback_request_body_data()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a92b1e30aed18fe59ec122fb65519d526_icgraph.png" border="0" usemap="#htp__multipart_8c_a92b1e30aed18fe59ec122fb65519d526_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a92b1e30aed18fe59ec122fb65519d526_icgraph" id="htp__multipart_8c_a92b1e30aed18fe59ec122fb65519d526_icgraph">
<area shape="rect" id="node2" href="htp__private_8h.html#a7ec64e252d77945deded415a91bae392" title="htp_ch_multipart_callback\l_request_body_data" alt="" coords="224,5,397,46"/><area shape="rect" id="node3" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="445,5,619,46"/><area shape="rect" id="node4" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="667,5,799,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4f343a477e74a4e91636763f3c74129d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpartp_parse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__mpartp__t.html">htp_mpartp_t</a> *&#160;</td>
          <td class="paramname"><em>parser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses a chunk of multipart/form-data data. This function should be called as many times as necessary until all data has been consumed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">parser</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_ERROR on failure. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l01099">1099</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart_8h_source.html#l00230">htp_multipart_t::boundary</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00160">htp_mpartp_t::boundary_candidate_pos</a>, <a class="el" href="htp__multipart_8h_source.html#l00236">htp_multipart_t::boundary_count</a>, <a class="el" href="htp__multipart_8h_source.html#l00233">htp_multipart_t::boundary_len</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00115">htp_mpartp_t::boundary_match_pos</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00143">htp_mpartp_t::boundary_pieces</a>, <a class="el" href="bstr__builder_8c_source.html#l00052">bstr_builder_append_mem()</a>, <a class="el" href="util-decode-mime_8c_source.html#l00036">CR</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00171">htp_mpartp_t::cr_aside</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00135">htp_mpartp_t::current_part_mode</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__util_8c_source.html#l02051">fprint_raw_data()</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00102">htp_mpartp_t::handle_boundary</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00100">htp_mpartp_t::handle_data</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__util_8c_source.html#l00049">htp_is_lws()</a>, <a class="el" href="htp__multipart_8h_source.html#l00064">HTP_MULTIPART_BBOUNDARY_LWS_AFTER</a>, <a class="el" href="htp__multipart_8h_source.html#l00067">HTP_MULTIPART_BBOUNDARY_NLWS_AFTER</a>, <a class="el" href="htp__multipart_8h_source.html#l00061">HTP_MULTIPART_CRLF_LINE</a>, <a class="el" href="htp__multipart_8h_source.html#l00058">HTP_MULTIPART_LF_LINE</a>, <a class="el" href="htp__multipart_8h_source.html#l00091">HTP_MULTIPART_PART_AFTER_LAST_BOUNDARY</a>, <a class="el" href="htp__multipart_8h_source.html#l00085">HTP_MULTIPART_SEEN_LAST_BOUNDARY</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="util-decode-mime_8c_source.html#l00037">LF</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00056">MODE_LINE</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00109">htp_mpartp_t::parser_state</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00070">STATE_BOUNDARY</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00079">STATE_BOUNDARY_EAT_LWS</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00082">STATE_BOUNDARY_EAT_LWS_CR</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00073">STATE_BOUNDARY_IS_LAST1</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00076">STATE_BOUNDARY_IS_LAST2</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00067">STATE_DATA</a>, and <a class="el" href="htp__multipart__private_8h_source.html#l00064">STATE_INIT</a>.</p>

<p>Referenced by <a class="el" href="htp__content__handlers_8c_source.html#l00193">htp_ch_multipart_callback_request_body_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_cgraph.png" border="0" usemap="#htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_cgraph" id="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_cgraph">
<area shape="rect" id="node2" href="bstr__builder_8c.html#a1d3f608e4787b2e01540b2e675fd3565" title="bstr_builder_append_mem" alt="" coords="182,56,357,83"/><area shape="rect" id="node6" href="htp__private_8h.html#a0ec8330cb428004d467f69e7c6acdb84" title="fprint_raw_data" alt="" coords="214,107,325,133"/><area shape="rect" id="node9" href="htp__private_8h.html#a01068fcd4418a90ea81a2ad5e4eb8c81" title="htp_is_lws" alt="" coords="227,157,311,184"/><area shape="rect" id="node3" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="418,56,526,83"/><area shape="rect" id="node4" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="587,5,698,32"/><area shape="rect" id="node5" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="603,56,682,83"/><area shape="rect" id="node7" href="htp__private_8h.html#a9bd7382b55286e62a10aac00bc630af1" title="fprint_raw_data_ex" alt="" coords="406,107,538,133"/><area shape="rect" id="node8" href="suricata-common_8h.html#a7e9938e922f1dfd71bc01995bc2b7777" title="strlcat" alt="" coords="613,107,672,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_icgraph.png" border="0" usemap="#htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_icgraph" id="htp__multipart_8c_a4f343a477e74a4e91636763f3c74129d_icgraph">
<area shape="rect" id="node2" href="htp__private_8h.html#a7ec64e252d77945deded415a91bae392" title="htp_ch_multipart_callback\l_request_body_data" alt="" coords="181,5,355,46"/><area shape="rect" id="node3" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="403,5,576,46"/><area shape="rect" id="node4" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="625,5,757,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade5c03a799c0f5af2319900fe78a98e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpartp_parse_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Parses one part header.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">part</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>HTP_OK on success, HTP_DECLINED on parsing error, HTP_ERROR on fatal error. </dd></dl>

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00312">312</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="bstr_8c_source.html#l00081">bstr_add_mem_noex()</a>, <a class="el" href="bstr_8c_source.html#l00098">bstr_add_noex()</a>, <a class="el" href="bstr_8c_source.html#l00218">bstr_cmp_c_nocase()</a>, <a class="el" href="bstr_8c_source.html#l00254">bstr_dup_mem()</a>, <a class="el" href="bstr_8c_source.html#l00262">bstr_expand()</a>, <a class="el" href="bstr_8c_source.html#l00281">bstr_free()</a>, <a class="el" href="bstr_8h_source.html#l00077">bstr_len</a>, <a class="el" href="htp_8h_source.html#l00179">htp_header_t::flags</a>, <a class="el" href="htp__multipart_8h_source.html#l00242">htp_multipart_t::flags</a>, <a class="el" href="htp__multipart_8h_source.html#l00273">htp_multipart_part_t::headers</a>, <a class="el" href="htp__core_8h_source.html#l00078">HTP_DECLINED</a>, <a class="el" href="htp__core_8h_source.html#l00071">HTP_ERROR</a>, <a class="el" href="htp__util_8c_source.html#l00049">htp_is_lws()</a>, <a class="el" href="htp__util_8c_source.html#l00154">htp_is_space()</a>, <a class="el" href="htp__util_8c_source.html#l00110">htp_is_token()</a>, <a class="el" href="htp__multipart_8h_source.html#l00155">HTP_MULTIPART_NUL_BYTE</a>, <a class="el" href="htp__multipart_8h_source.html#l00133">HTP_MULTIPART_PART_HEADER_INVALID</a>, <a class="el" href="htp__multipart_8h_source.html#l00127">HTP_MULTIPART_PART_HEADER_REPEATED</a>, <a class="el" href="htp__multipart_8h_source.html#l00130">HTP_MULTIPART_PART_HEADER_UNKNOWN</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="htp__table_8c_source.html#l00056">htp_table_add()</a>, <a class="el" href="htp__table_8c_source.html#l00189">htp_table_get()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, <a class="el" href="htp__multipart__private_8h_source.html#l00086">htp_mpartp_t::multipart</a>, <a class="el" href="htp_8h_source.html#l00173">htp_header_t::name</a>, <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>, and <a class="el" href="htp_8h_source.html#l00176">htp_header_t::value</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00602">htp_mpart_part_handle_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_cgraph.png" border="0" usemap="#htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_cgraph" alt=""/></div>
<map name="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_cgraph" id="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_cgraph">
<area shape="rect" id="node2" href="bstr_8c.html#a5dc5d24b60cf123df96b274b7d5bb567" title="bstr_add_mem_noex" alt="" coords="382,56,525,83"/><area shape="rect" id="node4" href="bstr_8c.html#acbbec871f8fd06709d92af6892b264a2" title="bstr_add_noex" alt="" coords="227,5,333,32"/><area shape="rect" id="node5" href="bstr_8c.html#a37ec2adc98a8251ee1ab49cf9f6f5050" title="bstr_cmp_c_nocase" alt="" coords="384,259,523,285"/><area shape="rect" id="node7" href="bstr_8c.html#ae558f2c20b24baa62f84a3ee820b2b2f" title="bstr_dup_mem" alt="" coords="613,107,721,133"/><area shape="rect" id="node9" href="bstr_8c.html#a51bc377ac30a1092e84a4c3ab3d289f9" title="bstr_expand" alt="" coords="233,360,327,387"/><area shape="rect" id="node11" href="bstr_8c.html#a1b9ca92f8699af4136e5d1ed38ff73b0" title="bstr_free" alt="" coords="417,208,490,235"/><area shape="rect" id="node12" href="htp__private_8h.html#a01068fcd4418a90ea81a2ad5e4eb8c81" title="htp_is_lws" alt="" coords="238,411,322,437"/><area shape="rect" id="node13" href="htp__private_8h.html#a8154aaa13d12e1fea9b066e0881bd125" title="htp_is_space" alt="" coords="231,461,329,488"/><area shape="rect" id="node14" href="htp__private_8h.html#a7a0e47fdda476b38045a7d3406fb51ee" title="htp_is_token" alt="" coords="232,512,328,539"/><area shape="rect" id="node16" href="htp__table_8c.html#a80ff6b5f23273fa08d13d8d2d0efc4a0" title="htp_table_add" alt="" coords="229,157,331,184"/><area shape="rect" id="node19" href="htp__table_8c.html#ac852ef60754016fac1c214ea1d771025" title="htp_table_get" alt="" coords="230,309,330,336"/><area shape="rect" id="node3" href="bstr_8c.html#ad6bdcaadaf0034880584515edbca2427" title="bstr_adjust_len" alt="" coords="809,107,919,133"/><area shape="rect" id="node6" href="bstr_8c.html#a8b64cdb63293a1ca608bc2c735c20e7d" title="bstr_util_cmp_mem_nocase" alt="" coords="574,284,759,311"/><area shape="rect" id="node8" href="bstr_8c.html#a6b551b4e84311c0608d2a359440d9118" title="bstr_alloc" alt="" coords="825,157,903,184"/><area shape="rect" id="node10" href="bstr_8c.html#ac28786b1f330ae5992293ba028db9936" title="bstr_adjust_size" alt="" coords="395,360,512,387"/><area shape="rect" id="node15" href="htp__private_8h.html#a238c39a6d7fd7f35735f9c97a1b2aa66" title="htp_is_separator" alt="" coords="394,512,513,539"/><area shape="rect" id="node17" href="bstr_8c.html#ab4fc824d8df74ad6863a085f3901d30f" title="bstr_dup" alt="" coords="417,157,489,184"/><area shape="rect" id="node18" href="bstr_8c.html#abaf68b4b27be54655cba0d74c24646c1" title="bstr_dup_ex" alt="" coords="620,157,713,184"/><area shape="rect" id="node20" href="bstr_8c.html#a4d6765fb2a88a0f2bac4e41bee24c294" title="bstr_cmp_nocase" alt="" coords="391,309,516,336"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_icgraph.png" border="0" usemap="#htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_icgraph" alt=""/></div>
<map name="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_icgraph" id="htp__multipart_8c_ade5c03a799c0f5af2319900fe78a98e0_icgraph">
<area shape="rect" id="node2" href="htp__multipart__private_8h.html#a368c461de4ad8f9d864f5c29968e6f4a" title="htp_mpart_part_handle_data" alt="" coords="227,5,413,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a72b162a6bdf6226c5181a15ddf28ee41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="htp__core_8h.html#ab8a71422665c0773654b9b4d96f01e31">htp_status_t</a> htp_mpartp_run_request_file_data_hook </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhtp__multipart__part__t.html">htp_multipart_part_t</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="htp__multipart_8c_source.html#l00574">574</a> of file <a class="el" href="htp__multipart_8c_source.html">htp_multipart.c</a>.</p>

<p>References <a class="el" href="htp__multipart__private_8h_source.html#l00088">htp_mpartp_t::cfg</a>, <a class="el" href="htp_8h_source.html#l00136">htp_file_data_t::data</a>, <a class="el" href="app-layer-htp_8h_source.html#l00506">data</a>, <a class="el" href="htp_8h_source.html#l00133">htp_file_data_t::file</a>, <a class="el" href="htp__multipart_8h_source.html#l00276">htp_multipart_part_t::file</a>, <a class="el" href="htp__config__private_8h_source.html#l00244">htp_cfg_t::hook_request_file_data</a>, <a class="el" href="htp__hooks_8c_source.html#l00120">htp_hook_run_all()</a>, <a class="el" href="htp__core_8h_source.html#l00081">HTP_OK</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, <a class="el" href="htp_8h_source.html#l00119">htp_file_t::len</a>, <a class="el" href="htp_8h_source.html#l00139">htp_file_data_t::len</a>, and <a class="el" href="htp__multipart_8h_source.html#l00250">htp_multipart_part_t::parser</a>.</p>

<p>Referenced by <a class="el" href="htp__multipart_8c_source.html#l00520">htp_mpart_part_finalize_data()</a>, and <a class="el" href="htp__multipart_8c_source.html#l00602">htp_mpart_part_handle_data()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_cgraph.png" border="0" usemap="#htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_cgraph" alt=""/></div>
<map name="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_cgraph" id="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_cgraph">
<area shape="rect" id="node2" href="htp__hooks_8c.html#a8981d368a73f78ddfb4ad1de1f4a5fc2" title="htp_hook_run_all" alt="" coords="216,12,336,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_icgraph.png" border="0" usemap="#htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_icgraph" alt=""/></div>
<map name="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_icgraph" id="htp__multipart_8c_a72b162a6bdf6226c5181a15ddf28ee41_icgraph">
<area shape="rect" id="node2" href="htp__multipart__private_8h.html#adf2e99c5087b2ec07b11bf4df9e2073f" title="htp_mpart_part_finalize_data" alt="" coords="216,12,405,39"/><area shape="rect" id="node7" href="htp__multipart__private_8h.html#a368c461de4ad8f9d864f5c29968e6f4a" title="htp_mpart_part_handle_data" alt="" coords="217,63,404,89"/><area shape="rect" id="node3" href="htp__multipart_8h.html#a116c58436d2cbd3fdae8eba1f39d808c" title="htp_mpartp_finalize" alt="" coords="454,12,589,39"/><area shape="rect" id="node4" href="htp__private_8h.html#a7ec64e252d77945deded415a91bae392" title="htp_ch_multipart_callback\l_request_body_data" alt="" coords="637,5,811,46"/><area shape="rect" id="node5" href="htp__private_8h.html#a5828725587fa5f395faa80e7d2059194" title="htp_ch_multipart_callback\l_request_headers" alt="" coords="859,5,1032,46"/><area shape="rect" id="node6" href="htp__config_8h.html#a476cb8af65fec9a8a59d89b10c8f9880" title="htp_config_register\l_multipart_parser" alt="" coords="1081,5,1213,46"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a8a84310ac5c5a9ff38fc974698b3a7.html">libhtp</a></li><li class="navelem"><a class="el" href="dir_230ed285961c8f21296b4c8e0daccb5b.html">htp</a></li><li class="navelem"><a class="el" href="htp__multipart_8c.html">htp_multipart.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:01 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
