<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/tm-threads.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tm-threads_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tm-threads.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="runmodes_8h_source.html">runmodes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-queues_8h_source.html">tm-queues.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-queuehandlers_8h_source.html">tm-queuehandlers.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tmqh-packetpool_8h_source.html">tmqh-packetpool.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threads_8h_source.html">threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-cpu_8h_source.html">util-cpu.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-optimize_8h_source.html">util-optimize.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-profiling_8h_source.html">util-profiling.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-signal_8h_source.html">util-signal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="queue_8h_source.html">queue.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tm-threads.c:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c__incl.png" border="0" usemap="#src_2tm-threads_8c" alt=""/></div>
<map name="src_2tm-threads_8c" id="src_2tm-threads_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="1273,229,1407,256"/><area shape="rect" id="node23" href="suricata_8h.html" title="suricata.h" alt="" coords="1059,155,1137,181"/><area shape="rect" id="node27" href="stream_8h.html" title="stream.h" alt="" coords="703,80,776,107"/><area shape="rect" id="node29" href="runmodes_8h.html" title="runmodes.h" alt="" coords="1903,80,1993,107"/><area shape="rect" id="node15" href="threadvars_8h.html" title="threadvars.h" alt="" coords="546,453,640,480"/><area shape="rect" id="node18" href="tm-queues_8h.html" title="tm&#45;queues.h" alt="" coords="277,528,371,555"/><area shape="rect" id="node43" href="tm-queuehandlers_8h.html" title="tm&#45;queuehandlers.h" alt="" coords="2017,80,2153,107"/><area shape="rect" id="node44" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="401,229,495,256"/><area shape="rect" id="node45" href="tmqh-packetpool_8h.html" title="tmqh&#45;packetpool.h" alt="" coords="434,304,563,331"/><area shape="rect" id="node5" href="threads_8h.html" title="threads.h" alt="" coords="1483,528,1559,555"/><area shape="rect" id="node9" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="1883,304,1972,331"/><area shape="rect" id="node47" href="util-privs_8h.html" title="util&#45;privs.h" alt="" coords="2177,80,2260,107"/><area shape="rect" id="node6" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="55,603,129,629"/><area shape="rect" id="node20" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="690,304,792,331"/><area shape="rect" id="node48" href="util-profiling_8h.html" title="util&#45;profiling.h" alt="" coords="43,453,141,480"/><area shape="rect" id="node49" href="util-signal_8h.html" title="util&#45;signal.h" alt="" coords="2284,80,2372,107"/><area shape="rect" id="node50" href="queue_8h.html" title="queue.h" alt="" coords="2397,80,2464,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="1581,304,1653,331"/><area shape="rect" id="node8" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="345,379,495,405"/><area shape="rect" id="node10" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="1628,379,1708,405"/><area shape="rect" id="node11" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="868,304,951,331"/><area shape="rect" id="node13" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1162,304,1301,331"/><area shape="rect" id="node21" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="1678,304,1756,331"/><area shape="rect" id="node22" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="1781,304,1859,331"/><area shape="rect" id="node12" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="716,379,809,405"/><area shape="rect" id="node14" href="decode_8h.html" title="decode.h" alt="" coords="987,379,1061,405"/><area shape="rect" id="node16" href="util-mpm_8h.html" title="util&#45;mpm.h" alt="" coords="809,528,892,555"/><area shape="rect" id="node17" href="util-affinity_8h.html" title="util&#45;affinity.h" alt="" coords="1216,528,1309,555"/><area shape="rect" id="node19" href="counters_8h.html" title="counters.h" alt="" coords="552,528,635,555"/><area shape="rect" id="node24" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="975,304,1085,331"/><area shape="rect" id="node25" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="1530,453,1627,480"/><area shape="rect" id="node28" href="flow_8h.html" title="flow.h" alt="" coords="671,229,728,256"/><area shape="rect" id="node30" href="runmode-pcap_8h.html" title="runmode&#45;pcap.h" alt="" coords="1816,155,1931,181"/><area shape="rect" id="node31" href="runmode-pcap-file_8h.html" title="runmode&#45;pcap&#45;file.h" alt="" coords="1955,155,2091,181"/><area shape="rect" id="node32" href="runmode-pfring_8h.html" title="runmode&#45;pfring.h" alt="" coords="1518,155,1636,181"/><area shape="rect" id="node33" href="runmode-tile_8h.html" title="runmode&#45;tile.h" alt="" coords="1288,155,1392,181"/><area shape="rect" id="node34" href="runmode-nfq_8h.html" title="runmode&#45;nfq.h" alt="" coords="2115,155,2220,181"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html" title="runmode&#45;ipfw.h" alt="" coords="2245,155,2355,181"/><area shape="rect" id="node36" href="runmode-erf-file_8h.html" title="runmode&#45;erf&#45;file.h" alt="" coords="2380,155,2503,181"/><area shape="rect" id="node37" href="runmode-erf-dag_8h.html" title="runmode&#45;erf&#45;dag.h" alt="" coords="2527,155,2653,181"/><area shape="rect" id="node38" href="runmode-napatech_8h.html" title="runmode&#45;napatech.h" alt="" coords="2678,155,2817,181"/><area shape="rect" id="node39" href="runmode-af-packet_8h.html" title="runmode&#45;af&#45;packet.h" alt="" coords="2843,155,2984,181"/><area shape="rect" id="node40" href="runmode-nflog_8h.html" title="runmode&#45;nflog.h" alt="" coords="3008,155,3123,181"/><area shape="rect" id="node41" href="runmode-unix-socket_8h.html" title="runmode&#45;unix&#45;socket.h" alt="" coords="3147,155,3301,181"/><area shape="rect" id="node42" href="runmode-netmap_8h.html" title="runmode&#45;netmap.h" alt="" coords="1661,155,1792,181"/><area shape="rect" id="node46" href="tm-modules_8h.html" title="tm&#45;modules.h" alt="" coords="257,304,359,331"/></map>
</div>
</div>
<p><a href="tm-threads_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structThread__.html">Thread_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structThreads__.html">Threads_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a65d6f6542420fa94bb0267932a0627c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a65d6f6542420fa94bb0267932a0627c7">THREAD_KILL_MAX_WAIT_TIME</a>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a65d6f6542420fa94bb0267932a0627c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d6f6542420fa94bb0267932a0627c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a65d6f6542420fa94bb0267932a0627c7">THREAD_KILL_MAX_WAIT_TIME</a>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a65d6f6542420fa94bb0267932a0627c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:ae7676cdfa371dfdcf6fb0687737c29a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70be2dc5c8bdc85b027ea6118753cca1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a70be2dc5c8bdc85b027ea6118753cca1">STEP</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a70be2dc5c8bdc85b027ea6118753cca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a4a25ddda3358d22d411c7ea9e7d173bd"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structThread__.html">Thread_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a4a25ddda3358d22d411c7ea9e7d173bd">Thread</a></td></tr>
<tr class="separator:a4a25ddda3358d22d411c7ea9e7d173bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9141a89360460e98098ccabd3ef15206"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structThreads__.html">Threads_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a9141a89360460e98098ccabd3ef15206">Threads</a></td></tr>
<tr class="separator:a9141a89360460e98098ccabd3ef15206"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3051b9f7e147aecbdfef8a693987e8f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3">TmThreadsCheckFlag</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t flag)</td></tr>
<tr class="memdesc:a3051b9f7e147aecbdfef8a693987e8f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a thread flag is set.  <a href="#a3051b9f7e147aecbdfef8a693987e8f3">More...</a><br/></td></tr>
<tr class="separator:a3051b9f7e147aecbdfef8a693987e8f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a901bedcd2161f466a67de9a4ad88aba8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8">TmThreadsSetFlag</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t flag)</td></tr>
<tr class="memdesc:a901bedcd2161f466a67de9a4ad88aba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a thread flag.  <a href="#a901bedcd2161f466a67de9a4ad88aba8">More...</a><br/></td></tr>
<tr class="separator:a901bedcd2161f466a67de9a4ad88aba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a2a3d971bdab1af519d4aabd46b8f5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d">TmThreadsUnsetFlag</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t flag)</td></tr>
<tr class="memdesc:a1a2a3d971bdab1af519d4aabd46b8f5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unset a thread flag.  <a href="#a1a2a3d971bdab1af519d4aabd46b8f5d">More...</a><br/></td></tr>
<tr class="separator:a1a2a3d971bdab1af519d4aabd46b8f5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6a7d6f5867c6909351b1ee45dc2a0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b">TmThreadsSlotVarRun</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *slot)</td></tr>
<tr class="memdesc:a3e6a7d6f5867c6909351b1ee45dc2a0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Separate run function so we can call it recursively.  <a href="#a3e6a7d6f5867c6909351b1ee45dc2a0b">More...</a><br/></td></tr>
<tr class="separator:a3e6a7d6f5867c6909351b1ee45dc2a0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae587bc031308c4d760fd6441136ad684"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684">TmThreadsSlotPktAcqLoop</a> (void *td)</td></tr>
<tr class="separator:ae587bc031308c4d760fd6441136ad684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f906803e6e37b43aed5cf1a37c91ee"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee">TmThreadsSlotVar</a> (void *td)</td></tr>
<tr class="separator:a86f906803e6e37b43aed5cf1a37c91ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25369baa1a83811c880d10bf95cad079"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079">TmThreadSetSlots</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, char *name, void *(*fn_p)(void *))</td></tr>
<tr class="memdesc:a25369baa1a83811c880d10bf95cad079"><td class="mdescLeft">&#160;</td><td class="mdescRight">We set the slot functions.  <a href="#a25369baa1a83811c880d10bf95cad079">More...</a><br/></td></tr>
<tr class="separator:a25369baa1a83811c880d10bf95cad079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed496257ee64f54e5f3005057052f385"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aed496257ee64f54e5f3005057052f385">TmThreadsGetTVContainingSlot</a> (<a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *tm_slot)</td></tr>
<tr class="separator:aed496257ee64f54e5f3005057052f385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0eac5949cfd34a6917cd5c8f5c1583d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aa0eac5949cfd34a6917cd5c8f5c1583d">TmSlotFree</a> (<a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *tms)</td></tr>
<tr class="separator:aa0eac5949cfd34a6917cd5c8f5c1583d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf6491e6eb3b8cd303e0e611091ea1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a6cf6491e6eb3b8cd303e0e611091ea1e">TmSlotSetFuncAppend</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="tm-modules_8h.html#afa13d23f7e5e46b5a39f59777f6a3118">TmModule</a> *tm, void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="memdesc:a6cf6491e6eb3b8cd303e0e611091ea1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a new entry to the slots.  <a href="#a6cf6491e6eb3b8cd303e0e611091ea1e">More...</a><br/></td></tr>
<tr class="separator:a6cf6491e6eb3b8cd303e0e611091ea1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8e382db05213745aad6a6f3ff8a2e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a4b8e382db05213745aad6a6f3ff8a2e8">TmSlotGetSlotForTM</a> (int tm_id)</td></tr>
<tr class="memdesc:a4b8e382db05213745aad6a6f3ff8a2e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the slot holding a TM with the particular tm_id.  <a href="#a4b8e382db05213745aad6a6f3ff8a2e8">More...</a><br/></td></tr>
<tr class="separator:a4b8e382db05213745aad6a6f3ff8a2e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa719128e8936ee43f9c460d37ee8238f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aa719128e8936ee43f9c460d37ee8238f">TmThreadSetThreadPriority</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, int prio)</td></tr>
<tr class="memdesc:aa719128e8936ee43f9c460d37ee8238f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the thread options (thread priority).  <a href="#aa719128e8936ee43f9c460d37ee8238f">More...</a><br/></td></tr>
<tr class="separator:aa719128e8936ee43f9c460d37ee8238f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2281ca1569730c81dffeb4779b399cef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef">TmThreadSetPrio</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:a2281ca1569730c81dffeb4779b399cef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjusting nice value for threads.  <a href="#a2281ca1569730c81dffeb4779b399cef">More...</a><br/></td></tr>
<tr class="separator:a2281ca1569730c81dffeb4779b399cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba178d0197498f1397f9be8247ebb75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a6ba178d0197498f1397f9be8247ebb75">TmThreadSetCPUAffinity</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t cpu)</td></tr>
<tr class="memdesc:a6ba178d0197498f1397f9be8247ebb75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the thread options (cpu affinity).  <a href="#a6ba178d0197498f1397f9be8247ebb75">More...</a><br/></td></tr>
<tr class="separator:a6ba178d0197498f1397f9be8247ebb75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91e211f1f8350abcd67b23c58dcf577"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577">TmThreadSetCPU</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint8_t <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:ae91e211f1f8350abcd67b23c58dcf577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6121f124848a0f3961e4eee3faf34f8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a6121f124848a0f3961e4eee3faf34f8e">TmThreadGetNbThreads</a> (uint8_t <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:a6121f124848a0f3961e4eee3faf34f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda67fab252b97fe5f158ba053a45de7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7">TmThreadSetupOptions</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:aeda67fab252b97fe5f158ba053a45de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the thread options (cpu affinitythread). Priority should be already set by pthread_create.  <a href="#aeda67fab252b97fe5f158ba053a45de7">More...</a><br/></td></tr>
<tr class="separator:aeda67fab252b97fe5f158ba053a45de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af78474ba8e49604c9cf705c57cc95f51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51">TmThreadCreate</a> (char *name, char *inq_name, char *inqh_name, char *outq_name, char *outqh_name, char *slots, void *(*fn_p)(void *), int mucond)</td></tr>
<tr class="memdesc:af78474ba8e49604c9cf705c57cc95f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns the TV instance for a new thread.  <a href="#af78474ba8e49604c9cf705c57cc95f51">More...</a><br/></td></tr>
<tr class="separator:af78474ba8e49604c9cf705c57cc95f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e074117df241b52004b4b1c5228b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ac0e074117df241b52004b4b1c5228b8e">TmThreadCreatePacketHandler</a> (char *name, char *inq_name, char *inqh_name, char *outq_name, char *outqh_name, char *slots)</td></tr>
<tr class="memdesc:ac0e074117df241b52004b4b1c5228b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns a TV instance for a Packet Processing Thread. This function doesn't support custom slots, and hence shouldn't be supplied "custom" as its slot type. All PPT threads are created with a mucond(see TmThreadCreate declaration) of 0. Hence the tv conditional variables are not used to kill the thread.  <a href="#ac0e074117df241b52004b4b1c5228b8e">More...</a><br/></td></tr>
<tr class="separator:ac0e074117df241b52004b4b1c5228b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b66d870752829f5f0ccb6c91b76dac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a79b66d870752829f5f0ccb6c91b76dac">TmThreadCreateMgmtThread</a> (char *name, void *(fn_p)(void *), int mucond)</td></tr>
<tr class="memdesc:a79b66d870752829f5f0ccb6c91b76dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom slot functions and hence a function pointer should be sent as an argument.  <a href="#a79b66d870752829f5f0ccb6c91b76dac">More...</a><br/></td></tr>
<tr class="separator:a79b66d870752829f5f0ccb6c91b76dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace687797a257f61387245ec3ec403916"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ace687797a257f61387245ec3ec403916">TmThreadCreateMgmtThreadByName</a> (char *name, char *module, int mucond)</td></tr>
<tr class="memdesc:ace687797a257f61387245ec3ec403916"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom slot functions and hence a function pointer should be sent as an argument.  <a href="#ace687797a257f61387245ec3ec403916">More...</a><br/></td></tr>
<tr class="separator:ace687797a257f61387245ec3ec403916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad83f5fc0de8d0ee23346b19ddf5c3d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d">TmThreadCreateCmdThreadByName</a> (char *name, char *module, int mucond)</td></tr>
<tr class="memdesc:a0ad83f5fc0de8d0ee23346b19ddf5c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and returns the TV instance for a Command thread (CMD). This function supports only custom slot functions and hence a function pointer should be sent as an argument.  <a href="#a0ad83f5fc0de8d0ee23346b19ddf5c3d">More...</a><br/></td></tr>
<tr class="separator:a0ad83f5fc0de8d0ee23346b19ddf5c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ae4af36f2b0389107a54a8dc00691c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c">TmThreadAppend</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, int <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="memdesc:a30ae4af36f2b0389107a54a8dc00691c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends this TV to tv_root based on its type.  <a href="#a30ae4af36f2b0389107a54a8dc00691c">More...</a><br/></td></tr>
<tr class="separator:a30ae4af36f2b0389107a54a8dc00691c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af367d3b08ee19db4d0f14dbecd2fa18b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#af367d3b08ee19db4d0f14dbecd2fa18b">TmThreadRemove</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, int <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="memdesc:af367d3b08ee19db4d0f14dbecd2fa18b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes this TV from tv_root based on its type.  <a href="#af367d3b08ee19db4d0f14dbecd2fa18b">More...</a><br/></td></tr>
<tr class="separator:af367d3b08ee19db4d0f14dbecd2fa18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a753d89c2cd996f5b019d2a5e0a6dd1d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a753d89c2cd996f5b019d2a5e0a6dd1d2">TmThreadKillThread</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:a753d89c2cd996f5b019d2a5e0a6dd1d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kill a thread.  <a href="#a753d89c2cd996f5b019d2a5e0a6dd1d2">More...</a><br/></td></tr>
<tr class="separator:a753d89c2cd996f5b019d2a5e0a6dd1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ead5949f2b33753f2695414139238c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a9ead5949f2b33753f2695414139238c0">TmThreadDisableReceiveThreads</a> (void)</td></tr>
<tr class="memdesc:a9ead5949f2b33753f2695414139238c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable all threads having the specified TMs.  <a href="#a9ead5949f2b33753f2695414139238c0">More...</a><br/></td></tr>
<tr class="separator:a9ead5949f2b33753f2695414139238c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ce86ebf39159c57e35bed0e37dbc9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a06ce86ebf39159c57e35bed0e37dbc9e">TmThreadDisablePacketThreads</a> (void)</td></tr>
<tr class="memdesc:a06ce86ebf39159c57e35bed0e37dbc9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable all threads having the specified TMs.  <a href="#a06ce86ebf39159c57e35bed0e37dbc9e">More...</a><br/></td></tr>
<tr class="separator:a06ce86ebf39159c57e35bed0e37dbc9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28ba83501fd26a26c4707e61b2550ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ae28ba83501fd26a26c4707e61b2550ae">TmThreadGetFirstTmSlotForPartialPattern</a> (const char *tm_name)</td></tr>
<tr class="separator:ae28ba83501fd26a26c4707e61b2550ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe5f632012afd5313df3fa692f2ccd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aafe5f632012afd5313df3fa692f2ccd8">TmThreadKillThreadsFamily</a> (int family)</td></tr>
<tr class="separator:aafe5f632012afd5313df3fa692f2ccd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09cc5ceb2d9be836871da62a8c419734"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a09cc5ceb2d9be836871da62a8c419734">TmThreadKillThreads</a> (void)</td></tr>
<tr class="separator:a09cc5ceb2d9be836871da62a8c419734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1658ac1d3a66d7c50006fc125933c2c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a1658ac1d3a66d7c50006fc125933c2c1">TmThreadFree</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="separator:a1658ac1d3a66d7c50006fc125933c2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e0a9360bef968f5e7f26d483c5767a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a10e0a9360bef968f5e7f26d483c5767a">TmThreadClearThreadsFamily</a> (int family)</td></tr>
<tr class="separator:a10e0a9360bef968f5e7f26d483c5767a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c7ad411065ae98710138b400f84633"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633">TmThreadSpawn</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:af5c7ad411065ae98710138b400f84633"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spawns a thread associated with the ThreadVars instance tv.  <a href="#af5c7ad411065ae98710138b400f84633">More...</a><br/></td></tr>
<tr class="separator:af5c7ad411065ae98710138b400f84633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bbe73bf03f22e82bc0364e425c14a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ad4bbe73bf03f22e82bc0364e425c14a5">TmThreadSetAOF</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint8_t aof)</td></tr>
<tr class="memdesc:ad4bbe73bf03f22e82bc0364e425c14a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the thread flags for a thread instance(tv)  <a href="#ad4bbe73bf03f22e82bc0364e425c14a5">More...</a><br/></td></tr>
<tr class="separator:ad4bbe73bf03f22e82bc0364e425c14a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a706eef27334eebefb3f0653a37b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44">TmThreadInitMC</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:a33a706eef27334eebefb3f0653a37b44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the mutex and condition variables for this TV.  <a href="#a33a706eef27334eebefb3f0653a37b44">More...</a><br/></td></tr>
<tr class="separator:a33a706eef27334eebefb3f0653a37b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dec77fa2aee796d6435afa70f1ee475"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475">TmThreadTestThreadUnPaused</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:a9dec77fa2aee796d6435afa70f1ee475"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if the thread represented in the arg has been unpaused or not.  <a href="#a9dec77fa2aee796d6435afa70f1ee475">More...</a><br/></td></tr>
<tr class="separator:a9dec77fa2aee796d6435afa70f1ee475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbb02380645247d1256fe2a20701e92a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a">TmThreadWaitForFlag</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:afbb02380645247d1256fe2a20701e92a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits till the specified flag(s) is(are) set. We don't bother if the kill flag has been set or not on the thread.  <a href="#afbb02380645247d1256fe2a20701e92a">More...</a><br/></td></tr>
<tr class="separator:afbb02380645247d1256fe2a20701e92a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa983635a1574f57d99e63bfd842d16b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aa983635a1574f57d99e63bfd842d16b2">TmThreadContinue</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:aa983635a1574f57d99e63bfd842d16b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpauses a thread.  <a href="#aa983635a1574f57d99e63bfd842d16b2">More...</a><br/></td></tr>
<tr class="separator:aa983635a1574f57d99e63bfd842d16b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7b9b9a303a1a124ad7b3a56410e1f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ace7b9b9a303a1a124ad7b3a56410e1f5">TmThreadContinueThreads</a> ()</td></tr>
<tr class="memdesc:ace7b9b9a303a1a124ad7b3a56410e1f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpauses all threads present in tv_root.  <a href="#ace7b9b9a303a1a124ad7b3a56410e1f5">More...</a><br/></td></tr>
<tr class="separator:ace7b9b9a303a1a124ad7b3a56410e1f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2d67470344cffbf928bffc47229a0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a7b2d67470344cffbf928bffc47229a0e">TmThreadPause</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:a7b2d67470344cffbf928bffc47229a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pauses a thread.  <a href="#a7b2d67470344cffbf928bffc47229a0e">More...</a><br/></td></tr>
<tr class="separator:a7b2d67470344cffbf928bffc47229a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff93094fe1627593600c899abadf3e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a1ff93094fe1627593600c899abadf3e0">TmThreadPauseThreads</a> ()</td></tr>
<tr class="memdesc:a1ff93094fe1627593600c899abadf3e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pauses all threads present in tv_root.  <a href="#a1ff93094fe1627593600c899abadf3e0">More...</a><br/></td></tr>
<tr class="separator:a1ff93094fe1627593600c899abadf3e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7c8ef1a6d109517c07c2533c3d3216d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ac7c8ef1a6d109517c07c2533c3d3216d">TmThreadCheckThreadState</a> (void)</td></tr>
<tr class="memdesc:ac7c8ef1a6d109517c07c2533c3d3216d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to check the thread for certain conditions of failure. If the thread has been specified to restart on failure, the thread is restarted. If the thread has been specified to gracefully shutdown the engine on failure, it does so. The global aof flag, tv_aof overrides the thread aof flag, if it holds a THV_ENGINE_EXIT;.  <a href="#ac7c8ef1a6d109517c07c2533c3d3216d">More...</a><br/></td></tr>
<tr class="separator:ac7c8ef1a6d109517c07c2533c3d3216d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af1510ae299a7c320b068b229b9ae3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a3af1510ae299a7c320b068b229b9ae3a">TmThreadWaitOnThreadInit</a> (void)</td></tr>
<tr class="memdesc:a3af1510ae299a7c320b068b229b9ae3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to check if all threads have finished their initialization. On finding an un-initialized thread, it waits till that thread completes its initialization, before proceeding to the next thread.  <a href="#a3af1510ae299a7c320b068b229b9ae3a">More...</a><br/></td></tr>
<tr class="separator:a3af1510ae299a7c320b068b229b9ae3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafcd43c520c1596655540c7b8082471"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#adafcd43c520c1596655540c7b8082471">TmThreadsGetCallingThread</a> (void)</td></tr>
<tr class="memdesc:adafcd43c520c1596655540c7b8082471"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the TV for the calling thread.  <a href="#adafcd43c520c1596655540c7b8082471">More...</a><br/></td></tr>
<tr class="separator:adafcd43c520c1596655540c7b8082471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7caef5a78841ac82554ee5d55f0d9db"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aa7caef5a78841ac82554ee5d55f0d9db">TmThreadCountThreadsByTmmFlags</a> (uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:aa7caef5a78841ac82554ee5d55f0d9db"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns a count of all the threads that match the flag  <a href="#aa7caef5a78841ac82554ee5d55f0d9db">More...</a><br/></td></tr>
<tr class="separator:aa7caef5a78841ac82554ee5d55f0d9db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c819d012b841b4861541195bb579eb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a9c819d012b841b4861541195bb579eb3">TmThreadsListThreads</a> (void)</td></tr>
<tr class="separator:a9c819d012b841b4861541195bb579eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b792091fc079fe5b2cf755e5f53849a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a">TmThreadsRegisterThread</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, const int <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>)</td></tr>
<tr class="separator:a7b792091fc079fe5b2cf755e5f53849a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6938fc8a75cc9f64967bd1655b374d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#aa6938fc8a75cc9f64967bd1655b374d8">TmThreadsUnregisterThread</a> (const int id)</td></tr>
<tr class="separator:aa6938fc8a75cc9f64967bd1655b374d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad05e0376acf69238bdc79a5f5393201a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ad05e0376acf69238bdc79a5f5393201a">TmThreadsInjectPacketsById</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> **packets, const int id)</td></tr>
<tr class="separator:ad05e0376acf69238bdc79a5f5393201a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9d9696175133d57b70889a2fb7ec63c6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#a9d9696175133d57b70889a2fb7ec63c6">tv_root</a> [<a class="el" href="tm-threads-common_8h.html#a29d44341ce767c5dfc737d622fc97ba1a1aeb95d6bc0cead449fa4cecb2bcd6a4">TVT_MAX</a>] = { NULL }</td></tr>
<tr class="separator:a9d9696175133d57b70889a2fb7ec63c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac003a7c799393730d1ecab455c42cd91"><td class="memItemLeft" align="right" valign="top"><a class="el" href="threads_8h.html#a93b9e097562019ea65191bd846ecf3ae">SCMutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#ac003a7c799393730d1ecab455c42cd91">tv_root_lock</a> = <a class="el" href="threads_8h.html#a5f2fb777344db00e3ffa3156cc1a4cb5">SCMUTEX_INITIALIZER</a></td></tr>
<tr class="separator:ac003a7c799393730d1ecab455c42cd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5ecb3cc5e9d89db70f326a9efdb96a"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm-threads_8c.html#adb5ecb3cc5e9d89db70f326a9efdb96a">tv_aof</a> = <a class="el" href="threadvars_8h.html#ad645002d760c97674366b151bff3fb30">THV_RESTART_THREAD</a></td></tr>
<tr class="separator:adb5ecb3cc5e9d89db70f326a9efdb96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd>
<dd>
Anoop Saldanha <a href="#" onclick="location.href='mai'+'lto:'+'ano'+'op'+'sal'+'da'+'nha'+'@g'+'mai'+'l.'+'com'; return false;">anoop<span style="display: none;">.nosp@m.</span>sald<span style="display: none;">.nosp@m.</span>anha@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> </dd>
<dd>
Eric Leblond <a href="#" onclick="location.href='mai'+'lto:'+'eri'+'c@'+'reg'+'it'+'.or'+'g'; return false;">eric@<span style="display: none;">.nosp@m.</span>regi<span style="display: none;">.nosp@m.</span>t.org</a></dd></dl>
<p>Thread management functions. </p>

<p>Definition in file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a70be2dc5c8bdc85b027ea6118753cca1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STEP&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02093">2093</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l02097">TmThreadsRegisterThread()</a>.</p>

</div>
</div>
<a class="anchor" id="a65d6f6542420fa94bb0267932a0627c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THREAD_KILL_MAX_WAIT_TIME&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a65d6f6542420fa94bb0267932a0627c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define THREAD_KILL_MAX_WAIT_TIME&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae7676cdfa371dfdcf6fb0687737c29a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WAIT_TIME&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae7676cdfa371dfdcf6fb0687737c29a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WAIT_TIME&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a4a25ddda3358d22d411c7ea9e7d173bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structThread__.html">Thread_</a>  <a class="el" href="tm-threads_8c.html#a4a25ddda3358d22d411c7ea9e7d173bd">Thread</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9141a89360460e98098ccabd3ef15206"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structThreads__.html">Threads_</a>  <a class="el" href="tm-threads_8c.html#a9141a89360460e98098ccabd3ef15206">Threads</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa0eac5949cfd34a6917cd5c8f5c1583d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmSlotFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *&#160;</td>
          <td class="paramname"><em>tms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00756">756</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

</div>
</div>
<a class="anchor" id="a4b8e382db05213745aad6a6f3ff8a2e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a>* TmSlotGetSlotForTM </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tm_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the slot holding a TM with the particular tm_id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tm_id</td><td>TM id of the TM whose slot has to be returned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slots</td><td>Pointer to the slot. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00781">781</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

</div>
</div>
<a class="anchor" id="a6cf6491e6eb3b8cd303e0e611091ea1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmSlotSetFuncAppend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tm-modules_8h.html#afa13d23f7e5e46b5a39f59777f6a3118">TmModule</a> *&#160;</td>
          <td class="paramname"><em>tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a new entry to the slots. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>TV the slot is attached to. </td></tr>
    <tr><td class="paramname">tm</td><td>TM to append. </td></tr>
    <tr><td class="paramname">data</td><td>Data to be passed on to the slot init function. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00769">769</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>, <a class="el" href="runmode-erf-file_8c_source.html#l00057">RunModeErfFileSingle()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00142">RunModeFilePcapAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00062">RunModeFilePcapSingle()</a>, <a class="el" href="util-runmodes_8c_source.html#l00482">RunModeSetIPSAutoFp()</a>, <a class="el" href="util-runmodes_8c_source.html#l00659">RunModeSetIPSWorker()</a>, <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>, <a class="el" href="runmodes_8c_source.html#l00896">SetupOutputs()</a>, <a class="el" href="tm-threads_8c_source.html#l01239">TmThreadCreateCmdThreadByName()</a>, and <a class="el" href="tm-threads_8c_source.html#l01206">TmThreadCreateMgmtThreadByName()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a6cf6491e6eb3b8cd303e0e611091ea1e_icgraph.png" border="0" usemap="#tm-threads_8c_a6cf6491e6eb3b8cd303e0e611091ea1e_icgraph" alt=""/></div>
<map name="tm-threads_8c_a6cf6491e6eb3b8cd303e0e611091ea1e_icgraph" id="tm-threads_8c_a6cf6491e6eb3b8cd303e0e611091ea1e_icgraph">
<area shape="rect" id="node2" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="525,56,683,83"/><area shape="rect" id="node6" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="528,5,680,32"/><area shape="rect" id="node7" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="519,157,689,184"/><area shape="rect" id="node9" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="521,107,687,133"/><area shape="rect" id="node10" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="523,284,685,311"/><area shape="rect" id="node15" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="523,208,685,235"/><area shape="rect" id="node18" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="499,423,709,449"/><area shape="rect" id="node31" href="runmodes_8h.html#aff3c7033d01050e768d646d45b1df04e" title="SetupOutputs" alt="" coords="279,157,382,184"/><area shape="rect" id="node32" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="211,513,450,540"/><area shape="rect" id="node35" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="990,702,1183,743"/><area shape="rect" id="node3" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="767,43,932,69"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1238,397,1429,424"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1483,655,1533,681"/><area shape="rect" id="node8" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="760,93,939,120"/><area shape="rect" id="node11" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="763,245,935,272"/><area shape="rect" id="node13" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="766,296,933,323"/><area shape="rect" id="node12" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="997,245,1176,272"/><area shape="rect" id="node14" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1000,296,1173,323"/><area shape="rect" id="node16" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="763,144,935,171"/><area shape="rect" id="node17" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="766,195,933,221"/><area shape="rect" id="node19" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="767,347,931,373"/><area shape="rect" id="node21" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="760,397,939,424"/><area shape="rect" id="node23" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="757,448,941,475"/><area shape="rect" id="node25" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="765,499,934,525"/><area shape="rect" id="node27" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="765,549,933,576"/><area shape="rect" id="node29" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="763,600,935,627"/><area shape="rect" id="node20" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1001,347,1172,373"/><area shape="rect" id="node22" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1003,397,1171,424"/><area shape="rect" id="node24" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="991,448,1182,475"/><area shape="rect" id="node26" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="999,499,1175,525"/><area shape="rect" id="node28" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="999,549,1174,576"/><area shape="rect" id="node30" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="997,600,1176,627"/><area shape="rect" id="node33" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="514,579,694,605"/><area shape="rect" id="node34" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1232,629,1435,656"/><area shape="rect" id="node36" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1243,680,1423,707"/><area shape="rect" id="node37" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1242,731,1425,757"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a30ae4af36f2b0389107a54a8dc00691c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadAppend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends this TV to tv_root based on its type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>holds the type this TV belongs to. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01265">1265</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threadvars_8h_source.html#l00121">ThreadVars_::prev</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01689">TmThreadSpawn()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a30ae4af36f2b0389107a54a8dc00691c_icgraph.png" border="0" usemap="#tm-threads_8c_a30ae4af36f2b0389107a54a8dc00691c_icgraph" alt=""/></div>
<map name="tm-threads_8c_a30ae4af36f2b0389107a54a8dc00691c_icgraph" id="tm-threads_8c_a30ae4af36f2b0389107a54a8dc00691c_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a6c2161fae3aaccd4a4ac33c9fed7a7f2" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="179,362,301,389"/><area shape="rect" id="node3" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1111,58,1251,85"/><area shape="rect" id="node5" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="846,109,1026,136"/><area shape="rect" id="node7" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1091,160,1271,186"/><area shape="rect" id="node8" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1090,210,1273,237"/><area shape="rect" id="node9" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="379,413,531,440"/><area shape="rect" id="node12" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="375,464,534,490"/><area shape="rect" id="node13" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="372,514,537,541"/><area shape="rect" id="node15" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="369,565,540,592"/><area shape="rect" id="node16" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="349,666,560,693"/><area shape="rect" id="node29" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="373,312,536,338"/><area shape="rect" id="node34" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="373,362,536,389"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1331,160,1381,186"/><area shape="rect" id="node6" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1080,109,1283,136"/><area shape="rect" id="node10" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="617,464,783,490"/><area shape="rect" id="node11" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1086,565,1277,592"/><area shape="rect" id="node14" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="611,514,789,541"/><area shape="rect" id="node17" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="618,565,782,592"/><area shape="rect" id="node19" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="611,616,789,642"/><area shape="rect" id="node21" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="608,666,792,693"/><area shape="rect" id="node23" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="615,717,785,744"/><area shape="rect" id="node25" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="616,768,784,794"/><area shape="rect" id="node27" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="614,818,786,845"/><area shape="rect" id="node18" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="851,565,1021,592"/><area shape="rect" id="node20" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="852,616,1020,642"/><area shape="rect" id="node22" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="841,666,1031,693"/><area shape="rect" id="node24" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="848,717,1024,744"/><area shape="rect" id="node26" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="849,768,1023,794"/><area shape="rect" id="node28" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="847,818,1025,845"/><area shape="rect" id="node30" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="614,261,786,288"/><area shape="rect" id="node32" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="617,312,783,338"/><area shape="rect" id="node31" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="847,362,1025,389"/><area shape="rect" id="node33" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="849,413,1023,440"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="614,362,786,389"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="617,413,783,440"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac7c8ef1a6d109517c07c2533c3d3216d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadCheckThreadState </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to check the thread for certain conditions of failure. If the thread has been specified to restart on failure, the thread is restarted. If the thread has been specified to gracefully shutdown the engine on failure, it does so. The global aof flag, tv_aof overrides the thread aof flag, if it holds a THV_ENGINE_EXIT;. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01916">1916</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00069">ThreadVars_::aof</a>, <a class="el" href="suricata_8c_source.html#l00380">EngineKill()</a>, <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="suricata_8c_source.html#l00219">suricata_ctl_flags</a>, <a class="el" href="suricata_8h_source.html#l00092">SURICATA_KILL</a>, <a class="el" href="suricata_8h_source.html#l00089">SURICATA_STOP</a>, <a class="el" href="threadvars_8h_source.html#l00061">ThreadVars_::t</a>, <a class="el" href="threadvars_8h_source.html#l00045">THV_DEINIT</a>, <a class="el" href="threadvars_8h_source.html#l00054">THV_ENGINE_EXIT</a>, <a class="el" href="threadvars_8h_source.html#l00041">THV_FAILED</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00084">tv_aof</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_cgraph.png" border="0" usemap="#tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_cgraph" alt=""/></div>
<map name="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_cgraph" id="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_cgraph">
<area shape="rect" id="node2" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="281,5,361,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="246,56,397,83"/><area shape="rect" id="node4" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="255,107,388,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_icgraph.png" border="0" usemap="#tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_icgraph" alt=""/></div>
<map name="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_icgraph" id="tm-threads_8c_ac7c8ef1a6d109517c07c2533c3d3216d_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="245,5,296,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10e0a9360bef968f5e7f26d483c5767a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadClearThreadsFamily </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01664">1664</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l01642">TmThreadFree()</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a10e0a9360bef968f5e7f26d483c5767a_cgraph.png" border="0" usemap="#tm-threads_8c_a10e0a9360bef968f5e7f26d483c5767a_cgraph" alt=""/></div>
<map name="tm-threads_8c_a10e0a9360bef968f5e7f26d483c5767a_cgraph" id="tm-threads_8c_a10e0a9360bef968f5e7f26d483c5767a_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a1658ac1d3a66d7c50006fc125933c2c1" title="TmThreadFree" alt="" coords="253,37,360,64"/><area shape="rect" id="node3" href="counters_8c.html#a09bd1636d92f10107f55cf59f5b4a30f" title="StatsThreadCleanup" alt="" coords="432,12,573,39"/><area shape="rect" id="node5" href="tm-threads_8c.html#aa6938fc8a75cc9f64967bd1655b374d8" title="TmThreadsUnregisterThread" alt="" coords="409,63,597,89"/><area shape="rect" id="node4" href="counters_8c.html#aabceecc6ca3d6be4cc51adbf23597ff8" title="Releases the StatsPrivateThreadContext allocated by the user, for storing and updating local counter ..." alt="" coords="646,5,829,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa983635a1574f57d99e63bfd842d16b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadContinue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpauses a thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to a TV instance that has to be unpaused </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01819">1819</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, and <a class="el" href="tm-threads_8c_source.html#l00108">TmThreadsUnsetFlag()</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-loader_8c_source.html#l00167">TmThreadContinueDetectLoaderThreads()</a>, and <a class="el" href="tm-threads_8c_source.html#l01829">TmThreadContinueThreads()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_cgraph.png" border="0" usemap="#tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_cgraph" alt=""/></div>
<map name="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_cgraph" id="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="187,5,335,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_icgraph.png" border="0" usemap="#tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_icgraph" alt=""/></div>
<map name="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_icgraph" id="tm-threads_8c_aa983635a1574f57d99e63bfd842d16b2_icgraph">
<area shape="rect" id="node2" href="detect-engine-loader_8h.html#ac99678d1d5dba28b321a14c89a09bc12" title="Unpauses all threads present in tv_root. " alt="" coords="187,5,397,46"/><area shape="rect" id="node5" href="tm-threads_8h.html#abf6431e879f608a1f681e735d3b5ff0a" title="Unpauses all threads present in tv_root. " alt="" coords="457,67,637,93"/><area shape="rect" id="node3" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="445,15,648,41"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="696,41,747,68"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace7b9b9a303a1a124ad7b3a56410e1f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadContinueThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpauses all threads present in tv_root. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01829">1829</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l01819">TmThreadContinue()</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_cgraph.png" border="0" usemap="#tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_cgraph" alt=""/></div>
<map name="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_cgraph" id="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#aa983635a1574f57d99e63bfd842d16b2" title="Unpauses a thread. " alt="" coords="235,5,368,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="417,5,565,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_icgraph.png" border="0" usemap="#tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_icgraph" alt=""/></div>
<map name="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_icgraph" id="tm-threads_8c_ace7b9b9a303a1a124ad7b3a56410e1f5_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="235,5,285,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa7caef5a78841ac82554ee5d55f0d9db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t TmThreadCountThreadsByTmmFlags </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns a count of all the threads that match the flag </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02040">2040</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="threadvars_8h_source.html#l00075">ThreadVars_::tmm_flags</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p>Referenced by <a class="el" href="tmqh-packetpool_8c_source.html#l00583">PacketPoolPostRunmodes()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aa7caef5a78841ac82554ee5d55f0d9db_icgraph.png" border="0" usemap="#tm-threads_8c_aa7caef5a78841ac82554ee5d55f0d9db_icgraph" alt=""/></div>
<map name="tm-threads_8c_aa7caef5a78841ac82554ee5d55f0d9db_icgraph" id="tm-threads_8c_aa7caef5a78841ac82554ee5d55f0d9db_icgraph">
<area shape="rect" id="node2" href="tmqh-packetpool_8h.html#ab91c961c33b49aff67cabd5e6e6384e8" title="Set the max_pending_return_packets value. " alt="" coords="264,12,443,39"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="491,12,541,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af78474ba8e49604c9cf705c57cc95f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadCreate </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>inq_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>inqh_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>outq_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>outqh_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>slots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void *)&#160;</td>
          <td class="paramname"><em>fn_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mucond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns the TV instance for a new thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of this TV instance </td></tr>
    <tr><td class="paramname">inq_name</td><td>Incoming queue name </td></tr>
    <tr><td class="paramname">inqh_name</td><td>Incoming queue handler name as set by <a class="el" href="runmode-unittests_8c.html#a58283282aed172d5cc1839bf01c21bc2">TmqhSetup()</a> </td></tr>
    <tr><td class="paramname">outq_name</td><td>Outgoing queue name </td></tr>
    <tr><td class="paramname">outqh_name</td><td>Outgoing queue handler as set by <a class="el" href="runmode-unittests_8c.html#a58283282aed172d5cc1839bf01c21bc2">TmqhSetup()</a> </td></tr>
    <tr><td class="paramname">slots</td><td>String representation for the slot function to be used </td></tr>
    <tr><td class="paramname">fn_p</td><td>Pointer to function when "slots" is of type "custom" </td></tr>
    <tr><td class="paramname">mucond</td><td>Flag to indicate whether to initialize the condition and the mutex variables for this newly created TV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>newly created TV instance, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01026">1026</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00069">ThreadVars_::aof</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00041">Tmqh_::InHandler</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00042">Tmqh_::InShutdownHandler</a>, <a class="el" href="threadvars_8h_source.html#l00088">ThreadVars_::InShutdownHandler</a>, <a class="el" href="counters_8h_source.html#l00072">StatsPublicThreadContext_::m</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00040">Tmqh_::name</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00083">ThreadVars_::outctx</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00043">Tmqh_::OutHandler</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00044">Tmqh_::OutHandlerCtxSetup</a>, <a class="el" href="threadvars_8h_source.html#l00082">ThreadVars_::outq</a>, <a class="el" href="threadvars_8h_source.html#l00084">ThreadVars_::outqh_name</a>, <a class="el" href="threadvars_8h_source.html#l00110">ThreadVars_::perf_public_ctx</a>, <a class="el" href="tm-queues_8h_source.html#l00030">Tmq_::reader_cnt</a>, <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="util-error_8h_source.html#l00078">SC_ERR_THREAD_CREATE</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, <a class="el" href="threadvars_8h_source.html#l00053">THV_RESTART_THREAD</a>, <a class="el" href="threadvars_8h_source.html#l00036">THV_USE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tm-queues_8c_source.html#l00049">TmqCreateQueue()</a>, <a class="el" href="tm-queues_8c_source.html#l00068">TmqGetQueueByName()</a>, <a class="el" href="threadvars_8h_source.html#l00087">ThreadVars_::tmqh_in</a>, <a class="el" href="threadvars_8h_source.html#l00089">ThreadVars_::tmqh_out</a>, <a class="el" href="tm-queuehandlers_8c_source.html#l00056">TmqhGetQueueHandlerByName()</a>, <a class="el" href="tm-threads_8c_source.html#l01751">TmThreadInitMC()</a>, <a class="el" href="tm-threads_8c_source.html#l00641">TmThreadSetSlots()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, and <a class="el" href="tm-queues_8h_source.html#l00031">Tmq_::writer_cnt</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01239">TmThreadCreateCmdThreadByName()</a>, <a class="el" href="tm-threads_8c_source.html#l01178">TmThreadCreateMgmtThread()</a>, <a class="el" href="tm-threads_8c_source.html#l01206">TmThreadCreateMgmtThreadByName()</a>, and <a class="el" href="tm-threads_8c_source.html#l01148">TmThreadCreatePacketHandler()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_cgraph.png" border="0" usemap="#tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_cgraph" alt=""/></div>
<map name="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_cgraph" id="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_cgraph">
<area shape="rect" id="node2" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="216,5,341,32"/><area shape="rect" id="node3" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="199,56,358,83"/><area shape="rect" id="node4" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="173,107,384,133"/><area shape="rect" id="node5" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="219,157,339,184"/><area shape="rect" id="node6" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="213,461,344,488"/><area shape="rect" id="node16" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="971,253,1104,280"/><area shape="rect" id="node7" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="459,461,589,488"/><area shape="rect" id="node32" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="433,715,615,741"/><area shape="rect" id="node8" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="713,563,823,589"/><area shape="rect" id="node9" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="695,309,841,336"/><area shape="rect" id="node10" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="688,917,848,944"/><area shape="rect" id="node15" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="728,512,808,539"/><area shape="rect" id="node17" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="704,613,832,640"/><area shape="rect" id="node18" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="962,613,1113,640"/><area shape="rect" id="node19" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="664,461,872,488"/><area shape="rect" id="node20" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="694,664,842,691"/><area shape="rect" id="node21" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="691,157,845,184"/><area shape="rect" id="node24" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1233,89,1391,116"/><area shape="rect" id="node23" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1255,191,1369,217"/><area shape="rect" id="node22" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="921,89,1154,116"/><area shape="rect" id="node28" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="692,765,844,792"/><area shape="rect" id="node29" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="701,867,835,893"/><area shape="rect" id="node11" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="975,968,1099,995"/><area shape="rect" id="node12" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="967,867,1108,893"/><area shape="rect" id="node13" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1203,867,1421,893"/><area shape="rect" id="node14" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1470,867,1714,893"/><area shape="rect" id="node25" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1509,89,1675,116"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1763,89,1978,116"/><area shape="rect" id="node27" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2027,89,2114,116"/><area shape="rect" id="node30" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1267,968,1357,995"/><area shape="rect" id="node31" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="962,816,1113,843"/><area shape="rect" id="node33" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="715,1019,821,1045"/><area shape="rect" id="node35" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="721,968,815,995"/><area shape="rect" id="node34" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="966,1019,1109,1045"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_icgraph.png" border="0" usemap="#tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_icgraph" alt=""/></div>
<map name="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_icgraph" id="tm-threads_8c_af78474ba8e49604c9cf705c57cc95f51_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="174,5,413,32"/><area shape="rect" id="node6" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="197,56,390,83"/><area shape="rect" id="node8" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="953,107,1146,149"/><area shape="rect" id="node11" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="190,284,397,311"/><area shape="rect" id="node3" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="477,5,657,32"/><area shape="rect" id="node4" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1195,5,1397,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1445,107,1496,133"/><area shape="rect" id="node7" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1226,56,1366,83"/><area shape="rect" id="node9" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1206,157,1386,184"/><area shape="rect" id="node10" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1205,107,1387,133"/><area shape="rect" id="node12" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="491,157,643,184"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="487,208,646,235"/><area shape="rect" id="node16" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="484,259,649,285"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="481,309,652,336"/><area shape="rect" id="node19" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="461,613,672,640"/><area shape="rect" id="node32" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="485,411,648,437"/><area shape="rect" id="node37" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="485,360,648,387"/><area shape="rect" id="node13" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="729,208,895,235"/><area shape="rect" id="node14" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1201,512,1391,539"/><area shape="rect" id="node17" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="723,259,901,285"/><area shape="rect" id="node20" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="730,765,894,792"/><area shape="rect" id="node22" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="723,512,901,539"/><area shape="rect" id="node24" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="720,563,904,589"/><area shape="rect" id="node26" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="727,613,897,640"/><area shape="rect" id="node28" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="728,664,896,691"/><area shape="rect" id="node30" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="726,715,898,741"/><area shape="rect" id="node21" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="964,765,1135,792"/><area shape="rect" id="node23" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="965,512,1133,539"/><area shape="rect" id="node25" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="954,563,1145,589"/><area shape="rect" id="node27" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="961,613,1137,640"/><area shape="rect" id="node29" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="962,664,1137,691"/><area shape="rect" id="node31" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="960,715,1139,741"/><area shape="rect" id="node33" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="726,411,898,437"/><area shape="rect" id="node35" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="729,461,895,488"/><area shape="rect" id="node34" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="960,411,1139,437"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="963,461,1136,488"/><area shape="rect" id="node38" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="726,309,898,336"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="729,360,895,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ad83f5fc0de8d0ee23346b19ddf5c3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadCreateCmdThreadByName </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mucond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns the TV instance for a Command thread (CMD). This function supports only custom slot functions and hence a function pointer should be sent as an argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of this TV instance </td></tr>
    <tr><td class="paramname">module</td><td>Name of TmModule with COMMAND flag set. </td></tr>
    <tr><td class="paramname">mucond</td><td>Flag to indicate whether to initialize the condition and the mutex variables for this newly created TV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>newly created TV instance, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01239">1239</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="flow-hash_8h_source.html#l00206">m</a>, <a class="el" href="util-affinity_8h_source.html#l00057">MANAGEMENT_CPU_SET</a>, <a class="el" href="tm-modules_8c_source.html#l00051">TmModuleGetByName()</a>, <a class="el" href="tm-threads_8c_source.html#l00769">TmSlotSetFuncAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>, <a class="el" href="tm-threads_8c_source.html#l00935">TmThreadSetCPU()</a>, <a class="el" href="tm-threads_8c_source.html#l02097">TmThreadsRegisterThread()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00128">TVT_CMD</a>, and <a class="el" href="threadvars_8h_source.html#l00101">ThreadVars_::type</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-loader_8c_source.html#l00264">DetectLoaderThreadSpawn()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_cgraph.png" border="0" usemap="#tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_cgraph" alt=""/></div>
<map name="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_cgraph" id="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_cgraph">
<area shape="rect" id="node2" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="305,31,460,57"/><area shape="rect" id="node3" href="tm-threads_8c.html#a6cf6491e6eb3b8cd303e0e611091ea1e" title="Appends a new entry to the slots. " alt="" coords="304,81,461,108"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="323,132,443,159"/><area shape="rect" id="node39" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="317,183,448,209"/><area shape="rect" id="node40" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="294,233,471,260"/><area shape="rect" id="node5" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="563,5,688,32"/><area shape="rect" id="node6" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="546,56,705,83"/><area shape="rect" id="node7" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="520,107,731,133"/><area shape="rect" id="node8" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="565,157,685,184"/><area shape="rect" id="node9" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="560,461,691,488"/><area shape="rect" id="node19" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1317,253,1451,280"/><area shape="rect" id="node10" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="805,461,936,488"/><area shape="rect" id="node35" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="779,715,962,741"/><area shape="rect" id="node11" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="1059,563,1170,589"/><area shape="rect" id="node12" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="1042,309,1187,336"/><area shape="rect" id="node13" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="1035,917,1195,944"/><area shape="rect" id="node18" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="1075,512,1155,539"/><area shape="rect" id="node20" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="1051,613,1179,640"/><area shape="rect" id="node21" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="1309,613,1459,640"/><area shape="rect" id="node22" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="1011,461,1219,488"/><area shape="rect" id="node23" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="1041,664,1189,691"/><area shape="rect" id="node24" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="1037,157,1192,184"/><area shape="rect" id="node27" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1579,89,1738,116"/><area shape="rect" id="node26" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1601,191,1716,217"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="1267,89,1501,116"/><area shape="rect" id="node31" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="1039,765,1191,792"/><area shape="rect" id="node32" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="1047,867,1182,893"/><area shape="rect" id="node14" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="1322,968,1446,995"/><area shape="rect" id="node15" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="1313,867,1455,893"/><area shape="rect" id="node16" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1549,867,1768,893"/><area shape="rect" id="node17" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1817,867,2061,893"/><area shape="rect" id="node28" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1855,89,2022,116"/><area shape="rect" id="node29" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="2110,89,2325,116"/><area shape="rect" id="node30" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2374,89,2461,116"/><area shape="rect" id="node33" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1614,968,1703,995"/><area shape="rect" id="node34" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="1309,816,1459,843"/><area shape="rect" id="node36" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1061,1019,1168,1045"/><area shape="rect" id="node38" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="1068,968,1161,995"/><area shape="rect" id="node37" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="1313,1019,1455,1045"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_icgraph.png" border="0" usemap="#tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_icgraph" alt=""/></div>
<map name="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_icgraph" id="tm-threads_8c_a0ad83f5fc0de8d0ee23346b19ddf5c3d_icgraph">
<area shape="rect" id="node2" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="294,5,474,32"/><area shape="rect" id="node3" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="523,5,725,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="773,5,824,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a79b66d870752829f5f0ccb6c91b76dac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadCreateMgmtThread </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">fn_p)(void *, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mucond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom slot functions and hence a function pointer should be sent as an argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of this TV instance </td></tr>
    <tr><td class="paramname">fn_p</td><td>Pointer to function when "slots" is of type "custom" </td></tr>
    <tr><td class="paramname">mucond</td><td>Flag to indicate whether to initialize the condition and the mutex variables for this newly created TV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>newly created TV instance, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01178">1178</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="util-affinity_8h_source.html#l00057">MANAGEMENT_CPU_SET</a>, <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>, <a class="el" href="tm-threads_8c_source.html#l00935">TmThreadSetCPU()</a>, <a class="el" href="tm-threads_8c_source.html#l02097">TmThreadsRegisterThread()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00127">TVT_MGMT</a>, and <a class="el" href="threadvars_8h_source.html#l00101">ThreadVars_::type</a>.</p>

<p>Referenced by <a class="el" href="counters_8c_source.html#l00796">StatsSpawnThreads()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_cgraph.png" border="0" usemap="#tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_cgraph" alt=""/></div>
<map name="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_cgraph" id="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="277,132,397,159"/><area shape="rect" id="node37" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="272,183,403,209"/><area shape="rect" id="node38" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="249,233,426,260"/><area shape="rect" id="node3" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="517,5,643,32"/><area shape="rect" id="node4" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="501,56,659,83"/><area shape="rect" id="node5" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="475,107,685,133"/><area shape="rect" id="node6" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="520,157,640,184"/><area shape="rect" id="node7" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="515,461,645,488"/><area shape="rect" id="node17" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1272,253,1405,280"/><area shape="rect" id="node8" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="760,461,891,488"/><area shape="rect" id="node33" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="734,715,917,741"/><area shape="rect" id="node9" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="1014,563,1125,589"/><area shape="rect" id="node10" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="997,309,1142,336"/><area shape="rect" id="node11" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="989,917,1149,944"/><area shape="rect" id="node16" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="1029,512,1109,539"/><area shape="rect" id="node18" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="1005,613,1133,640"/><area shape="rect" id="node19" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="1263,613,1414,640"/><area shape="rect" id="node20" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="965,461,1173,488"/><area shape="rect" id="node21" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="995,664,1143,691"/><area shape="rect" id="node22" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="992,157,1147,184"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1534,89,1693,116"/><area shape="rect" id="node24" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1556,191,1671,217"/><area shape="rect" id="node23" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="1222,89,1455,116"/><area shape="rect" id="node29" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="993,765,1145,792"/><area shape="rect" id="node30" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="1002,867,1137,893"/><area shape="rect" id="node12" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="1277,968,1401,995"/><area shape="rect" id="node13" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="1268,867,1409,893"/><area shape="rect" id="node14" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1504,867,1723,893"/><area shape="rect" id="node15" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1771,867,2015,893"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1810,89,1977,116"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="2065,89,2279,116"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2329,89,2415,116"/><area shape="rect" id="node31" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1569,968,1658,995"/><area shape="rect" id="node32" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="1263,816,1414,843"/><area shape="rect" id="node34" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1016,1019,1123,1045"/><area shape="rect" id="node36" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="1023,968,1116,995"/><area shape="rect" id="node35" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="1267,1019,1410,1045"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_icgraph.png" border="0" usemap="#tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_icgraph" alt=""/></div>
<map name="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_icgraph" id="tm-threads_8c_a79b66d870752829f5f0ccb6c91b76dac_icgraph">
<area shape="rect" id="node2" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="249,5,389,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="437,5,488,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace687797a257f61387245ec3ec403916"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadCreateMgmtThreadByName </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mucond</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom slot functions and hence a function pointer should be sent as an argument. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of this TV instance </td></tr>
    <tr><td class="paramname">module</td><td>Name of TmModule with MANAGEMENT flag set. </td></tr>
    <tr><td class="paramname">mucond</td><td>Flag to indicate whether to initialize the condition and the mutex variables for this newly created TV.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>newly created TV instance, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01206">1206</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="flow-hash_8h_source.html#l00206">m</a>, <a class="el" href="util-affinity_8h_source.html#l00057">MANAGEMENT_CPU_SET</a>, <a class="el" href="tm-modules_8c_source.html#l00051">TmModuleGetByName()</a>, <a class="el" href="tm-threads_8c_source.html#l00769">TmSlotSetFuncAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>, <a class="el" href="tm-threads_8c_source.html#l00935">TmThreadSetCPU()</a>, <a class="el" href="tm-threads_8c_source.html#l02097">TmThreadsRegisterThread()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00127">TVT_MGMT</a>, and <a class="el" href="threadvars_8h_source.html#l00101">ThreadVars_::type</a>.</p>

<p>Referenced by <a class="el" href="flow-manager_8c_source.html#l00709">FlowManagerThreadSpawn()</a>, and <a class="el" href="flow-manager_8c_source.html#l00869">FlowRecyclerThreadSpawn()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ace687797a257f61387245ec3ec403916_cgraph.png" border="0" usemap="#tm-threads_8c_ace687797a257f61387245ec3ec403916_cgraph" alt=""/></div>
<map name="tm-threads_8c_ace687797a257f61387245ec3ec403916_cgraph" id="tm-threads_8c_ace687797a257f61387245ec3ec403916_cgraph">
<area shape="rect" id="node2" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="260,31,415,57"/><area shape="rect" id="node3" href="tm-threads_8c.html#a6cf6491e6eb3b8cd303e0e611091ea1e" title="Appends a new entry to the slots. " alt="" coords="259,81,416,108"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="277,132,397,159"/><area shape="rect" id="node39" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="272,183,403,209"/><area shape="rect" id="node40" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="249,233,426,260"/><area shape="rect" id="node5" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="517,5,643,32"/><area shape="rect" id="node6" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="501,56,659,83"/><area shape="rect" id="node7" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="475,107,685,133"/><area shape="rect" id="node8" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="520,157,640,184"/><area shape="rect" id="node9" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="515,461,645,488"/><area shape="rect" id="node19" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1272,253,1405,280"/><area shape="rect" id="node10" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="760,461,891,488"/><area shape="rect" id="node35" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="734,715,917,741"/><area shape="rect" id="node11" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="1014,563,1125,589"/><area shape="rect" id="node12" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="997,309,1142,336"/><area shape="rect" id="node13" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="989,917,1149,944"/><area shape="rect" id="node18" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="1029,512,1109,539"/><area shape="rect" id="node20" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="1005,613,1133,640"/><area shape="rect" id="node21" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="1263,613,1414,640"/><area shape="rect" id="node22" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="965,461,1173,488"/><area shape="rect" id="node23" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="995,664,1143,691"/><area shape="rect" id="node24" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="992,157,1147,184"/><area shape="rect" id="node27" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1534,89,1693,116"/><area shape="rect" id="node26" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1556,191,1671,217"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="1222,89,1455,116"/><area shape="rect" id="node31" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="993,765,1145,792"/><area shape="rect" id="node32" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="1002,867,1137,893"/><area shape="rect" id="node14" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="1277,968,1401,995"/><area shape="rect" id="node15" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="1268,867,1409,893"/><area shape="rect" id="node16" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1504,867,1723,893"/><area shape="rect" id="node17" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1771,867,2015,893"/><area shape="rect" id="node28" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1810,89,1977,116"/><area shape="rect" id="node29" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="2065,89,2279,116"/><area shape="rect" id="node30" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2329,89,2415,116"/><area shape="rect" id="node33" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1569,968,1658,995"/><area shape="rect" id="node34" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="1263,816,1414,843"/><area shape="rect" id="node36" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1016,1019,1123,1045"/><area shape="rect" id="node38" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="1023,968,1116,995"/><area shape="rect" id="node37" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="1267,1019,1410,1045"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ace687797a257f61387245ec3ec403916_icgraph.png" border="0" usemap="#tm-threads_8c_ace687797a257f61387245ec3ec403916_icgraph" alt=""/></div>
<map name="tm-threads_8c_ace687797a257f61387245ec3ec403916_icgraph" id="tm-threads_8c_ace687797a257f61387245ec3ec403916_icgraph">
<area shape="rect" id="node2" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="250,5,430,32"/><area shape="rect" id="node4" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="249,56,431,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="480,31,531,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac0e074117df241b52004b4b1c5228b8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadCreatePacketHandler </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>inq_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>inqh_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>outq_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>outqh_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>slots</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and returns a TV instance for a Packet Processing Thread. This function doesn't support custom slots, and hence shouldn't be supplied "custom" as its slot type. All PPT threads are created with a mucond(see TmThreadCreate declaration) of 0. Hence the tv conditional variables are not used to kill the thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of this TV instance </td></tr>
    <tr><td class="paramname">inq_name</td><td>Incoming queue name </td></tr>
    <tr><td class="paramname">inqh_name</td><td>Incoming queue handler name as set by <a class="el" href="runmode-unittests_8c.html#a58283282aed172d5cc1839bf01c21bc2">TmqhSetup()</a> </td></tr>
    <tr><td class="paramname">outq_name</td><td>Outgoing queue name </td></tr>
    <tr><td class="paramname">outqh_name</td><td>Outgoing queue handler as set by <a class="el" href="runmode-unittests_8c.html#a58283282aed172d5cc1839bf01c21bc2">TmqhSetup()</a> </td></tr>
    <tr><td class="paramname">slots</td><td>String representation for the slot function to be used</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>newly created TV instance, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01148">1148</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>, <a class="el" href="tm-threads_8c_source.html#l02097">TmThreadsRegisterThread()</a>, <a class="el" href="tm-threads-common_8h_source.html#l00126">TVT_PPT</a>, and <a class="el" href="threadvars_8h_source.html#l00101">ThreadVars_::type</a>.</p>

<p>Referenced by <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>, <a class="el" href="runmode-erf-file_8c_source.html#l00057">RunModeErfFileSingle()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00142">RunModeFilePcapAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00062">RunModeFilePcapSingle()</a>, <a class="el" href="util-runmodes_8c_source.html#l00482">RunModeSetIPSAutoFp()</a>, <a class="el" href="util-runmodes_8c_source.html#l00659">RunModeSetIPSWorker()</a>, and <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_cgraph.png" border="0" usemap="#tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_cgraph" alt=""/></div>
<map name="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_cgraph" id="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="291,132,411,159"/><area shape="rect" id="node37" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="262,183,439,209"/><area shape="rect" id="node3" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="531,5,656,32"/><area shape="rect" id="node4" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="514,56,673,83"/><area shape="rect" id="node5" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="488,107,699,133"/><area shape="rect" id="node6" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="533,157,653,184"/><area shape="rect" id="node7" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="528,461,659,488"/><area shape="rect" id="node17" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1285,253,1419,280"/><area shape="rect" id="node8" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="773,461,904,488"/><area shape="rect" id="node33" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="747,715,930,741"/><area shape="rect" id="node9" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="1027,563,1138,589"/><area shape="rect" id="node10" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="1010,309,1155,336"/><area shape="rect" id="node11" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="1003,917,1163,944"/><area shape="rect" id="node16" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="1043,512,1123,539"/><area shape="rect" id="node18" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="1019,613,1147,640"/><area shape="rect" id="node19" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="1277,613,1427,640"/><area shape="rect" id="node20" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="979,461,1187,488"/><area shape="rect" id="node21" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="1009,664,1157,691"/><area shape="rect" id="node22" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="1005,157,1160,184"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1547,89,1706,116"/><area shape="rect" id="node24" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1569,191,1684,217"/><area shape="rect" id="node23" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="1235,89,1469,116"/><area shape="rect" id="node29" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="1007,765,1159,792"/><area shape="rect" id="node30" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="1015,867,1150,893"/><area shape="rect" id="node12" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="1290,968,1414,995"/><area shape="rect" id="node13" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="1281,867,1423,893"/><area shape="rect" id="node14" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1517,867,1736,893"/><area shape="rect" id="node15" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1785,867,2029,893"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1823,89,1990,116"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="2078,89,2293,116"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2342,89,2429,116"/><area shape="rect" id="node31" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1582,968,1671,995"/><area shape="rect" id="node32" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="1277,816,1427,843"/><area shape="rect" id="node34" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1029,1019,1136,1045"/><area shape="rect" id="node36" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="1036,968,1129,995"/><area shape="rect" id="node35" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="1281,1019,1423,1045"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_icgraph.png" border="0" usemap="#tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_icgraph" alt=""/></div>
<map name="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_icgraph" id="tm-threads_8c_ac0e074117df241b52004b4b1c5228b8e_icgraph">
<area shape="rect" id="node2" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="287,56,446,83"/><area shape="rect" id="node6" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="291,5,443,32"/><area shape="rect" id="node7" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="281,157,452,184"/><area shape="rect" id="node9" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="284,107,449,133"/><area shape="rect" id="node10" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="285,259,448,285"/><area shape="rect" id="node15" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="285,208,448,235"/><area shape="rect" id="node18" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="261,461,472,488"/><area shape="rect" id="node3" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="529,56,695,83"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="993,385,1183,412"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1232,385,1283,412"/><area shape="rect" id="node8" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="523,107,701,133"/><area shape="rect" id="node11" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="526,259,698,285"/><area shape="rect" id="node13" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="529,309,695,336"/><area shape="rect" id="node12" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="759,259,937,285"/><area shape="rect" id="node14" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="761,309,935,336"/><area shape="rect" id="node16" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="526,157,698,184"/><area shape="rect" id="node17" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="529,208,695,235"/><area shape="rect" id="node19" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="530,360,694,387"/><area shape="rect" id="node21" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="523,411,701,437"/><area shape="rect" id="node23" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="520,461,704,488"/><area shape="rect" id="node25" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="527,512,697,539"/><area shape="rect" id="node27" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="528,563,696,589"/><area shape="rect" id="node29" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="526,613,698,640"/><area shape="rect" id="node20" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="763,360,933,387"/><area shape="rect" id="node22" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="764,411,932,437"/><area shape="rect" id="node24" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="753,461,943,488"/><area shape="rect" id="node26" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="760,512,936,539"/><area shape="rect" id="node28" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="761,563,935,589"/><area shape="rect" id="node30" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="759,613,937,640"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a06ce86ebf39159c57e35bed0e37dbc9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadDisablePacketThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable all threads having the specified TMs. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01510">1510</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00576">PacketQueue_::cond_q</a>, <a class="el" href="suricata_8h_source.html#l00129">data_queues</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="tm-queues_8h_source.html#l00028">Tmq_::name</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="tm-queues_8h_source.html#l00033">Tmq_::q_type</a>, <a class="el" href="tm-queues_8h_source.html#l00030">Tmq_::reader_cnt</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="flow-manager_8c.html#a65d6f6542420fa94bb0267932a0627c7">THREAD_KILL_MAX_WAIT_TIME</a>, <a class="el" href="threadvars_8h_source.html#l00040">THV_KILL</a>, <a class="el" href="threadvars_8h_source.html#l00046">THV_RUNNING_DONE</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, <a class="el" href="tm-threads-common_8h_source.html#l00126">TVT_PPT</a>, <a class="el" href="flow-manager_8c.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>, and <a class="el" href="tm-queues_8h_source.html#l00031">Tmq_::writer_cnt</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_cgraph.png" border="0" usemap="#tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_cgraph" alt=""/></div>
<map name="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_cgraph" id="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="267,5,418,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="276,56,409,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_icgraph.png" border="0" usemap="#tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_icgraph" alt=""/></div>
<map name="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_icgraph" id="tm-threads_8c_a06ce86ebf39159c57e35bed0e37dbc9e_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="267,5,317,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ead5949f2b33753f2695414139238c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadDisableReceiveThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable all threads having the specified TMs. </p>
<p>Breaks out of the packet acquisition loop, and bumps into the 'flow loop', where it will process packets from the flow engine's shutdown handling. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01418">1418</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00576">PacketQueue_::cond_q</a>, <a class="el" href="suricata_8h_source.html#l00129">data_queues</a>, <a class="el" href="tm-modules_8h_source.html#l00063">TmModule_::flags</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="tm-queues_8h_source.html#l00028">Tmq_::name</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="tm-queues_8h_source.html#l00033">Tmq_::q_type</a>, <a class="el" href="tm-queues_8h_source.html#l00030">Tmq_::reader_cnt</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="flow-manager_8c.html#a65d6f6542420fa94bb0267932a0627c7">THREAD_KILL_MAX_WAIT_TIME</a>, <a class="el" href="threadvars_8h_source.html#l00049">THV_FLOW_LOOP</a>, <a class="el" href="threadvars_8h_source.html#l00048">THV_KILL_PKTACQ</a>, <a class="el" href="tm-modules_8h_source.html#l00031">TM_FLAG_RECEIVE_TM</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-modules_8c_source.html#l00088">TmModuleGetById()</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, <a class="el" href="tm-threads-common_8h_source.html#l00126">TVT_PPT</a>, <a class="el" href="flow-manager_8c.html#ae7676cdfa371dfdcf6fb0687737c29a6">WAIT_TIME</a>, and <a class="el" href="tm-queues_8h_source.html#l00031">Tmq_::writer_cnt</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_cgraph.png" border="0" usemap="#tm-threads_8c_a9ead5949f2b33753f2695414139238c0_cgraph" alt=""/></div>
<map name="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_cgraph" id="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_cgraph">
<area shape="rect" id="node2" href="tm-modules_8c.html#a485c801500ee11c202386649e8064292" title="Returns a TM Module by its id. " alt="" coords="285,5,416,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="275,56,426,83"/><area shape="rect" id="node4" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="284,107,417,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_icgraph.png" border="0" usemap="#tm-threads_8c_a9ead5949f2b33753f2695414139238c0_icgraph" alt=""/></div>
<map name="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_icgraph" id="tm-threads_8c_a9ead5949f2b33753f2695414139238c0_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="275,5,325,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1658ac1d3a66d7c50006fc125933c2c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01642">1642</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00078">ThreadVars_::id</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="counters_8c_source.html#l01219">StatsThreadCleanup()</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, and <a class="el" href="tm-threads_8c_source.html#l02140">TmThreadsUnregisterThread()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01664">TmThreadClearThreadsFamily()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_cgraph.png" border="0" usemap="#tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_cgraph" alt=""/></div>
<map name="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_cgraph" id="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#a09bd1636d92f10107f55cf59f5b4a30f" title="StatsThreadCleanup" alt="" coords="184,12,325,39"/><area shape="rect" id="node4" href="tm-threads_8c.html#aa6938fc8a75cc9f64967bd1655b374d8" title="TmThreadsUnregisterThread" alt="" coords="161,63,349,89"/><area shape="rect" id="node3" href="counters_8c.html#aabceecc6ca3d6be4cc51adbf23597ff8" title="Releases the StatsPrivateThreadContext allocated by the user, for storing and updating local counter ..." alt="" coords="398,5,581,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_icgraph.png" border="0" usemap="#tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_icgraph" alt=""/></div>
<map name="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_icgraph" id="tm-threads_8c_a1658ac1d3a66d7c50006fc125933c2c1_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a10e0a9360bef968f5e7f26d483c5767a" title="TmThreadClearThreadsFamily" alt="" coords="161,5,359,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae28ba83501fd26a26c4707e61b2550ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a>* TmThreadGetFirstTmSlotForPartialPattern </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tm_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01582">1582</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-modules_8h_source.html#l00040">TmModule_::name</a>, <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-modules_8c_source.html#l00088">TmModuleGetById()</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00126">TVT_PPT</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ae28ba83501fd26a26c4707e61b2550ae_cgraph.png" border="0" usemap="#tm-threads_8c_ae28ba83501fd26a26c4707e61b2550ae_cgraph" alt=""/></div>
<map name="tm-threads_8c_ae28ba83501fd26a26c4707e61b2550ae_cgraph" id="tm-threads_8c_ae28ba83501fd26a26c4707e61b2550ae_cgraph">
<area shape="rect" id="node2" href="tm-modules_8c.html#a485c801500ee11c202386649e8064292" title="Returns a TM Module by its id. " alt="" coords="243,12,373,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6121f124848a0f3961e4eee3faf34f8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TmThreadGetNbThreads </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00951">951</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-affinity_8h_source.html#l00058">MAX_CPU_SET</a>, <a class="el" href="util-affinity_8h_source.html#l00074">ThreadsAffinityType_::nb_threads</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-affinity_8c_source.html#l00034">thread_affinity</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>.</p>

<p>Referenced by <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00142">RunModeFilePcapAutoFp()</a>, <a class="el" href="util-runmodes_8c_source.html#l00482">RunModeSetIPSAutoFp()</a>, and <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a6121f124848a0f3961e4eee3faf34f8e_icgraph.png" border="0" usemap="#tm-threads_8c_a6121f124848a0f3961e4eee3faf34f8e_icgraph" alt=""/></div>
<map name="tm-threads_8c_a6121f124848a0f3961e4eee3faf34f8e_icgraph" id="tm-threads_8c_a6121f124848a0f3961e4eee3faf34f8e_icgraph">
<area shape="rect" id="node2" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="247,5,406,32"/><area shape="rect" id="node6" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="241,56,412,83"/><area shape="rect" id="node8" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="245,107,408,133"/><area shape="rect" id="node13" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="221,309,432,336"/><area shape="rect" id="node3" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="725,5,891,32"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="953,233,1143,260"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1192,233,1243,260"/><area shape="rect" id="node7" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="483,56,661,83"/><area shape="rect" id="node9" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="486,107,658,133"/><area shape="rect" id="node11" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="489,157,655,184"/><area shape="rect" id="node10" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="719,107,897,133"/><area shape="rect" id="node12" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="721,157,895,184"/><area shape="rect" id="node14" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="490,208,654,235"/><area shape="rect" id="node16" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="483,259,661,285"/><area shape="rect" id="node18" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="480,309,664,336"/><area shape="rect" id="node20" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="487,360,657,387"/><area shape="rect" id="node22" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="488,411,656,437"/><area shape="rect" id="node24" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="486,461,658,488"/><area shape="rect" id="node15" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="723,208,893,235"/><area shape="rect" id="node17" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="724,259,892,285"/><area shape="rect" id="node19" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="713,309,903,336"/><area shape="rect" id="node21" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="720,360,896,387"/><area shape="rect" id="node23" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="721,411,895,437"/><area shape="rect" id="node25" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="719,461,897,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33a706eef27334eebefb3f0653a37b44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadInitMC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the mutex and condition variables for this TV. </p>
<p>It can be used by a thread to control a wait loop that can also be influenced by other threads.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to a TV instance </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01751">1751</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00116">ThreadVars_::ctrl_cond</a>, <a class="el" href="threadvars_8h_source.html#l00115">ThreadVars_::ctrl_mutex</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00047">SCCtrlCondInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00039">SCCtrlMutexInit</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, and <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a33a706eef27334eebefb3f0653a37b44_icgraph.png" border="0" usemap="#tm-threads_8c_a33a706eef27334eebefb3f0653a37b44_icgraph" alt=""/></div>
<map name="tm-threads_8c_a33a706eef27334eebefb3f0653a37b44_icgraph" id="tm-threads_8c_a33a706eef27334eebefb3f0653a37b44_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="173,81,293,108"/><area shape="rect" id="node3" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="342,5,581,32"/><area shape="rect" id="node7" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="365,56,558,83"/><area shape="rect" id="node9" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1121,107,1314,149"/><area shape="rect" id="node12" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="358,284,565,311"/><area shape="rect" id="node4" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="645,5,825,32"/><area shape="rect" id="node5" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1363,5,1565,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1613,107,1664,133"/><area shape="rect" id="node8" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1394,56,1534,83"/><area shape="rect" id="node10" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1374,157,1554,184"/><area shape="rect" id="node11" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1373,107,1555,133"/><area shape="rect" id="node13" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="659,157,811,184"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="655,208,814,235"/><area shape="rect" id="node17" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="652,259,817,285"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="649,309,820,336"/><area shape="rect" id="node20" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="629,613,840,640"/><area shape="rect" id="node33" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="653,411,816,437"/><area shape="rect" id="node38" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="653,360,816,387"/><area shape="rect" id="node14" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="897,208,1063,235"/><area shape="rect" id="node15" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1369,512,1559,539"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="891,259,1069,285"/><area shape="rect" id="node21" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="898,765,1062,792"/><area shape="rect" id="node23" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="891,512,1069,539"/><area shape="rect" id="node25" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="888,563,1072,589"/><area shape="rect" id="node27" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="895,613,1065,640"/><area shape="rect" id="node29" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="896,664,1064,691"/><area shape="rect" id="node31" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="894,715,1066,741"/><area shape="rect" id="node22" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1132,765,1303,792"/><area shape="rect" id="node24" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1133,512,1301,539"/><area shape="rect" id="node26" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1122,563,1313,589"/><area shape="rect" id="node28" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1129,613,1305,640"/><area shape="rect" id="node30" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1130,664,1305,691"/><area shape="rect" id="node32" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1128,715,1307,741"/><area shape="rect" id="node34" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="894,411,1066,437"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="897,461,1063,488"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1128,411,1307,437"/><area shape="rect" id="node37" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1131,461,1304,488"/><area shape="rect" id="node39" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="894,309,1066,336"/><area shape="rect" id="node40" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="897,360,1063,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a753d89c2cd996f5b019d2a5e0a6dd1d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadKillThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kill a thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>A ThreadVars instance corresponding to the thread that has to be killed. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01339">1339</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="decode_8h_source.html#l00576">PacketQueue_::cond_q</a>, <a class="el" href="threadvars_8h_source.html#l00116">ThreadVars_::ctrl_cond</a>, <a class="el" href="suricata_8h_source.html#l00129">data_queues</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="threadvars_8h_source.html#l00088">ThreadVars_::InShutdownHandler</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="tm-queues_8h_source.html#l00028">Tmq_::name</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00083">ThreadVars_::outctx</a>, <a class="el" href="tm-queuehandlers_8h_source.html#l00045">Tmqh_::OutHandlerCtxFree</a>, <a class="el" href="threadvars_8h_source.html#l00084">ThreadVars_::outqh_name</a>, <a class="el" href="tm-queues_8h_source.html#l00033">Tmq_::q_type</a>, <a class="el" href="tm-queues_8h_source.html#l00030">Tmq_::reader_cnt</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threadvars_8h_source.html#l00061">ThreadVars_::t</a>, <a class="el" href="threadvars_8h_source.html#l00042">THV_CLOSED</a>, <a class="el" href="threadvars_8h_source.html#l00045">THV_DEINIT</a>, <a class="el" href="threadvars_8h_source.html#l00040">THV_KILL</a>, <a class="el" href="tm-queuehandlers_8c_source.html#l00056">TmqhGetQueueHandlerByName()</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, and <a class="el" href="tm-queues_8h_source.html#l00031">Tmq_::writer_cnt</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01613">TmThreadKillThreadsFamily()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_cgraph.png" border="0" usemap="#tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_cgraph" alt=""/></div>
<map name="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_cgraph" id="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_cgraph">
<area shape="rect" id="node2" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="192,5,403,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="222,56,373,83"/><area shape="rect" id="node4" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="231,107,364,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_icgraph.png" border="0" usemap="#tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_icgraph" alt=""/></div>
<map name="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_icgraph" id="tm-threads_8c_a753d89c2cd996f5b019d2a5e0a6dd1d2_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#aafe5f632012afd5313df3fa692f2ccd8" title="TmThreadKillThreadsFamily" alt="" coords="193,5,378,32"/><area shape="rect" id="node3" href="tm-threads_8h.html#a09cc5ceb2d9be836871da62a8c419734" title="TmThreadKillThreads" alt="" coords="427,5,573,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="621,5,672,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09cc5ceb2d9be836871da62a8c419734"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadKillThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01631">1631</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads_8c_source.html#l01613">TmThreadKillThreadsFamily()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_cgraph.png" border="0" usemap="#tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_cgraph" alt=""/></div>
<map name="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_cgraph" id="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#aafe5f632012afd5313df3fa692f2ccd8" title="TmThreadKillThreadsFamily" alt="" coords="201,56,386,83"/><area shape="rect" id="node3" href="tm-threads_8c.html#a753d89c2cd996f5b019d2a5e0a6dd1d2" title="Kill a thread. " alt="" coords="435,56,573,83"/><area shape="rect" id="node4" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="621,5,832,32"/><area shape="rect" id="node5" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="651,56,802,83"/><area shape="rect" id="node6" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="660,107,793,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_icgraph.png" border="0" usemap="#tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_icgraph" alt=""/></div>
<map name="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_icgraph" id="tm-threads_8c_a09cc5ceb2d9be836871da62a8c419734_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="200,5,251,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aafe5f632012afd5313df3fa692f2ccd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadKillThreadsFamily </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01613">1613</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l01339">TmThreadKillThread()</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01631">TmThreadKillThreads()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_cgraph.png" border="0" usemap="#tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_cgraph" alt=""/></div>
<map name="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_cgraph" id="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a753d89c2cd996f5b019d2a5e0a6dd1d2" title="Kill a thread. " alt="" coords="240,56,379,83"/><area shape="rect" id="node3" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="427,5,637,32"/><area shape="rect" id="node4" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="457,56,607,83"/><area shape="rect" id="node5" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="465,107,599,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_icgraph.png" border="0" usemap="#tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_icgraph" alt=""/></div>
<map name="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_icgraph" id="tm-threads_8c_aafe5f632012afd5313df3fa692f2ccd8_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a09cc5ceb2d9be836871da62a8c419734" title="TmThreadKillThreads" alt="" coords="240,5,387,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="435,5,485,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7b2d67470344cffbf928bffc47229a0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadPause </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pauses a thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to a TV instance that has to be paused </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01852">1852</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, and <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01862">TmThreadPauseThreads()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_cgraph.png" border="0" usemap="#tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_cgraph" alt=""/></div>
<map name="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_cgraph" id="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="173,5,307,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_icgraph.png" border="0" usemap="#tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_icgraph" alt=""/></div>
<map name="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_icgraph" id="tm-threads_8c_a7b2d67470344cffbf928bffc47229a0e_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#ad1d51aa31a2d9b355d6fc3b30c2e688a" title="Pauses all threads present in tv_root. " alt="" coords="173,5,339,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1ff93094fe1627593600c899abadf3e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadPauseThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pauses all threads present in tv_root. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01862">1862</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l01852">TmThreadPause()</a>, <a class="el" href="tm-threads_8c_source.html#l02076">TmThreadsListThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a1ff93094fe1627593600c899abadf3e0_cgraph.png" border="0" usemap="#tm-threads_8c_a1ff93094fe1627593600c899abadf3e0_cgraph" alt=""/></div>
<map name="tm-threads_8c_a1ff93094fe1627593600c899abadf3e0_cgraph" id="tm-threads_8c_a1ff93094fe1627593600c899abadf3e0_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a7b2d67470344cffbf928bffc47229a0e" title="Pauses a thread. " alt="" coords="238,5,357,32"/><area shape="rect" id="node4" href="tm-threads_8c.html#a9c819d012b841b4861541195bb579eb3" title="TmThreadsListThreads" alt="" coords="219,56,375,83"/><area shape="rect" id="node3" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="424,5,557,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af367d3b08ee19db4d0f14dbecd2fa18b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadRemove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes this TV from tv_root based on its type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>The tv instance to remove from the global tv list. </td></tr>
    <tr><td class="paramname">type</td><td>Holds the type this TV belongs to. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01303">1303</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threadvars_8h_source.html#l00121">ThreadVars_::prev</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>.</p>

</div>
</div>
<a class="anchor" id="a3051b9f7e147aecbdfef8a693987e8f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TmThreadsCheckFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a thread flag is set. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>flag is set. </td></tr>
    <tr><td class="paramname">0</td><td>flag is not set. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00092">92</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="flow-manager_8c_source.html#l00106">FlowDisableFlowManagerThread()</a>, <a class="el" href="flow-manager_8c_source.html#l00918">FlowDisableFlowRecyclerThread()</a>, <a class="el" href="source-ipfw_8c_source.html#l00514">IPFWSetVerdict()</a>, <a class="el" href="tm-threads_8c_source.html#l01916">TmThreadCheckThreadState()</a>, <a class="el" href="tm-threads_8c_source.html#l01510">TmThreadDisablePacketThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01418">TmThreadDisableReceiveThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01339">TmThreadKillThread()</a>, <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>, <a class="el" href="tm-threads_8c_source.html#l01787">TmThreadTestThreadUnPaused()</a>, <a class="el" href="tm-threads_8c_source.html#l01805">TmThreadWaitForFlag()</a>, and <a class="el" href="tm-threads_8c_source.html#l01958">TmThreadWaitOnThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a3051b9f7e147aecbdfef8a693987e8f3_icgraph.png" border="0" usemap="#tm-threads_8c_a3051b9f7e147aecbdfef8a693987e8f3_icgraph" alt=""/></div>
<map name="tm-threads_8c_a3051b9f7e147aecbdfef8a693987e8f3_icgraph" id="tm-threads_8c_a3051b9f7e147aecbdfef8a693987e8f3_icgraph">
<area shape="rect" id="node2" href="flow-manager_8h.html#accf6fd4bc60c4c479d771a3633ef76d0" title="Used to disable flow manager thread(s). " alt="" coords="993,62,1205,89"/><area shape="rect" id="node4" href="flow-manager_8h.html#af0697852bbf2664d27f0344feb954ea4" title="Used to disable flow recycler thread(s). " alt="" coords="726,113,941,139"/><area shape="rect" id="node5" href="source-ipfw_8c.html#a8968707c6520c6915f9e360fc08d4d03" title="This function sets the Verdict and processes the packet. " alt="" coords="251,569,368,595"/><area shape="rect" id="node9" href="tm-threads_8h.html#ac7c8ef1a6d109517c07c2533c3d3216d" title="Used to check the thread for certain conditions of failure. If the thread has been specified to resta..." alt="" coords="1003,163,1194,190"/><area shape="rect" id="node10" href="tm-threads_8h.html#a06ce86ebf39159c57e35bed0e37dbc9e" title="Disable all threads having the specified TMs. " alt="" coords="461,214,675,241"/><area shape="rect" id="node11" href="tm-threads_8h.html#a9ead5949f2b33753f2695414139238c0" title="Disable all threads having the specified TMs. " alt="" coords="723,265,943,291"/><area shape="rect" id="node12" href="tm-threads_8h.html#aa10ec1b4bfaf123e488873736e02810a" title="Kill a thread. " alt="" coords="499,315,637,342"/><area shape="rect" id="node15" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="477,467,659,494"/><area shape="rect" id="node46" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="503,417,633,443"/><area shape="rect" id="node47" href="tm-threads_8h.html#a85a2e2fd6a381bdb598af4539f97d486" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="205,417,413,443"/><area shape="rect" id="node48" href="tm-threads_8h.html#aeb52a24324b5a4b46f2ec122a1a5f452" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="233,467,385,494"/><area shape="rect" id="node50" href="tm-threads_8h.html#a3af1510ae299a7c320b068b229b9ae3a" title="Used to check if all threads have finished their initialization. On finding an un&#45;initialized thread..." alt="" coords="218,11,401,38"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2051,265,2101,291"/><area shape="rect" id="node6" href="source-ipfw_8c.html#aac10f58ffca4d706d237d95d79744322" title="This function handles the Verdict processing. " alt="" coords="519,569,617,595"/><area shape="rect" id="node7" href="source-ipfw_8h.html#aee3db72356c63c2955b3abb9d65577f3" title="Registration Function for VerdictIPFW. " alt="" coords="730,569,937,595"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1031,569,1166,595"/><area shape="rect" id="node13" href="tm-threads_8h.html#aafe5f632012afd5313df3fa692f2ccd8" title="TmThreadKillThreadsFamily" alt="" coords="741,315,926,342"/><area shape="rect" id="node14" href="tm-threads_8h.html#a09cc5ceb2d9be836871da62a8c419734" title="TmThreadKillThreads" alt="" coords="1025,315,1172,342"/><area shape="rect" id="node16" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="768,467,899,494"/><area shape="rect" id="node17" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="1039,467,1159,494"/><area shape="rect" id="node18" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="1254,534,1493,561"/><area shape="rect" id="node21" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1277,391,1470,418"/><area shape="rect" id="node23" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1277,460,1470,501"/><area shape="rect" id="node26" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="1270,738,1477,765"/><area shape="rect" id="node19" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1557,539,1737,566"/><area shape="rect" id="node20" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1800,518,2003,545"/><area shape="rect" id="node22" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1577,387,1717,414"/><area shape="rect" id="node24" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1557,489,1737,515"/><area shape="rect" id="node25" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1555,438,1738,465"/><area shape="rect" id="node27" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1571,915,1723,942"/><area shape="rect" id="node29" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1567,865,1726,891"/><area shape="rect" id="node30" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1564,649,1729,675"/><area shape="rect" id="node32" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1561,598,1732,625"/><area shape="rect" id="node33" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1541,713,1752,739"/><area shape="rect" id="node40" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1565,763,1728,790"/><area shape="rect" id="node43" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1565,814,1728,841"/><area shape="rect" id="node28" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1819,1126,1984,1153"/><area shape="rect" id="node31" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1812,569,1991,595"/><area shape="rect" id="node34" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1819,873,1983,899"/><area shape="rect" id="node35" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1812,619,1991,646"/><area shape="rect" id="node36" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1809,670,1993,697"/><area shape="rect" id="node37" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1817,721,1986,747"/><area shape="rect" id="node38" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1817,771,1985,798"/><area shape="rect" id="node39" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1815,822,1987,849"/><area shape="rect" id="node41" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1815,974,1987,1001"/><area shape="rect" id="node42" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1818,923,1985,950"/><area shape="rect" id="node44" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1815,1075,1987,1102"/><area shape="rect" id="node45" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1818,1025,1985,1051"/><area shape="rect" id="node49" href="tm-threads_8h.html#a6c2161fae3aaccd4a4ac33c9fed7a7f2" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="1313,602,1434,629"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4bbe73bf03f22e82bc0364e425c14a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadSetAOF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>aof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the thread flags for a thread instance(tv) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the thread instance for which the flag has to be set </td></tr>
    <tr><td class="paramname">flags</td><td>Holds the thread state this thread instance has to be set to Sets the aof(Action on failure) for a thread instance(tv)</td></tr>
    <tr><td class="paramname">tv</td><td>Pointer to the thread instance for which the aof has to be set </td></tr>
    <tr><td class="paramname">aof</td><td>Holds the aof this thread instance has to be set to </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01735">1735</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00069">ThreadVars_::aof</a>.</p>

</div>
</div>
<a class="anchor" id="ae91e211f1f8350abcd67b23c58dcf577"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSetCPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00935">935</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00103">ThreadVars_::cpu_affinity</a>, <a class="el" href="util-affinity_8h_source.html#l00058">MAX_CPU_SET</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="threadvars_8h_source.html#l00127">THREAD_SET_AFFTYPE</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, <a class="el" href="runmodes_8h_source.html#l00095">threading_set_cpu_affinity</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>.</p>

<p>Referenced by <a class="el" href="runmode-pcap-file_8c_source.html#l00142">RunModeFilePcapAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00062">RunModeFilePcapSingle()</a>, <a class="el" href="util-runmodes_8c_source.html#l00482">RunModeSetIPSAutoFp()</a>, <a class="el" href="util-runmodes_8c_source.html#l00659">RunModeSetIPSWorker()</a>, <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>, <a class="el" href="tm-threads_8c_source.html#l01239">TmThreadCreateCmdThreadByName()</a>, <a class="el" href="tm-threads_8c_source.html#l01178">TmThreadCreateMgmtThread()</a>, and <a class="el" href="tm-threads_8c_source.html#l01206">TmThreadCreateMgmtThreadByName()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ae91e211f1f8350abcd67b23c58dcf577_icgraph.png" border="0" usemap="#tm-threads_8c_ae91e211f1f8350abcd67b23c58dcf577_icgraph" alt=""/></div>
<map name="tm-threads_8c_ae91e211f1f8350abcd67b23c58dcf577_icgraph" id="tm-threads_8c_ae91e211f1f8350abcd67b23c58dcf577_icgraph">
<area shape="rect" id="node2" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="219,512,389,539"/><area shape="rect" id="node6" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="221,461,387,488"/><area shape="rect" id="node7" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="223,157,385,184"/><area shape="rect" id="node12" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="223,56,385,83"/><area shape="rect" id="node15" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="199,360,409,387"/><area shape="rect" id="node28" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="185,563,423,589"/><area shape="rect" id="node31" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="207,613,401,640"/><area shape="rect" id="node33" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="705,665,898,706"/><area shape="rect" id="node3" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="475,512,653,539"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="953,335,1143,361"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1197,613,1248,640"/><area shape="rect" id="node8" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="478,107,650,133"/><area shape="rect" id="node10" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="481,157,647,184"/><area shape="rect" id="node9" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="712,107,891,133"/><area shape="rect" id="node11" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="715,157,888,184"/><area shape="rect" id="node13" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="478,5,650,32"/><area shape="rect" id="node14" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="481,56,647,83"/><area shape="rect" id="node16" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="482,259,646,285"/><area shape="rect" id="node18" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="475,309,653,336"/><area shape="rect" id="node20" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="472,360,656,387"/><area shape="rect" id="node22" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="479,411,649,437"/><area shape="rect" id="node24" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="480,461,648,488"/><area shape="rect" id="node26" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="478,208,650,235"/><area shape="rect" id="node17" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="716,259,887,285"/><area shape="rect" id="node19" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="717,309,885,336"/><area shape="rect" id="node21" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="706,360,897,387"/><area shape="rect" id="node23" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="713,411,889,437"/><area shape="rect" id="node25" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="714,461,889,488"/><area shape="rect" id="node27" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="712,208,891,235"/><area shape="rect" id="node29" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="711,563,891,589"/><area shape="rect" id="node30" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="947,563,1149,589"/><area shape="rect" id="node32" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="978,613,1118,640"/><area shape="rect" id="node34" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="958,715,1138,741"/><area shape="rect" id="node35" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="957,664,1139,691"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6ba178d0197498f1397f9be8247ebb75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSetCPUAffinity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>cpu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the thread options (cpu affinity). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>pointer to the ThreadVars to setup the affinity. </td></tr>
    <tr><td class="paramname">cpu</td><td>cpu on which affinity is set.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TM_ECODE_OK</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00926">926</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00103">ThreadVars_::cpu_affinity</a>, <a class="el" href="threadvars_8h_source.html#l00125">THREAD_SET_AFFINITY</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a6ba178d0197498f1397f9be8247ebb75_icgraph.png" border="0" usemap="#tm-threads_8c_a6ba178d0197498f1397f9be8247ebb75_icgraph" alt=""/></div>
<map name="tm-threads_8c_a6ba178d0197498f1397f9be8247ebb75_icgraph" id="tm-threads_8c_a6ba178d0197498f1397f9be8247ebb75_icgraph">
<area shape="rect" id="node2" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="225,5,383,32"/><area shape="rect" id="node3" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="432,5,597,32"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="646,5,837,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="885,5,936,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2281ca1569730c81dffeb4779b399cef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadSetPrio </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjusting nice value for threads. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00891">891</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="util-error_8h_source.html#l00077">SC_ERR_THREAD_NICE_PRIO</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, and <a class="el" href="threadvars_8h_source.html#l00105">ThreadVars_::thread_priority</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00967">TmThreadSetupOptions()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a2281ca1569730c81dffeb4779b399cef_icgraph.png" border="0" usemap="#tm-threads_8c_a2281ca1569730c81dffeb4779b399cef_icgraph" alt=""/></div>
<map name="tm-threads_8c_a2281ca1569730c81dffeb4779b399cef_icgraph" id="tm-threads_8c_a2281ca1569730c81dffeb4779b399cef_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a0f83441e03b28d0fb0dfba2923ffaa0d" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="179,81,339,108"/><area shape="rect" id="node3" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="387,56,570,83"/><area shape="rect" id="node44" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="413,107,544,133"/><area shape="rect" id="node4" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="619,81,749,108"/><area shape="rect" id="node5" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="797,81,917,108"/><area shape="rect" id="node6" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="966,5,1205,32"/><area shape="rect" id="node10" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="989,56,1182,83"/><area shape="rect" id="node12" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1745,107,1938,149"/><area shape="rect" id="node15" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="982,284,1189,311"/><area shape="rect" id="node7" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1269,5,1449,32"/><area shape="rect" id="node8" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1987,5,2189,32"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2237,107,2288,133"/><area shape="rect" id="node11" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="2018,56,2158,83"/><area shape="rect" id="node13" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1998,157,2178,184"/><area shape="rect" id="node14" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1997,107,2179,133"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1283,157,1435,184"/><area shape="rect" id="node19" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1279,208,1438,235"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1276,259,1441,285"/><area shape="rect" id="node22" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1273,309,1444,336"/><area shape="rect" id="node23" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1253,613,1464,640"/><area shape="rect" id="node36" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1277,411,1440,437"/><area shape="rect" id="node41" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1277,360,1440,387"/><area shape="rect" id="node17" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1521,208,1687,235"/><area shape="rect" id="node18" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1993,512,2183,539"/><area shape="rect" id="node21" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1515,259,1693,285"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1522,765,1686,792"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1515,512,1693,539"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1512,563,1696,589"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1519,613,1689,640"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1520,664,1688,691"/><area shape="rect" id="node34" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1518,715,1690,741"/><area shape="rect" id="node25" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1756,765,1927,792"/><area shape="rect" id="node27" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1757,512,1925,539"/><area shape="rect" id="node29" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1746,563,1937,589"/><area shape="rect" id="node31" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1753,613,1929,640"/><area shape="rect" id="node33" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1754,664,1929,691"/><area shape="rect" id="node35" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1752,715,1931,741"/><area shape="rect" id="node37" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1518,411,1690,437"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1521,461,1687,488"/><area shape="rect" id="node38" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1752,411,1931,437"/><area shape="rect" id="node40" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1755,461,1928,488"/><area shape="rect" id="node42" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1518,309,1690,336"/><area shape="rect" id="node43" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1521,360,1687,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a25369baa1a83811c880d10bf95cad079"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSetSlots </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *(*)(void *)&#160;</td>
          <td class="paramname"><em>fn_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We set the slot functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the TV to set the slot function for. </td></tr>
    <tr><td class="paramname">name</td><td>Name of the slot variant. </td></tr>
    <tr><td class="paramname">fn_p</td><td>Pointer to a custom slot function. Used only if slot variant "name" is "custom".</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TmEcode</td><td>TM_ECODE_OK on success; TM_ECODE_FAILED on failure. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00641">641</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="threadvars_8h_source.html#l00092">ThreadVars_::tm_func</a>, <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_cgraph.png" border="0" usemap="#tm-threads_8c_a25369baa1a83811c880d10bf95cad079_cgraph" alt=""/></div>
<map name="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_cgraph" id="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="185,667,367,694"/><area shape="rect" id="node22" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="211,439,341,466"/><area shape="rect" id="node3" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="465,515,575,542"/><area shape="rect" id="node4" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="440,819,600,846"/><area shape="rect" id="node9" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="467,971,573,998"/><area shape="rect" id="node12" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="480,566,560,593"/><area shape="rect" id="node13" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="723,313,856,339"/><area shape="rect" id="node14" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="473,921,567,947"/><area shape="rect" id="node15" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="456,617,584,643"/><area shape="rect" id="node16" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="714,566,865,593"/><area shape="rect" id="node17" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="416,465,624,491"/><area shape="rect" id="node18" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="446,414,594,441"/><area shape="rect" id="node19" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="444,667,596,694"/><area shape="rect" id="node20" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="453,870,587,897"/><area shape="rect" id="node5" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="727,819,851,846"/><area shape="rect" id="node6" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="719,769,860,795"/><area shape="rect" id="node7" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="955,769,1173,795"/><area shape="rect" id="node8" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1222,769,1466,795"/><area shape="rect" id="node10" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="718,971,861,998"/><area shape="rect" id="node11" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1019,921,1109,947"/><area shape="rect" id="node21" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="714,921,865,947"/><area shape="rect" id="node23" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="447,262,593,289"/><area shape="rect" id="node24" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="443,161,597,187"/><area shape="rect" id="node27" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="985,161,1143,187"/><area shape="rect" id="node26" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1007,59,1121,86"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="673,110,906,137"/><area shape="rect" id="node28" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1261,161,1427,187"/><area shape="rect" id="node29" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1515,161,1730,187"/><area shape="rect" id="node30" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1779,161,1866,187"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_icgraph.png" border="0" usemap="#tm-threads_8c_a25369baa1a83811c880d10bf95cad079_icgraph" alt=""/></div>
<map name="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_icgraph" id="tm-threads_8c_a25369baa1a83811c880d10bf95cad079_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="184,81,304,108"/><area shape="rect" id="node3" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="353,5,591,32"/><area shape="rect" id="node7" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="375,56,569,83"/><area shape="rect" id="node9" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1131,107,1325,149"/><area shape="rect" id="node12" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="369,284,575,311"/><area shape="rect" id="node4" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="655,5,835,32"/><area shape="rect" id="node5" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1373,5,1576,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1624,107,1675,133"/><area shape="rect" id="node8" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1405,56,1545,83"/><area shape="rect" id="node10" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1385,157,1565,184"/><area shape="rect" id="node11" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1383,107,1566,133"/><area shape="rect" id="node13" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="669,157,821,184"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="666,208,825,235"/><area shape="rect" id="node17" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="663,259,828,285"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="660,309,831,336"/><area shape="rect" id="node20" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="640,613,851,640"/><area shape="rect" id="node33" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="664,411,827,437"/><area shape="rect" id="node38" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="664,360,827,387"/><area shape="rect" id="node14" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="908,208,1073,235"/><area shape="rect" id="node15" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1379,512,1570,539"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="901,259,1080,285"/><area shape="rect" id="node21" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="909,765,1073,792"/><area shape="rect" id="node23" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="901,512,1080,539"/><area shape="rect" id="node25" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="899,563,1083,589"/><area shape="rect" id="node27" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="906,613,1075,640"/><area shape="rect" id="node29" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="907,664,1075,691"/><area shape="rect" id="node31" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="905,715,1077,741"/><area shape="rect" id="node22" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1143,765,1313,792"/><area shape="rect" id="node24" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1144,512,1312,539"/><area shape="rect" id="node26" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1133,563,1323,589"/><area shape="rect" id="node28" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1140,613,1316,640"/><area shape="rect" id="node30" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1141,664,1315,691"/><area shape="rect" id="node32" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1139,715,1317,741"/><area shape="rect" id="node34" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="905,411,1077,437"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="907,461,1074,488"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1139,411,1317,437"/><area shape="rect" id="node37" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1141,461,1315,488"/><area shape="rect" id="node39" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="905,309,1077,336"/><area shape="rect" id="node40" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="907,360,1074,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa719128e8936ee43f9c460d37ee8238f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSetThreadPriority </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the thread options (thread priority). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the ThreadVars to setup the thread priority.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TM_ECODE_OK.</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00880">880</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00105">ThreadVars_::thread_priority</a>, <a class="el" href="threadvars_8h_source.html#l00126">THREAD_SET_PRIORITY</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aa719128e8936ee43f9c460d37ee8238f_icgraph.png" border="0" usemap="#tm-threads_8c_aa719128e8936ee43f9c460d37ee8238f_icgraph" alt=""/></div>
<map name="tm-threads_8c_aa719128e8936ee43f9c460d37ee8238f_icgraph" id="tm-threads_8c_aa719128e8936ee43f9c460d37ee8238f_icgraph">
<area shape="rect" id="node2" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="238,5,397,32"/><area shape="rect" id="node3" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="445,5,611,32"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="659,5,850,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="899,5,949,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeda67fab252b97fe5f158ba053a45de7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSetupOptions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>pointer to the ThreadVars of the calling thread. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00967">967</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-affinity_8c_source.html#l00298">AffinityGetNextCPU()</a>, <a class="el" href="threadvars_8h_source.html#l00103">ThreadVars_::cpu_affinity</a>, <a class="el" href="util-affinity_8h_source.html#l00070">ThreadsAffinityType_::cpu_set</a>, <a class="el" href="util-affinity_8h_source.html#l00063">EXCLUSIVE_AFFINITY</a>, <a class="el" href="util-affinity_8h_source.html#l00078">ThreadsAffinityType_::hiprio_cpu</a>, <a class="el" href="util-affinity_8h_source.html#l00076">ThreadsAffinityType_::lowprio_cpu</a>, <a class="el" href="util-affinity_8h_source.html#l00077">ThreadsAffinityType_::medprio_cpu</a>, <a class="el" href="util-affinity_8h_source.html#l00072">ThreadsAffinityType_::mode_flag</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="util-affinity_8h_source.html#l00073">ThreadsAffinityType_::prio</a>, <a class="el" href="threads_8h_source.html#l00088">PRIO_HIGH</a>, <a class="el" href="threads_8h_source.html#l00086">PRIO_LOW</a>, <a class="el" href="threads_8h_source.html#l00087">PRIO_MEDIUM</a>, <a class="el" href="threads_8h_source.html#l00247">SCGetThreadIdLong</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-affinity_8c_source.html#l00034">thread_affinity</a>, <a class="el" href="threadvars_8h_source.html#l00105">ThreadVars_::thread_priority</a>, <a class="el" href="threadvars_8h_source.html#l00125">THREAD_SET_AFFINITY</a>, <a class="el" href="threadvars_8h_source.html#l00127">THREAD_SET_AFFTYPE</a>, <a class="el" href="threadvars_8h_source.html#l00126">THREAD_SET_PRIORITY</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, and <a class="el" href="tm-threads_8c_source.html#l00891">TmThreadSetPrio()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_cgraph.png" border="0" usemap="#tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_cgraph" alt=""/></div>
<map name="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_cgraph" id="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_cgraph">
<area shape="rect" id="node2" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="213,5,355,32"/><area shape="rect" id="node5" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="222,56,346,83"/><area shape="rect" id="node3" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="403,5,621,32"/><area shape="rect" id="node4" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="670,5,914,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_icgraph.png" border="0" usemap="#tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_icgraph" alt=""/></div>
<map name="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_icgraph" id="tm-threads_8c_aeda67fab252b97fe5f158ba053a45de7_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="214,56,397,83"/><area shape="rect" id="node43" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="240,107,371,133"/><area shape="rect" id="node3" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="445,81,576,108"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="624,81,744,108"/><area shape="rect" id="node5" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="793,5,1031,32"/><area shape="rect" id="node9" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="815,56,1009,83"/><area shape="rect" id="node11" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1571,107,1765,149"/><area shape="rect" id="node14" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="809,284,1015,311"/><area shape="rect" id="node6" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1095,5,1275,32"/><area shape="rect" id="node7" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1813,5,2016,32"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2064,107,2115,133"/><area shape="rect" id="node10" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1845,56,1985,83"/><area shape="rect" id="node12" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1825,157,2005,184"/><area shape="rect" id="node13" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1823,107,2006,133"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1109,157,1261,184"/><area shape="rect" id="node18" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1106,208,1265,235"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1103,259,1268,285"/><area shape="rect" id="node21" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1100,309,1271,336"/><area shape="rect" id="node22" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1080,613,1291,640"/><area shape="rect" id="node35" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1104,411,1267,437"/><area shape="rect" id="node40" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1104,360,1267,387"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1348,208,1513,235"/><area shape="rect" id="node17" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1819,512,2010,539"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1341,259,1520,285"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1349,765,1513,792"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1341,512,1520,539"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1339,563,1523,589"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1346,613,1515,640"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1347,664,1515,691"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1345,715,1517,741"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1583,765,1753,792"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1584,512,1752,539"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1573,563,1763,589"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1580,613,1756,640"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1581,664,1755,691"/><area shape="rect" id="node34" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1579,715,1757,741"/><area shape="rect" id="node36" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1345,411,1517,437"/><area shape="rect" id="node38" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1347,461,1514,488"/><area shape="rect" id="node37" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1579,411,1757,437"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1581,461,1755,488"/><area shape="rect" id="node41" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1345,309,1517,336"/><area shape="rect" id="node42" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1347,360,1514,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adafcd43c520c1596655540c7b8082471"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadsGetCallingThread </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the TV for the calling thread. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">tv</td><td>Pointer to the ThreadVars instance for the calling thread; NULL on no match </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02013">2013</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="threadvars_8h_source.html#l00061">ThreadVars_::t</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

</div>
</div>
<a class="anchor" id="aed496257ee64f54e5f3005057052f385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* TmThreadsGetTVContainingSlot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *&#160;</td>
          <td class="paramname"><em>tm_slot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00676">676</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>.</p>

</div>
</div>
<a class="anchor" id="ad05e0376acf69238bdc79a5f5393201a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TmThreadsInjectPacketsById </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> **&#160;</td>
          <td class="paramname"><em>packets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">r</td><td>1 if packet was accepted, 0 otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>if packet was not accepted, it's still the responsibility of the caller. </dd></dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02178">2178</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00576">PacketQueue_::cond_q</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="decode_8h_source.html#l00575">PacketQueue_::mutex_q</a>, <a class="el" href="packet-queue_8c_source.html#l00136">PacketEnqueue()</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="threadvars_8h_source.html#l00096">ThreadVars_::stream_pq</a>, <a class="el" href="tm-threads_8c_source.html#l02068">Threads_::threads</a>, <a class="el" href="tm-threads_8c_source.html#l02069">Threads_::threads_size</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, and <a class="el" href="tm-threads_8c_source.html#l02061">Thread_::tv</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ad05e0376acf69238bdc79a5f5393201a_cgraph.png" border="0" usemap="#tm-threads_8c_ad05e0376acf69238bdc79a5f5393201a_cgraph" alt=""/></div>
<map name="tm-threads_8c_ad05e0376acf69238bdc79a5f5393201a_cgraph" id="tm-threads_8c_ad05e0376acf69238bdc79a5f5393201a_cgraph">
<area shape="rect" id="node2" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="248,5,363,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c819d012b841b4861541195bb579eb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadsListThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02076">2076</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads_8c_source.html#l02064">Thread_::in_use</a>, <a class="el" href="tm-threads_8c_source.html#l02062">Thread_::name</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l02068">Threads_::threads</a>, <a class="el" href="tm-threads_8c_source.html#l02069">Threads_::threads_size</a>, <a class="el" href="tm-threads_8c_source.html#l02061">Thread_::tv</a>, and <a class="el" href="tm-threads_8c_source.html#l02063">Thread_::type</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01862">TmThreadPauseThreads()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a9c819d012b841b4861541195bb579eb3_icgraph.png" border="0" usemap="#tm-threads_8c_a9c819d012b841b4861541195bb579eb3_icgraph" alt=""/></div>
<map name="tm-threads_8c_a9c819d012b841b4861541195bb579eb3_icgraph" id="tm-threads_8c_a9c819d012b841b4861541195bb579eb3_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#ad1d51aa31a2d9b355d6fc3b30c2e688a" title="Pauses all threads present in tv_root. " alt="" coords="211,5,376,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af5c7ad411065ae98710138b400f84633"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadSpawn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spawns a thread associated with the ThreadVars instance tv. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TM_ECODE_OK</td><td>on success and TM_ECODE_FAILED on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01689">1689</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00061">ThreadVars_::t</a>, <a class="el" href="threadvars_8h_source.html#l00037">THV_INIT_DONE</a>, <a class="el" href="threadvars_8h_source.html#l00046">THV_RUNNING_DONE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="threadvars_8h_source.html#l00092">ThreadVars_::tm_func</a>, <a class="el" href="tm-threads_8c_source.html#l01265">TmThreadAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01805">TmThreadWaitForFlag()</a>, and <a class="el" href="threadvars_8h_source.html#l00101">ThreadVars_::type</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-loader_8c_source.html#l00264">DetectLoaderThreadSpawn()</a>, <a class="el" href="flow-manager_8c_source.html#l00709">FlowManagerThreadSpawn()</a>, <a class="el" href="flow-manager_8c_source.html#l00869">FlowRecyclerThreadSpawn()</a>, <a class="el" href="runmode-erf-file_8c_source.html#l00125">RunModeErfFileAutoFp()</a>, <a class="el" href="runmode-erf-file_8c_source.html#l00057">RunModeErfFileSingle()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00142">RunModeFilePcapAutoFp()</a>, <a class="el" href="runmode-pcap-file_8c_source.html#l00062">RunModeFilePcapSingle()</a>, <a class="el" href="util-runmodes_8c_source.html#l00482">RunModeSetIPSAutoFp()</a>, <a class="el" href="util-runmodes_8c_source.html#l00659">RunModeSetIPSWorker()</a>, <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>, and <a class="el" href="counters_8c_source.html#l00796">StatsSpawnThreads()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_af5c7ad411065ae98710138b400f84633_cgraph.png" border="0" usemap="#tm-threads_8c_af5c7ad411065ae98710138b400f84633_cgraph" alt=""/></div>
<map name="tm-threads_8c_af5c7ad411065ae98710138b400f84633_cgraph" id="tm-threads_8c_af5c7ad411065ae98710138b400f84633_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type. " alt="" coords="189,5,315,32"/><area shape="rect" id="node3" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="176,56,328,83"/><area shape="rect" id="node4" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="377,56,527,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_af5c7ad411065ae98710138b400f84633_icgraph.png" border="0" usemap="#tm-threads_8c_af5c7ad411065ae98710138b400f84633_icgraph" alt=""/></div>
<map name="tm-threads_8c_af5c7ad411065ae98710138b400f84633_icgraph" id="tm-threads_8c_af5c7ad411065ae98710138b400f84633_icgraph">
<area shape="rect" id="node2" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="191,5,371,32"/><area shape="rect" id="node5" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="918,56,1098,83"/><area shape="rect" id="node6" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="917,107,1099,133"/><area shape="rect" id="node7" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="202,436,361,463"/><area shape="rect" id="node10" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="205,385,357,412"/><area shape="rect" id="node11" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="196,537,367,564"/><area shape="rect" id="node13" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="199,487,364,513"/><area shape="rect" id="node14" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="200,664,363,691"/><area shape="rect" id="node19" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="200,588,363,615"/><area shape="rect" id="node22" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="176,309,387,336"/><area shape="rect" id="node35" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="938,588,1078,615"/><area shape="rect" id="node3" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="907,5,1109,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1157,107,1208,133"/><area shape="rect" id="node8" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="444,461,609,488"/><area shape="rect" id="node9" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="913,360,1103,387"/><area shape="rect" id="node12" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="437,512,616,539"/><area shape="rect" id="node15" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="441,664,613,691"/><area shape="rect" id="node17" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="443,715,610,741"/><area shape="rect" id="node16" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="673,563,852,589"/><area shape="rect" id="node18" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="676,613,849,640"/><area shape="rect" id="node20" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="441,563,613,589"/><area shape="rect" id="node21" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="443,613,610,640"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="445,259,609,285"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="437,309,616,336"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="435,360,619,387"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="442,411,611,437"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="443,157,611,184"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="441,208,613,235"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="677,259,848,285"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="679,309,847,336"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="667,360,858,387"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="675,411,851,437"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="675,157,850,184"/><area shape="rect" id="node34" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="673,208,852,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7b792091fc079fe5b2cf755e5f53849a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TmThreadsRegisterThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">id</td><td>thread id, or 0 if not found </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02097">2097</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="tm-threads_8c_source.html#l02064">Thread_::in_use</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="tm-threads_8c_source.html#l02062">Thread_::name</a>, <a class="el" href="util-mem_8h_source.html#l00205">SCCalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-mem_8h_source.html#l00190">SCRealloc</a>, <a class="el" href="tm-threads_8c_source.html#l02093">STEP</a>, <a class="el" href="tm-threads_8c_source.html#l02068">Threads_::threads</a>, <a class="el" href="tm-threads_8c_source.html#l02069">Threads_::threads_size</a>, <a class="el" href="tm-threads_8c_source.html#l02061">Thread_::tv</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>, and <a class="el" href="tm-threads_8c_source.html#l02063">Thread_::type</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01239">TmThreadCreateCmdThreadByName()</a>, <a class="el" href="tm-threads_8c_source.html#l01178">TmThreadCreateMgmtThread()</a>, <a class="el" href="tm-threads_8c_source.html#l01206">TmThreadCreateMgmtThreadByName()</a>, and <a class="el" href="tm-threads_8c_source.html#l01148">TmThreadCreatePacketHandler()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a7b792091fc079fe5b2cf755e5f53849a_icgraph.png" border="0" usemap="#tm-threads_8c_a7b792091fc079fe5b2cf755e5f53849a_icgraph" alt=""/></div>
<map name="tm-threads_8c_a7b792091fc079fe5b2cf755e5f53849a_icgraph" id="tm-threads_8c_a7b792091fc079fe5b2cf755e5f53849a_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="233,5,471,32"/><area shape="rect" id="node6" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="255,56,449,83"/><area shape="rect" id="node8" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1011,107,1205,149"/><area shape="rect" id="node11" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="249,284,455,311"/><area shape="rect" id="node3" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="535,5,715,32"/><area shape="rect" id="node4" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1253,5,1456,32"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1504,107,1555,133"/><area shape="rect" id="node7" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1285,56,1425,83"/><area shape="rect" id="node9" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1265,157,1445,184"/><area shape="rect" id="node10" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1263,107,1446,133"/><area shape="rect" id="node12" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="549,157,701,184"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="546,208,705,235"/><area shape="rect" id="node16" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="543,259,708,285"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="540,309,711,336"/><area shape="rect" id="node19" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="520,613,731,640"/><area shape="rect" id="node32" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="544,411,707,437"/><area shape="rect" id="node37" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="544,360,707,387"/><area shape="rect" id="node13" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="788,208,953,235"/><area shape="rect" id="node14" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1259,512,1450,539"/><area shape="rect" id="node17" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="781,259,960,285"/><area shape="rect" id="node20" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="789,765,953,792"/><area shape="rect" id="node22" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="781,512,960,539"/><area shape="rect" id="node24" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="779,563,963,589"/><area shape="rect" id="node26" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="786,613,955,640"/><area shape="rect" id="node28" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="787,664,955,691"/><area shape="rect" id="node30" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="785,715,957,741"/><area shape="rect" id="node21" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1023,765,1193,792"/><area shape="rect" id="node23" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1024,512,1192,539"/><area shape="rect" id="node25" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1013,563,1203,589"/><area shape="rect" id="node27" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1020,613,1196,640"/><area shape="rect" id="node29" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1021,664,1195,691"/><area shape="rect" id="node31" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1019,715,1197,741"/><area shape="rect" id="node33" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="785,411,957,437"/><area shape="rect" id="node35" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="787,461,954,488"/><area shape="rect" id="node34" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1019,411,1197,437"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1021,461,1195,488"/><area shape="rect" id="node38" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="785,309,957,336"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="787,360,954,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a901bedcd2161f466a67de9a4ad88aba8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadsSetFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a thread flag. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00100">100</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00155">SC_ATOMIC_OR</a>.</p>

<p>Referenced by <a class="el" href="flow-manager_8c_source.html#l00106">FlowDisableFlowManagerThread()</a>, <a class="el" href="flow-manager_8c_source.html#l00918">FlowDisableFlowRecyclerThread()</a>, <a class="el" href="tm-threads_8c_source.html#l01916">TmThreadCheckThreadState()</a>, <a class="el" href="tm-threads_8c_source.html#l01026">TmThreadCreate()</a>, <a class="el" href="tm-threads_8c_source.html#l01510">TmThreadDisablePacketThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01418">TmThreadDisableReceiveThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01339">TmThreadKillThread()</a>, <a class="el" href="tm-threads_8c_source.html#l01852">TmThreadPause()</a>, <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>, and <a class="el" href="tm-threads_8c_source.html#l00118">TmThreadsSlotVarRun()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a901bedcd2161f466a67de9a4ad88aba8_icgraph.png" border="0" usemap="#tm-threads_8c_a901bedcd2161f466a67de9a4ad88aba8_icgraph" alt=""/></div>
<map name="tm-threads_8c_a901bedcd2161f466a67de9a4ad88aba8_icgraph" id="tm-threads_8c_a901bedcd2161f466a67de9a4ad88aba8_icgraph">
<area shape="rect" id="node2" href="flow-manager_8h.html#accf6fd4bc60c4c479d771a3633ef76d0" title="Used to disable flow manager thread(s). " alt="" coords="890,65,1102,92"/><area shape="rect" id="node4" href="flow-manager_8h.html#af0697852bbf2664d27f0344feb954ea4" title="Used to disable flow recycler thread(s). " alt="" coords="622,116,837,142"/><area shape="rect" id="node5" href="tm-threads_8h.html#ac7c8ef1a6d109517c07c2533c3d3216d" title="Used to check the thread for certain conditions of failure. If the thread has been specified to resta..." alt="" coords="901,166,1091,193"/><area shape="rect" id="node6" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="936,673,1056,700"/><area shape="rect" id="node40" href="tm-threads_8h.html#a06ce86ebf39159c57e35bed0e37dbc9e" title="Disable all threads having the specified TMs. " alt="" coords="623,233,836,260"/><area shape="rect" id="node41" href="tm-threads_8h.html#a9ead5949f2b33753f2695414139238c0" title="Disable all threads having the specified TMs. " alt="" coords="886,850,1106,877"/><area shape="rect" id="node42" href="tm-threads_8h.html#aa10ec1b4bfaf123e488873736e02810a" title="Kill a thread. " alt="" coords="195,882,333,909"/><area shape="rect" id="node45" href="tm-threads_8h.html#ae401f0dfc8a12e25be48a5602af92609" title="Pauses a thread. " alt="" coords="205,654,323,681"/><area shape="rect" id="node47" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="390,465,573,492"/><area shape="rect" id="node49" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="416,528,547,554"/><area shape="rect" id="node50" href="tm-threads_8h.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="187,502,341,529"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2427,817,2477,844"/><area shape="rect" id="node7" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="1155,677,1394,704"/><area shape="rect" id="node10" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1178,804,1371,830"/><area shape="rect" id="node12" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1934,962,2127,1003"/><area shape="rect" id="node15" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="1171,589,1378,616"/><area shape="rect" id="node8" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1941,838,2121,865"/><area shape="rect" id="node9" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="2176,817,2379,844"/><area shape="rect" id="node11" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="2207,868,2347,894"/><area shape="rect" id="node13" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="2187,969,2367,996"/><area shape="rect" id="node14" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="2186,918,2369,945"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1472,394,1624,421"/><area shape="rect" id="node19" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1469,496,1627,522"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1465,716,1631,742"/><area shape="rect" id="node22" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1463,640,1633,666"/><area shape="rect" id="node23" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1443,572,1653,598"/><area shape="rect" id="node34" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1467,774,1629,801"/><area shape="rect" id="node37" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1467,318,1629,345"/><area shape="rect" id="node17" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1711,369,1876,396"/><area shape="rect" id="node18" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="2182,521,2373,548"/><area shape="rect" id="node21" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1704,724,1883,750"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1711,572,1875,598"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1704,420,1883,446"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1701,470,1885,497"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1709,521,1878,548"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1709,622,1877,649"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1707,673,1879,700"/><area shape="rect" id="node25" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1945,572,2116,598"/><area shape="rect" id="node27" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1947,420,2115,446"/><area shape="rect" id="node29" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1935,470,2126,497"/><area shape="rect" id="node31" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1943,521,2119,548"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1707,774,1879,801"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1710,825,1877,852"/><area shape="rect" id="node38" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1707,268,1879,294"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1710,318,1877,345"/><area shape="rect" id="node43" href="tm-threads_8h.html#aafe5f632012afd5313df3fa692f2ccd8" title="TmThreadKillThreadsFamily" alt="" coords="637,933,822,960"/><area shape="rect" id="node44" href="tm-threads_8h.html#a09cc5ceb2d9be836871da62a8c419734" title="TmThreadKillThreads" alt="" coords="1201,1078,1348,1105"/><area shape="rect" id="node46" href="tm-threads_8h.html#ad1d51aa31a2d9b355d6fc3b30c2e688a" title="Pauses all threads present in tv_root. " alt="" coords="399,654,564,681"/><area shape="rect" id="node48" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="664,528,795,554"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae587bc031308c4d760fd6441136ad684"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* TmThreadsSlotPktAcqLoop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>td</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00255">255</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="suricata_8c_source.html#l00391">EngineDone()</a>, <a class="el" href="suricata_8c_source.html#l00380">EngineKill()</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="decode_8h_source.html#l00575">PacketQueue_::mutex_q</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00401">PacketPoolDestroy()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00364">PacketPoolInit()</a>, <a class="el" href="tm-threads_8h_source.html#l00045">TmSlot_::PktAcqLoop</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00208">SC_ATOMIC_SET</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-error_8h_source.html#l00079">SC_ERR_THREAD_INIT</a>, <a class="el" href="util-privs_8h_source.html#l00037">SCDropCaps</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00263">SCLogWarning</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads_8h_source.html#l00293">SCSetThreadName</a>, <a class="el" href="tm-threads_8h_source.html#l00052">TmSlot_::slot_initdata</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="tm-threads_8h_source.html#l00063">TmSlot_::slot_post_pq</a>, <a class="el" href="tm-threads_8h_source.html#l00058">TmSlot_::slot_pre_pq</a>, <a class="el" href="tm-threads_8h_source.html#l00049">TmSlot_::SlotThreadDeinit</a>, <a class="el" href="tm-threads_8h_source.html#l00048">TmSlot_::SlotThreadExitPrintStats</a>, <a class="el" href="tm-threads_8h_source.html#l00047">TmSlot_::SlotThreadInit</a>, <a class="el" href="counters_8c_source.html#l01112">StatsSetupPrivate()</a>, <a class="el" href="counters_8h_source.html#l00132">StatsSyncCounters</a>, <a class="el" href="threadvars_8h_source.html#l00096">ThreadVars_::stream_pq</a>, <a class="el" href="suricata_8c_source.html#l00219">suricata_ctl_flags</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, <a class="el" href="threadvars_8h_source.html#l00042">THV_CLOSED</a>, <a class="el" href="threadvars_8h_source.html#l00045">THV_DEINIT</a>, <a class="el" href="threadvars_8h_source.html#l00049">THV_FLOW_LOOP</a>, <a class="el" href="threadvars_8h_source.html#l00037">THV_INIT_DONE</a>, <a class="el" href="threadvars_8h_source.html#l00048">THV_KILL_PKTACQ</a>, <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, <a class="el" href="threadvars_8h_source.html#l00039">THV_PAUSED</a>, <a class="el" href="threadvars_8h_source.html#l00046">THV_RUNNING_DONE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00121">TM_ECODE_DONE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-threads-common_8h_source.html#l00067">TMM_STREAMTCP</a>, <a class="el" href="threadvars_8h_source.html#l00087">ThreadVars_::tmqh_in</a>, <a class="el" href="threadvars_8h_source.html#l00089">ThreadVars_::tmqh_out</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00967">TmThreadSetupOptions()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00108">TmThreadsUnsetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l01787">TmThreadTestThreadUnPaused()</a>, <a class="el" href="tm-threads_8c_source.html#l01805">TmThreadWaitForFlag()</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, and <a class="el" href="util-signal_8c_source.html#l00028">UtilSignalBlock()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00641">TmThreadSetSlots()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_cgraph.png" border="0" usemap="#tm-threads_8c_ae587bc031308c4d760fd6441136ad684_cgraph" alt=""/></div>
<map name="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_cgraph" id="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_cgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="295,5,388,32"/><area shape="rect" id="node3" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="301,56,381,83"/><area shape="rect" id="node4" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="274,107,409,133"/><area shape="rect" id="node7" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="288,157,395,184"/><area shape="rect" id="node9" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="277,208,405,235"/><area shape="rect" id="node10" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="494,461,645,488"/><area shape="rect" id="node11" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="261,259,421,285"/><area shape="rect" id="node16" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="275,360,408,387"/><area shape="rect" id="node17" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="267,411,415,437"/><area shape="rect" id="node18" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="237,461,445,488"/><area shape="rect" id="node19" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="265,512,417,539"/><area shape="rect" id="node20" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="286,563,397,589"/><area shape="rect" id="node5" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="758,107,847,133"/><area shape="rect" id="node6" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="494,107,645,133"/><area shape="rect" id="node8" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="498,157,641,184"/><area shape="rect" id="node12" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="499,233,640,260"/><area shape="rect" id="node15" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="507,284,631,311"/><area shape="rect" id="node13" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="693,233,912,260"/><area shape="rect" id="node14" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="961,233,1205,260"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_icgraph.png" border="0" usemap="#tm-threads_8c_ae587bc031308c4d760fd6441136ad684_icgraph" alt=""/></div>
<map name="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_icgraph" id="tm-threads_8c_ae587bc031308c4d760fd6441136ad684_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="237,81,368,108"/><area shape="rect" id="node3" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="416,81,536,108"/><area shape="rect" id="node4" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="585,5,823,32"/><area shape="rect" id="node8" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="607,56,801,83"/><area shape="rect" id="node10" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1363,107,1557,149"/><area shape="rect" id="node13" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="601,284,807,311"/><area shape="rect" id="node5" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="887,5,1067,32"/><area shape="rect" id="node6" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1605,5,1808,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1856,107,1907,133"/><area shape="rect" id="node9" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1637,56,1777,83"/><area shape="rect" id="node11" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1617,157,1797,184"/><area shape="rect" id="node12" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1615,107,1798,133"/><area shape="rect" id="node14" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="901,157,1053,184"/><area shape="rect" id="node17" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="898,208,1057,235"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="895,259,1060,285"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="892,309,1063,336"/><area shape="rect" id="node21" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="872,613,1083,640"/><area shape="rect" id="node34" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="896,411,1059,437"/><area shape="rect" id="node39" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="896,360,1059,387"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1140,208,1305,235"/><area shape="rect" id="node16" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1611,512,1802,539"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1133,259,1312,285"/><area shape="rect" id="node22" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1141,765,1305,792"/><area shape="rect" id="node24" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1133,512,1312,539"/><area shape="rect" id="node26" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1131,563,1315,589"/><area shape="rect" id="node28" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1138,613,1307,640"/><area shape="rect" id="node30" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1139,664,1307,691"/><area shape="rect" id="node32" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1137,715,1309,741"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1375,765,1545,792"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1376,512,1544,539"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1365,563,1555,589"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1372,613,1548,640"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1373,664,1547,691"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1371,715,1549,741"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1137,411,1309,437"/><area shape="rect" id="node37" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1139,461,1306,488"/><area shape="rect" id="node36" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1371,411,1549,437"/><area shape="rect" id="node38" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1373,461,1547,488"/><area shape="rect" id="node40" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1137,309,1309,336"/><area shape="rect" id="node41" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1139,360,1306,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a86f906803e6e37b43aed5cf1a37c91ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* TmThreadsSlotVar </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>td</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000131">Todo:</a></b></dt><dd>Only the first "slot" currently makes the "post_pq" available to the thread module. </dd></dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00392">392</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="suricata_8c_source.html#l00380">EngineKill()</a>, <a class="el" href="tm-queues_8h_source.html#l00029">Tmq_::id</a>, <a class="el" href="threadvars_8h_source.html#l00081">ThreadVars_::inq</a>, <a class="el" href="decode_8h_source.html#l00571">PacketQueue_::len</a>, <a class="el" href="decode_8h_source.html#l00575">PacketQueue_::mutex_q</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="packet-queue_8c_source.html#l00164">PacketDequeue()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00401">PacketPoolDestroy()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00345">PacketPoolInitEmpty()</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00208">SC_ATOMIC_SET</a>, <a class="el" href="util-error_8h_source.html#l00079">SC_ERR_THREAD_INIT</a>, <a class="el" href="util-privs_8h_source.html#l00037">SCDropCaps</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00263">SCLogWarning</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="threads_8h_source.html#l00293">SCSetThreadName</a>, <a class="el" href="tm-threads_8h_source.html#l00052">TmSlot_::slot_initdata</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="tm-threads_8h_source.html#l00063">TmSlot_::slot_post_pq</a>, <a class="el" href="tm-threads_8h_source.html#l00058">TmSlot_::slot_pre_pq</a>, <a class="el" href="tm-threads_8h_source.html#l00049">TmSlot_::SlotThreadDeinit</a>, <a class="el" href="tm-threads_8h_source.html#l00048">TmSlot_::SlotThreadExitPrintStats</a>, <a class="el" href="tm-threads_8h_source.html#l00047">TmSlot_::SlotThreadInit</a>, <a class="el" href="counters_8c_source.html#l01112">StatsSetupPrivate()</a>, <a class="el" href="counters_8h_source.html#l00132">StatsSyncCounters</a>, <a class="el" href="threadvars_8h_source.html#l00096">ThreadVars_::stream_pq</a>, <a class="el" href="threadvars_8h_source.html#l00098">ThreadVars_::thread_setup_flags</a>, <a class="el" href="threadvars_8h_source.html#l00042">THV_CLOSED</a>, <a class="el" href="threadvars_8h_source.html#l00045">THV_DEINIT</a>, <a class="el" href="threadvars_8h_source.html#l00041">THV_FAILED</a>, <a class="el" href="threadvars_8h_source.html#l00037">THV_INIT_DONE</a>, <a class="el" href="threadvars_8h_source.html#l00040">THV_KILL</a>, <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, <a class="el" href="threadvars_8h_source.html#l00039">THV_PAUSED</a>, <a class="el" href="threadvars_8h_source.html#l00046">THV_RUNNING_DONE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00093">ThreadVars_::tm_slots</a>, <a class="el" href="tm-threads-common_8h_source.html#l00067">TMM_STREAMTCP</a>, <a class="el" href="threadvars_8h_source.html#l00087">ThreadVars_::tmqh_in</a>, <a class="el" href="threadvars_8h_source.html#l00089">ThreadVars_::tmqh_out</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00443">TmqhOutputPacketpool()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00557">TmqhReleasePacketsToPacketPool()</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00967">TmThreadSetupOptions()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00118">TmThreadsSlotVarRun()</a>, <a class="el" href="tm-threads_8c_source.html#l00108">TmThreadsUnsetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l01787">TmThreadTestThreadUnPaused()</a>, <a class="el" href="tm-threads_8c_source.html#l01805">TmThreadWaitForFlag()</a>, <a class="el" href="decode_8h_source.html#l00569">PacketQueue_::top</a>, <a class="el" href="suricata_8h_source.html#l00127">trans_q</a>, and <a class="el" href="util-signal_8c_source.html#l00028">UtilSignalBlock()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00641">TmThreadSetSlots()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_cgraph.png" border="0" usemap="#tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_cgraph" alt=""/></div>
<map name="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_cgraph" id="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_cgraph">
<area shape="rect" id="node2" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="248,5,328,32"/><area shape="rect" id="node3" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="775,107,889,133"/><area shape="rect" id="node4" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="221,360,355,387"/><area shape="rect" id="node7" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="215,411,361,437"/><area shape="rect" id="node8" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="224,461,352,488"/><area shape="rect" id="node9" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="753,208,911,235"/><area shape="rect" id="node13" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="441,107,674,133"/><area shape="rect" id="node14" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="482,563,633,589"/><area shape="rect" id="node15" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="208,664,368,691"/><area shape="rect" id="node20" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="491,259,624,285"/><area shape="rect" id="node21" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="211,208,365,235"/><area shape="rect" id="node22" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="214,715,362,741"/><area shape="rect" id="node23" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="184,563,392,589"/><area shape="rect" id="node24" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="212,613,364,640"/><area shape="rect" id="node25" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="233,765,343,792"/><area shape="rect" id="node5" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="513,360,602,387"/><area shape="rect" id="node6" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="482,411,633,437"/><area shape="rect" id="node10" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1029,208,1195,235"/><area shape="rect" id="node11" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="1283,208,1498,235"/><area shape="rect" id="node12" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1547,208,1634,235"/><area shape="rect" id="node16" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="487,639,628,665"/><area shape="rect" id="node19" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="495,689,619,716"/><area shape="rect" id="node17" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="723,639,941,665"/><area shape="rect" id="node18" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="990,639,1234,665"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_icgraph.png" border="0" usemap="#tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_icgraph" alt=""/></div>
<map name="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_icgraph" id="tm-threads_8c_a86f906803e6e37b43aed5cf1a37c91ee_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="184,81,315,108"/><area shape="rect" id="node3" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="363,81,483,108"/><area shape="rect" id="node4" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="531,5,770,32"/><area shape="rect" id="node8" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="554,56,747,83"/><area shape="rect" id="node10" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1310,107,1503,149"/><area shape="rect" id="node13" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="547,284,754,311"/><area shape="rect" id="node5" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="834,5,1014,32"/><area shape="rect" id="node6" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1552,5,1755,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1803,107,1853,133"/><area shape="rect" id="node9" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1583,56,1723,83"/><area shape="rect" id="node11" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1563,157,1743,184"/><area shape="rect" id="node12" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1562,107,1745,133"/><area shape="rect" id="node14" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="848,157,1000,184"/><area shape="rect" id="node17" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="845,208,1003,235"/><area shape="rect" id="node18" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="841,259,1007,285"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="839,309,1009,336"/><area shape="rect" id="node21" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="819,613,1029,640"/><area shape="rect" id="node34" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="843,411,1005,437"/><area shape="rect" id="node39" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="843,360,1005,387"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1087,208,1252,235"/><area shape="rect" id="node16" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1558,512,1749,539"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1080,259,1259,285"/><area shape="rect" id="node22" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1087,765,1251,792"/><area shape="rect" id="node24" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1080,512,1259,539"/><area shape="rect" id="node26" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1077,563,1261,589"/><area shape="rect" id="node28" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1085,613,1254,640"/><area shape="rect" id="node30" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1085,664,1253,691"/><area shape="rect" id="node32" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1083,715,1255,741"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1321,765,1492,792"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1323,512,1491,539"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1311,563,1502,589"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1319,613,1495,640"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1319,664,1494,691"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1317,715,1496,741"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1083,411,1255,437"/><area shape="rect" id="node37" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1086,461,1253,488"/><area shape="rect" id="node36" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1317,411,1496,437"/><area shape="rect" id="node38" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1320,461,1493,488"/><area shape="rect" id="node40" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1083,309,1255,336"/><area shape="rect" id="node41" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1086,360,1253,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e6a7d6f5867c6909351b1ee45dc2a0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadsSlotVarRun </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tm-threads_8h.html#a2f58053298a7a0020d381c12aebb56cd">TmSlot</a> *&#160;</td>
          <td class="paramname"><em>slot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Separate run function so we can call it recursively. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000130">Todo:</a></b></dt><dd>Deal with post_pq for slots beyond the first. </dd></dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00118">118</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads_8h_source.html#l00069">TmSlot_::id</a>, <a class="el" href="decode_8h_source.html#l00575">PacketQueue_::mutex_q</a>, <a class="el" href="util-profiling_8h_source.html#l00151">PACKET_PROFILING_TMM_END</a>, <a class="el" href="util-profiling_8h_source.html#l00143">PACKET_PROFILING_TMM_START</a>, <a class="el" href="packet-queue_8c_source.html#l00164">PacketDequeue()</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8h_source.html#l00072">TmSlot_::slot_next</a>, <a class="el" href="tm-threads_8h_source.html#l00063">TmSlot_::slot_post_pq</a>, <a class="el" href="tm-threads_8h_source.html#l00058">TmSlot_::slot_pre_pq</a>, <a class="el" href="threadvars_8h_source.html#l00041">THV_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8h_source.html#l00066">TmSlot_::tm_id</a>, <a class="el" href="threadvars_8h_source.html#l00089">ThreadVars_::tmqh_out</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00443">TmqhOutputPacketpool()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00557">TmqhReleasePacketsToPacketPool()</a>, <a class="el" href="tm-threads_8c_source.html#l00100">TmThreadsSetFlag()</a>, <a class="el" href="tm-threads_8c_source.html#l00118">TmThreadsSlotVarRun()</a>, <a class="el" href="decode_8h_source.html#l00569">PacketQueue_::top</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>, and <a class="el" href="tm-threads_8c_source.html#l00118">TmThreadsSlotVarRun()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_cgraph.png" border="0" usemap="#tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_cgraph" alt=""/></div>
<map name="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_cgraph" id="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_cgraph">
<area shape="rect" id="node2" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="513,6,628,33"/><area shape="rect" id="node3" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="491,69,650,95"/><area shape="rect" id="node7" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="209,31,442,58"/><area shape="rect" id="node8" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="259,133,392,159"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="699,69,866,95"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="915,69,1130,95"/><area shape="rect" id="node6" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="1179,69,1266,95"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_icgraph.png" border="0" usemap="#tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_icgraph" alt=""/></div>
<map name="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_icgraph" id="tm-threads_8c_a3e6a7d6f5867c6909351b1ee45dc2a0b_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="411,81,541,108"/><area shape="rect" id="node43" href="tm-threads_8h.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="208,119,363,145"/><area shape="rect" id="node3" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="589,81,720,108"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="768,81,888,108"/><area shape="rect" id="node5" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="937,5,1175,32"/><area shape="rect" id="node9" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="959,56,1153,83"/><area shape="rect" id="node11" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1715,107,1909,149"/><area shape="rect" id="node14" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="953,284,1159,311"/><area shape="rect" id="node6" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1239,5,1419,32"/><area shape="rect" id="node7" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1957,5,2160,32"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2208,107,2259,133"/><area shape="rect" id="node10" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1989,56,2129,83"/><area shape="rect" id="node12" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1969,157,2149,184"/><area shape="rect" id="node13" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1967,107,2150,133"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1253,157,1405,184"/><area shape="rect" id="node18" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1250,208,1409,235"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1247,259,1412,285"/><area shape="rect" id="node21" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1244,309,1415,336"/><area shape="rect" id="node22" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1224,613,1435,640"/><area shape="rect" id="node35" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1248,411,1411,437"/><area shape="rect" id="node40" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1248,360,1411,387"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1492,208,1657,235"/><area shape="rect" id="node17" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1963,512,2154,539"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1485,259,1664,285"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1493,765,1657,792"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1485,512,1664,539"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1483,563,1667,589"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1490,613,1659,640"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1491,664,1659,691"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1489,715,1661,741"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1727,765,1897,792"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1728,512,1896,539"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1717,563,1907,589"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1724,613,1900,640"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1725,664,1899,691"/><area shape="rect" id="node34" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1723,715,1901,741"/><area shape="rect" id="node36" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1489,411,1661,437"/><area shape="rect" id="node38" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1491,461,1658,488"/><area shape="rect" id="node37" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1723,411,1901,437"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1725,461,1899,488"/><area shape="rect" id="node41" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1489,309,1661,336"/><area shape="rect" id="node42" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1491,360,1658,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6938fc8a75cc9f64967bd1655b374d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadsUnregisterThread </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l02140">2140</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads_8c_source.html#l02064">Thread_::in_use</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="tm-threads_8c_source.html#l02068">Threads_::threads</a>, <a class="el" href="tm-threads_8c_source.html#l02070">Threads_::threads_cnt</a>, and <a class="el" href="tm-threads_8c_source.html#l02069">Threads_::threads_size</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01642">TmThreadFree()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_aa6938fc8a75cc9f64967bd1655b374d8_icgraph.png" border="0" usemap="#tm-threads_8c_aa6938fc8a75cc9f64967bd1655b374d8_icgraph" alt=""/></div>
<map name="tm-threads_8c_aa6938fc8a75cc9f64967bd1655b374d8_icgraph" id="tm-threads_8c_aa6938fc8a75cc9f64967bd1655b374d8_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a1658ac1d3a66d7c50006fc125933c2c1" title="TmThreadFree" alt="" coords="243,5,349,32"/><area shape="rect" id="node3" href="tm-threads_8h.html#a10e0a9360bef968f5e7f26d483c5767a" title="TmThreadClearThreadsFamily" alt="" coords="398,5,597,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a2a3d971bdab1af519d4aabd46b8f5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadsUnsetFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unset a thread flag. </p>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00108">108</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00142">SC_ATOMIC_AND</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01819">TmThreadContinue()</a>, <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a1a2a3d971bdab1af519d4aabd46b8f5d_icgraph.png" border="0" usemap="#tm-threads_8c_a1a2a3d971bdab1af519d4aabd46b8f5d_icgraph" alt=""/></div>
<map name="tm-threads_8c_a1a2a3d971bdab1af519d4aabd46b8f5d_icgraph" id="tm-threads_8c_a1a2a3d971bdab1af519d4aabd46b8f5d_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a89c07017a8e655832ff2c9848dab6126" title="Unpauses a thread. " alt="" coords="835,39,968,65"/><area shape="rect" id="node7" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="203,144,386,171"/><area shape="rect" id="node46" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="229,93,360,120"/><area shape="rect" id="node3" href="detect-engine-loader_8h.html#ac99678d1d5dba28b321a14c89a09bc12" title="Unpauses all threads present in tv_root. " alt="" coords="1069,31,1280,73"/><area shape="rect" id="node6" href="tm-threads_8h.html#abf6431e879f608a1f681e735d3b5ff0a" title="Unpauses all threads present in tv_root. " alt="" coords="1827,13,2007,40"/><area shape="rect" id="node4" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1328,97,1531,124"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2061,173,2112,200"/><area shape="rect" id="node8" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="435,144,565,171"/><area shape="rect" id="node9" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="613,148,733,175"/><area shape="rect" id="node10" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="782,97,1021,124"/><area shape="rect" id="node12" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="805,148,998,175"/><area shape="rect" id="node14" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1579,199,1773,241"/><area shape="rect" id="node17" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="798,427,1005,453"/><area shape="rect" id="node11" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1085,97,1265,124"/><area shape="rect" id="node13" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1847,148,1987,175"/><area shape="rect" id="node15" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1827,199,2007,225"/><area shape="rect" id="node16" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1826,249,2009,276"/><area shape="rect" id="node18" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1099,452,1251,479"/><area shape="rect" id="node21" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1095,401,1254,428"/><area shape="rect" id="node22" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1092,553,1257,580"/><area shape="rect" id="node24" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1089,503,1260,529"/><area shape="rect" id="node25" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1069,655,1280,681"/><area shape="rect" id="node38" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1093,300,1256,327"/><area shape="rect" id="node43" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1093,351,1256,377"/><area shape="rect" id="node19" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1347,452,1512,479"/><area shape="rect" id="node20" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1822,553,2013,580"/><area shape="rect" id="node23" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1340,503,1519,529"/><area shape="rect" id="node26" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1347,807,1511,833"/><area shape="rect" id="node28" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1340,553,1519,580"/><area shape="rect" id="node30" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1337,604,1521,631"/><area shape="rect" id="node32" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1345,655,1514,681"/><area shape="rect" id="node34" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1345,705,1513,732"/><area shape="rect" id="node36" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1343,756,1515,783"/><area shape="rect" id="node27" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1591,807,1761,833"/><area shape="rect" id="node29" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1592,553,1760,580"/><area shape="rect" id="node31" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1581,604,1771,631"/><area shape="rect" id="node33" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1588,655,1764,681"/><area shape="rect" id="node35" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1589,705,1763,732"/><area shape="rect" id="node37" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1587,756,1765,783"/><area shape="rect" id="node39" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1343,249,1515,276"/><area shape="rect" id="node41" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1346,300,1513,327"/><area shape="rect" id="node40" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1587,351,1765,377"/><area shape="rect" id="node42" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1589,401,1763,428"/><area shape="rect" id="node44" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1343,351,1515,377"/><area shape="rect" id="node45" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1346,401,1513,428"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9dec77fa2aee796d6435afa70f1ee475"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadTestThreadUnPaused </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if the thread represented in the arg has been unpaused or not. </p>
<pre class="fragment">   The function would return if the thread tv has been unpaused or if the
   kill flag for the thread has been set.
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the TV instance. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01787">1787</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00040">THV_KILL</a>, <a class="el" href="threadvars_8h_source.html#l00038">THV_PAUSE</a>, and <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_cgraph.png" border="0" usemap="#tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_cgraph" alt=""/></div>
<map name="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_cgraph" id="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="262,5,413,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_icgraph.png" border="0" usemap="#tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_icgraph" alt=""/></div>
<map name="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_icgraph" id="tm-threads_8c_a9dec77fa2aee796d6435afa70f1ee475_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="262,56,445,83"/><area shape="rect" id="node43" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="288,107,419,133"/><area shape="rect" id="node3" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="493,81,624,108"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="672,81,792,108"/><area shape="rect" id="node5" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="841,5,1079,32"/><area shape="rect" id="node9" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="863,56,1057,83"/><area shape="rect" id="node11" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1619,107,1813,149"/><area shape="rect" id="node14" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="857,284,1063,311"/><area shape="rect" id="node6" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1143,5,1323,32"/><area shape="rect" id="node7" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1861,5,2064,32"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2112,107,2163,133"/><area shape="rect" id="node10" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1893,56,2033,83"/><area shape="rect" id="node12" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1873,157,2053,184"/><area shape="rect" id="node13" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1871,107,2054,133"/><area shape="rect" id="node15" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1157,157,1309,184"/><area shape="rect" id="node18" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1154,208,1313,235"/><area shape="rect" id="node19" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1151,259,1316,285"/><area shape="rect" id="node21" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1148,309,1319,336"/><area shape="rect" id="node22" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1128,613,1339,640"/><area shape="rect" id="node35" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1152,411,1315,437"/><area shape="rect" id="node40" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1152,360,1315,387"/><area shape="rect" id="node16" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1396,208,1561,235"/><area shape="rect" id="node17" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1867,512,2058,539"/><area shape="rect" id="node20" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1389,259,1568,285"/><area shape="rect" id="node23" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1397,765,1561,792"/><area shape="rect" id="node25" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1389,512,1568,539"/><area shape="rect" id="node27" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1387,563,1571,589"/><area shape="rect" id="node29" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1394,613,1563,640"/><area shape="rect" id="node31" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1395,664,1563,691"/><area shape="rect" id="node33" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1393,715,1565,741"/><area shape="rect" id="node24" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1631,765,1801,792"/><area shape="rect" id="node26" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1632,512,1800,539"/><area shape="rect" id="node28" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1621,563,1811,589"/><area shape="rect" id="node30" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1628,613,1804,640"/><area shape="rect" id="node32" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1629,664,1803,691"/><area shape="rect" id="node34" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1627,715,1805,741"/><area shape="rect" id="node36" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1393,411,1565,437"/><area shape="rect" id="node38" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1395,461,1562,488"/><area shape="rect" id="node37" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1627,411,1805,437"/><area shape="rect" id="node39" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1629,461,1803,488"/><area shape="rect" id="node41" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1393,309,1565,336"/><area shape="rect" id="node42" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1395,360,1562,387"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afbb02380645247d1256fe2a20701e92a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TmThreadWaitForFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits till the specified flag(s) is(are) set. We don't bother if the kill flag has been set or not on the thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the TV instance. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01805">1805</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01689">TmThreadSpawn()</a>, <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_cgraph.png" border="0" usemap="#tm-threads_8c_afbb02380645247d1256fe2a20701e92a_cgraph" alt=""/></div>
<map name="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_cgraph" id="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="206,5,357,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_icgraph.png" border="0" usemap="#tm-threads_8c_afbb02380645247d1256fe2a20701e92a_icgraph" alt=""/></div>
<map name="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_icgraph" id="tm-threads_8c_afbb02380645247d1256fe2a20701e92a_icgraph">
<area shape="rect" id="node2" href="tm-threads_8h.html#a6c2161fae3aaccd4a4ac33c9fed7a7f2" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="843,361,965,388"/><area shape="rect" id="node37" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="206,435,389,461"/><area shape="rect" id="node44" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="232,485,363,512"/><area shape="rect" id="node3" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1107,563,1247,589"/><area shape="rect" id="node5" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1087,613,1267,640"/><area shape="rect" id="node7" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1087,461,1267,488"/><area shape="rect" id="node8" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1086,512,1269,539"/><area shape="rect" id="node9" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1101,360,1253,387"/><area shape="rect" id="node12" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1098,309,1257,336"/><area shape="rect" id="node13" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1095,208,1260,235"/><area shape="rect" id="node15" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1092,259,1263,285"/><area shape="rect" id="node16" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1072,411,1283,437"/><area shape="rect" id="node29" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1096,157,1259,184"/><area shape="rect" id="node34" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1096,81,1259,108"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2053,664,2104,691"/><area shape="rect" id="node6" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1803,765,2005,792"/><area shape="rect" id="node10" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1340,259,1505,285"/><area shape="rect" id="node11" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1809,360,1999,387"/><area shape="rect" id="node14" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1333,208,1512,235"/><area shape="rect" id="node17" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1341,309,1505,336"/><area shape="rect" id="node19" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1333,360,1512,387"/><area shape="rect" id="node21" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1331,411,1515,437"/><area shape="rect" id="node23" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1338,461,1507,488"/><area shape="rect" id="node25" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1339,512,1507,539"/><area shape="rect" id="node27" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1337,563,1509,589"/><area shape="rect" id="node18" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1573,309,1744,336"/><area shape="rect" id="node20" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1575,360,1743,387"/><area shape="rect" id="node22" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1563,411,1754,437"/><area shape="rect" id="node24" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1571,461,1747,488"/><area shape="rect" id="node26" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1571,512,1746,539"/><area shape="rect" id="node28" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1569,563,1748,589"/><area shape="rect" id="node30" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1337,107,1509,133"/><area shape="rect" id="node32" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1339,157,1506,184"/><area shape="rect" id="node31" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1569,107,1748,133"/><area shape="rect" id="node33" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1572,157,1745,184"/><area shape="rect" id="node35" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1337,5,1509,32"/><area shape="rect" id="node36" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1339,56,1506,83"/><area shape="rect" id="node38" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="437,485,568,512"/><area shape="rect" id="node39" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="616,496,736,523"/><area shape="rect" id="node40" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="785,611,1023,637"/><area shape="rect" id="node41" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="807,560,1001,587"/><area shape="rect" id="node42" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="807,489,1001,530"/><area shape="rect" id="node43" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="801,284,1007,311"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3af1510ae299a7c320b068b229b9ae3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tm-threads-common_8h.html#ac25dfd7d68171eabc8dd78ee6b6ac782">TmEcode</a> TmThreadWaitOnThreadInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to check if all threads have finished their initialization. On finding an un-initialized thread, it waits till that thread completes its initialization, before proceeding to the next thread. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TM_ECODE_OK</td><td>all initialized properly </td></tr>
    <tr><td class="paramname">TM_ECODE_FAILED</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l01958">1958</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00120">ThreadVars_::next</a>, <a class="el" href="util-error_8h_source.html#l00079">SC_ERR_THREAD_INIT</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00254">SCLogNotice</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="threadvars_8h_source.html#l00042">THV_CLOSED</a>, <a class="el" href="threadvars_8h_source.html#l00041">THV_FAILED</a>, <a class="el" href="threadvars_8h_source.html#l00037">THV_INIT_DONE</a>, <a class="el" href="tm-threads-common_8h_source.html#l00120">TM_ECODE_FAILED</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tm-threads_8c_source.html#l00092">TmThreadsCheckFlag()</a>, <a class="el" href="suricata-common_8h_source.html#l00033">TRUE</a>, <a class="el" href="tm-threads_8c_source.html#l00080">tv_root_lock</a>, <a class="el" href="tm-threads-common_8h_source.html#l00129">TVT_MAX</a>, <a class="el" href="tm-threads-common_8h_source.html#l00127">TVT_MGMT</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00126">TVT_PPT</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_cgraph.png" border="0" usemap="#tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_cgraph" alt=""/></div>
<map name="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_cgraph" id="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="238,5,389,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_icgraph.png" border="0" usemap="#tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_icgraph" alt=""/></div>
<map name="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_icgraph" id="tm-threads_8c_a3af1510ae299a7c320b068b229b9ae3a_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="237,5,288,32"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="adb5ecb3cc5e9d89db70f326a9efdb96a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t tv_aof = <a class="el" href="threadvars_8h.html#ad645002d760c97674366b151bff3fb30">THV_RESTART_THREAD</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00084">84</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01916">TmThreadCheckThreadState()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d9696175133d57b70889a2fb7ec63c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a>* tv_root[<a class="el" href="tm-threads-common_8h.html#a29d44341ce767c5dfc737d622fc97ba1a1aeb95d6bc0cead449fa4cecb2bcd6a4">TVT_MAX</a>] = { NULL }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00077">77</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>Referenced by <a class="el" href="flow-manager_8c_source.html#l00106">FlowDisableFlowManagerThread()</a>, <a class="el" href="flow-manager_8c_source.html#l00918">FlowDisableFlowRecyclerThread()</a>, <a class="el" href="detect-engine-loader_8c_source.html#l00167">TmThreadContinueDetectLoaderThreads()</a>, and <a class="el" href="detect-engine-loader_8c_source.html#l00143">TmThreadWakeupDetectLoaderThreads()</a>.</p>

</div>
</div>
<a class="anchor" id="ac003a7c799393730d1ecab455c42cd91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="threads_8h.html#a93b9e097562019ea65191bd846ecf3ae">SCMutex</a> tv_root_lock = <a class="el" href="threads_8h.html#a5f2fb777344db00e3ffa3156cc1a4cb5">SCMUTEX_INITIALIZER</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="tm-threads_8c_source.html#l00080">80</a> of file <a class="el" href="tm-threads_8c_source.html">tm-threads.c</a>.</p>

<p>Referenced by <a class="el" href="flow-manager_8c_source.html#l00106">FlowDisableFlowManagerThread()</a>, <a class="el" href="flow-manager_8c_source.html#l00918">FlowDisableFlowRecyclerThread()</a>, <a class="el" href="tm-threads_8c_source.html#l00781">TmSlotGetSlotForTM()</a>, <a class="el" href="tm-threads_8c_source.html#l01265">TmThreadAppend()</a>, <a class="el" href="tm-threads_8c_source.html#l01916">TmThreadCheckThreadState()</a>, <a class="el" href="tm-threads_8c_source.html#l01664">TmThreadClearThreadsFamily()</a>, <a class="el" href="detect-engine-loader_8c_source.html#l00167">TmThreadContinueDetectLoaderThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01829">TmThreadContinueThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l02040">TmThreadCountThreadsByTmmFlags()</a>, <a class="el" href="tm-threads_8c_source.html#l01510">TmThreadDisablePacketThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01418">TmThreadDisableReceiveThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01582">TmThreadGetFirstTmSlotForPartialPattern()</a>, <a class="el" href="tm-threads_8c_source.html#l01613">TmThreadKillThreadsFamily()</a>, <a class="el" href="tm-threads_8c_source.html#l01862">TmThreadPauseThreads()</a>, <a class="el" href="tm-threads_8c_source.html#l01303">TmThreadRemove()</a>, <a class="el" href="tm-threads_8c_source.html#l02013">TmThreadsGetCallingThread()</a>, <a class="el" href="tm-threads_8c_source.html#l00676">TmThreadsGetTVContainingSlot()</a>, <a class="el" href="tm-threads_8c_source.html#l01958">TmThreadWaitOnThreadInit()</a>, and <a class="el" href="detect-engine-loader_8c_source.html#l00143">TmThreadWakeupDetectLoaderThreads()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="tm-threads_8c.html">tm-threads.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:14 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
