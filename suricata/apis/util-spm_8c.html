<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/util-spm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util-spm_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util-spm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-spm_8h_source.html">util-spm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-spm-bs_8h_source.html">util-spm-bs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-spm-bs2bm_8h_source.html">util-spm-bs2bm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-spm-bm_8h_source.html">util-spm-bm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-clock_8h_source.html">util-clock.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-spm.c:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c__incl.png" border="0" usemap="#src_2util-spm_8c" alt=""/></div>
<map name="src_2util-spm_8c" id="src_2util-spm_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="519,304,652,331"/><area shape="rect" id="node41" href="suricata_8h.html" title="suricata.h" alt="" coords="197,229,275,256"/><area shape="rect" id="node44" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="269,80,365,107"/><area shape="rect" id="node45" href="util-spm_8h.html" title="util&#45;spm.h" alt="" coords="390,80,468,107"/><area shape="rect" id="node46" href="util-spm-bs_8h.html" title="util&#45;spm&#45;bs.h" alt="" coords="490,155,587,181"/><area shape="rect" id="node47" href="util-spm-bs2bm_8h.html" title="util&#45;spm&#45;bs2bm.h" alt="" coords="217,155,340,181"/><area shape="rect" id="node48" href="util-spm-bm_8h.html" title="util&#45;spm&#45;bm.h" alt="" coords="364,155,465,181"/><area shape="rect" id="node49" href="util-clock_8h.html" title="util&#45;clock.h" alt="" coords="663,80,748,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="1695,379,1768,405"/><area shape="rect" id="node24" href="threads_8h.html" title="threads.h" alt="" coords="593,677,668,704"/><area shape="rect" id="node27" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="2652,379,2801,405"/><area shape="rect" id="node28" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="791,528,880,555"/><area shape="rect" id="node30" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="619,603,699,629"/><area shape="rect" id="node32" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="849,677,932,704"/><area shape="rect" id="node34" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="607,379,747,405"/><area shape="rect" id="node38" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="275,379,377,405"/><area shape="rect" id="node39" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="402,379,480,405"/><area shape="rect" id="node40" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="505,379,583,405"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="1612,528,1695,555"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="2181,528,2235,555"/><area shape="rect" id="node13" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="2426,453,2525,480"/><area shape="rect" id="node14" href="htp__config_8h.html" title="htp_config.h" alt="" coords="924,453,1017,480"/><area shape="rect" id="node15" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="1042,453,1205,480"/><area shape="rect" id="node16" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="1231,453,1377,480"/><area shape="rect" id="node17" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="1401,453,1495,480"/><area shape="rect" id="node18" href="htp__list_8h.html" title="htp_list.h" alt="" coords="1964,453,2039,480"/><area shape="rect" id="node19" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="2294,453,2401,480"/><area shape="rect" id="node20" href="htp__table_8h.html" title="htp_table.h" alt="" coords="1999,528,2085,555"/><area shape="rect" id="node21" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="1671,453,1793,480"/><area shape="rect" id="node22" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="1818,453,1939,480"/><area shape="rect" id="node23" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="1348,528,1481,555"/><area shape="rect" id="node25" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="593,752,668,779"/><area shape="rect" id="node29" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="923,603,1009,629"/><area shape="rect" id="node31" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="773,603,899,629"/><area shape="rect" id="node33" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="844,752,937,779"/><area shape="rect" id="node35" href="decode_8h.html" title="decode.h" alt="" coords="451,603,525,629"/><area shape="rect" id="node36" href="detect_8h.html" title="detect.h" alt="" coords="643,453,712,480"/><area shape="rect" id="node37" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="526,528,636,555"/><area shape="rect" id="node42" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="5,304,101,331"/></map>
</div>
</div>
<p><a href="util-spm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0920e054e473b4e5b27064f0cf070d78"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm_8c.html#a0920e054e473b4e5b27064f0cf070d78">Bs2bmSearch</a> (uint8_t *text, uint32_t textlen, uint8_t *needle, uint16_t needlelen)</td></tr>
<tr class="memdesc:a0920e054e473b4e5b27064f0cf070d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search a pattern in the text using the Bs2Bm algorithm (build a bad characters array)  <a href="#a0920e054e473b4e5b27064f0cf070d78">More...</a><br/></td></tr>
<tr class="separator:a0920e054e473b4e5b27064f0cf070d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28ac5e4ac013100ef4b8143da2f1ef2"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm_8c.html#ab28ac5e4ac013100ef4b8143da2f1ef2">Bs2bmNocaseSearch</a> (uint8_t *text, uint32_t textlen, uint8_t *needle, uint16_t needlelen)</td></tr>
<tr class="memdesc:ab28ac5e4ac013100ef4b8143da2f1ef2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search a pattern in the text using the Bs2Bm nocase algorithm (build a bad characters array)  <a href="#ab28ac5e4ac013100ef4b8143da2f1ef2">More...</a><br/></td></tr>
<tr class="separator:ab28ac5e4ac013100ef4b8143da2f1ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012133adf35686480d833cddd856b05e"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm_8c.html#a012133adf35686480d833cddd856b05e">BoyerMooreSearch</a> (uint8_t *text, uint32_t textlen, uint8_t *needle, uint16_t needlelen)</td></tr>
<tr class="memdesc:a012133adf35686480d833cddd856b05e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search a pattern in the text using Boyer Moore algorithm (build a bad character shifts array and good prefixes shift array)  <a href="#a012133adf35686480d833cddd856b05e">More...</a><br/></td></tr>
<tr class="separator:a012133adf35686480d833cddd856b05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b05da977fc439a45875f67b9f3dce9"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm_8c.html#a58b05da977fc439a45875f67b9f3dce9">BoyerMooreNocaseSearch</a> (uint8_t *text, uint32_t textlen, uint8_t *needle, uint16_t needlelen)</td></tr>
<tr class="memdesc:a58b05da977fc439a45875f67b9f3dce9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search a pattern in the text using Boyer Moore nocase algorithm (build a bad character shifts array and good prefixes shift array)  <a href="#a58b05da977fc439a45875f67b9f3dce9">More...</a><br/></td></tr>
<tr class="separator:a58b05da977fc439a45875f67b9f3dce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a71343a44e19211e7973c72ac5f5454"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-spm_8c.html#a5a71343a44e19211e7973c72ac5f5454">UtilSpmSearchRegistertests</a> (void)</td></tr>
<tr class="separator:a5a71343a44e19211e7973c72ac5f5454"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Pablo Rincon Crespo <a href="#" onclick="location.href='mai'+'lto:'+'pab'+'lo'+'.ri'+'nc'+'on.'+'cr'+'esp'+'o@'+'gma'+'il'+'.co'+'m'; return false;">pablo<span style="display: none;">.nosp@m.</span>.rin<span style="display: none;">.nosp@m.</span>con.c<span style="display: none;">.nosp@m.</span>resp<span style="display: none;">.nosp@m.</span>o@gma<span style="display: none;">.nosp@m.</span>il.c<span style="display: none;">.nosp@m.</span>om</a></dd></dl>
<p>PR (17/01/2010): Single pattern search algorithms: Currently there are 3 algorithms to choose: BasicSearch, Bs2Bm and BoyerMoore (Boyer Moores algorithm). The first one doesn't need a context. But for Bs2Bm and BoyerMoore, you'll need to build some arrays.</p>
<p>!! If you are going to use the same pattern multiple times, please, try to store the context some where. For Bs2Bm, the context is an array of "badchars". For BoyerMoore you need to store two arrays of shifts. Have a look at the wrappers and unittests for examples of this. If you cant store the context, use the wrappers: Bs2bmSearch, BoyerMooreSearch, and the ones caseless, or BasicSearch That is the most basic.</p>
<p>Use the stats and <a class="el" href="util-clock_8h.html">util-clock.h</a> to determine which one fit better for you Boyer Moore should be used for patterns greater than 1 of length In the range of 2 - 6, if the text length is greater than 1000 you could use boyer moore, otherwise, basic search. If the pattern is greater than 6 and the textlen is greater than 500, use boyer moore. This is an aproximation, but use the stats and util-clock to determine which one fit better for your case. </p>

<p>Definition in file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a58b05da977fc439a45875f67b9f3dce9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* BoyerMooreNocaseSearch </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>textlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needlelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search a pattern in the text using Boyer Moore nocase algorithm (build a bad character shifts array and good prefixes shift array) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">text</td><td>Text to search in </td></tr>
    <tr><td class="paramname">textlen</td><td>length of the text </td></tr>
    <tr><td class="paramname">needle</td><td>pattern to search for </td></tr>
    <tr><td class="paramname">needlelen</td><td>length of the pattern </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm_8c_source.html#l00123">123</a> of file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>

<p>References <a class="el" href="util-spm-bm_8c_source.html#l00124">BoyerMooreCtxDeInit()</a>, <a class="el" href="util-spm-bm_8c_source.html#l00354">BoyerMooreNocase()</a>, and <a class="el" href="util-spm-bm_8c_source.html#l00110">BoyerMooreNocaseCtxInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_a58b05da977fc439a45875f67b9f3dce9_cgraph.png" border="0" usemap="#util-spm_8c_a58b05da977fc439a45875f67b9f3dce9_cgraph" alt=""/></div>
<map name="util-spm_8c_a58b05da977fc439a45875f67b9f3dce9_cgraph" id="util-spm_8c_a58b05da977fc439a45875f67b9f3dce9_cgraph">
<area shape="rect" id="node2" href="util-spm-bm_8c.html#a40ec567a71bb907691681f07e25f78ad" title="Free the memory allocated to Booyer Moore context. " alt="" coords="246,5,394,32"/><area shape="rect" id="node3" href="util-spm-bm_8c.html#ac0b057b002a1b78afe98bfaf55bfbc01" title="Boyer Moore search algorithm Is better as the pattern length increases and for big buffers to search ..." alt="" coords="251,56,389,83"/><area shape="rect" id="node4" href="util-spm-bm_8c.html#ae0829e0adc174f39600c884b1102b30c" title="Setup a Booyer Moore context for nocase search. " alt="" coords="232,107,408,133"/><area shape="rect" id="node5" href="util-spm-bm_8c.html#aab627387582301c758b20eb1650f4bc0" title="Setup a Booyer Moore context. " alt="" coords="477,81,608,108"/><area shape="rect" id="node6" href="util-spm-bm_8c.html#a3547420c83def4a1ebe21cf45261231d" title="Given a BmCtx structure, recreate the pre/suffixes for nocase. " alt="" coords="456,132,629,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a012133adf35686480d833cddd856b05e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* BoyerMooreSearch </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>textlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needlelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search a pattern in the text using Boyer Moore algorithm (build a bad character shifts array and good prefixes shift array) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">text</td><td>Text to search in </td></tr>
    <tr><td class="paramname">textlen</td><td>length of the text </td></tr>
    <tr><td class="paramname">needle</td><td>pattern to search for </td></tr>
    <tr><td class="paramname">needlelen</td><td>length of the pattern </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm_8c_source.html#l00104">104</a> of file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>

<p>References <a class="el" href="util-spm-bm_8c_source.html#l00305">BoyerMoore()</a>, <a class="el" href="util-spm-bm_8c_source.html#l00124">BoyerMooreCtxDeInit()</a>, and <a class="el" href="util-spm-bm_8c_source.html#l00076">BoyerMooreCtxInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_a012133adf35686480d833cddd856b05e_cgraph.png" border="0" usemap="#util-spm_8c_a012133adf35686480d833cddd856b05e_cgraph" alt=""/></div>
<map name="util-spm_8c_a012133adf35686480d833cddd856b05e_cgraph" id="util-spm_8c_a012133adf35686480d833cddd856b05e_cgraph">
<area shape="rect" id="node2" href="util-spm-bm_8c.html#a5886feebf61e43a7b217bb942e8451c6" title="Boyer Moore search algorithm Is better as the pattern length increases and for big buffers to search ..." alt="" coords="215,5,307,32"/><area shape="rect" id="node3" href="util-spm-bm_8c.html#a40ec567a71bb907691681f07e25f78ad" title="Free the memory allocated to Booyer Moore context. " alt="" coords="187,56,335,83"/><area shape="rect" id="node4" href="util-spm-bm_8c.html#aab627387582301c758b20eb1650f4bc0" title="Setup a Booyer Moore context. " alt="" coords="196,107,327,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab28ac5e4ac013100ef4b8143da2f1ef2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* Bs2bmNocaseSearch </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>textlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needlelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search a pattern in the text using the Bs2Bm nocase algorithm (build a bad characters array) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">text</td><td>Text to search in </td></tr>
    <tr><td class="paramname">textlen</td><td>length of the text </td></tr>
    <tr><td class="paramname">needle</td><td>pattern to search for </td></tr>
    <tr><td class="paramname">needlelen</td><td>length of the pattern </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm_8c_source.html#l00087">87</a> of file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>

<p>References <a class="el" href="util-spm-bm_8h_source.html#l00031">ALPHABET_SIZE</a>, <a class="el" href="util-spm-bs2bm_8c_source.html#l00043">Bs2BmBadchars()</a>, and <a class="el" href="util-spm-bs2bm_8c_source.html#l00142">Bs2BmNocase()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_ab28ac5e4ac013100ef4b8143da2f1ef2_cgraph.png" border="0" usemap="#util-spm_8c_ab28ac5e4ac013100ef4b8143da2f1ef2_cgraph" alt=""/></div>
<map name="util-spm_8c_ab28ac5e4ac013100ef4b8143da2f1ef2_cgraph" id="util-spm_8c_ab28ac5e4ac013100ef4b8143da2f1ef2_cgraph">
<area shape="rect" id="node2" href="util-spm-bs2bm_8c.html#a8ece831fc199338d92945281ecfb2546" title="Array setup function for Bs2Bm of bad characters index (not found at the needle) " alt="" coords="203,5,323,32"/><area shape="rect" id="node3" href="util-spm-bs2bm_8c.html#a71e47fe12a7533d6a11f93949996f0f2" title="Basic search case less with a bad characters array. The array badchars contains flags at character&#39;s ..." alt="" coords="207,56,318,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0920e054e473b4e5b27064f0cf070d78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* Bs2bmSearch </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>textlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>needle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>needlelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search a pattern in the text using the Bs2Bm algorithm (build a bad characters array) </p>
<p>Wrappers for building context and searching (Bs2Bm and boyermoore) Use them if you cant store the context </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">text</td><td>Text to search in </td></tr>
    <tr><td class="paramname">textlen</td><td>length of the text </td></tr>
    <tr><td class="paramname">needle</td><td>pattern to search for </td></tr>
    <tr><td class="paramname">needlelen</td><td>length of the pattern </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-spm_8c_source.html#l00071">71</a> of file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>

<p>References <a class="el" href="util-spm-bm_8h_source.html#l00031">ALPHABET_SIZE</a>, <a class="el" href="util-spm-bs2bm_8c_source.html#l00093">Bs2Bm()</a>, and <a class="el" href="util-spm-bs2bm_8c_source.html#l00043">Bs2BmBadchars()</a>.</p>

<p>Referenced by <a class="el" href="app-layer-htp_8c_source.html#l01278">HtpRequestBodyHandleMultipart()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_cgraph.png" border="0" usemap="#util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_cgraph" alt=""/></div>
<map name="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_cgraph" id="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_cgraph">
<area shape="rect" id="node2" href="util-spm-bs2bm_8c.html#a24ce63cafb748dfa2c37909bef8bf0c4" title="Basic search with a bad characters array. The array badchars contains flags at character&#39;s ascii inde..." alt="" coords="185,5,250,32"/><area shape="rect" id="node3" href="util-spm-bs2bm_8c.html#a8ece831fc199338d92945281ecfb2546" title="Array setup function for Bs2Bm of bad characters index (not found at the needle) " alt="" coords="157,56,277,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_icgraph.png" border="0" usemap="#util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_icgraph" alt=""/></div>
<map name="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_icgraph" id="util-spm_8c_a0920e054e473b4e5b27064f0cf070d78_icgraph">
<area shape="rect" id="node2" href="app-layer-htp_8c.html#a7c8de21b238af723ac6783faf36c5940" title="HtpRequestBodyHandleMultipart" alt="" coords="157,5,371,32"/><area shape="rect" id="node3" href="group__httplayer.html#ga44076de04240313e46c32ca79db458cc" title="Function callback to append chunks for Requests. " alt="" coords="419,5,626,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a71343a44e19211e7973c72ac5f5454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilSpmSearchRegistertests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-spm_8c_source.html#l02318">2318</a> of file <a class="el" href="util-spm_8c_source.html">util-spm.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-spm_8c_a5a71343a44e19211e7973c72ac5f5454_icgraph.png" border="0" usemap="#util-spm_8c_a5a71343a44e19211e7973c72ac5f5454_icgraph" alt=""/></div>
<map name="util-spm_8c_a5a71343a44e19211e7973c72ac5f5454_icgraph" id="util-spm_8c_a5a71343a44e19211e7973c72ac5f5454_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="243,5,341,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="587,5,637,32"/><area shape="rect" id="node4" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="389,31,539,57"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util-spm_8c.html">util-spm.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:17 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
