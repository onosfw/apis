<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: State support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__sigstate.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">State support</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:detect-engine-state_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-state_8c.html">detect-engine-state.c</a></td></tr>
<tr class="memdesc:detect-engine-state_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">State based signature handling. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:detect-engine-state_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-state_8h.html">detect-engine-state.h</a></td></tr>
<tr class="memdesc:detect-engine-state_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structures and function prototypes for keeping state for the detection engine. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga69763b0d6a24b69b48cf74d41564def3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#ga69763b0d6a24b69b48cf74d41564def3">CASE_CODE</a>(E)&#160;&#160;&#160;case E: return #E</td></tr>
<tr class="separator:ga69763b0d6a24b69b48cf74d41564def3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73f308066b6a80d852a22b769fffe9b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#ga73f308066b6a80d852a22b769fffe9b2">MAX_STORED_TXID_OFFSET</a>&#160;&#160;&#160;127</td></tr>
<tr class="separator:ga73f308066b6a80d852a22b769fffe9b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gada8ed9c30b08c405c5359cdfbe5815bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gada8ed9c30b08c405c5359cdfbe5815bb">DetectEngineStateAlloc</a> (void)</td></tr>
<tr class="memdesc:gada8ed9c30b08c405c5359cdfbe5815bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alloc a DetectEngineState object.  <a href="#gada8ed9c30b08c405c5359cdfbe5815bb">More...</a><br/></td></tr>
<tr class="separator:gada8ed9c30b08c405c5359cdfbe5815bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4728d2dcd27022e581dca452795f0c0d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#ga4728d2dcd27022e581dca452795f0c0d">DetectEngineStateFlowAlloc</a> (void)</td></tr>
<tr class="separator:ga4728d2dcd27022e581dca452795f0c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6fe68f13b5ffdcb71abd7c92676813d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gad6fe68f13b5ffdcb71abd7c92676813d">DetectEngineStateFree</a> (<a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *state)</td></tr>
<tr class="memdesc:gad6fe68f13b5ffdcb71abd7c92676813d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a DetectEngineState object.  <a href="#gad6fe68f13b5ffdcb71abd7c92676813d">More...</a><br/></td></tr>
<tr class="separator:gad6fe68f13b5ffdcb71abd7c92676813d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfef8e2bcb55dc6ec2788c418dc4a7d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">DetectEngineStateFlowFree</a> (<a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a> *state)</td></tr>
<tr class="separator:gacfef8e2bcb55dc6ec2788c418dc4a7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad37bfa7d57fcfc7c457a1028c0da4f80"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gad37bfa7d57fcfc7c457a1028c0da4f80">DeStateFlowHasInspectableState</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, <a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, const uint8_t alversion, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:gad37bfa7d57fcfc7c457a1028c0da4f80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we need to inspect this state.  <a href="#gad37bfa7d57fcfc7c457a1028c0da4f80">More...</a><br/></td></tr>
<tr class="separator:gad37bfa7d57fcfc7c457a1028c0da4f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cd5aba6758fd5795f477973b5f2fdfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#ga4cd5aba6758fd5795f477973b5f2fdfb">DeStateDetectStartDetection</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *de_ctx, <a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *det_ctx, <a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *s, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>, <a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, const uint8_t alversion)</td></tr>
<tr class="memdesc:ga4cd5aba6758fd5795f477973b5f2fdfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Match app layer sig list against app state and store relevant match information.  <a href="#ga4cd5aba6758fd5795f477973b5f2fdfb">More...</a><br/></td></tr>
<tr class="separator:ga4cd5aba6758fd5795f477973b5f2fdfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaea2ddcec2d9f3549aea0de468834039"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gaaea2ddcec2d9f3549aea0de468834039">DeStateDetectContinueDetection</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *de_ctx, <a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *det_ctx, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>, <a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto, const uint8_t alversion)</td></tr>
<tr class="memdesc:gaaea2ddcec2d9f3549aea0de468834039"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continue DeState detection of the signatures stored in the state.  <a href="#gaaea2ddcec2d9f3549aea0de468834039">More...</a><br/></td></tr>
<tr class="separator:gaaea2ddcec2d9f3549aea0de468834039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad76e9cb6462b7784633d17b1347f771b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gad76e9cb6462b7784633d17b1347f771b">DeStateUpdateInspectTransactionId</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, const uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:gad76e9cb6462b7784633d17b1347f771b"><td class="mdescLeft">&#160;</td><td class="mdescRight">update flow's inspection id's  <a href="#gad76e9cb6462b7784633d17b1347f771b">More...</a><br/></td></tr>
<tr class="separator:gad76e9cb6462b7784633d17b1347f771b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae49e923c7e86601c4a96caf9ab2d4f24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gae49e923c7e86601c4a96caf9ab2d4f24">DetectEngineStateReset</a> (<a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a> *state, uint8_t direction)</td></tr>
<tr class="memdesc:gae49e923c7e86601c4a96caf9ab2d4f24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a DetectEngineState state.  <a href="#gae49e923c7e86601c4a96caf9ab2d4f24">More...</a><br/></td></tr>
<tr class="separator:gae49e923c7e86601c4a96caf9ab2d4f24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf15c37dbdf92918d6f107087ff082fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#gabf15c37dbdf92918d6f107087ff082fb">DetectEngineStateResetTxs</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="memdesc:gabf15c37dbdf92918d6f107087ff082fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset de state for active tx' To be used on detect engine reload.  <a href="#gabf15c37dbdf92918d6f107087ff082fb">More...</a><br/></td></tr>
<tr class="separator:gabf15c37dbdf92918d6f107087ff082fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga205034ae2733eb44d2ae6630026a34f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sigstate.html#ga205034ae2733eb44d2ae6630026a34f6">DeStateRegisterTests</a> (void)</td></tr>
<tr class="separator:ga205034ae2733eb44d2ae6630026a34f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>It is possible to do matching on reconstructed applicative flow. This is done by this code. It uses the <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b" title="Flow data structure. ">Flow</a> structure to store the list of signatures to match on the reconstructed stream.</p>
<p>The <a class="el" href="structFlow__.html#a2f68ade67ed135f7ad225784d3771e78">Flow::de_state</a> is a <a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> structure. This is basically a containter for storage item of type <a class="el" href="detect-engine-state_8h.html#ab65c0a51c0b89637771948495df93509">DeStateStore</a>. They contains an array of <a class="el" href="detect-engine-state_8h.html#ad99f58c3edea5cbbd2f3c4eeaa9d68a7">DeStateStoreItem</a> which store the state of match for an individual signature identified by <a class="el" href="structDeStateStoreItem__.html#a7fd61a636e81efabbabfea9eb92a366c">DeStateStoreItem::sid</a>.</p>
<p>The state is constructed by <a class="el" href="group__sigstate.html#ga4cd5aba6758fd5795f477973b5f2fdfb" title="Match app layer sig list against app state and store relevant match information. ">DeStateDetectStartDetection()</a> which also starts the matching. Work is continued by <a class="el" href="group__sigstate.html#gaaea2ddcec2d9f3549aea0de468834039" title="Continue DeState detection of the signatures stored in the state. ">DeStateDetectContinueDetection()</a>.</p>
<p>Once a transaction has been analysed DeStateRestartDetection() is used to reset the structures. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga69763b0d6a24b69b48cf74d41564def3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CASE_CODE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">E</td><td>)</td>
          <td>&#160;&#160;&#160;case E: return #E</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>convert enum to string </p>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00082">82</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga73f308066b6a80d852a22b769fffe9b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_STORED_TXID_OFFSET&#160;&#160;&#160;127</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The <a class="el" href="structDetectEngineThreadCtx__.html#a8c422de9a40936ca3b01ea194c691a11">DetectEngineThreadCtx::de_state_sig_array</a> contains 2 separate values:</p>
<ol type="1">
<li>the first bit tells the prefilter engine to bypass the rule (or not)</li>
<li>the other bits allow 'ContinueDetect' to specify an offset again the base tx id. This offset will then be used by 'StartDetect' to not inspect transactions again for the same signature.</li>
</ol>
<p>The offset in (2) has a max value due to the limited data type. If it is set to max the code will fall back to a slower path that validates that we're not adding duplicate rules to the detection state. </p>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00094">94</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-state_8c_source.html#l00476">DeStateDetectStartDetection()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaaea2ddcec2d9f3549aea0de468834039"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DeStateDetectContinueDetection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td>
          <td class="paramname"><em>alproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>alversion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continue DeState detection of the signatures stored in the state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the threadvars. </td></tr>
    <tr><td class="paramname">de_ctx</td><td>DetectEngineCtx instance. </td></tr>
    <tr><td class="paramname">det_ctx</td><td>DetectEngineThreadCtx instance. </td></tr>
    <tr><td class="paramname">f</td><td>Pointer to the flow. </td></tr>
    <tr><td class="paramname">flags</td><td>Flags. </td></tr>
    <tr><td class="paramname">alproto</td><td>App protocol. </td></tr>
    <tr><td class="paramname">alversion</td><td>Current app layer version. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00979">979</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00384">Flow_::alparser</a>, <a class="el" href="app-layer-parser_8c_source.html#l00736">AppLayerParserGetStateProgress()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00769">AppLayerParserGetStateProgressCompletionStatus()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00539">AppLayerParserGetTransactionInspectId()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00760">AppLayerParserGetTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00751">AppLayerParserGetTxCnt()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00833">AppLayerParserGetTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01047">AppLayerParserProtocolSupportsTxs()</a>, <a class="el" href="detect-engine-state_8h_source.html#l00124">DetectEngineStateDirection_::cnt</a>, <a class="el" href="detect-engine-state_8h_source.html#l00149">DetectEngineStateDirectionFlow_::cnt</a>, <a class="el" href="flow_8h_source.html#l00388">Flow_::de_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00057">DE_STATE_CHUNK_SIZE</a>, <a class="el" href="detect-engine-state_8h_source.html#l00130">DetectEngineState_::dir_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00154">DetectEngineStateFlow_::dir_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00126">DetectEngineStateDirection_::flags</a>, <a class="el" href="detect-engine-state_8h_source.html#l00150">DetectEngineStateDirectionFlow_::flags</a>, <a class="el" href="flow_8c_source.html#l00868">FlowGetAppState()</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>, <a class="el" href="detect-engine-state_8h_source.html#l00122">DetectEngineStateDirection_::head</a>, <a class="el" href="detect-engine-state_8h_source.html#l00147">DetectEngineStateDirectionFlow_::head</a>, <a class="el" href="detect-engine-state_8h_source.html#l00118">DeStateStore_::next</a>, <a class="el" href="detect-engine-state_8h_source.html#l00143">DeStateStoreFlowRules_::next</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="suricata-common_8h_source.html#l00230">SigIntId</a>, <a class="el" href="detect-engine-state_8h_source.html#l00117">DeStateStore_::store</a>, <a class="el" href="detect-engine-state_8h_source.html#l00142">DeStateStoreFlowRules_::store</a>, <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>, <a class="el" href="detect_8h_source.html#l00831">DetectEngineThreadCtx_::tx_id</a>, and <a class="el" href="detect_8h_source.html#l00829">DetectEngineThreadCtx_::tx_id_set</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_cgraph.png" border="0" usemap="#group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_cgraph" alt=""/></div>
<map name="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_cgraph" id="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#aac5503d1811500f82687093b7d85d341" title="get the progress value for a tx/protocol " alt="" coords="281,5,500,32"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#aa6d2b1e4dcee3616e0fdda0ee96e03f8" title="AppLayerParserGetStateProgress\lCompletionStatus" alt="" coords="281,57,500,98"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a6aa2bf85c50af391090247d1416758d8" title="AppLayerParserGetTransaction\lInspectId" alt="" coords="289,122,493,163"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a2a0c9e0f732c9fb0240cf2f0b73613f6" title="AppLayerParserGetTx" alt="" coords="315,188,466,215"/><area shape="rect" id="node7" href="app-layer-parser_8c.html#a8fe15cbcd76f969cc497b74aeb90ee66" title="AppLayerParserGetTxCnt" alt="" coords="305,239,477,265"/><area shape="rect" id="node8" href="app-layer-parser_8c.html#a0c30716ce0c65eca306be891f35411d2" title="AppLayerParserGetTxDetect\lState" alt="" coords="295,290,486,331"/><area shape="rect" id="node9" href="app-layer-parser_8c.html#a5d36767e076ef8376251c27326532e55" title="AppLayerParserProtocolSupportsTxs" alt="" coords="272,356,509,383"/><area shape="rect" id="node10" href="flow_8c.html#afb864b6392ad4eddbdf7092d4ec4e78e" title="FlowGetAppState" alt="" coords="328,407,453,433"/><area shape="rect" id="node3" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="558,213,709,240"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_icgraph.png" border="0" usemap="#group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_icgraph" alt=""/></div>
<map name="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_icgraph" id="group__sigstate_gaaea2ddcec2d9f3549aea0de468834039_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="272,5,411,32"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="459,5,520,32"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="568,5,739,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="787,5,922,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="971,5,1069,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1315,5,1365,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1117,31,1267,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4cd5aba6758fd5795f477973b5f2fdfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DeStateDetectStartDetection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td>
          <td class="paramname"><em>alproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>alversion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Match app layer sig list against app state and store relevant match information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>Pointer to the threadvars. </td></tr>
    <tr><td class="paramname">de_ctx</td><td>DetectEngineCtx instance. </td></tr>
    <tr><td class="paramname">det_ctx</td><td>DetectEngineThreadCtx instance. </td></tr>
    <tr><td class="paramname">s</td><td>Pointer to the signature. </td></tr>
    <tr><td class="paramname">f</td><td>Pointer to the flow. </td></tr>
    <tr><td class="paramname">flags</td><td>Flags. </td></tr>
    <tr><td class="paramname">alproto</td><td>App protocol. </td></tr>
    <tr><td class="paramname">alversion</td><td>Current app layer version.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;=</td><td>0 An integer value indicating the no of matches. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00476">476</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00384">Flow_::alparser</a>, <a class="el" href="app-layer-protos_8h_source.html#l00040">ALPROTO_DCERPC</a>, <a class="el" href="app-layer-protos_8h_source.html#l00038">ALPROTO_SMB</a>, <a class="el" href="app-layer-protos_8h_source.html#l00039">ALPROTO_SMB2</a>, <a class="el" href="detect-engine_8c_source.html#l00114">app_inspection_engine</a>, <a class="el" href="detect_8h_source.html#l00903">SigTableElmt_::AppLayerMatch</a>, <a class="el" href="app-layer-parser_8c_source.html#l00736">AppLayerParserGetStateProgress()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00769">AppLayerParserGetStateProgressCompletionStatus()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00539">AppLayerParserGetTransactionInspectId()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00760">AppLayerParserGetTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00751">AppLayerParserGetTxCnt()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01047">AppLayerParserProtocolSupportsTxs()</a>, <a class="el" href="detect-engine_8h_source.html#l00045">DetectEngineAppInspectionEngine_::Callback</a>, <a class="el" href="app-layer-smb_8h_source.html#l00086">SMBState_::dcerpc</a>, <a class="el" href="app-layer-smb_8h_source.html#l00087">SMBState_::dcerpc_present</a>, <a class="el" href="detect-engine-state_8h_source.html#l00075">DE_STATE_FLAG_FULL_INSPECT</a>, <a class="el" href="detect-engine-state_8h_source.html#l00076">DE_STATE_FLAG_SIG_CANT_MATCH</a>, <a class="el" href="detect_8h_source.html#l00849">DetectEngineThreadCtx_::de_state_sig_array</a>, <a class="el" href="detect-engine-state_8h_source.html#l00053">DETECT_ENGINE_INSPECT_SIG_CANT_MATCH</a>, <a class="el" href="detect-engine-state_8h_source.html#l00054">DETECT_ENGINE_INSPECT_SIG_CANT_MATCH_FILESTORE</a>, <a class="el" href="detect-engine-state_8h_source.html#l00052">DETECT_ENGINE_INSPECT_SIG_MATCH</a>, <a class="el" href="detect_8h_source.html#l00117">DETECT_SM_LIST_AMATCH</a>, <a class="el" href="detect_8h_source.html#l00118">DETECT_SM_LIST_DMATCH</a>, <a class="el" href="detect-engine-dcepayload_8c_source.html#l00064">DetectEngineInspectDcePayload()</a>, <a class="el" href="detect_8c_source.html#l01923">DetectSignatureApplyActions()</a>, <a class="el" href="detect_8h_source.html#l00373">Signature_::flags</a>, <a class="el" href="flow_8c_source.html#l00868">FlowGetAppState()</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>, <a class="el" href="detect-engine_8h_source.html#l00037">DetectEngineAppInspectionEngine_::inspect_flags</a>, <a class="el" href="util-profiling_8h_source.html#l00082">KEYWORD_PROFILING_END</a>, <a class="el" href="util-profiling_8h_source.html#l00064">KEYWORD_PROFILING_SET_LIST</a>, <a class="el" href="util-profiling_8h_source.html#l00068">KEYWORD_PROFILING_START</a>, <a class="el" href="detect-engine-state_8c_source.html#l00094">MAX_STORED_TXID_OFFSET</a>, <a class="el" href="detect-engine_8h_source.html#l00050">DetectEngineAppInspectionEngine_::next</a>, <a class="el" href="detect_8h_source.html#l00358">SigMatch_::next</a>, <a class="el" href="detect_8h_source.html#l00384">Signature_::num</a>, <a class="el" href="decode_8h_source.html#l00271">PACKET_ALERT_FLAG_STATE_MATCH</a>, <a class="el" href="decode_8h_source.html#l00275">PACKET_ALERT_FLAG_TX</a>, <a class="el" href="detect-engine-alert_8c_source.html#l00189">PacketAlertAppend()</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00359">Flow_::protomap</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="detect_8h_source.html#l00262">SIG_FLAG_NOALERT</a>, <a class="el" href="detect_8h_source.html#l01233">sigmatch_table</a>, <a class="el" href="detect-engine_8h_source.html#l00036">DetectEngineAppInspectionEngine_::sm_list</a>, <a class="el" href="detect_8h_source.html#l00432">Signature_::sm_lists</a>, <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">tx_id</a>, <a class="el" href="detect_8h_source.html#l00831">DetectEngineThreadCtx_::tx_id</a>, <a class="el" href="detect_8h_source.html#l00829">DetectEngineThreadCtx_::tx_id_set</a>, and <a class="el" href="detect_8h_source.html#l00355">SigMatch_::type</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_cgraph.png" border="0" usemap="#group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_cgraph" alt=""/></div>
<map name="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_cgraph" id="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#aac5503d1811500f82687093b7d85d341" title="get the progress value for a tx/protocol " alt="" coords="257,5,476,32"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#aa6d2b1e4dcee3616e0fdda0ee96e03f8" title="AppLayerParserGetStateProgress\lCompletionStatus" alt="" coords="257,57,476,98"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a6aa2bf85c50af391090247d1416758d8" title="AppLayerParserGetTransaction\lInspectId" alt="" coords="265,122,469,163"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a2a0c9e0f732c9fb0240cf2f0b73613f6" title="AppLayerParserGetTx" alt="" coords="291,188,442,215"/><area shape="rect" id="node7" href="app-layer-parser_8c.html#a8fe15cbcd76f969cc497b74aeb90ee66" title="AppLayerParserGetTxCnt" alt="" coords="281,239,453,265"/><area shape="rect" id="node8" href="app-layer-parser_8c.html#a5d36767e076ef8376251c27326532e55" title="AppLayerParserProtocolSupportsTxs" alt="" coords="248,289,485,316"/><area shape="rect" id="node9" href="detect-engine-dcepayload_8c.html#a5b66e7647e544a880639f3cbb8c62e2f" title="Do the content inspection &amp; validation for a signature against dce stub. " alt="" coords="259,340,474,367"/><area shape="rect" id="node19" href="detect_8c.html#ac00c13ef5905a82b6726875f9a6b0e69" title="Apply action(s) and Set &#39;drop&#39; sig info, if applicable. " alt="" coords="270,391,463,417"/><area shape="rect" id="node20" href="flow_8c.html#afb864b6392ad4eddbdf7092d4ec4e78e" title="FlowGetAppState" alt="" coords="304,441,429,468"/><area shape="rect" id="node21" href="detect-engine-alert_8c.html#ab0e97bac79257b8d920009e1d5ec7161" title="append a signature match to a packet " alt="" coords="299,492,434,519"/><area shape="rect" id="node3" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="562,188,713,215"/><area shape="rect" id="node10" href="detect-engine-content-inspection_8c.html#a3e7f38a74a478813133ff9ed5c8ec7a5" title="Run the actual payload match functions. " alt="" coords="534,340,741,367"/><area shape="rect" id="node11" href="util-spm-bm_8c.html#a5886feebf61e43a7b217bb942e8451c6" title="Boyer Moore search algorithm Is better as the pattern length increases and for big buffers to search ..." alt="" coords="829,264,921,291"/><area shape="rect" id="node12" href="util-spm-bm_8c.html#ac0b057b002a1b78afe98bfaf55bfbc01" title="Boyer Moore search algorithm Is better as the pattern length increases and for big buffers to search ..." alt="" coords="806,315,943,341"/><area shape="rect" id="node13" href="detect-pcre_8c.html#a6ae7853f4c9163cb68d47b7f08b9336f" title="Match a regex on a single payload. " alt="" coords="789,365,960,392"/><area shape="rect" id="node18" href="detect-replace_8c.html#a743cca1d9869292d42f02b113b8d000e" title="DetectReplaceAddToList" alt="" coords="791,416,959,443"/><area shape="rect" id="node14" href="detect-flowvar_8c.html#a932d5966f2cd85270cc55391c12c37b6" title="Store flowvar in det_ctx so we can exec it post&#45;match. " alt="" coords="1009,340,1183,367"/><area shape="rect" id="node15" href="pkt-var_8c.html#ae9bb0210402740e68639080fd5aadcd4" title="PktVarAdd" alt="" coords="1053,391,1139,417"/><area shape="rect" id="node16" href="pkt-var_8c.html#a1faa35c0ef110acba143236b99404ed2" title="PktVarGet" alt="" coords="1243,365,1325,392"/><area shape="rect" id="node17" href="pkt-var_8c.html#addc8c2b9e91acb75029ea3dd0eb4a6d5" title="PktVarUpdate" alt="" coords="1232,416,1336,443"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_icgraph.png" border="0" usemap="#group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_icgraph" alt=""/></div>
<map name="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_icgraph" id="group__sigstate_ga4cd5aba6758fd5795f477973b5f2fdfb_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="248,5,387,32"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="435,5,496,32"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="544,5,715,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="763,5,898,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="947,5,1045,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1291,5,1341,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1093,31,1243,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad37bfa7d57fcfc7c457a1028c0da4f80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DeStateFlowHasInspectableState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td>
          <td class="paramname"><em>alproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>alversion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if we need to inspect this state. </p>
<p>Check if a flow already contains(newly updated as well) de state.</p>
<p>State needs to be inspected if:</p>
<ol type="1">
<li>state has been updated</li>
<li>we already have de_state in progress</li>
</ol>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>no inspectable state </td></tr>
    <tr><td class="paramname">1</td><td>inspectable state </td></tr>
    <tr><td class="paramname">2</td><td>inspectable state, but no update </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00376">376</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00388">Flow_::de_state</a>, <a class="el" href="flow_8h_source.html#l00379">Flow_::detect_alversion</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="stream_8h_source.html#l00030">STREAM_EOF</a>, and <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gad37bfa7d57fcfc7c457a1028c0da4f80_icgraph.png" border="0" usemap="#group__sigstate_gad37bfa7d57fcfc7c457a1028c0da4f80_icgraph" alt=""/></div>
<map name="group__sigstate_gad37bfa7d57fcfc7c457a1028c0da4f80_icgraph" id="group__sigstate_gad37bfa7d57fcfc7c457a1028c0da4f80_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="243,12,381,39"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="429,12,491,39"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="539,12,709,39"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="758,12,893,39"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="941,12,1040,39"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1285,12,1336,39"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1088,37,1237,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga205034ae2733eb44d2ae6630026a34f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DeStateRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l02326">2326</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_ga205034ae2733eb44d2ae6630026a34f6_icgraph.png" border="0" usemap="#group__sigstate_ga205034ae2733eb44d2ae6630026a34f6_icgraph" alt=""/></div>
<map name="group__sigstate_ga205034ae2733eb44d2ae6630026a34f6_icgraph" id="group__sigstate_ga205034ae2733eb44d2ae6630026a34f6_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="205,5,304,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="549,5,600,32"/><area shape="rect" id="node4" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="352,31,501,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad76e9cb6462b7784633d17b1347f771b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DeStateUpdateInspectTransactionId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update flow's inspection id's </p>
<p>Update the inspect id.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>unlocked flow </td></tr>
    <tr><td class="paramname">flags</td><td>direction and disruption flags</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>it is possible that f-&gt;alstate, f-&gt;alparser are NULL </dd></dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l01103">1103</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00384">Flow_::alparser</a>, <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>, <a class="el" href="flow_8h_source.html#l00385">Flow_::alstate</a>, <a class="el" href="app-layer-parser_8c_source.html#l00549">AppLayerParserSetTransactionInspectId()</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>, and <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01954">Detect()</a>, and <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_cgraph.png" border="0" usemap="#group__sigstate_gad76e9cb6462b7784633d17b1347f771b_cgraph" alt=""/></div>
<map name="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_cgraph" id="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#a7f1dcf0b6977ba926f6fcd8b585aaf09" title="AppLayerParserSetTransaction\lInspectId" alt="" coords="288,122,491,163"/><area shape="rect" id="node3" href="app-layer-parser_8c.html#aac5503d1811500f82687093b7d85d341" title="get the progress value for a tx/protocol " alt="" coords="539,5,757,32"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#aa6d2b1e4dcee3616e0fdda0ee96e03f8" title="AppLayerParserGetStateProgress\lCompletionStatus" alt="" coords="539,57,757,98"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a6aa2bf85c50af391090247d1416758d8" title="AppLayerParserGetTransaction\lInspectId" alt="" coords="546,122,750,163"/><area shape="rect" id="node7" href="app-layer-parser_8c.html#a2a0c9e0f732c9fb0240cf2f0b73613f6" title="AppLayerParserGetTx" alt="" coords="573,188,723,215"/><area shape="rect" id="node8" href="app-layer-parser_8c.html#a8fe15cbcd76f969cc497b74aeb90ee66" title="AppLayerParserGetTxCnt" alt="" coords="562,239,734,265"/><area shape="rect" id="node4" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="806,127,957,153"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_icgraph.png" border="0" usemap="#group__sigstate_gad76e9cb6462b7784633d17b1347f771b_icgraph" alt=""/></div>
<map name="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_icgraph" id="group__sigstate_gad76e9cb6462b7784633d17b1347f771b_icgraph">
<area shape="rect" id="node2" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="475,5,536,32"/><area shape="rect" id="node8" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="288,31,427,57"/><area shape="rect" id="node3" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="584,5,755,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="803,5,938,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="987,5,1085,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1331,5,1381,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1133,31,1283,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gada8ed9c30b08c405c5359cdfbe5815bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a>* DetectEngineStateAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alloc a DetectEngineState object. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Alloc'd</td><td>instance of DetectEngineState. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00266">266</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="ga4728d2dcd27022e581dca452795f0c0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a>* DetectEngineStateFlowAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00276">276</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="gacfef8e2bcb55dc6ec2788c418dc4a7d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectEngineStateFlowFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00305">305</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="detect-engine-state_8h_source.html#l00154">DetectEngineStateFlow_::dir_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00147">DetectEngineStateDirectionFlow_::head</a>, <a class="el" href="detect-engine-state_8h_source.html#l00143">DeStateStoreFlowRules_::next</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

</div>
</div>
<a class="anchor" id="gad6fe68f13b5ffdcb71abd7c92676813d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectEngineStateFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a DetectEngineState object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>DetectEngineState instance to free. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l00286">286</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="detect-engine-state_8h_source.html#l00130">DetectEngineState_::dir_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00122">DetectEngineStateDirection_::head</a>, <a class="el" href="detect-engine-state_8h_source.html#l00118">DeStateStore_::next</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

</div>
</div>
<a class="anchor" id="gae49e923c7e86601c4a96caf9ab2d4f24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectEngineStateReset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect-engine-state_8h.html#a2814c2034561cbc8de035a12e19b732e">DetectEngineStateFlow</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a DetectEngineState state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Pointer to the state(LOCKED). </td></tr>
    <tr><td class="paramname">direction</td><td>Direction flags - STREAM_TOSERVER or STREAM_TOCLIENT. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l01115">1115</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="detect-engine-state_8h_source.html#l00149">DetectEngineStateDirectionFlow_::cnt</a>, <a class="el" href="detect-engine-state_8h_source.html#l00154">DetectEngineStateFlow_::dir_state</a>, and <a class="el" href="detect-engine-state_8h_source.html#l00150">DetectEngineStateDirectionFlow_::flags</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gae49e923c7e86601c4a96caf9ab2d4f24_icgraph.png" border="0" usemap="#group__sigstate_gae49e923c7e86601c4a96caf9ab2d4f24_icgraph" alt=""/></div>
<map name="group__sigstate_gae49e923c7e86601c4a96caf9ab2d4f24_icgraph" id="group__sigstate_gae49e923c7e86601c4a96caf9ab2d4f24_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="221,5,360,32"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="408,5,469,32"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="517,5,688,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="737,5,871,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="920,5,1019,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1264,5,1315,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1067,31,1216,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gabf15c37dbdf92918d6f107087ff082fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectEngineStateResetTxs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset de state for active tx' To be used on detect engine reload. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>write LOCKED flow </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-state_8c_source.html#l01135">1135</a> of file <a class="el" href="detect-engine-state_8c_source.html">detect-engine-state.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00384">Flow_::alparser</a>, <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>, <a class="el" href="app-layer-parser_8c_source.html#l00539">AppLayerParserGetTransactionInspectId()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00760">AppLayerParserGetTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00751">AppLayerParserGetTxCnt()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00833">AppLayerParserGetTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01047">AppLayerParserProtocolSupportsTxs()</a>, <a class="el" href="detect-engine-state_8h_source.html#l00124">DetectEngineStateDirection_::cnt</a>, <a class="el" href="detect-engine-state_8h_source.html#l00130">DetectEngineState_::dir_state</a>, <a class="el" href="detect-engine-state_8h_source.html#l00125">DetectEngineStateDirection_::filestore_cnt</a>, <a class="el" href="detect-engine-state_8h_source.html#l00126">DetectEngineStateDirection_::flags</a>, <a class="el" href="flow_8c_source.html#l00868">FlowGetAppState()</a>, <a class="el" href="suricata-common_8h_source.html#l00286">MIN</a>, and <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_cgraph.png" border="0" usemap="#group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_cgraph" alt=""/></div>
<map name="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_cgraph" id="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#a6aa2bf85c50af391090247d1416758d8" title="AppLayerParserGetTransaction\lInspectId" alt="" coords="259,5,463,46"/><area shape="rect" id="node3" href="app-layer-parser_8c.html#a2a0c9e0f732c9fb0240cf2f0b73613f6" title="AppLayerParserGetTx" alt="" coords="286,71,437,97"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a8fe15cbcd76f969cc497b74aeb90ee66" title="AppLayerParserGetTxCnt" alt="" coords="275,121,447,148"/><area shape="rect" id="node6" href="app-layer-parser_8c.html#a0c30716ce0c65eca306be891f35411d2" title="AppLayerParserGetTxDetect\lState" alt="" coords="266,173,457,214"/><area shape="rect" id="node7" href="app-layer-parser_8c.html#a5d36767e076ef8376251c27326532e55" title="AppLayerParserProtocolSupportsTxs" alt="" coords="243,239,480,265"/><area shape="rect" id="node8" href="flow_8c.html#afb864b6392ad4eddbdf7092d4ec4e78e" title="FlowGetAppState" alt="" coords="299,289,424,316"/><area shape="rect" id="node4" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="529,151,679,177"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_icgraph.png" border="0" usemap="#group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_icgraph" alt=""/></div>
<map name="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_icgraph" id="group__sigstate_gabf15c37dbdf92918d6f107087ff082fb_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="243,5,381,32"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="429,5,491,32"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="539,5,709,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="758,5,893,32"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="941,5,1040,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1285,5,1336,32"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1088,31,1237,57"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:18 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
