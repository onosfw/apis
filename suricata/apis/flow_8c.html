<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/flow.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('flow_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">flow.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="decode_8h_source.html">decode.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="runmodes_8h_source.html">runmodes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-random_8h_source.html">util-random.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow_8h_source.html">flow.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-queue_8h_source.html">flow-queue.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-hash_8h_source.html">flow-hash.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-util_8h_source.html">flow-util.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-var_8h_source.html">flow-var.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-private_8h_source.html">flow-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-timeout_8h_source.html">flow-timeout.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-manager_8h_source.html">flow-manager.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="flow-storage_8h_source.html">flow-storage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-private_8h_source.html">stream-tcp-private.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp-reassemble_8h_source.html">stream-tcp-reassemble.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream-tcp_8h_source.html">stream-tcp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest-helper_8h_source.html">util-unittest-helper.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-byte_8h_source.html">util-byte.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-misc_8h_source.html">util-misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect_8h_source.html">detect.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for flow.c:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c__incl.png" border="0" usemap="#src_2flow_8c" alt=""/></div>
<map name="src_2flow_8c" id="src_2flow_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="752,229,885,256"/><area shape="rect" id="node24" href="suricata_8h.html" title="suricata.h" alt="" coords="779,155,857,181"/><area shape="rect" id="node11" href="decode_8h.html" title="decode.h" alt="" coords="1369,528,1444,555"/><area shape="rect" id="node27" href="conf_8h.html" title="conf.h" alt="" coords="2027,80,2085,107"/><area shape="rect" id="node12" href="threadvars_8h.html" title="threadvars.h" alt="" coords="1042,603,1136,629"/><area shape="rect" id="node28" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="1366,229,1460,256"/><area shape="rect" id="node29" href="runmodes_8h.html" title="runmodes.h" alt="" coords="2109,80,2200,107"/><area shape="rect" id="node30" href="util-random_8h.html" title="util&#45;random.h" alt="" coords="2225,80,2321,107"/><area shape="rect" id="node31" href="util-time_8h.html" title="util&#45;time.h" alt="" coords="2346,80,2424,107"/><area shape="rect" id="node19" href="flow_8h.html" title="flow.h" alt="" coords="1457,453,1513,480"/><area shape="rect" id="node32" href="flow-queue_8h.html" title="flow&#45;queue.h" alt="" coords="1200,155,1296,181"/><area shape="rect" id="node33" href="flow-hash_8h.html" title="flow&#45;hash.h" alt="" coords="1321,155,1409,181"/><area shape="rect" id="node34" href="flow-util_8h.html" title="flow&#45;util.h" alt="" coords="2501,80,2579,107"/><area shape="rect" id="node36" href="flow-var_8h.html" title="flow&#45;var.h" alt="" coords="1725,379,1803,405"/><area shape="rect" id="node37" href="flow-private_8h.html" title="flow&#45;private.h" alt="" coords="1259,80,1359,107"/><area shape="rect" id="node38" href="flow-timeout_8h.html" title="flow&#45;timeout.h" alt="" coords="2755,80,2859,107"/><area shape="rect" id="node39" href="flow-manager_8h.html" title="flow&#45;manager.h" alt="" coords="2883,80,2993,107"/><area shape="rect" id="node40" href="flow-storage_8h.html" title="flow&#45;storage.h" alt="" coords="1477,379,1581,405"/><area shape="rect" id="node41" href="stream-tcp-private_8h.html" title="stream&#45;tcp&#45;private.h" alt="" coords="1796,229,1935,256"/><area shape="rect" id="node42" href="stream-tcp-reassemble_8h.html" title="stream&#45;tcp&#45;reassemble.h" alt="" coords="1790,155,1956,181"/><area shape="rect" id="node44" href="stream-tcp_8h.html" title="stream&#45;tcp.h" alt="" coords="1705,80,1799,107"/><area shape="rect" id="node45" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="3018,80,3115,107"/><area shape="rect" id="node46" href="util-unittest-helper_8h.html" title="util&#45;unittest&#45;helper.h" alt="" coords="3140,80,3276,107"/><area shape="rect" id="node47" href="util-byte_8h.html" title="util&#45;byte.h" alt="" coords="3301,80,3379,107"/><area shape="rect" id="node48" href="util-misc_8h.html" title="util&#45;misc.h" alt="" coords="744,453,827,480"/><area shape="rect" id="node7" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="279,453,368,480"/><area shape="rect" id="node49" href="util-privs_8h.html" title="util&#45;privs.h" alt="" coords="3404,80,3487,107"/><area shape="rect" id="node18" href="detect_8h.html" title="detect.h" alt="" coords="999,379,1068,405"/><area shape="rect" id="node35" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine. " alt="" coords="2468,155,2612,181"/><area shape="rect" id="node43" href="stream_8h.html" title="stream.h" alt="" coords="1649,229,1721,256"/><area shape="rect" id="node50" href="app-layer-parser_8h.html" title="app&#45;layer&#45;parser.h" alt="" coords="2603,80,2729,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="745,304,817,331"/><area shape="rect" id="node5" href="threads_8h.html" title="threads.h" alt="" coords="627,677,703,704"/><area shape="rect" id="node6" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="1261,304,1411,331"/><area shape="rect" id="node8" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="705,528,785,555"/><area shape="rect" id="node9" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="380,304,463,331"/><area shape="rect" id="node10" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="945,304,1084,331"/><area shape="rect" id="node20" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="863,528,965,555"/><area shape="rect" id="node22" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="487,304,565,331"/><area shape="rect" id="node23" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="590,304,668,331"/><area shape="rect" id="node13" href="decode-events_8h.html" title="decode&#45;events.h" alt="" coords="1279,603,1397,629"/><area shape="rect" id="node14" href="source-nflog_8h.html" title="source&#45;nflog.h" alt="" coords="1423,603,1527,629"/><area shape="rect" id="node15" href="source-nfq_8h.html" title="source&#45;nfq.h" alt="" coords="1161,603,1255,629"/><area shape="rect" id="node16" href="source-ipfw_8h.html" title="source&#45;ipfw.h" alt="" coords="1551,603,1651,629"/><area shape="rect" id="node17" href="source-pcap_8h.html" title="source&#45;pcap.h" alt="" coords="1676,603,1780,629"/><area shape="rect" id="node21" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="1013,453,1123,480"/><area shape="rect" id="node25" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="5,379,101,405"/></map>
</div>
</div>
<p><a href="flow_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a3232d5ee2fdb2b5ffd2be3bdbbf4f18b">FLOW_DEFAULT_EMERGENCY_RECOVERY</a>&#160;&#160;&#160;30</td></tr>
<tr class="separator:a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896f8fb0988876b52fba26b36f46e61a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a896f8fb0988876b52fba26b36f46e61a">FLOW_DEFAULT_HASHSIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="separator:a896f8fb0988876b52fba26b36f46e61a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0527582503a0d59bcfc0c3392d336e9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a0527582503a0d59bcfc0c3392d336e9e">FLOW_DEFAULT_MEMCAP</a>&#160;&#160;&#160;(32 * 1024 * 1024) /* 32 MB */</td></tr>
<tr class="separator:a0527582503a0d59bcfc0c3392d336e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af279bea0e0bad43d54b60bbf8743942c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#af279bea0e0bad43d54b60bbf8743942c">FLOW_DEFAULT_PREALLOC</a>&#160;&#160;&#160;10000</td></tr>
<tr class="separator:af279bea0e0bad43d54b60bbf8743942c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a042231529464e85eb0482c00c0cd114f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a042231529464e85eb0482c00c0cd114f">SC_ATOMIC_DECLARE</a> (unsigned int, flow_prune_idx)</td></tr>
<tr class="separator:a042231529464e85eb0482c00c0cd114f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a3c29e500a18c716b94d6975c58009"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a00a3c29e500a18c716b94d6975c58009">SC_ATOMIC_DECLARE</a> (unsigned int, flow_flags)</td></tr>
<tr class="separator:a00a3c29e500a18c716b94d6975c58009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a4fa1db77ebc6f5bd811ccf151f1c8218">FlowRegisterTests</a> (void)</td></tr>
<tr class="memdesc:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to register the Flow Unitests.  <a href="#a4fa1db77ebc6f5bd811ccf151f1c8218">More...</a><br/></td></tr>
<tr class="separator:a4fa1db77ebc6f5bd811ccf151f1c8218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871212f9b59e814e9b4763644459247b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a871212f9b59e814e9b4763644459247b">FlowInitFlowProto</a> (void)</td></tr>
<tr class="memdesc:a871212f9b59e814e9b4763644459247b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the default timeout, free function and flow state function for all supported flow_proto.  <a href="#a871212f9b59e814e9b4763644459247b">More...</a><br/></td></tr>
<tr class="separator:a871212f9b59e814e9b4763644459247b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3fa579bec395b4b6a1e501c7556fd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a3f3fa579bec395b4b6a1e501c7556fd5">FlowSetProtoTimeout</a> (uint8_t <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>, uint32_t new_timeout, uint32_t est_timeout, uint32_t closed_timeout)</td></tr>
<tr class="memdesc:a3f3fa579bec395b4b6a1e501c7556fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the timeout values for the specified protocol.  <a href="#a3f3fa579bec395b4b6a1e501c7556fd5">More...</a><br/></td></tr>
<tr class="separator:a3f3fa579bec395b4b6a1e501c7556fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff70557f7674db3b37717d755491a99"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a1ff70557f7674db3b37717d755491a99">FlowSetProtoEmergencyTimeout</a> (uint8_t <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>, uint32_t emerg_new_timeout, uint32_t emerg_est_timeout, uint32_t emerg_closed_timeout)</td></tr>
<tr class="memdesc:a1ff70557f7674db3b37717d755491a99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the emergency timeout values for the specified protocol.  <a href="#a1ff70557f7674db3b37717d755491a99">More...</a><br/></td></tr>
<tr class="separator:a1ff70557f7674db3b37717d755491a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05174d1570db7ee4b5a25f5ea7234e87"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a05174d1570db7ee4b5a25f5ea7234e87">FlowSetProtoFreeFunc</a> (uint8_t <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>, void(*Free)(void *))</td></tr>
<tr class="memdesc:a05174d1570db7ee4b5a25f5ea7234e87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the function to get protocol specific flow state.  <a href="#a05174d1570db7ee4b5a25f5ea7234e87">More...</a><br/></td></tr>
<tr class="separator:a05174d1570db7ee4b5a25f5ea7234e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac544802aadaf9306d54a61942d3e597d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d">FlowCleanupAppLayer</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="separator:ac544802aadaf9306d54a61942d3e597d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2af32f22fdfd78a6fef1a70ee995d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a0a2af32f22fdfd78a6fef1a70ee995d8">FlowUpdateSpareFlows</a> (void)</td></tr>
<tr class="memdesc:a0a2af32f22fdfd78a6fef1a70ee995d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure we have enough spare flows.  <a href="#a0a2af32f22fdfd78a6fef1a70ee995d8">More...</a><br/></td></tr>
<tr class="separator:a0a2af32f22fdfd78a6fef1a70ee995d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31dc69acbfa8279be8ddec1106ee5713"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a31dc69acbfa8279be8ddec1106ee5713">FlowSetIPOnlyFlag</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, char direction)</td></tr>
<tr class="memdesc:a31dc69acbfa8279be8ddec1106ee5713"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the IPOnly scanned flag for 'direction'. This function handles the locking too.  <a href="#a31dc69acbfa8279be8ddec1106ee5713">More...</a><br/></td></tr>
<tr class="separator:a31dc69acbfa8279be8ddec1106ee5713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1812b3481c7bb32873ae4402ba6c3769"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a1812b3481c7bb32873ae4402ba6c3769">FlowSetIPOnlyFlagNoLock</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, char direction)</td></tr>
<tr class="memdesc:a1812b3481c7bb32873ae4402ba6c3769"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the IPOnly scanned flag for 'direction'.  <a href="#a1812b3481c7bb32873ae4402ba6c3769">More...</a><br/></td></tr>
<tr class="separator:a1812b3481c7bb32873ae4402ba6c3769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122">FlowGetPacketDirection</a> (const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine the direction of the packet compared to the flow  <a href="#a6f7e81aaf61a41cdaa7cbb87d8964122">More...</a><br/></td></tr>
<tr class="separator:a6f7e81aaf61a41cdaa7cbb87d8964122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc656c44694fa7460e7a5317c04fb47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#accc656c44694fa7460e7a5317c04fb47">FlowHandlePacketUpdateRemove</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:accc656c44694fa7460e7a5317c04fb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d88a8d5aee8f279280f3d7976a15a61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a3d88a8d5aee8f279280f3d7976a15a61">FlowHandlePacketUpdate</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a3d88a8d5aee8f279280f3d7976a15a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update Packet and Flow.  <a href="#a3d88a8d5aee8f279280f3d7976a15a61">More...</a><br/></td></tr>
<tr class="separator:a3d88a8d5aee8f279280f3d7976a15a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630858d075864b1b8693caf370fa8e00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a630858d075864b1b8693caf370fa8e00">FlowHandlePacket</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:a630858d075864b1b8693caf370fa8e00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point for packet flow handling.  <a href="#a630858d075864b1b8693caf370fa8e00">More...</a><br/></td></tr>
<tr class="separator:a630858d075864b1b8693caf370fa8e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada00bd8b6540d5be41c074c8489b132e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#ada00bd8b6540d5be41c074c8489b132e">FlowInitConfig</a> (char quiet)</td></tr>
<tr class="memdesc:ada00bd8b6540d5be41c074c8489b132e"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the configuration  <a href="#ada00bd8b6540d5be41c074c8489b132e">More...</a><br/></td></tr>
<tr class="separator:ada00bd8b6540d5be41c074c8489b132e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dae51c56800ed0e22279e49913cd15a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a8dae51c56800ed0e22279e49913cd15a">FlowShutdown</a> (void)</td></tr>
<tr class="memdesc:a8dae51c56800ed0e22279e49913cd15a"><td class="mdescLeft">&#160;</td><td class="mdescRight">shutdown the flow engine  <a href="#a8dae51c56800ed0e22279e49913cd15a">More...</a><br/></td></tr>
<tr class="separator:a8dae51c56800ed0e22279e49913cd15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e9eb43b74a70300e86da9c025705b1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a">FlowClearMemory</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, uint8_t proto_map)</td></tr>
<tr class="memdesc:a6e9eb43b74a70300e86da9c025705b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function clear the flow memory before queueing it to spare flow queue.  <a href="#a6e9eb43b74a70300e86da9c025705b1a">More...</a><br/></td></tr>
<tr class="separator:a6e9eb43b74a70300e86da9c025705b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1135a66e64bd8fe19166c853ea0e7986"><td class="memItemLeft" align="right" valign="top"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a1135a66e64bd8fe19166c853ea0e7986">FlowGetAppProtocol</a> (const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="separator:a1135a66e64bd8fe19166c853ea0e7986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb864b6392ad4eddbdf7092d4ec4e78e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#afb864b6392ad4eddbdf7092d4ec4e78e">FlowGetAppState</a> (const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f)</td></tr>
<tr class="separator:afb864b6392ad4eddbdf7092d4ec4e78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca700f93b37d88672923ffb56949d640"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#aca700f93b37d88672923ffb56949d640">FlowGetDisruptionFlags</a> (const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *f, uint8_t <a class="el" href="source-erf-file_8c.html#a01ff0636d6a8eaabc8be0085e5bc047a">flags</a>)</td></tr>
<tr class="memdesc:aca700f93b37d88672923ffb56949d640"><td class="mdescLeft">&#160;</td><td class="mdescRight">get 'disruption' flags: GAP/DEPTH/PASS  <a href="#aca700f93b37d88672923ffb56949d640">More...</a><br/></td></tr>
<tr class="separator:aca700f93b37d88672923ffb56949d640"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5fc33a1b111d68d2889fc1effbc254f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow_8c.html#a5fc33a1b111d68d2889fc1effbc254f1">run_mode</a></td></tr>
<tr class="separator:a5fc33a1b111d68d2889fc1effbc254f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a></dd></dl>
<p>Flow implementation. </p>

<p>Definition in file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a3232d5ee2fdb2b5ffd2be3bdbbf4f18b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_EMERGENCY_RECOVERY&#160;&#160;&#160;30</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00065">65</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a896f8fb0988876b52fba26b36f46e61a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_HASHSIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00068">68</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a0527582503a0d59bcfc0c3392d336e9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_MEMCAP&#160;&#160;&#160;(32 * 1024 * 1024) /* 32 MB */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00070">70</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="af279bea0e0bad43d54b60bbf8743942c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DEFAULT_PREALLOC&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00072">72</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac544802aadaf9306d54a61942d3e597d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowCleanupAppLayer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00094">94</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00384">Flow_::alparser</a>, <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>, <a class="el" href="flow_8h_source.html#l00385">Flow_::alstate</a>, <a class="el" href="app-layer-parser_8c_source.html#l01075">AppLayerParserStateCleanup()</a>, and <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00083">AppLayerHandleTCPData()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph.png" border="0" usemap="#flow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph" alt=""/></div>
<map name="flow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph" id="flow_8c_ac544802aadaf9306d54a61942d3e597d_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="208,37,403,64"/><area shape="rect" id="node3" href="app-layer-parser_8c.html#a2c0d7e33b5fd15d582813483991f4f24" title="AppLayerParserStateFree" alt="" coords="451,12,623,39"/><area shape="rect" id="node5" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="462,63,613,89"/><area shape="rect" id="node4" href="app-layer-events_8c.html#ab03fd63a3051f13200cfaacc7c94c930" title="AppLayerDecoderEventsFree\lEvents" alt="" coords="673,5,866,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ac544802aadaf9306d54a61942d3e597d_icgraph.png" border="0" usemap="#flow_8c_ac544802aadaf9306d54a61942d3e597d_icgraph" alt=""/></div>
<map name="flow_8c_ac544802aadaf9306d54a61942d3e597d_icgraph" id="flow_8c_ac544802aadaf9306d54a61942d3e597d_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="208,68,381,95"/><area shape="rect" id="node3" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="429,5,533,32"/><area shape="rect" id="node4" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="582,68,797,95"/><area shape="rect" id="node5" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="845,31,1045,73"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="1093,61,1293,102"/><area shape="rect" id="node7" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1342,68,1469,95"/><area shape="rect" id="node8" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1518,68,1605,95"/><area shape="rect" id="node9" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1654,68,1850,95"/><area shape="rect" id="node10" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1899,68,2034,95"/><area shape="rect" id="node11" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2083,68,2181,95"/><area shape="rect" id="node12" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2229,43,2379,69"/><area shape="rect" id="node13" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2427,68,2477,95"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e9eb43b74a70300e86da9c025705b1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowClearMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function clear the flow memory before queueing it to spare flow queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>pointer to the flow needed to be cleared. </td></tr>
    <tr><td class="paramname">proto_map</td><td>mapped value of the protocol to FLOW_PROTO's. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00783">783</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow-private_8h_source.html#l00076">flow_proto</a>, <a class="el" href="flow-util_8h_source.html#l00083">FLOW_RECYCLE</a>, <a class="el" href="flow-storage_8c_source.html#l00059">FlowFreeStorage()</a>, <a class="el" href="flow_8h_source.html#l00429">FlowProto_::Freefunc</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, and <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00488">FlowShutdown()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph.png" border="0" usemap="#flow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph" alt=""/></div>
<map name="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph" id="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_cgraph">
<area shape="rect" id="node2" href="flow-storage_8c.html#aa43aab9054b3dd6ca65eb1b37acfcf13" title="FlowFreeStorage" alt="" coords="182,31,303,57"/><area shape="rect" id="node3" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="353,5,474,32"/><area shape="rect" id="node5" href="util-storage_8c.html#a842a9a77b4fb19baf4b10fc9ed2bd3fb" title="StorageFreeAll" alt="" coords="359,56,467,83"/><area shape="rect" id="node4" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="523,5,637,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph.png" border="0" usemap="#flow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph" alt=""/></div>
<map name="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph" id="flow_8c_a6e9eb43b74a70300e86da9c025705b1a_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#a8dae51c56800ed0e22279e49913cd15a" title="shutdown the flow engine " alt="" coords="182,5,290,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="339,5,389,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1135a66e64bd8fe19166c853ea0e7986"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> FlowGetAppProtocol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00863">863</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00364">Flow_::alproto</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01954">Detect()</a>, and <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph.png" border="0" usemap="#flow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph" alt=""/></div>
<map name="flow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph" id="flow_8c_a1135a66e64bd8fe19166c853ea0e7986_icgraph">
<area shape="rect" id="node2" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="384,31,445,57"/><area shape="rect" id="node8" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="197,56,336,83"/><area shape="rect" id="node3" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="493,31,664,57"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="713,31,847,57"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="896,31,995,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1043,5,1192,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1240,31,1291,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afb864b6392ad4eddbdf7092d4ec4e78e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* FlowGetAppState </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow_8c_source.html#l00868">868</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00385">Flow_::alstate</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-state_8c_source.html#l00979">DeStateDetectContinueDetection()</a>, <a class="el" href="detect-engine-state_8c_source.html#l00476">DeStateDetectStartDetection()</a>, <a class="el" href="detect-engine-state_8c_source.html#l01135">DetectEngineStateResetTxs()</a>, <a class="el" href="app-layer-htp-xff_8c_source.html#l00177">HttpXFFGetIP()</a>, <a class="el" href="app-layer-htp-xff_8c_source.html#l00113">HttpXFFGetIPFromTx()</a>, and <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_afb864b6392ad4eddbdf7092d4ec4e78e_icgraph.png" border="0" usemap="#flow_8c_afb864b6392ad4eddbdf7092d4ec4e78e_icgraph" alt=""/></div>
<map name="flow_8c_afb864b6392ad4eddbdf7092d4ec4e78e_icgraph" id="flow_8c_afb864b6392ad4eddbdf7092d4ec4e78e_icgraph">
<area shape="rect" id="node2" href="group__sigstate.html#gaaea2ddcec2d9f3549aea0de468834039" title="Continue DeState detection of the signatures stored in the state. " alt="" coords="179,5,397,32"/><area shape="rect" id="node10" href="group__sigstate.html#ga4cd5aba6758fd5795f477973b5f2fdfb" title="Match app layer sig list against app state and store relevant match information. " alt="" coords="191,56,385,83"/><area shape="rect" id="node11" href="group__sigstate.html#gabf15c37dbdf92918d6f107087ff082fb" title="Reset de state for active tx&#39; To be used on detect engine reload. " alt="" coords="193,107,383,133"/><area shape="rect" id="node12" href="app-layer-htp-xff_8h.html#a019a88513f614a8dbe24247d9b0a2c4d" title="Function to return XFF IP if any. The caller needs to lock the flow. " alt="" coords="461,233,568,260"/><area shape="rect" id="node13" href="app-layer-htp-xff_8h.html#af49719780cb74ccfcef61ef5dc51d26d" title="Function to return XFF IP if any in the selected transaction. The caller needs to lock the flow..." alt="" coords="213,259,363,285"/><area shape="rect" id="node3" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="445,81,584,108"/><area shape="rect" id="node4" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="632,81,693,108"/><area shape="rect" id="node5" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="741,81,912,108"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="961,81,1095,108"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1144,81,1243,108"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1291,56,1440,83"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1488,81,1539,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca700f93b37d88672923ffb56949d640"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t FlowGetDisruptionFlags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get 'disruption' flags: GAP/DEPTH/PASS </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
    <tr><td class="paramname">flags</td><td>existing flags to be ammended </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">flags</td><td>original flags + disrupt flags (if any)  handle UDP </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00880">880</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="stream-tcp-private_8h_source.html#l00226">TcpSession_::client</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">flags</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00065">TcpStream_::flags</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="flow_8h_source.html#l00355">Flow_::protoctx</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00225">TcpSession_::server</a>, <a class="el" href="stream_8h_source.html#l00034">STREAM_DEPTH</a>, <a class="el" href="stream_8h_source.html#l00033">STREAM_GAP</a>, <a class="el" href="stream_8h_source.html#l00031">STREAM_TOSERVER</a>, <a class="el" href="stream-tcp-private_8h_source.html#l00159">STREAMTCP_STREAM_FLAG_DEPTH_REACHED</a>, and <a class="el" href="stream-tcp-private_8h_source.html#l00153">STREAMTCP_STREAM_FLAG_GAP</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01954">Detect()</a>, <a class="el" href="output-streaming_8c_source.html#l00143">HttpBodyIterator()</a>, and <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_aca700f93b37d88672923ffb56949d640_icgraph.png" border="0" usemap="#flow_8c_aca700f93b37d88672923ffb56949d640_icgraph" alt=""/></div>
<map name="flow_8c_aca700f93b37d88672923ffb56949d640_icgraph" id="flow_8c_aca700f93b37d88672923ffb56949d640_icgraph">
<area shape="rect" id="node2" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="403,31,464,57"/><area shape="rect" id="node8" href="output-streaming_8c.html#a9970962efe18bf5ae597f70a19c3ad85" title="Http Body Iterator for logging. " alt="" coords="226,31,345,57"/><area shape="rect" id="node9" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="216,81,355,108"/><area shape="rect" id="node3" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="512,31,683,57"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="731,31,866,57"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="915,31,1013,57"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1061,5,1211,32"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1259,31,1309,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6f7e81aaf61a41cdaa7cbb87d8964122"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowGetPacketDirection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine the direction of the packet compared to the flow </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>to_server </td></tr>
    <tr><td class="paramname">1</td><td>to_client </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00181">181</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00228">CMP_ADDR</a>, <a class="el" href="decode_8h_source.html#l00233">CMP_PORT</a>, <a class="el" href="decode_8h_source.html#l00382">Packet_::dp</a>, <a class="el" href="decode_8h_source.html#l00385">Packet_::proto</a>, <a class="el" href="flow_8h_source.html#l00306">Flow_::sp</a>, <a class="el" href="decode_8h_source.html#l00378">Packet_::sp</a>, <a class="el" href="flow_8h_source.html#l00304">Flow_::src</a>, <a class="el" href="decode_8h_source.html#l00375">Packet_::src</a>, <a class="el" href="flow_8h_source.html#l00041">TOCLIENT</a>, and <a class="el" href="flow_8h_source.html#l00040">TOSERVER</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00269">FlowHandlePacketUpdate()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph.png" border="0" usemap="#flow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph" alt=""/></div>
<map name="flow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph" id="flow_8c_a6f7e81aaf61a41cdaa7cbb87d8964122_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#a3d88a8d5aee8f279280f3d7976a15a61" title="Update Packet and Flow. " alt="" coords="219,1204,394,1231"/><area shape="rect" id="node3" href="flow_8h.html#ae727a896e38d8ebdce4b7b050d08c178" title="Entry point for packet flow handling. " alt="" coords="443,1204,575,1231"/><area shape="rect" id="node4" href="decode_8h.html#a03b94d79586f4abbd8b762f75de608c8" title="Main ICMPv4 decoding function. " alt="" coords="624,1153,741,1180"/><area shape="rect" id="node44" href="decode_8h.html#af09d0f9b3af3be970dbe770c79e66cce" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="789,1660,907,1687"/><area shape="rect" id="node45" href="decode_8h.html#a04bd1d44001e393003da2420291028e1" title="DecodeSCTP" alt="" coords="631,1255,734,1281"/><area shape="rect" id="node46" href="decode_8h.html#a1683201a43f216e90e02810223202957" title="DecodeTCP" alt="" coords="635,1204,730,1231"/><area shape="rect" id="node22" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="2056,420,2152,447"/><area shape="rect" id="node5" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="800,1153,896,1180"/><area shape="rect" id="node6" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="955,775,1071,801"/><area shape="rect" id="node24" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="2485,1508,2587,1535"/><area shape="rect" id="node26" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2485,1036,2587,1063"/><area shape="rect" id="node27" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="2489,1660,2583,1687"/><area shape="rect" id="node29" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="2721,1457,2812,1484"/><area shape="rect" id="node34" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="2719,673,2814,700"/><area shape="rect" id="node35" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="2456,980,2616,1007"/><area shape="rect" id="node38" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="2975,927,3070,953"/><area shape="rect" id="node37" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="2981,876,3064,903"/><area shape="rect" id="node18" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1299,623,1405,649"/><area shape="rect" id="node36" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="2715,953,2818,980"/><area shape="rect" id="node7" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="3219,643,3312,669"/><area shape="rect" id="node13" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1298,319,1406,345"/><area shape="rect" id="node15" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1518,369,1623,396"/><area shape="rect" id="node17" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1120,623,1243,649"/><area shape="rect" id="node30" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="3217,769,3314,796"/><area shape="rect" id="node40" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1131,471,1232,497"/><area shape="rect" id="node42" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1291,724,1413,751"/><area shape="rect" id="node32" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="3176,857,3355,884"/><area shape="rect" id="node8" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="3417,643,3620,669"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="3683,643,3818,669"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="3867,643,3965,669"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="4013,617,4163,644"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="4211,643,4261,669"/><area shape="rect" id="node14" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1461,167,1680,193"/><area shape="rect" id="node16" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1997,369,2211,396"/><area shape="rect" id="node19" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="1493,319,1649,345"/><area shape="rect" id="node20" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1785,268,1881,295"/><area shape="rect" id="node21" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1780,319,1887,345"/><area shape="rect" id="node23" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="2291,1305,2387,1332"/><area shape="rect" id="node39" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="2270,420,2407,447"/><area shape="rect" id="node25" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2917,1288,3128,1315"/><area shape="rect" id="node28" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="2664,1609,2869,1636"/><area shape="rect" id="node31" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="3415,731,3622,757"/><area shape="rect" id="node33" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="3403,848,3634,875"/><area shape="rect" id="node41" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1728,471,1939,497"/><area shape="rect" id="node43" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1987,673,2221,700"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a630858d075864b1b8693caf370fa8e00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowHandlePacket </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point for packet flow handling. </p>
<p>This is called for every packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>threadvars </td></tr>
    <tr><td class="paramname">dtv</td><td>decode thread vars (for flow output api thread data) </td></tr>
    <tr><td class="paramname">p</td><td>packet to handle flow for </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00327">327</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="flow-hash_8c_source.html#l00653">FlowGetFlowFromHash()</a>, <a class="el" href="flow_8c_source.html#l00269">FlowHandlePacketUpdate()</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, and <a class="el" href="decode_8h_source.html#l01025">PKT_HAS_FLOW</a>.</p>

<p>Referenced by <a class="el" href="decode-icmpv4_8c_source.html#l00154">DecodeICMPV4()</a>, <a class="el" href="decode-icmpv6_8c_source.html#l00167">DecodeICMPV6()</a>, <a class="el" href="decode-sctp_8c_source.html#l00062">DecodeSCTP()</a>, <a class="el" href="decode-tcp_8c_source.html#l00187">DecodeTCP()</a>, and <a class="el" href="decode-udp_8c_source.html#l00073">DecodeUDP()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a630858d075864b1b8693caf370fa8e00_cgraph.png" border="0" usemap="#flow_8c_a630858d075864b1b8693caf370fa8e00_cgraph" alt=""/></div>
<map name="flow_8c_a630858d075864b1b8693caf370fa8e00_cgraph" id="flow_8c_a630858d075864b1b8693caf370fa8e00_cgraph">
<area shape="rect" id="node2" href="flow-hash_8c.html#ab9b72607bceec0064346afce2f6cbdd1" title="Get Flow for packet. " alt="" coords="195,5,355,32"/><area shape="rect" id="node5" href="flow_8c.html#a3d88a8d5aee8f279280f3d7976a15a61" title="Update Packet and Flow. " alt="" coords="187,56,362,83"/><area shape="rect" id="node3" href="flow-util_8c.html#ab860700383c3811a4aaf74b2cfd1de05" title="FlowInit" alt="" coords="459,5,527,32"/><area shape="rect" id="node4" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="625,5,775,32"/><area shape="rect" id="node6" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow " alt="" coords="411,56,575,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a630858d075864b1b8693caf370fa8e00_icgraph.png" border="0" usemap="#flow_8c_a630858d075864b1b8693caf370fa8e00_icgraph" alt=""/></div>
<map name="flow_8c_a630858d075864b1b8693caf370fa8e00_icgraph" id="flow_8c_a630858d075864b1b8693caf370fa8e00_icgraph">
<area shape="rect" id="node2" href="decode_8h.html#a03b94d79586f4abbd8b762f75de608c8" title="Main ICMPv4 decoding function. " alt="" coords="187,1153,304,1180"/><area shape="rect" id="node42" href="decode_8h.html#af09d0f9b3af3be970dbe770c79e66cce" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="352,1660,469,1687"/><area shape="rect" id="node43" href="decode_8h.html#a04bd1d44001e393003da2420291028e1" title="DecodeSCTP" alt="" coords="194,1255,297,1281"/><area shape="rect" id="node44" href="decode_8h.html#a1683201a43f216e90e02810223202957" title="DecodeTCP" alt="" coords="198,1204,293,1231"/><area shape="rect" id="node20" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="1619,420,1715,447"/><area shape="rect" id="node3" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="363,1153,459,1180"/><area shape="rect" id="node4" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="518,775,634,801"/><area shape="rect" id="node22" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="2048,1508,2149,1535"/><area shape="rect" id="node24" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2047,1036,2150,1063"/><area shape="rect" id="node25" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="2051,1660,2146,1687"/><area shape="rect" id="node27" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="2284,1457,2375,1484"/><area shape="rect" id="node32" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="2282,673,2377,700"/><area shape="rect" id="node33" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="2019,980,2179,1007"/><area shape="rect" id="node36" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="2538,927,2633,953"/><area shape="rect" id="node35" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="2544,876,2627,903"/><area shape="rect" id="node16" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="861,623,968,649"/><area shape="rect" id="node34" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="2278,953,2381,980"/><area shape="rect" id="node5" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="2781,643,2875,669"/><area shape="rect" id="node11" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="861,319,969,345"/><area shape="rect" id="node13" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1081,369,1186,396"/><area shape="rect" id="node15" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="683,623,805,649"/><area shape="rect" id="node28" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="2779,769,2877,796"/><area shape="rect" id="node38" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="693,471,795,497"/><area shape="rect" id="node40" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="853,724,976,751"/><area shape="rect" id="node30" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="2739,857,2917,884"/><area shape="rect" id="node6" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="2980,643,3183,669"/><area shape="rect" id="node7" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="3246,643,3381,669"/><area shape="rect" id="node8" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="3429,643,3528,669"/><area shape="rect" id="node9" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="3576,617,3725,644"/><area shape="rect" id="node10" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="3773,643,3824,669"/><area shape="rect" id="node12" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1024,167,1243,193"/><area shape="rect" id="node14" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1559,369,1774,396"/><area shape="rect" id="node17" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="1055,319,1211,345"/><area shape="rect" id="node18" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1348,268,1444,295"/><area shape="rect" id="node19" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1343,319,1449,345"/><area shape="rect" id="node21" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="1853,1305,1949,1332"/><area shape="rect" id="node37" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="1833,420,1970,447"/><area shape="rect" id="node23" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2480,1288,2691,1315"/><area shape="rect" id="node26" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="2227,1609,2432,1636"/><area shape="rect" id="node29" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="2978,731,3185,757"/><area shape="rect" id="node31" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2966,848,3197,875"/><area shape="rect" id="node39" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1291,471,1501,497"/><area shape="rect" id="node41" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1550,673,1783,700"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3d88a8d5aee8f279280f3d7976a15a61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowHandlePacketUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update Packet and Flow. </p>
<p>Updates packet and flow based on the new packet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>locked flow </td></tr>
    <tr><td class="paramname">p</td><td>packet</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>overwrites p::flowflags </dd></dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00269">269</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00925">DecodeSetNoPacketInspectionFlag</a>, <a class="el" href="decode_8h_source.html#l00913">DecodeSetNoPayloadInspectionFlag</a>, <a class="el" href="flow_8h_source.html#l00339">Flow_::flags</a>, <a class="el" href="decode_8h_source.html#l00400">Packet_::flow</a>, <a class="el" href="flow_8h_source.html#l00061">FLOW_NOPACKET_INSPECTION</a>, <a class="el" href="flow_8h_source.html#l00063">FLOW_NOPAYLOAD_INSPECTION</a>, <a class="el" href="flow_8h_source.html#l00172">FLOW_PKT_ESTABLISHED</a>, <a class="el" href="flow_8h_source.html#l00171">FLOW_PKT_TOCLIENT</a>, <a class="el" href="flow_8h_source.html#l00176">FLOW_PKT_TOCLIENT_FIRST</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00175">FLOW_PKT_TOSERVER_FIRST</a>, <a class="el" href="flow_8h_source.html#l00418">FLOW_STATE_ESTABLISHED</a>, <a class="el" href="flow_8h_source.html#l00048">FLOW_TO_DST_SEEN</a>, <a class="el" href="flow_8h_source.html#l00046">FLOW_TO_SRC_SEEN</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="flow_8c_source.html#l00181">FlowGetPacketDirection()</a>, <a class="el" href="decode_8h_source.html#l00213">GET_PKT_LEN</a>, <a class="el" href="decode_8h_source.html#l00505">Packet_::pcap_cnt</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="util-atomic_8h_source.html#l00208">SC_ATOMIC_SET</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="flow_8h_source.html#l00412">Flow_::todstbytecnt</a>, <a class="el" href="flow_8h_source.html#l00410">Flow_::todstpktcnt</a>, <a class="el" href="flow_8h_source.html#l00040">TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00413">Flow_::tosrcbytecnt</a>, and <a class="el" href="flow_8h_source.html#l00411">Flow_::tosrcpktcnt</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00327">FlowHandlePacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_cgraph.png" border="0" usemap="#flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_cgraph" alt=""/></div>
<map name="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_cgraph" id="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_cgraph">
<area shape="rect" id="node2" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow " alt="" coords="230,5,394,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_icgraph.png" border="0" usemap="#flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_icgraph" alt=""/></div>
<map name="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_icgraph" id="flow_8c_a3d88a8d5aee8f279280f3d7976a15a61_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#ae727a896e38d8ebdce4b7b050d08c178" title="Entry point for packet flow handling. " alt="" coords="230,1204,362,1231"/><area shape="rect" id="node3" href="decode_8h.html#a03b94d79586f4abbd8b762f75de608c8" title="Main ICMPv4 decoding function. " alt="" coords="411,1153,528,1180"/><area shape="rect" id="node43" href="decode_8h.html#af09d0f9b3af3be970dbe770c79e66cce" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="576,1660,693,1687"/><area shape="rect" id="node44" href="decode_8h.html#a04bd1d44001e393003da2420291028e1" title="DecodeSCTP" alt="" coords="418,1255,521,1281"/><area shape="rect" id="node45" href="decode_8h.html#a1683201a43f216e90e02810223202957" title="DecodeTCP" alt="" coords="422,1204,517,1231"/><area shape="rect" id="node21" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="1843,420,1939,447"/><area shape="rect" id="node4" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="587,1153,683,1180"/><area shape="rect" id="node5" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="742,775,858,801"/><area shape="rect" id="node23" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="2272,1508,2373,1535"/><area shape="rect" id="node25" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2271,1036,2374,1063"/><area shape="rect" id="node26" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="2275,1660,2370,1687"/><area shape="rect" id="node28" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="2508,1457,2599,1484"/><area shape="rect" id="node33" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="2506,673,2601,700"/><area shape="rect" id="node34" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="2243,980,2403,1007"/><area shape="rect" id="node37" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="2762,927,2857,953"/><area shape="rect" id="node36" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="2768,876,2851,903"/><area shape="rect" id="node17" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1085,623,1192,649"/><area shape="rect" id="node35" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="2502,953,2605,980"/><area shape="rect" id="node6" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="3005,643,3099,669"/><area shape="rect" id="node12" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1085,319,1193,345"/><area shape="rect" id="node14" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1305,369,1410,396"/><area shape="rect" id="node16" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="907,623,1029,649"/><area shape="rect" id="node29" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="3003,769,3101,796"/><area shape="rect" id="node39" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="917,471,1019,497"/><area shape="rect" id="node41" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1077,724,1200,751"/><area shape="rect" id="node31" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="2963,857,3141,884"/><area shape="rect" id="node7" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="3204,643,3407,669"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="3470,643,3605,669"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="3653,643,3752,669"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="3800,617,3949,644"/><area shape="rect" id="node11" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="3997,643,4048,669"/><area shape="rect" id="node13" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1248,167,1467,193"/><area shape="rect" id="node15" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1783,369,1998,396"/><area shape="rect" id="node18" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="1279,319,1435,345"/><area shape="rect" id="node19" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1572,268,1668,295"/><area shape="rect" id="node20" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1567,319,1673,345"/><area shape="rect" id="node22" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="2077,1305,2173,1332"/><area shape="rect" id="node38" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="2057,420,2194,447"/><area shape="rect" id="node24" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2704,1288,2915,1315"/><area shape="rect" id="node27" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="2451,1609,2656,1636"/><area shape="rect" id="node30" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="3202,731,3409,757"/><area shape="rect" id="node32" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="3190,848,3421,875"/><area shape="rect" id="node40" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1515,471,1725,497"/><area shape="rect" id="node42" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1774,673,2007,700"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="accc656c44694fa7460e7a5317c04fb47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowHandlePacketUpdateRemove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove packet from flow. This assumes this happens <em>before</em> the packet is added to the stream engine and other higher state.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000083">Todo:</a></b></dt><dd>we can't restore the lastts </dd></dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00236">236</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00928">DecodeUnsetNoPacketInspectionFlag</a>, <a class="el" href="decode_8h_source.html#l00917">DecodeUnsetNoPayloadInspectionFlag</a>, <a class="el" href="flow_8h_source.html#l00339">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00061">FLOW_NOPACKET_INSPECTION</a>, <a class="el" href="flow_8h_source.html#l00063">FLOW_NOPAYLOAD_INSPECTION</a>, <a class="el" href="flow_8h_source.html#l00172">FLOW_PKT_ESTABLISHED</a>, <a class="el" href="flow_8h_source.html#l00171">FLOW_PKT_TOCLIENT</a>, <a class="el" href="flow_8h_source.html#l00176">FLOW_PKT_TOCLIENT_FIRST</a>, <a class="el" href="flow_8h_source.html#l00170">FLOW_PKT_TOSERVER</a>, <a class="el" href="flow_8h_source.html#l00175">FLOW_PKT_TOSERVER_FIRST</a>, <a class="el" href="decode_8h_source.html#l00394">Packet_::flowflags</a>, <a class="el" href="decode_8h_source.html#l00213">GET_PKT_LEN</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="flow_8h_source.html#l00412">Flow_::todstbytecnt</a>, <a class="el" href="flow_8h_source.html#l00410">Flow_::todstpktcnt</a>, <a class="el" href="flow_8h_source.html#l00413">Flow_::tosrcbytecnt</a>, and <a class="el" href="flow_8h_source.html#l00411">Flow_::tosrcpktcnt</a>.</p>

</div>
</div>
<a class="anchor" id="ada00bd8b6540d5be41c074c8489b132e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowInitConfig </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>quiet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the configuration </p>
<dl class="section warning"><dt>Warning</dt><dd>Not thread safe </dd></dl>
<p>set config values for memcap, prealloc and hash_size </p>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00347">347</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="util-byte_8c_source.html#l00196">ByteExtractStringUint32()</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00380">ConfGetInt()</a>, <a class="el" href="flow_8h_source.html#l00239">FlowCnf_::emergency_recovery</a>, <a class="el" href="suricata-common_8h_source.html#l00034">FALSE</a>, <a class="el" href="flow-hash_8h_source.html#l00060">FBLOCK_INIT</a>, <a class="el" href="flow-util_8h_source.html#l00142">FLOW_CHECK_MEMCAP</a>, <a class="el" href="flow-private_8h_source.html#l00085">flow_config</a>, <a class="el" href="flow_8c_source.html#l00065">FLOW_DEFAULT_EMERGENCY_RECOVERY</a>, <a class="el" href="flow_8c_source.html#l00068">FLOW_DEFAULT_HASHSIZE</a>, <a class="el" href="flow_8c_source.html#l00070">FLOW_DEFAULT_MEMCAP</a>, <a class="el" href="flow_8c_source.html#l00072">FLOW_DEFAULT_PREALLOC</a>, <a class="el" href="flow-private_8h_source.html#l00084">flow_hash</a>, <a class="el" href="flow-private_8h_source.html#l00082">flow_recycle_q</a>, <a class="el" href="flow-private_8h_source.html#l00079">flow_spare_q</a>, <a class="el" href="flow-util_8c_source.html#l00049">FlowAlloc()</a>, <a class="el" href="flow-queue_8c_source.html#l00072">FlowEnqueue()</a>, <a class="el" href="flow_8c_source.html#l00539">FlowInitFlowProto()</a>, <a class="el" href="flow-queue_8c_source.html#l00047">FlowQueueInit()</a>, <a class="el" href="flow-storage_8c_source.html#l00034">FlowStorageSize()</a>, <a class="el" href="flow_8h_source.html#l00228">FlowCnf_::hash_rand</a>, <a class="el" href="flow_8h_source.html#l00229">FlowCnf_::hash_size</a>, <a class="el" href="flow-queue_8h_source.html#l00045">FlowQueue_::len</a>, <a class="el" href="flow_8h_source.html#l00230">FlowCnf_::memcap</a>, <a class="el" href="util-misc_8c_source.html#l00190">ParseSizeStringU64()</a>, <a class="el" href="flow_8h_source.html#l00232">FlowCnf_::prealloc</a>, <a class="el" href="util-random_8c_source.html#l00035">RandomTimePreseed()</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-error_8h_source.html#l00237">SC_ERR_FLOW_INIT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-error_8h_source.html#l00230">SC_ERR_SIZE_PARSE</a>, <a class="el" href="util-mem_8h_source.html#l00205">SCCalloc</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ada00bd8b6540d5be41c074c8489b132e_cgraph.png" border="0" usemap="#flow_8c_ada00bd8b6540d5be41c074c8489b132e_cgraph" alt=""/></div>
<map name="flow_8c_ada00bd8b6540d5be41c074c8489b132e_cgraph" id="flow_8c_ada00bd8b6540d5be41c074c8489b132e_cgraph">
<area shape="rect" id="node2" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="545,7,708,33"/><area shape="rect" id="node4" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="386,159,457,185"/><area shape="rect" id="node8" href="conf_8c.html#a0699665aae394f33c9fe33880891c1e7" title="Retrieve a configuration value as an integer. " alt="" coords="191,159,278,185"/><area shape="rect" id="node9" href="flow-util_8c.html#ae1ba1db44e3a77c4829397d5d659c432" title="allocate a flow " alt="" coords="195,260,274,287"/><area shape="rect" id="node12" href="flow-queue_8c.html#a9b5bc9b6bfa0e8e7b2663d4810f7c151" title="add a flow to a queue " alt="" coords="184,311,285,337"/><area shape="rect" id="node13" href="flow_8c.html#a871212f9b59e814e9b4763644459247b" title="Function to set the default timeout, free function and flow state function for all supported flow_pro..." alt="" coords="358,57,485,84"/><area shape="rect" id="node15" href="flow-queue_8c.html#a853a0108459a40b625e99f667dcdce0c" title="FlowQueueInit" alt="" coords="181,361,288,388"/><area shape="rect" id="node10" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="361,235,482,261"/><area shape="rect" id="node16" href="util-misc_8c.html#ad06f7f59424271edbb160b18ce10f70b" title="ParseSizeStringU64" alt="" coords="165,412,305,439"/><area shape="rect" id="node17" href="util-random_8c.html#a4b7c890f27dd0dbc69427497f47429d1" title="create a seed number to pass to rand() , rand_r(), and similars " alt="" coords="161,463,309,489"/><area shape="rect" id="node3" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="783,7,908,33"/><area shape="rect" id="node5" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="575,159,678,185"/><area shape="rect" id="node6" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="769,108,922,135"/><area shape="rect" id="node7" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="815,159,876,185"/><area shape="rect" id="node11" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="569,235,684,261"/><area shape="rect" id="node14" href="conf_8c.html#a4d5920eea97bb4713c41e3ffef423757" title="Lookup the value of a child configuration node by name. " alt="" coords="533,108,720,135"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_ada00bd8b6540d5be41c074c8489b132e_icgraph.png" border="0" usemap="#flow_8c_ada00bd8b6540d5be41c074c8489b132e_icgraph" alt=""/></div>
<map name="flow_8c_ada00bd8b6540d5be41c074c8489b132e_icgraph" id="flow_8c_ada00bd8b6540d5be41c074c8489b132e_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="160,5,211,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a871212f9b59e814e9b4763644459247b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowInitFlowProto </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the default timeout, free function and flow state function for all supported flow_proto. </p>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00539">539</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="util-byte_8c_source.html#l00196">ByteExtractStringUint32()</a>, <a class="el" href="flow_8h_source.html#l00425">FlowProto_::closed_timeout</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="conf_8c_source.html#l00721">ConfNodeLookupChild()</a>, <a class="el" href="conf_8c_source.html#l00745">ConfNodeLookupChildValue()</a>, <a class="el" href="flow_8h_source.html#l00428">FlowProto_::emerg_closed_timeout</a>, <a class="el" href="flow_8h_source.html#l00427">FlowProto_::emerg_est_timeout</a>, <a class="el" href="flow_8h_source.html#l00426">FlowProto_::emerg_new_timeout</a>, <a class="el" href="flow_8h_source.html#l00424">FlowProto_::est_timeout</a>, <a class="el" href="flow-private_8h_source.html#l00042">FLOW_DEFAULT_CLOSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00052">FLOW_DEFAULT_EMERG_CLOSED_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00051">FLOW_DEFAULT_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00050">FLOW_DEFAULT_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00041">FLOW_DEFAULT_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00040">FLOW_DEFAULT_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00058">FLOW_IPPROTO_ICMP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00057">FLOW_IPPROTO_ICMP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00048">FLOW_IPPROTO_ICMP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00047">FLOW_IPPROTO_ICMP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00054">FLOW_IPPROTO_TCP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00053">FLOW_IPPROTO_TCP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00044">FLOW_IPPROTO_TCP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00043">FLOW_IPPROTO_TCP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00056">FLOW_IPPROTO_UDP_EMERG_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00055">FLOW_IPPROTO_UDP_EMERG_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00046">FLOW_IPPROTO_UDP_EST_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00045">FLOW_IPPROTO_UDP_NEW_TIMEOUT</a>, <a class="el" href="flow-private_8h_source.html#l00076">flow_proto</a>, <a class="el" href="flow-private_8h_source.html#l00065">FLOW_PROTO_DEFAULT</a>, <a class="el" href="flow-private_8h_source.html#l00063">FLOW_PROTO_ICMP</a>, <a class="el" href="flow-private_8h_source.html#l00061">FLOW_PROTO_TCP</a>, <a class="el" href="flow-private_8h_source.html#l00062">FLOW_PROTO_UDP</a>, <a class="el" href="flow_8h_source.html#l00429">FlowProto_::Freefunc</a>, <a class="el" href="flow_8h_source.html#l00423">FlowProto_::new_timeout</a>, and <a class="el" href="decode-template_8h_source.html#l00053">proto</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a871212f9b59e814e9b4763644459247b_cgraph.png" border="0" usemap="#flow_8c_a871212f9b59e814e9b4763644459247b_cgraph" alt=""/></div>
<map name="flow_8c_a871212f9b59e814e9b4763644459247b_cgraph" id="flow_8c_a871212f9b59e814e9b4763644459247b_cgraph">
<area shape="rect" id="node2" href="util-byte_8c.html#aff93b9381b90e88415cb6f8c5daa8bca" title="ByteExtractStringUint32" alt="" coords="193,5,356,32"/><area shape="rect" id="node4" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="223,157,326,184"/><area shape="rect" id="node5" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="417,107,570,133"/><area shape="rect" id="node7" href="conf_8c.html#a4d5920eea97bb4713c41e3ffef423757" title="Lookup the value of a child configuration node by name. " alt="" coords="181,107,368,133"/><area shape="rect" id="node3" href="util-byte_8c.html#a43dab0146a4fbdf54e3c1dba707b0534" title="ByteExtractString" alt="" coords="431,5,556,32"/><area shape="rect" id="node6" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="463,157,524,184"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a871212f9b59e814e9b4763644459247b_icgraph.png" border="0" usemap="#flow_8c_a871212f9b59e814e9b4763644459247b_icgraph" alt=""/></div>
<map name="flow_8c_a871212f9b59e814e9b4763644459247b_icgraph" id="flow_8c_a871212f9b59e814e9b4763644459247b_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#a897689d742258e918e752f50cd93915e" title="initialize the configuration " alt="" coords="181,5,288,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="336,5,387,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4fa1db77ebc6f5bd811ccf151f1c8218"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to register the Flow Unitests. </p>

<p>Definition at line <a class="el" href="flow_8c_source.html#l01135">1135</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow-manager_8c_source.html#l01276">FlowMgrRegisterTests()</a>, and <a class="el" href="flow-storage_8c_source.html#l00289">RegisterFlowStorageTests()</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph.png" border="0" usemap="#flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph" alt=""/></div>
<map name="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph" id="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_cgraph">
<area shape="rect" id="node2" href="flow-manager_8c.html#affd360a45ef1f0fe240cd081632c9a8b" title="Function to register the Flow Unitests. " alt="" coords="199,5,353,32"/><area shape="rect" id="node3" href="flow-storage_8c.html#a1fa52a76c102f2b63b0aa346ac8a41db" title="RegisterFlowStorageTests" alt="" coords="187,56,365,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_icgraph.png" border="0" usemap="#flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_icgraph" alt=""/></div>
<map name="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_icgraph" id="flow_8c_a4fa1db77ebc6f5bd811ccf151f1c8218_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="187,31,285,57"/><area shape="rect" id="node3" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="333,5,483,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="531,31,581,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a31dc69acbfa8279be8ddec1106ee5713"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetIPOnlyFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the IPOnly scanned flag for 'direction'. This function handles the locking too. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Flow to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00155">155</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00339">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00058">FLOW_TOCLIENT_IPONLY_SET</a>, <a class="el" href="flow_8h_source.html#l00056">FLOW_TOSERVER_IPONLY_SET</a>, <a class="el" href="flow_8h_source.html#l00211">FLOWLOCK_UNLOCK</a>, and <a class="el" href="flow_8h_source.html#l00208">FLOWLOCK_WRLOCK</a>.</p>

<p>Referenced by <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a31dc69acbfa8279be8ddec1106ee5713_icgraph.png" border="0" usemap="#flow_8c_a31dc69acbfa8279be8ddec1106ee5713_icgraph" alt=""/></div>
<map name="flow_8c_a31dc69acbfa8279be8ddec1106ee5713_icgraph" id="flow_8c_a31dc69acbfa8279be8ddec1106ee5713_icgraph">
<area shape="rect" id="node2" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="189,31,328,57"/><area shape="rect" id="node3" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="376,31,437,57"/><area shape="rect" id="node4" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="485,31,656,57"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="705,31,839,57"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="888,31,987,57"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1035,5,1184,32"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1232,31,1283,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1812b3481c7bb32873ae4402ba6c3769"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowSetIPOnlyFlagNoLock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the IPOnly scanned flag for 'direction'. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Flow to set the flag in </td></tr>
    <tr><td class="paramname">direction</td><td>direction to set the flag in </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00169">169</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00339">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00058">FLOW_TOCLIENT_IPONLY_SET</a>, and <a class="el" href="flow_8h_source.html#l00056">FLOW_TOSERVER_IPONLY_SET</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-alert_8c_source.html#l00238">PacketAlertFinalize()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a1812b3481c7bb32873ae4402ba6c3769_icgraph.png" border="0" usemap="#flow_8c_a1812b3481c7bb32873ae4402ba6c3769_icgraph" alt=""/></div>
<map name="flow_8c_a1812b3481c7bb32873ae4402ba6c3769_icgraph" id="flow_8c_a1812b3481c7bb32873ae4402ba6c3769_icgraph">
<area shape="rect" id="node2" href="detect-engine-alert_8h.html#a88941691124f73025a433d1614f35619" title="Check the threshold of the sigs that match, set actions, break on pass action This function iterate t..." alt="" coords="235,31,370,57"/><area shape="rect" id="node3" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="419,31,557,57"/><area shape="rect" id="node4" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="605,31,667,57"/><area shape="rect" id="node5" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="715,31,885,57"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="934,31,1069,57"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1117,31,1216,57"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1264,5,1413,32"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1461,31,1512,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1ff70557f7674db3b37717d755491a99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowSetProtoEmergencyTimeout </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>emerg_new_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>emerg_est_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>emerg_closed_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the emergency timeout values for the specified protocol. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>protocol of which timeout value is needed to be set. </td></tr>
    <tr><td class="paramname">emerg_new_timeout</td><td>timeout value for the new flows. </td></tr>
    <tr><td class="paramname">emerg_est_timeout</td><td>timeout value for the established flows. </td></tr>
    <tr><td class="paramname">emerg_closed_timeout</td><td>timeout value for the closed flows. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00848">848</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00428">FlowProto_::emerg_closed_timeout</a>, <a class="el" href="flow_8h_source.html#l00427">FlowProto_::emerg_est_timeout</a>, <a class="el" href="flow_8h_source.html#l00426">FlowProto_::emerg_new_timeout</a>, <a class="el" href="flow-private_8h_source.html#l00076">flow_proto</a>, and <a class="el" href="flow-util_8c_source.html#l00092">FlowGetProtoMapping()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a1ff70557f7674db3b37717d755491a99_cgraph.png" border="0" usemap="#flow_8c_a1ff70557f7674db3b37717d755491a99_cgraph" alt=""/></div>
<map name="flow_8c_a1ff70557f7674db3b37717d755491a99_cgraph" id="flow_8c_a1ff70557f7674db3b37717d755491a99_cgraph">
<area shape="rect" id="node2" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="270,5,421,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a05174d1570db7ee4b5a25f5ea7234e87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowSetProtoFreeFunc </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>Free</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the function to get protocol specific flow state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>protocol of which function is needed to be set. </td></tr>
    <tr><td class="paramname">Free</td><td>Function pointer which will be called to free the protocol specific memory. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00807">807</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow-private_8h_source.html#l00076">flow_proto</a>, <a class="el" href="flow-util_8c_source.html#l00092">FlowGetProtoMapping()</a>, and <a class="el" href="flow_8h_source.html#l00429">FlowProto_::Freefunc</a>.</p>

<p>Referenced by <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph.png" border="0" usemap="#flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph" alt=""/></div>
<map name="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph" id="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_cgraph">
<area shape="rect" id="node2" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="211,5,362,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_icgraph.png" border="0" usemap="#flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_icgraph" alt=""/></div>
<map name="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_icgraph" id="flow_8c_a05174d1570db7ee4b5a25f5ea7234e87_icgraph">
<area shape="rect" id="node2" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="211,5,354,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="403,5,453,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f3fa579bec395b4b6a1e501c7556fd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowSetProtoTimeout </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>new_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>est_timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>closed_timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to set the timeout values for the specified protocol. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>protocol of which timeout value is needed to be set. </td></tr>
    <tr><td class="paramname">new_timeout</td><td>timeout value for the new flows. </td></tr>
    <tr><td class="paramname">est_timeout</td><td>timeout value for the established flows. </td></tr>
    <tr><td class="paramname">closed_timeout</td><td>timeout value for the closed flows. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00825">825</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00425">FlowProto_::closed_timeout</a>, <a class="el" href="flow_8h_source.html#l00424">FlowProto_::est_timeout</a>, <a class="el" href="flow-private_8h_source.html#l00076">flow_proto</a>, <a class="el" href="flow-util_8c_source.html#l00092">FlowGetProtoMapping()</a>, and <a class="el" href="flow_8h_source.html#l00423">FlowProto_::new_timeout</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a3f3fa579bec395b4b6a1e501c7556fd5_cgraph.png" border="0" usemap="#flow_8c_a3f3fa579bec395b4b6a1e501c7556fd5_cgraph" alt=""/></div>
<map name="flow_8c_a3f3fa579bec395b4b6a1e501c7556fd5_cgraph" id="flow_8c_a3f3fa579bec395b4b6a1e501c7556fd5_cgraph">
<area shape="rect" id="node2" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="203,5,354,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8dae51c56800ed0e22279e49913cd15a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowShutdown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>shutdown the flow engine </p>
<dl class="section warning"><dt>Warning</dt><dd>Not thread safe </dd></dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00488">488</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="flow-hash_8h_source.html#l00061">FBLOCK_DESTROY</a>, <a class="el" href="flow-private_8h_source.html#l00085">flow_config</a>, <a class="el" href="flow-private_8h_source.html#l00084">flow_hash</a>, <a class="el" href="flow-private_8h_source.html#l00082">flow_recycle_q</a>, <a class="el" href="flow-private_8h_source.html#l00079">flow_spare_q</a>, <a class="el" href="flow_8c_source.html#l00783">FlowClearMemory()</a>, <a class="el" href="flow-queue_8c_source.html#l00105">FlowDequeue()</a>, <a class="el" href="flow-util_8c_source.html#l00077">FlowFree()</a>, <a class="el" href="flow-util_8c_source.html#l00092">FlowGetProtoMapping()</a>, <a class="el" href="flow-queue_8c_source.html#l00061">FlowQueueDestroy()</a>, <a class="el" href="flow_8h_source.html#l00229">FlowCnf_::hash_size</a>, <a class="el" href="flow_8h_source.html#l00401">Flow_::hnext</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph.png" border="0" usemap="#flow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph" alt=""/></div>
<map name="flow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph" id="flow_8c_a8dae51c56800ed0e22279e49913cd15a_cgraph">
<area shape="rect" id="node2" href="flow_8c.html#a6e9eb43b74a70300e86da9c025705b1a" title="Function clear the flow memory before queueing it to spare flow queue. " alt="" coords="175,5,303,32"/><area shape="rect" id="node7" href="flow-queue_8c.html#afa9daefa1ef7bd8a4ef8528a43c1f599" title="remove a flow from the queue " alt="" coords="187,56,290,83"/><area shape="rect" id="node8" href="flow-util_8c.html#ae5fdd38c5ca6851df9ce87aee016ba54" title="cleanup &amp; free the memory of a flow " alt="" coords="386,81,462,108"/><area shape="rect" id="node9" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="163,157,314,184"/><area shape="rect" id="node10" href="flow-queue_8c.html#abb7a23ee9c1efb31ee74ed7de5603655" title="Destroy a flow queue. " alt="" coords="171,208,306,235"/><area shape="rect" id="node3" href="flow-storage_8c.html#aa43aab9054b3dd6ca65eb1b37acfcf13" title="FlowFreeStorage" alt="" coords="363,12,485,39"/><area shape="rect" id="node4" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="534,75,655,101"/><area shape="rect" id="node6" href="util-storage_8c.html#a842a9a77b4fb19baf4b10fc9ed2bd3fb" title="StorageFreeAll" alt="" coords="541,12,649,39"/><area shape="rect" id="node5" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="704,75,819,101"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a8dae51c56800ed0e22279e49913cd15a_icgraph.png" border="0" usemap="#flow_8c_a8dae51c56800ed0e22279e49913cd15a_icgraph" alt=""/></div>
<map name="flow_8c_a8dae51c56800ed0e22279e49913cd15a_icgraph" id="flow_8c_a8dae51c56800ed0e22279e49913cd15a_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="163,5,213,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a2af32f22fdfd78a6fef1a70ee995d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FlowUpdateSpareFlows </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure we have enough spare flows. </p>
<p>Enforce the prealloc parameter, so keep at least prealloc flows in the spare queue and free flows going over the limit.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if the queue was properly updated (or if it already was in good shape) </td></tr>
    <tr><td class="paramname">0</td><td>otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow_8c_source.html#l00113">113</a> of file <a class="el" href="flow_8c_source.html">flow.c</a>.</p>

<p>References <a class="el" href="flow-private_8h_source.html#l00085">flow_config</a>, <a class="el" href="flow-private_8h_source.html#l00079">flow_spare_q</a>, <a class="el" href="flow-util_8c_source.html#l00049">FlowAlloc()</a>, <a class="el" href="flow-queue_8c_source.html#l00105">FlowDequeue()</a>, <a class="el" href="flow-queue_8c_source.html#l00072">FlowEnqueue()</a>, <a class="el" href="flow-util_8c_source.html#l00077">FlowFree()</a>, <a class="el" href="flow-queue_8h_source.html#l00067">FQLOCK_LOCK</a>, <a class="el" href="flow-queue_8h_source.html#l00069">FQLOCK_UNLOCK</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, <a class="el" href="flow-queue_8h_source.html#l00045">FlowQueue_::len</a>, <a class="el" href="flow_8h_source.html#l00232">FlowCnf_::prealloc</a>, and <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow_8c_a0a2af32f22fdfd78a6fef1a70ee995d8_cgraph.png" border="0" usemap="#flow_8c_a0a2af32f22fdfd78a6fef1a70ee995d8_cgraph" alt=""/></div>
<map name="flow_8c_a0a2af32f22fdfd78a6fef1a70ee995d8_cgraph" id="flow_8c_a0a2af32f22fdfd78a6fef1a70ee995d8_cgraph">
<area shape="rect" id="node2" href="flow-util_8c.html#ae1ba1db44e3a77c4829397d5d659c432" title="allocate a flow " alt="" coords="229,5,307,32"/><area shape="rect" id="node5" href="flow-queue_8c.html#afa9daefa1ef7bd8a4ef8528a43c1f599" title="remove a flow from the queue " alt="" coords="217,56,319,83"/><area shape="rect" id="node6" href="flow-queue_8c.html#a9b5bc9b6bfa0e8e7b2663d4810f7c151" title="add a flow to a queue " alt="" coords="217,107,319,133"/><area shape="rect" id="node7" href="flow-util_8c.html#ae5fdd38c5ca6851df9ce87aee016ba54" title="cleanup &amp; free the memory of a flow " alt="" coords="230,157,306,184"/><area shape="rect" id="node3" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="369,81,490,108"/><area shape="rect" id="node4" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="539,81,653,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a042231529464e85eb0482c00c0cd114f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_prune_idx&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>atomic int that is used when freeing a flow from the hash. In this case we walk the hash to find a flow to free. This var records where we left off in the hash. Without this only the top rows of the hash are freed. This isn't just about fairness. Under severe presure, the hash rows on top would be all freed and the time to find a flow to free increased with every run. </p>

</div>
</div>
<a class="anchor" id="a00a3c29e500a18c716b94d6975c58009"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">flow_flags&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>atomic flags </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a5fc33a1b111d68d2889fc1effbc254f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int run_mode</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Run mode selected </p>

<p>Definition at line <a class="el" href="suricata_8c_source.html#l00222">222</a> of file <a class="el" href="suricata_8c_source.html">suricata.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="flow_8c.html">flow.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:08 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
