<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/runmode-af-packet.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('runmode-af-packet_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">runmode-af-packet.c File Reference<div class="ingroups"><a class="el" href="group__afppacket.html">AF_PACKET running mode</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;config.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="runmodes_8h_source.html">runmodes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="runmode-af-packet_8h_source.html">runmode-af-packet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log-httplog_8h_source.html">log-httplog.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="output_8h_source.html">output.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="detect-engine-mpm_8h_source.html">detect-engine-mpm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="alert-fastlog_8h_source.html">alert-fastlog.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="alert-prelude_8h_source.html">alert-prelude.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="alert-unified2-alert_8h_source.html">alert-unified2-alert.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="alert-debuglog_8h_source.html">alert-debuglog.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-cpu_8h_source.html">util-cpu.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-affinity_8h_source.html">util-affinity.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-device_8h_source.html">util-device.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-runmodes_8h_source.html">util-runmodes.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-ioctl_8h_source.html">util-ioctl.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="source-af-packet_8h_source.html">source-af-packet.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for runmode-af-packet.c:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c__incl.png" border="0" usemap="#src_2runmode-af-packet_8c" alt=""/></div>
<map name="src_2runmode-af-packet_8c" id="src_2runmode-af-packet_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="1863,229,1996,256"/><area shape="rect" id="node16" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="2598,155,2692,181"/><area shape="rect" id="node19" href="conf_8h.html" title="conf.h" alt="" coords="3527,80,3585,107"/><area shape="rect" id="node21" href="runmodes_8h.html" title="runmodes.h" alt="" coords="1223,80,1313,107"/><area shape="rect" id="node31" href="runmode-af-packet_8h.html" title="runmode&#45;af&#45;packet.h" alt="" coords="2005,155,2147,181"/><area shape="rect" id="node35" href="log-httplog_8h.html" title="log&#45;httplog.h" alt="" coords="2329,80,2423,107"/><area shape="rect" id="node36" href="output_8h.html" title="output.h" alt="" coords="2236,80,2305,107"/><area shape="rect" id="node40" href="detect-engine-mpm_8h.html" title="detect&#45;engine&#45;mpm.h" alt="" coords="3100,80,3244,107"/><area shape="rect" id="node41" href="alert-fastlog_8h.html" title="alert&#45;fastlog.h" alt="" coords="2548,80,2649,107"/><area shape="rect" id="node42" href="alert-prelude_8h.html" title="alert&#45;prelude.h" alt="" coords="2673,80,2777,107"/><area shape="rect" id="node43" href="alert-unified2-alert_8h.html" title="alert&#45;unified2&#45;alert.h" alt="" coords="2801,80,2937,107"/><area shape="rect" id="node44" href="alert-debuglog_8h.html" title="alert&#45;debuglog.h" alt="" coords="2961,80,3076,107"/><area shape="rect" id="node8" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="2433,304,2521,331"/><area shape="rect" id="node45" href="util-time_8h.html" title="util&#45;time.h" alt="" coords="3269,80,3347,107"/><area shape="rect" id="node6" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="3301,453,3376,480"/><area shape="rect" id="node46" href="util-affinity_8h.html" title="util&#45;affinity.h" alt="" coords="5,80,99,107"/><area shape="rect" id="node47" href="util-device_8h.html" title="util&#45;device.h" alt="" coords="3610,80,3701,107"/><area shape="rect" id="node48" href="util-runmodes_8h.html" title="util&#45;runmodes.h" alt="" coords="3726,80,3836,107"/><area shape="rect" id="node49" href="util-ioctl_8h.html" title="util&#45;ioctl.h" alt="" coords="3861,80,3939,107"/><area shape="rect" id="node50" href="source-af-packet_8h.html" title="source&#45;af&#45;packet.h" alt="" coords="3372,80,3503,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="2335,304,2408,331"/><area shape="rect" id="node5" href="threads_8h.html" title="threads.h" alt="" coords="2622,379,2697,405"/><area shape="rect" id="node7" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="2597,304,2747,331"/><area shape="rect" id="node9" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="2337,379,2417,405"/><area shape="rect" id="node10" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="1732,304,1815,331"/><area shape="rect" id="node11" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1839,304,1979,331"/><area shape="rect" id="node12" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="2003,304,2105,331"/><area shape="rect" id="node13" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="2130,304,2208,331"/><area shape="rect" id="node14" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="2233,304,2311,331"/><area shape="rect" id="node17" href="tmqh-packetpool_8h.html" title="tmqh&#45;packetpool.h" alt="" coords="2747,229,2876,256"/><area shape="rect" id="node18" href="tm-modules_8h.html" title="tm&#45;modules.h" alt="" coords="2621,229,2723,256"/><area shape="rect" id="node20" href="queue_8h.html" title="queue.h" alt="" coords="3522,155,3589,181"/><area shape="rect" id="node22" href="runmode-pcap_8h.html" title="runmode&#45;pcap.h" alt="" coords="568,155,683,181"/><area shape="rect" id="node23" href="runmode-pcap-file_8h.html" title="runmode&#45;pcap&#45;file.h" alt="" coords="707,155,843,181"/><area shape="rect" id="node24" href="runmode-pfring_8h.html" title="runmode&#45;pfring.h" alt="" coords="1734,155,1852,181"/><area shape="rect" id="node25" href="runmode-tile_8h.html" title="runmode&#45;tile.h" alt="" coords="1877,155,1981,181"/><area shape="rect" id="node26" href="runmode-nfq_8h.html" title="runmode&#45;nfq.h" alt="" coords="867,155,972,181"/><area shape="rect" id="node27" href="runmode-ipfw_8h.html" title="runmode&#45;ipfw.h" alt="" coords="997,155,1107,181"/><area shape="rect" id="node28" href="runmode-erf-file_8h.html" title="runmode&#45;erf&#45;file.h" alt="" coords="1132,155,1255,181"/><area shape="rect" id="node29" href="runmode-erf-dag_8h.html" title="runmode&#45;erf&#45;dag.h" alt="" coords="1279,155,1405,181"/><area shape="rect" id="node30" href="runmode-napatech_8h.html" title="runmode&#45;napatech.h" alt="" coords="1430,155,1569,181"/><area shape="rect" id="node32" href="runmode-nflog_8h.html" title="runmode&#45;nflog.h" alt="" coords="1595,155,1709,181"/><area shape="rect" id="node33" href="runmode-unix-socket_8h.html" title="runmode&#45;unix&#45;socket.h" alt="" coords="235,155,389,181"/><area shape="rect" id="node34" href="runmode-netmap_8h.html" title="runmode&#45;netmap.h" alt="" coords="413,155,544,181"/><area shape="rect" id="node37" href="suricata_8h.html" title="suricata.h" alt="" coords="2171,155,2249,181"/><area shape="rect" id="node38" href="output-packet_8h.html" title="output&#45;packet.h" alt="" coords="2275,155,2387,181"/><area shape="rect" id="node39" href="output-tx_8h.html" title="output&#45;tx.h" alt="" coords="2411,155,2495,181"/></map>
</div>
</div>
<p><a href="runmode-af-packet_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="memitem:a9c9407e762ec4c855225355ff68934c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#a9c9407e762ec4c855225355ff68934c0">max_pending_packets</a></td></tr>
<tr class="separator:a9c9407e762ec4c855225355ff68934c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67161472d35eac8fe97dc8b7bd04f29e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#a67161472d35eac8fe97dc8b7bd04f29e">RunModeAFPGetDefaultMode</a> (void)</td></tr>
<tr class="separator:a67161472d35eac8fe97dc8b7bd04f29e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf510dda35701437fc571d5b5f0f1f6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#abf510dda35701437fc571d5b5f0f1f6e">RunModeIdsAFPRegister</a> (void)</td></tr>
<tr class="separator:abf510dda35701437fc571d5b5f0f1f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02b352fd8b58facd2d8a704bb1e7c8d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9">AFPDerefConfig</a> (void *conf)</td></tr>
<tr class="separator:a02b352fd8b58facd2d8a704bb1e7c8d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44206676da7e92c8d5f1b2442dbe2e0"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0">ParseAFPConfig</a> (const char *iface)</td></tr>
<tr class="memdesc:aa44206676da7e92c8d5f1b2442dbe2e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">extract information from config file  <a href="#aa44206676da7e92c8d5f1b2442dbe2e0">More...</a><br/></td></tr>
<tr class="separator:aa44206676da7e92c8d5f1b2442dbe2e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa61e4db80a8f7e442c1799ece0a25db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#afa61e4db80a8f7e442c1799ece0a25db">AFPConfigGeThreadsCount</a> (void *conf)</td></tr>
<tr class="separator:afa61e4db80a8f7e442c1799ece0a25db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a3b74a93b01528dc796b7cac4d8649"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#ad9a3b74a93b01528dc796b7cac4d8649">AFPRunModeIsIPS</a> ()</td></tr>
<tr class="separator:ad9a3b74a93b01528dc796b7cac4d8649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af741b481e72c7d4e52637797fa320ea6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#af741b481e72c7d4e52637797fa320ea6">RunModeIdsAFPAutoFp</a> (void)</td></tr>
<tr class="separator:af741b481e72c7d4e52637797fa320ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4607fda68e0f4b15bc3207cec646da96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#a4607fda68e0f4b15bc3207cec646da96">RunModeIdsAFPSingle</a> (void)</td></tr>
<tr class="memdesc:a4607fda68e0f4b15bc3207cec646da96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single thread version of the AF_PACKET processing.  <a href="#a4607fda68e0f4b15bc3207cec646da96">More...</a><br/></td></tr>
<tr class="separator:a4607fda68e0f4b15bc3207cec646da96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1402fe271c8a1f767de444b2d9535722"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="runmode-af-packet_8c.html#a1402fe271c8a1f767de444b2d9535722">RunModeIdsAFPWorkers</a> (void)</td></tr>
<tr class="memdesc:a1402fe271c8a1f767de444b2d9535722"><td class="mdescLeft">&#160;</td><td class="mdescRight">Workers version of the AF_PACKET processing.  <a href="#a1402fe271c8a1f767de444b2d9535722">More...</a><br/></td></tr>
<tr class="separator:a1402fe271c8a1f767de444b2d9535722"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Eric Leblond <a href="#" onclick="location.href='mai'+'lto:'+'eri'+'c@'+'reg'+'it'+'.or'+'g'; return false;">eric@<span style="display: none;">.nosp@m.</span>regi<span style="display: none;">.nosp@m.</span>t.org</a></dd></dl>
<p>AF_PACKET socket runmode </p>

<p>Definition in file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afa61e4db80a8f7e442c1799ece0a25db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AFPConfigGeThreadsCount </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00373">373</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="source-af-packet_8h_source.html#l00063">AFPIfaceConfig_::threads</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00457">RunModeIdsAFPAutoFp()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00504">RunModeIdsAFPSingle()</a>, and <a class="el" href="runmode-af-packet_8c_source.html#l00549">RunModeIdsAFPWorkers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_afa61e4db80a8f7e442c1799ece0a25db_icgraph.png" border="0" usemap="#runmode-af-packet_8c_afa61e4db80a8f7e442c1799ece0a25db_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_afa61e4db80a8f7e442c1799ece0a25db_icgraph" id="runmode-af-packet_8c_afa61e4db80a8f7e442c1799ece0a25db_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="243,5,407,32"/><area shape="rect" id="node6" href="runmode-af-packet_8h.html#a4607fda68e0f4b15bc3207cec646da96" title="Single thread version of the AF_PACKET processing. " alt="" coords="246,56,405,83"/><area shape="rect" id="node7" href="runmode-af-packet_8h.html#a1402fe271c8a1f767de444b2d9535722" title="Workers version of the AF_PACKET processing. " alt="" coords="240,107,411,133"/><area shape="rect" id="node3" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="459,56,629,83"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="678,56,869,83"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="917,56,968,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a02b352fd8b58facd2d8a704bb1e7c8d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AFPDerefConfig </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00086">86</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00105">ParseAFPConfig()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a02b352fd8b58facd2d8a704bb1e7c8d9_icgraph.png" border="0" usemap="#runmode-af-packet_8c_a02b352fd8b58facd2d8a704bb1e7c8d9_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a02b352fd8b58facd2d8a704bb1e7c8d9_icgraph" id="runmode-af-packet_8c_a02b352fd8b58facd2d8a704bb1e7c8d9_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0" title="extract information from config file " alt="" coords="173,56,293,83"/><area shape="rect" id="node3" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="345,5,509,32"/><area shape="rect" id="node7" href="runmode-af-packet_8h.html#a4607fda68e0f4b15bc3207cec646da96" title="Single thread version of the AF_PACKET processing. " alt="" coords="347,56,506,83"/><area shape="rect" id="node8" href="runmode-af-packet_8h.html#a1402fe271c8a1f767de444b2d9535722" title="Workers version of the AF_PACKET processing. " alt="" coords="341,107,512,133"/><area shape="rect" id="node4" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="560,56,731,83"/><area shape="rect" id="node5" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="779,56,970,83"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1019,56,1069,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad9a3b74a93b01528dc796b7cac4d8649"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int AFPRunModeIsIPS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00379">379</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="conf_8c_source.html#l00359">ConfGetChildValueWithDefault()</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="conf_8c_source.html#l00762">ConfNodeLookupKeyValue()</a>, <a class="el" href="util-device_8c_source.html#l00072">LiveGetDeviceCount()</a>, <a class="el" href="util-device_8c_source.html#l00092">LiveGetDeviceName()</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, and <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_ad9a3b74a93b01528dc796b7cac4d8649_cgraph.png" border="0" usemap="#runmode-af-packet_8c_ad9a3b74a93b01528dc796b7cac4d8649_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_ad9a3b74a93b01528dc796b7cac4d8649_cgraph" id="runmode-af-packet_8c_ad9a3b74a93b01528dc796b7cac4d8649_cgraph">
<area shape="rect" id="node2" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="192,5,395,32"/><area shape="rect" id="node5" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="242,56,345,83"/><area shape="rect" id="node7" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="204,107,383,133"/><area shape="rect" id="node8" href="util-device_8c.html#a98bf56c79d344f38884b1af3cb36a9ea" title="Get the number of registered devices. " alt="" coords="222,157,365,184"/><area shape="rect" id="node9" href="util-device_8c.html#aeda89d2b7fa6bdef4cfc46d075542e32" title="Get a pointer to the device name at idx. " alt="" coords="222,208,365,235"/><area shape="rect" id="node3" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="443,5,578,32"/><area shape="rect" id="node4" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="627,31,781,57"/><area shape="rect" id="node6" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="480,107,541,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa44206676da7e92c8d5f1b2442dbe2e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ParseAFPConfig </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>iface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>extract information from config file </p>
<p>The returned structure will be freed by the thread init function. This is thus necessary to or copy the structure before giving it to thread or to reparse the file for each thread (and thus have new structure.</p>
<dl class="section return"><dt>Returns</dt><dd>a AFPIfaceConfig corresponding to the interface name </dd></dl>

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00105">105</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="source-af-packet_8h_source.html#l00054">AFP_COPY_MODE_IPS</a>, <a class="el" href="source-af-packet_8h_source.html#l00052">AFP_COPY_MODE_NONE</a>, <a class="el" href="source-af-packet_8h_source.html#l00053">AFP_COPY_MODE_TAP</a>, <a class="el" href="source-af-packet_8h_source.html#l00050">AFP_EMERGENCY_MODE</a>, <a class="el" href="source-af-packet_8h_source.html#l00047">AFP_RING_MODE</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00086">AFPDerefConfig()</a>, <a class="el" href="source-af-packet_8h_source.html#l00077">AFPIfaceConfig_::bpf_filter</a>, <a class="el" href="source-af-packet_8h_source.html#l00065">AFPIfaceConfig_::buffer_size</a>, <a class="el" href="source-af-packet_8h_source.html#l00076">AFPIfaceConfig_::checksum_mode</a>, <a class="el" href="decode_8h_source.html#l00042">CHECKSUM_VALIDATION_AUTO</a>, <a class="el" href="decode_8h_source.html#l00040">CHECKSUM_VALIDATION_DISABLE</a>, <a class="el" href="decode_8h_source.html#l00041">CHECKSUM_VALIDATION_ENABLE</a>, <a class="el" href="decode_8h_source.html#l00044">CHECKSUM_VALIDATION_KERNEL</a>, <a class="el" href="source-af-packet_8h_source.html#l00069">AFPIfaceConfig_::cluster_id</a>, <a class="el" href="source-af-packet_8h_source.html#l00070">AFPIfaceConfig_::cluster_type</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="conf_8c_source.html#l00468">ConfGetChildValueBoolWithDefault()</a>, <a class="el" href="conf_8c_source.html#l00420">ConfGetChildValueIntWithDefault()</a>, <a class="el" href="conf_8c_source.html#l00359">ConfGetChildValueWithDefault()</a>, <a class="el" href="conf_8c_source.html#l00176">ConfGetNode()</a>, <a class="el" href="conf_8c_source.html#l00762">ConfNodeLookupKeyValue()</a>, <a class="el" href="source-af-packet_8h_source.html#l00075">AFPIfaceConfig_::copy_mode</a>, <a class="el" href="source-af-packet_8h_source.html#l00080">AFPIfaceConfig_::DerefFunc</a>, <a class="el" href="source-af-packet_8h_source.html#l00074">AFPIfaceConfig_::flags</a>, <a class="el" href="util-ioctl_8c_source.html#l00153">GetIfaceOffloading()</a>, <a class="el" href="util-ioctl_8c_source.html#l00213">GetIfaceRSSQueuesNum()</a>, <a class="el" href="source-af-packet_8h_source.html#l00061">AFPIfaceConfig_::iface</a>, <a class="el" href="suricata_8c_source.html#l00233">max_pending_packets</a>, <a class="el" href="source-af-packet_8h_source.html#l00078">AFPIfaceConfig_::out_iface</a>, <a class="el" href="source-af-packet_8h_source.html#l00034">PACKET_FANOUT_CPU</a>, <a class="el" href="source-af-packet_8h_source.html#l00040">PACKET_FANOUT_FLAG_DEFRAG</a>, <a class="el" href="source-af-packet_8h_source.html#l00039">PACKET_FANOUT_FLAG_ROLLOVER</a>, <a class="el" href="source-af-packet_8h_source.html#l00032">PACKET_FANOUT_HASH</a>, <a class="el" href="source-af-packet_8h_source.html#l00033">PACKET_FANOUT_LB</a>, <a class="el" href="source-af-packet_8h_source.html#l00037">PACKET_FANOUT_QM</a>, <a class="el" href="source-af-packet_8h_source.html#l00036">PACKET_FANOUT_RND</a>, <a class="el" href="source-af-packet_8h_source.html#l00035">PACKET_FANOUT_ROLLOVER</a>, <a class="el" href="source-af-packet_8h_source.html#l00072">AFPIfaceConfig_::promisc</a>, <a class="el" href="source-af-packet_8h_source.html#l00067">AFPIfaceConfig_::ring_size</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="util-atomic_8h_source.html#l00091">SC_ATOMIC_RESET</a>, <a class="el" href="util-error_8h_source.html#l00222">SC_ERR_AFP_CREATE</a>, <a class="el" href="util-error_8h_source.html#l00065">SC_ERR_GET_CLUSTER_TYPE_FAILED</a>, <a class="el" href="util-error_8h_source.html#l00043">SC_ERR_INVALID_ARGUMENT</a>, <a class="el" href="util-error_8h_source.html#l00066">SC_ERR_INVALID_CLUSTER_TYPE</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00263">SCLogWarning</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="util-strlcpyu_8c_source.html#l00048">strlcpy()</a>, <a class="el" href="source-af-packet_8h_source.html#l00063">AFPIfaceConfig_::threads</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, and <a class="el" href="util-cpu_8c_source.html#l00098">UtilCpuGetNumProcessorsOnline()</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00457">RunModeIdsAFPAutoFp()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00504">RunModeIdsAFPSingle()</a>, and <a class="el" href="runmode-af-packet_8c_source.html#l00549">RunModeIdsAFPWorkers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_cgraph.png" border="0" usemap="#runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_cgraph" id="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_cgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9" title="AFPDerefConfig" alt="" coords="223,5,342,32"/><area shape="rect" id="node3" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="247,56,318,83"/><area shape="rect" id="node7" href="conf_8c.html#a840763787cd0111c51ccbf88230e8369" title="ConfGetChildValueBoolWith\lDefault" alt="" coords="189,158,376,199"/><area shape="rect" id="node11" href="conf_8c.html#ab86b284e0f4390915666fb15b1d09bb7" title="ConfGetChildValueIntWith\lDefault" alt="" coords="195,223,371,265"/><area shape="rect" id="node13" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="461,281,664,308"/><area shape="rect" id="node4" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="511,111,614,137"/><area shape="rect" id="node14" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="193,492,372,519"/><area shape="rect" id="node15" href="util-ioctl_8c.html#aec432b70f2df0828bde32692c9804c76" title="output offloading status of the link " alt="" coords="497,391,628,417"/><area shape="rect" id="node16" href="util-ioctl_8c.html#aa757c28cf75465254e6591ce9e27d51c" title="GetIfaceRSSQueuesNum" alt="" coords="476,441,649,468"/><area shape="rect" id="node6" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="771,365,832,392"/><area shape="rect" id="node17" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="173,543,392,569"/><area shape="rect" id="node5" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="918,168,1071,195"/><area shape="rect" id="node8" href="conf_8c.html#ad9d1cb8a5580a48745859b31f8e90e20" title="ConfGetChildValueBool" alt="" coords="483,169,643,196"/><area shape="rect" id="node9" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="734,224,869,251"/><area shape="rect" id="node10" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="748,169,855,196"/><area shape="rect" id="node12" href="conf_8c.html#a0ffa455c86982da0089fbf7b8954ef9d" title="ConfGetChildValueInt" alt="" coords="488,227,637,253"/><area shape="rect" id="node18" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="441,543,685,569"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_icgraph.png" border="0" usemap="#runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_icgraph" id="runmode-af-packet_8c_aa44206676da7e92c8d5f1b2442dbe2e0_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="177,5,341,32"/><area shape="rect" id="node6" href="runmode-af-packet_8h.html#a4607fda68e0f4b15bc3207cec646da96" title="Single thread version of the AF_PACKET processing. " alt="" coords="179,56,338,83"/><area shape="rect" id="node7" href="runmode-af-packet_8h.html#a1402fe271c8a1f767de444b2d9535722" title="Workers version of the AF_PACKET processing. " alt="" coords="173,107,344,133"/><area shape="rect" id="node3" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="392,56,563,83"/><area shape="rect" id="node4" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="611,56,802,83"/><area shape="rect" id="node5" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="851,56,901,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a67161472d35eac8fe97dc8b7bd04f29e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* RunModeAFPGetDefaultMode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00063">63</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>Referenced by <a class="el" href="runmodes_8c_source.html#l00270">RunModeDispatch()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a67161472d35eac8fe97dc8b7bd04f29e_icgraph.png" border="0" usemap="#runmode-af-packet_8c_a67161472d35eac8fe97dc8b7bd04f29e_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a67161472d35eac8fe97dc8b7bd04f29e_icgraph" id="runmode-af-packet_8c_a67161472d35eac8fe97dc8b7bd04f29e_icgraph">
<area shape="rect" id="node2" href="runmodes_8h.html#a4cc3e6408c1bd3e4d588eb27c6f156f3" title="RunModeDispatch" alt="" coords="253,5,384,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="432,5,483,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af741b481e72c7d4e52637797fa320ea6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunModeIdsAFPAutoFp </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00457">457</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="runmode-af-packet_8c_source.html#l00373">AFPConfigGeThreadsCount()</a>, <a class="el" href="source-af-packet_8c_source.html#l00356">AFPPeersListCheck()</a>, <a class="el" href="source-af-packet_8c_source.html#l00339">AFPPeersListInit()</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00105">ParseAFPConfig()</a>, <a class="el" href="runmodes_8c_source.html#l00910">RunModeInitialize()</a>, <a class="el" href="util-runmodes_8c_source.html#l00103">RunModeSetLiveCaptureAutoFp()</a>, <a class="el" href="util-error_8h_source.html#l00219">SC_ERR_RUNMODE</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="util-time_8c_source.html#l00054">TimeModeSetLive()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00068">RunModeIdsAFPRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_cgraph.png" border="0" usemap="#runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_cgraph" id="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_cgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#afa61e4db80a8f7e442c1799ece0a25db" title="AFPConfigGeThreadsCount" alt="" coords="231,14,417,40"/><area shape="rect" id="node3" href="group__afppeers.html#gab125105d3431b81bed5b09db6d6edb0f" title="Check that all AFPPeer got a peer. " alt="" coords="253,64,395,91"/><area shape="rect" id="node4" href="group__afppeers.html#ga54f6e0062f675bc9173cfb348164497f" title="Init the global list of AFPPeer. " alt="" coords="263,115,385,142"/><area shape="rect" id="node5" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="831,191,902,218"/><area shape="rect" id="node9" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0" title="extract information from config file " alt="" coords="264,527,384,554"/><area shape="rect" id="node23" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title="RunModeInitialize" alt="" coords="261,166,387,192"/><area shape="rect" id="node28" href="util-runmodes_8c.html#ac48eda3c5f69d700b3d54b55178241c7" title="RunModeSetLiveCaptureAutoFp" alt="" coords="219,1059,429,1086"/><area shape="rect" id="node50" href="util-time_8c.html#a4c8898901628befb98548be21b599f14" title="TimeModeSetLive" alt="" coords="261,1110,387,1136"/><area shape="rect" id="node6" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="1075,191,1178,218"/><area shape="rect" id="node7" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1265,191,1418,218"/><area shape="rect" id="node8" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1311,679,1372,706"/><area shape="rect" id="node10" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9" title="AFPDerefConfig" alt="" coords="527,502,646,528"/><area shape="rect" id="node11" href="conf_8c.html#a840763787cd0111c51ccbf88230e8369" title="ConfGetChildValueBoolWith\lDefault" alt="" coords="493,318,680,360"/><area shape="rect" id="node15" href="conf_8c.html#ab86b284e0f4390915666fb15b1d09bb7" title="ConfGetChildValueIntWith\lDefault" alt="" coords="499,436,675,477"/><area shape="rect" id="node17" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="765,380,968,407"/><area shape="rect" id="node18" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="497,552,676,579"/><area shape="rect" id="node19" href="util-ioctl_8c.html#aec432b70f2df0828bde32692c9804c76" title="output offloading status of the link " alt="" coords="1061,654,1192,680"/><area shape="rect" id="node20" href="util-ioctl_8c.html#aa757c28cf75465254e6591ce9e27d51c" title="GetIfaceRSSQueuesNum" alt="" coords="1040,704,1213,731"/><area shape="rect" id="node21" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="477,806,696,832"/><area shape="rect" id="node12" href="conf_8c.html#ad9d1cb8a5580a48745859b31f8e90e20" title="ConfGetChildValueBool" alt="" coords="787,326,947,352"/><area shape="rect" id="node13" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="1059,352,1194,379"/><area shape="rect" id="node14" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="1073,271,1180,298"/><area shape="rect" id="node16" href="conf_8c.html#a0ffa455c86982da0089fbf7b8954ef9d" title="ConfGetChildValueInt" alt="" coords="792,439,941,466"/><area shape="rect" id="node22" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="745,806,989,832"/><area shape="rect" id="node24" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="538,115,635,142"/><area shape="rect" id="node25" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file. " alt="" coords="770,14,963,40"/><area shape="rect" id="node27" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float. " alt="" coords="537,166,637,192"/><area shape="rect" id="node26" href="util-affinity_8c.html#ab716a16a85291314f6fd64bdf8366abb" title="find affinity by its name " alt="" coords="1037,64,1216,91"/><area shape="rect" id="node29" href="util-device_8c.html#a98bf56c79d344f38884b1af3cb36a9ea" title="Get the number of registered devices. " alt="" coords="515,1059,658,1086"/><area shape="rect" id="node30" href="tm-threads_8c.html#a6121f124848a0f3961e4eee3faf34f8e" title="TmThreadGetNbThreads" alt="" coords="503,1110,670,1136"/><area shape="rect" id="node31" href="util-runmodes_8c.html#af0eec250820d2db9a2bae6f0d620ad35" title="RunmodeSetFlowStreamAsync" alt="" coords="484,1160,689,1187"/><area shape="rect" id="node33" href="util-runmodes_8c.html#a489ab6586f887830804c9d396e95c457" title="create a queue string for autofp to pass to the flow queue handler. " alt="" coords="487,1212,686,1253"/><area shape="rect" id="node35" href="tm-threads_8c.html#ac0e074117df241b52004b4b1c5228b8e" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="483,1278,690,1304"/><area shape="rect" id="node41" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="509,1328,664,1355"/><area shape="rect" id="node42" href="tm-threads_8c.html#a6cf6491e6eb3b8cd303e0e611091ea1e" title="Appends a new entry to the slots. " alt="" coords="788,1404,945,1431"/><area shape="rect" id="node43" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="521,856,652,883"/><area shape="rect" id="node44" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="526,907,647,934"/><area shape="rect" id="node47" href="util-device_8c.html#aeda89d2b7fa6bdef4cfc46d075542e32" title="Get a pointer to the device name at idx. " alt="" coords="515,958,658,984"/><area shape="rect" id="node48" href="detect-engine_8c.html#ab671a7bd77e40c3d8433ff46bd43374b" title="Check if detection is enabled. " alt="" coords="513,1008,661,1035"/><area shape="rect" id="node49" href="runmodes_8c.html#a7d2ba9fcb621395068f1f182b93d98d9" title="SetupOutputs" alt="" coords="535,1430,638,1456"/><area shape="rect" id="node32" href="flow-hash_8c.html#a608c7569788adc7c116253c9eae67747" title="FlowDisableTcpReuseHandling" alt="" coords="764,1160,969,1187"/><area shape="rect" id="node34" href="suricata-common_8h.html#a7e9938e922f1dfd71bc01995bc2b7777" title="strlcat" alt="" coords="837,1219,896,1246"/><area shape="rect" id="node36" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="807,1324,927,1351"/><area shape="rect" id="node40" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="778,1274,955,1300"/><area shape="rect" id="node37" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1060,1375,1193,1402"/><area shape="rect" id="node38" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="1047,1274,1206,1300"/><area shape="rect" id="node39" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="1064,1324,1189,1351"/><area shape="rect" id="node45" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="791,932,943,959"/><area shape="rect" id="node46" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type. " alt="" coords="804,882,929,908"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_icgraph.png" border="0" usemap="#runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_icgraph" id="runmode-af-packet_8c_af741b481e72c7d4e52637797fa320ea6_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="219,5,389,32"/><area shape="rect" id="node3" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="438,5,629,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="677,5,728,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abf510dda35701437fc571d5b5f0f1f6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RunModeIdsAFPRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00068">68</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="runmodes_8h_source.html#l00037">RUNMODE_AFP_DEV</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00457">RunModeIdsAFPAutoFp()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00504">RunModeIdsAFPSingle()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00549">RunModeIdsAFPWorkers()</a>, and <a class="el" href="runmodes_8c_source.html#l00385">RunModeRegisterNewRunMode()</a>.</p>

<p>Referenced by <a class="el" href="runmodes_8c_source.html#l00201">RunModeRegisterRunModes()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_cgraph.png" border="0" usemap="#runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_cgraph" id="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_cgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="247,781,411,808"/><area shape="rect" id="node46" href="runmode-af-packet_8c.html#a4607fda68e0f4b15bc3207cec646da96" title="Single thread version of the AF_PACKET processing. " alt="" coords="250,883,409,909"/><area shape="rect" id="node48" href="runmode-af-packet_8c.html#a1402fe271c8a1f767de444b2d9535722" title="Workers version of the AF_PACKET processing. " alt="" coords="244,832,415,859"/><area shape="rect" id="node50" href="runmodes_8c.html#a93b05624527eb907a38ca0efab5bcd5c" title="Registers a new runmode. " alt="" coords="224,933,435,960"/><area shape="rect" id="node3" href="runmode-af-packet_8c.html#afa61e4db80a8f7e442c1799ece0a25db" title="AFPConfigGeThreadsCount" alt="" coords="499,756,685,783"/><area shape="rect" id="node4" href="group__afppeers.html#gab125105d3431b81bed5b09db6d6edb0f" title="Check that all AFPPeer got a peer. " alt="" coords="521,807,663,833"/><area shape="rect" id="node5" href="group__afppeers.html#ga54f6e0062f675bc9173cfb348164497f" title="Init the global list of AFPPeer. " alt="" coords="531,857,653,884"/><area shape="rect" id="node6" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="1103,1295,1174,1321"/><area shape="rect" id="node10" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0" title="extract information from config file " alt="" coords="532,959,652,985"/><area shape="rect" id="node24" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title="RunModeInitialize" alt="" coords="529,1371,655,1397"/><area shape="rect" id="node29" href="util-runmodes_8c.html#ac48eda3c5f69d700b3d54b55178241c7" title="RunModeSetLiveCaptureAutoFp" alt="" coords="487,351,697,377"/><area shape="rect" id="node45" href="util-time_8c.html#a4c8898901628befb98548be21b599f14" title="TimeModeSetLive" alt="" coords="529,705,655,732"/><area shape="rect" id="node7" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="1347,1295,1450,1321"/><area shape="rect" id="node8" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1537,1295,1690,1321"/><area shape="rect" id="node9" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1583,807,1644,833"/><area shape="rect" id="node11" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9" title="AFPDerefConfig" alt="" coords="799,984,918,1011"/><area shape="rect" id="node12" href="conf_8c.html#a840763787cd0111c51ccbf88230e8369" title="ConfGetChildValueBoolWith\lDefault" alt="" coords="765,1153,952,1194"/><area shape="rect" id="node16" href="conf_8c.html#ab86b284e0f4390915666fb15b1d09bb7" title="ConfGetChildValueIntWith\lDefault" alt="" coords="771,1035,947,1077"/><area shape="rect" id="node18" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="1037,1105,1240,1132"/><area shape="rect" id="node19" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="769,933,948,960"/><area shape="rect" id="node20" href="util-ioctl_8c.html#aec432b70f2df0828bde32692c9804c76" title="output offloading status of the link " alt="" coords="1333,832,1464,859"/><area shape="rect" id="node21" href="util-ioctl_8c.html#aa757c28cf75465254e6591ce9e27d51c" title="GetIfaceRSSQueuesNum" alt="" coords="1312,731,1485,757"/><area shape="rect" id="node22" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="749,528,968,555"/><area shape="rect" id="node13" href="conf_8c.html#ad9d1cb8a5580a48745859b31f8e90e20" title="ConfGetChildValueBool" alt="" coords="1059,1160,1219,1187"/><area shape="rect" id="node14" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="1331,1128,1466,1155"/><area shape="rect" id="node15" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="1345,1201,1452,1228"/><area shape="rect" id="node17" href="conf_8c.html#a0ffa455c86982da0089fbf7b8954ef9d" title="ConfGetChildValueInt" alt="" coords="1064,1048,1213,1075"/><area shape="rect" id="node23" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1017,528,1261,555"/><area shape="rect" id="node25" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="810,1421,907,1448"/><area shape="rect" id="node26" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file. " alt="" coords="1042,1523,1235,1549"/><area shape="rect" id="node28" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float. " alt="" coords="809,1371,909,1397"/><area shape="rect" id="node27" href="util-affinity_8c.html#ab716a16a85291314f6fd64bdf8366abb" title="find affinity by its name " alt="" coords="1309,1523,1488,1549"/><area shape="rect" id="node30" href="util-device_8c.html#a98bf56c79d344f38884b1af3cb36a9ea" title="Get the number of registered devices. " alt="" coords="787,680,930,707"/><area shape="rect" id="node31" href="tm-threads_8c.html#a6121f124848a0f3961e4eee3faf34f8e" title="TmThreadGetNbThreads" alt="" coords="775,56,942,83"/><area shape="rect" id="node32" href="util-runmodes_8c.html#af0eec250820d2db9a2bae6f0d620ad35" title="RunmodeSetFlowStreamAsync" alt="" coords="756,5,961,32"/><area shape="rect" id="node34" href="util-runmodes_8c.html#a489ab6586f887830804c9d396e95c457" title="create a queue string for autofp to pass to the flow queue handler. " alt="" coords="759,107,958,149"/><area shape="rect" id="node36" href="tm-threads_8c.html#ac0e074117df241b52004b4b1c5228b8e" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="755,173,962,200"/><area shape="rect" id="node38" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="781,275,936,301"/><area shape="rect" id="node39" href="tm-threads_8c.html#a6cf6491e6eb3b8cd303e0e611091ea1e" title="Appends a new entry to the slots. " alt="" coords="1060,275,1217,301"/><area shape="rect" id="node40" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="793,376,924,403"/><area shape="rect" id="node41" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="798,427,919,453"/><area shape="rect" id="node42" href="util-device_8c.html#aeda89d2b7fa6bdef4cfc46d075542e32" title="Get a pointer to the device name at idx. " alt="" coords="787,629,930,656"/><area shape="rect" id="node43" href="detect-engine_8c.html#ab671a7bd77e40c3d8433ff46bd43374b" title="Check if detection is enabled. " alt="" coords="785,477,933,504"/><area shape="rect" id="node44" href="runmodes_8c.html#a7d2ba9fcb621395068f1f182b93d98d9" title="SetupOutputs" alt="" coords="807,325,910,352"/><area shape="rect" id="node33" href="flow-hash_8c.html#a608c7569788adc7c116253c9eae67747" title="FlowDisableTcpReuseHandling" alt="" coords="1036,5,1241,32"/><area shape="rect" id="node35" href="suricata-common_8h.html#a7e9938e922f1dfd71bc01995bc2b7777" title="strlcat" alt="" coords="1109,115,1168,141"/><area shape="rect" id="node37" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="1079,173,1199,200"/><area shape="rect" id="node47" href="util-runmodes_8c.html#ab8e9f0da8e016dbd00df5d0b75112432" title="RunModeSetLiveCaptureSingle" alt="" coords="490,908,694,935"/><area shape="rect" id="node49" href="util-runmodes_8c.html#af172e0dce21aa23e4a6036c741fcb6ca" title="RunModeSetLiveCaptureWorkers" alt="" coords="483,655,701,681"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_icgraph.png" border="0" usemap="#runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_icgraph" id="runmode-af-packet_8c_abf510dda35701437fc571d5b5f0f1f6e_icgraph">
<area shape="rect" id="node2" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="225,5,415,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="464,5,515,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4607fda68e0f4b15bc3207cec646da96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunModeIdsAFPSingle </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single thread version of the AF_PACKET processing. </p>

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00504">504</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="runmode-af-packet_8c_source.html#l00373">AFPConfigGeThreadsCount()</a>, <a class="el" href="source-af-packet_8c_source.html#l00356">AFPPeersListCheck()</a>, <a class="el" href="source-af-packet_8c_source.html#l00339">AFPPeersListInit()</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00105">ParseAFPConfig()</a>, <a class="el" href="runmodes_8c_source.html#l00910">RunModeInitialize()</a>, <a class="el" href="util-runmodes_8c_source.html#l00446">RunModeSetLiveCaptureSingle()</a>, <a class="el" href="util-error_8h_source.html#l00219">SC_ERR_RUNMODE</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="util-time_8c_source.html#l00054">TimeModeSetLive()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00068">RunModeIdsAFPRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_cgraph.png" border="0" usemap="#runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_cgraph" id="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_cgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#afa61e4db80a8f7e442c1799ece0a25db" title="AFPConfigGeThreadsCount" alt="" coords="223,299,409,326"/><area shape="rect" id="node3" href="group__afppeers.html#gab125105d3431b81bed5b09db6d6edb0f" title="Check that all AFPPeer got a peer. " alt="" coords="245,350,387,377"/><area shape="rect" id="node4" href="group__afppeers.html#ga54f6e0062f675bc9173cfb348164497f" title="Init the global list of AFPPeer. " alt="" coords="255,401,377,427"/><area shape="rect" id="node5" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="733,553,803,579"/><area shape="rect" id="node9" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0" title="extract information from config file " alt="" coords="479,325,599,351"/><area shape="rect" id="node23" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title="RunModeInitialize" alt="" coords="253,603,379,630"/><area shape="rect" id="node28" href="util-runmodes_8c.html#ab8e9f0da8e016dbd00df5d0b75112432" title="RunModeSetLiveCaptureSingle" alt="" coords="214,705,418,731"/><area shape="rect" id="node31" href="util-time_8c.html#a4c8898901628befb98548be21b599f14" title="TimeModeSetLive" alt="" coords="253,755,379,782"/><area shape="rect" id="node6" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="997,654,1099,681"/><area shape="rect" id="node7" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1403,654,1557,681"/><area shape="rect" id="node8" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1256,325,1317,351"/><area shape="rect" id="node10" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9" title="AFPDerefConfig" alt="" coords="709,451,827,478"/><area shape="rect" id="node11" href="conf_8c.html#a840763787cd0111c51ccbf88230e8369" title="ConfGetChildValueBoolWith\lDefault" alt="" coords="675,132,861,173"/><area shape="rect" id="node15" href="conf_8c.html#ab86b284e0f4390915666fb15b1d09bb7" title="ConfGetChildValueIntWith\lDefault" alt="" coords="680,67,856,108"/><area shape="rect" id="node17" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="947,23,1149,50"/><area shape="rect" id="node18" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="679,502,857,529"/><area shape="rect" id="node19" href="util-ioctl_8c.html#aec432b70f2df0828bde32692c9804c76" title="output offloading status of the link " alt="" coords="983,299,1113,326"/><area shape="rect" id="node20" href="util-ioctl_8c.html#aa757c28cf75465254e6591ce9e27d51c" title="GetIfaceRSSQueuesNum" alt="" coords="961,249,1135,275"/><area shape="rect" id="node21" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="659,198,877,225"/><area shape="rect" id="node12" href="conf_8c.html#ad9d1cb8a5580a48745859b31f8e90e20" title="ConfGetChildValueBool" alt="" coords="968,139,1128,166"/><area shape="rect" id="node13" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="1219,111,1354,138"/><area shape="rect" id="node14" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="1233,206,1340,233"/><area shape="rect" id="node16" href="conf_8c.html#a0ffa455c86982da0089fbf7b8954ef9d" title="ConfGetChildValueInt" alt="" coords="973,82,1123,109"/><area shape="rect" id="node22" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="926,198,1170,225"/><area shape="rect" id="node24" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="490,603,587,630"/><area shape="rect" id="node25" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file. " alt="" coords="671,705,865,731"/><area shape="rect" id="node27" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float. " alt="" coords="489,553,589,579"/><area shape="rect" id="node26" href="util-affinity_8c.html#ab716a16a85291314f6fd64bdf8366abb" title="find affinity by its name " alt="" coords="959,705,1137,731"/><area shape="rect" id="node29" href="util-device_8c.html#a98bf56c79d344f38884b1af3cb36a9ea" title="Get the number of registered devices. " alt="" coords="467,755,610,782"/><area shape="rect" id="node30" href="util-device_8c.html#aeda89d2b7fa6bdef4cfc46d075542e32" title="Get a pointer to the device name at idx. " alt="" coords="467,806,610,833"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_icgraph.png" border="0" usemap="#runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_icgraph" id="runmode-af-packet_8c_a4607fda68e0f4b15bc3207cec646da96_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="213,5,384,32"/><area shape="rect" id="node3" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="433,5,623,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="672,5,723,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1402fe271c8a1f767de444b2d9535722"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RunModeIdsAFPWorkers </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Workers version of the AF_PACKET processing. </p>
<p>Start N threads with each thread doing all the work. </p>

<p>Definition at line <a class="el" href="runmode-af-packet_8c_source.html#l00549">549</a> of file <a class="el" href="runmode-af-packet_8c_source.html">runmode-af-packet.c</a>.</p>

<p>References <a class="el" href="runmode-af-packet_8c_source.html#l00373">AFPConfigGeThreadsCount()</a>, <a class="el" href="source-af-packet_8c_source.html#l00356">AFPPeersListCheck()</a>, <a class="el" href="source-af-packet_8c_source.html#l00339">AFPPeersListInit()</a>, <a class="el" href="conf_8c_source.html#l00331">ConfGet()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00105">ParseAFPConfig()</a>, <a class="el" href="runmodes_8c_source.html#l00910">RunModeInitialize()</a>, <a class="el" href="util-runmodes_8c_source.html#l00411">RunModeSetLiveCaptureWorkers()</a>, <a class="el" href="util-error_8h_source.html#l00219">SC_ERR_RUNMODE</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="util-time_8c_source.html#l00054">TimeModeSetLive()</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="runmode-af-packet_8c_source.html#l00068">RunModeIdsAFPRegister()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_cgraph.png" border="0" usemap="#runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_cgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_cgraph" id="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_cgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8c.html#afa61e4db80a8f7e442c1799ece0a25db" title="AFPConfigGeThreadsCount" alt="" coords="241,299,426,326"/><area shape="rect" id="node3" href="group__afppeers.html#gab125105d3431b81bed5b09db6d6edb0f" title="Check that all AFPPeer got a peer. " alt="" coords="263,350,404,377"/><area shape="rect" id="node4" href="group__afppeers.html#ga54f6e0062f675bc9173cfb348164497f" title="Init the global list of AFPPeer. " alt="" coords="273,401,394,427"/><area shape="rect" id="node5" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="757,553,827,579"/><area shape="rect" id="node9" href="runmode-af-packet_8c.html#aa44206676da7e92c8d5f1b2442dbe2e0" title="extract information from config file " alt="" coords="503,325,623,351"/><area shape="rect" id="node23" href="runmodes_8c.html#a07225b8600c17470752ae849ace81e0f" title="RunModeInitialize" alt="" coords="270,603,397,630"/><area shape="rect" id="node28" href="util-runmodes_8c.html#af172e0dce21aa23e4a6036c741fcb6ca" title="RunModeSetLiveCaptureWorkers" alt="" coords="225,705,442,731"/><area shape="rect" id="node31" href="util-time_8c.html#a4c8898901628befb98548be21b599f14" title="TimeModeSetLive" alt="" coords="270,755,397,782"/><area shape="rect" id="node6" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="1021,654,1123,681"/><area shape="rect" id="node7" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="1427,654,1581,681"/><area shape="rect" id="node8" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="1280,325,1341,351"/><area shape="rect" id="node10" href="runmode-af-packet_8c.html#a02b352fd8b58facd2d8a704bb1e7c8d9" title="AFPDerefConfig" alt="" coords="733,451,851,478"/><area shape="rect" id="node11" href="conf_8c.html#a840763787cd0111c51ccbf88230e8369" title="ConfGetChildValueBoolWith\lDefault" alt="" coords="699,132,885,173"/><area shape="rect" id="node15" href="conf_8c.html#ab86b284e0f4390915666fb15b1d09bb7" title="ConfGetChildValueIntWith\lDefault" alt="" coords="704,67,880,108"/><area shape="rect" id="node17" href="conf_8c.html#a8b5e47bd66a2faa1a70439f5e2aa0650" title="ConfGetChildValueWithDefault" alt="" coords="971,23,1173,50"/><area shape="rect" id="node18" href="conf_8c.html#a440d0a7db98ad1c818882ae03c645a18" title="Lookup for a key value under a specific node. " alt="" coords="703,502,881,529"/><area shape="rect" id="node19" href="util-ioctl_8c.html#aec432b70f2df0828bde32692c9804c76" title="output offloading status of the link " alt="" coords="1007,299,1137,326"/><area shape="rect" id="node20" href="util-ioctl_8c.html#aa757c28cf75465254e6591ce9e27d51c" title="GetIfaceRSSQueuesNum" alt="" coords="985,249,1159,275"/><area shape="rect" id="node21" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="683,198,901,225"/><area shape="rect" id="node12" href="conf_8c.html#ad9d1cb8a5580a48745859b31f8e90e20" title="ConfGetChildValueBool" alt="" coords="992,139,1152,166"/><area shape="rect" id="node13" href="conf_8c.html#aa780b7af154e82aad22fd1317892da52" title="ConfGetChildValue" alt="" coords="1243,111,1378,138"/><area shape="rect" id="node14" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="1257,206,1364,233"/><area shape="rect" id="node16" href="conf_8c.html#a0ffa455c86982da0089fbf7b8954ef9d" title="ConfGetChildValueInt" alt="" coords="997,82,1147,109"/><area shape="rect" id="node22" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="950,198,1194,225"/><area shape="rect" id="node24" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="514,603,611,630"/><area shape="rect" id="node25" href="util-affinity_8c.html#ae1a3c113aa148b64530ae41a0d5aa67f" title="Extract cpu affinity configuration from current config file. " alt="" coords="695,705,889,731"/><area shape="rect" id="node27" href="conf_8c.html#a1383ef0374af39daea9af86c53919c02" title="Retrieve a configuration value as a float. " alt="" coords="513,553,613,579"/><area shape="rect" id="node26" href="util-affinity_8c.html#ab716a16a85291314f6fd64bdf8366abb" title="find affinity by its name " alt="" coords="983,705,1161,731"/><area shape="rect" id="node29" href="util-device_8c.html#a98bf56c79d344f38884b1af3cb36a9ea" title="Get the number of registered devices. " alt="" coords="491,755,634,782"/><area shape="rect" id="node30" href="util-device_8c.html#aeda89d2b7fa6bdef4cfc46d075542e32" title="Get a pointer to the device name at idx. " alt="" coords="491,806,634,833"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_icgraph.png" border="0" usemap="#runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_icgraph" alt=""/></div>
<map name="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_icgraph" id="runmode-af-packet_8c_a1402fe271c8a1f767de444b2d9535722_icgraph">
<area shape="rect" id="node2" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="224,5,395,32"/><area shape="rect" id="node3" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="443,5,634,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="683,5,733,32"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a9c9407e762ec4c855225355ff68934c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int max_pending_packets</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum packets to simultaneously process. </p>

<p>Definition at line <a class="el" href="suricata_8c_source.html#l00233">233</a> of file <a class="el" href="suricata_8c_source.html">suricata.c</a>.</p>

<p>Referenced by <a class="el" href="tmqh-packetpool_8c_source.html#l00364">PacketPoolInit()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00583">PacketPoolPostRunmodes()</a>, <a class="el" href="runmode-af-packet_8c_source.html#l00105">ParseAFPConfig()</a>, <a class="el" href="source-nfq_8c_source.html#l00696">ReceiveNFQThreadInit()</a>, and <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="runmode-af-packet_8c.html">runmode-af-packet.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:09 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
