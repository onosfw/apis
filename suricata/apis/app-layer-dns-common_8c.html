<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/app-layer-dns-common.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('app-layer-dns-common_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">app-layer-dns-common.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream_8h_source.html">stream.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-parser_8h_source.html">app-layer-parser.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="app-layer-dns-common_8h_source.html">app-layer-dns-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-memcmp_8h_source.html">util-memcmp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-atomic_8h_source.html">util-atomic.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for app-layer-dns-common.c:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c__incl.png" border="0" usemap="#src_2app-layer-dns-common_8c" alt=""/></div>
<map name="src_2app-layer-dns-common_8c" id="src_2app-layer-dns-common_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="1875,80,2008,107"/><area shape="rect" id="node43" href="stream_8h.html" title="stream.h" alt="" coords="2695,80,2768,107"/><area shape="rect" id="node44" href="app-layer-parser_8h.html" title="app&#45;layer&#45;parser.h" alt="" coords="2265,229,2391,256"/><area shape="rect" id="node47" href="app-layer-dns-common_8h.html" title="app&#45;layer&#45;dns&#45;common.h" alt="" coords="2575,155,2740,181"/><area shape="rect" id="node50" href="util-memcmp_8h.html" title="util&#45;memcmp.h" alt="" coords="2793,80,2900,107"/><area shape="rect" id="node31" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="2692,528,2785,555"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="1206,155,1279,181"/><area shape="rect" id="node22" href="threads_8h.html" title="threads.h" alt="" coords="101,453,176,480"/><area shape="rect" id="node25" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="2152,155,2301,181"/><area shape="rect" id="node26" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="154,304,243,331"/><area shape="rect" id="node28" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="523,379,603,405"/><area shape="rect" id="node30" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="1825,453,1908,480"/><area shape="rect" id="node32" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1871,155,2011,181"/><area shape="rect" id="node39" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="2777,379,2879,405"/><area shape="rect" id="node41" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="1001,155,1079,181"/><area shape="rect" id="node42" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="1103,155,1181,181"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="1233,304,1316,331"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="437,304,491,331"/><area shape="rect" id="node11" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="227,229,327,256"/><area shape="rect" id="node12" href="htp__config_8h.html" title="htp_config.h" alt="" coords="635,229,728,256"/><area shape="rect" id="node13" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="753,229,916,256"/><area shape="rect" id="node14" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="941,229,1088,256"/><area shape="rect" id="node15" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="1112,229,1205,256"/><area shape="rect" id="node16" href="htp__list_8h.html" title="htp_list.h" alt="" coords="536,229,611,256"/><area shape="rect" id="node17" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="403,229,511,256"/><area shape="rect" id="node18" href="htp__table_8h.html" title="htp_table.h" alt="" coords="861,304,947,331"/><area shape="rect" id="node19" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="1280,229,1403,256"/><area shape="rect" id="node20" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="1427,229,1548,256"/><area shape="rect" id="node21" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="1645,304,1779,331"/><area shape="rect" id="node23" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="101,528,176,555"/><area shape="rect" id="node27" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="326,379,412,405"/><area shape="rect" id="node29" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="176,379,301,405"/><area shape="rect" id="node33" href="decode_8h.html" title="decode.h" alt="" coords="2129,379,2204,405"/><area shape="rect" id="node35" href="detect_8h.html" title="detect.h" alt="" coords="1907,229,1976,256"/><area shape="rect" id="node34" href="app-layer-protos_8h.html" title="app&#45;layer&#45;protos.h" alt="" coords="2315,453,2441,480"/><area shape="rect" id="node36" href="flow_8h.html" title="flow.h" alt="" coords="2634,304,2691,331"/><area shape="rect" id="node40" href="util-file_8h.html" title="util&#45;file.h" alt="" coords="1905,304,1975,331"/><area shape="rect" id="node37" href="util-var_8h.html" title="util&#45;var.h" alt="" coords="2629,379,2701,405"/><area shape="rect" id="node38" href="detect-tag_8h.html" title="detect&#45;tag.h" alt="" coords="2464,379,2555,405"/><area shape="rect" id="node45" href="app-layer-events_8h.html" title="app&#45;layer&#45;events.h" alt="" coords="2102,304,2231,331"/><area shape="rect" id="node46" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine. " alt="" coords="2256,304,2400,331"/><area shape="rect" id="node48" href="queue_8h.html" title="queue.h" alt="" coords="2681,229,2748,256"/><area shape="rect" id="node49" href="util-byte_8h.html" title="util&#45;byte.h" alt="" coords="2425,304,2503,331"/></map>
</div>
</div>
<p><a href="app-layer-dns-common_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDNSConfig__.html">DNSConfig_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a30efc81cc94c62a1227ff07f6cf34ec5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structDNSConfig__.html">DNSConfig_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a30efc81cc94c62a1227ff07f6cf34ec5">DNSConfig</a></td></tr>
<tr class="separator:a30efc81cc94c62a1227ff07f6cf34ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acda5b9d2927c12e46278ccdaf0edb4be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#acda5b9d2927c12e46278ccdaf0edb4be">DNSConfigInit</a> (void)</td></tr>
<tr class="separator:acda5b9d2927c12e46278ccdaf0edb4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af462eb3ba63076e0d18e540c4480664b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#af462eb3ba63076e0d18e540c4480664b">DNSConfigSetRequestFlood</a> (uint32_t value)</td></tr>
<tr class="separator:af462eb3ba63076e0d18e540c4480664b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f194cb6963010f95d263f64d390b007"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a9f194cb6963010f95d263f64d390b007">DNSConfigSetStateMemcap</a> (uint32_t value)</td></tr>
<tr class="separator:a9f194cb6963010f95d263f64d390b007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4065c6f2fe3e47d4df784aa6cff0419"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#af4065c6f2fe3e47d4df784aa6cff0419">SC_ATOMIC_DECLARE</a> (uint64_t, dns_memuse)</td></tr>
<tr class="separator:af4065c6f2fe3e47d4df784aa6cff0419"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a750d3e18b260f86461d7fa7ab12c8bdf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a750d3e18b260f86461d7fa7ab12c8bdf">SC_ATOMIC_DECLARE</a> (uint64_t, dns_memcap_state)</td></tr>
<tr class="separator:a750d3e18b260f86461d7fa7ab12c8bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4968b7d4e43892039cd67a9e98d03f30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a4968b7d4e43892039cd67a9e98d03f30">SC_ATOMIC_DECLARE</a> (uint64_t, dns_memcap_global)</td></tr>
<tr class="separator:a4968b7d4e43892039cd67a9e98d03f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf589cbf224b16b4dde766dee787e8f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#aaf589cbf224b16b4dde766dee787e8f2">DNSConfigSetGlobalMemcap</a> (uint64_t value)</td></tr>
<tr class="separator:aaf589cbf224b16b4dde766dee787e8f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c7da3ba981a212130793e73434ed5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a29c7da3ba981a212130793e73434ed5a">DNSIncrMemcap</a> (uint32_t size, <a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *state)</td></tr>
<tr class="separator:a29c7da3ba981a212130793e73434ed5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83765134e79a71c07572db597c19d768"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a83765134e79a71c07572db597c19d768">DNSDecrMemcap</a> (uint32_t size, <a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *state)</td></tr>
<tr class="separator:a83765134e79a71c07572db597c19d768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84161199802ac8e81f1a2e8774dc1d89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a84161199802ac8e81f1a2e8774dc1d89">DNSCheckMemcap</a> (uint32_t want, <a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *state)</td></tr>
<tr class="separator:a84161199802ac8e81f1a2e8774dc1d89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047c67dd05a49d5bb2bd5f31ec40d9b3"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a047c67dd05a49d5bb2bd5f31ec40d9b3">DNSMemcapGetMemuseCounter</a> (void)</td></tr>
<tr class="separator:a047c67dd05a49d5bb2bd5f31ec40d9b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45586f1e0b9a6d74274c8c9f4d65e6e1"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a45586f1e0b9a6d74274c8c9f4d65e6e1">DNSMemcapGetMemcapStateCounter</a> (void)</td></tr>
<tr class="separator:a45586f1e0b9a6d74274c8c9f4d65e6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cb83bc791b566e1318a14644d004540"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a5cb83bc791b566e1318a14644d004540">DNSMemcapGetMemcapGlobalCounter</a> (void)</td></tr>
<tr class="separator:a5cb83bc791b566e1318a14644d004540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da31710bf608c5657c1d56c5c3d5be4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a7da31710bf608c5657c1d56c5c3d5be4">DNSStateGetEventInfo</a> (const char *event_name, int *event_id, <a class="el" href="app-layer-events_8h.html#aaa257de080ed351a6ffab15bd4af5ace">AppLayerEventType</a> *<a class="el" href="alert-unified2-alert_8c.html#a45def65890de0da17bc0d6e2ca2b3a9f">event_type</a>)</td></tr>
<tr class="separator:a7da31710bf608c5657c1d56c5c3d5be4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793481696e1b95a257ac77e5657e83ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a793481696e1b95a257ac77e5657e83ff">DNSAppLayerRegisterGetEventInfo</a> (uint8_t ipproto, <a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a> alproto)</td></tr>
<tr class="separator:a793481696e1b95a257ac77e5657e83ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79545b066fa2dec22ab83a9b00a1767"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a51fee95fddbd477910dd5c3ea09eab11">AppLayerDecoderEvents</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#aa79545b066fa2dec22ab83a9b00a1767">DNSGetEvents</a> (void *state, uint64_t id)</td></tr>
<tr class="separator:aa79545b066fa2dec22ab83a9b00a1767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa862924f4f882435beadabd0bf3abe47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#aa862924f4f882435beadabd0bf3abe47">DNSHasEvents</a> (void *state)</td></tr>
<tr class="separator:aa862924f4f882435beadabd0bf3abe47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a236df5f89f00a22be7b925f3a6de854e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a236df5f89f00a22be7b925f3a6de854e">DNSGetTx</a> (void *alstate, uint64_t <a class="el" href="app-layer-dns-tcp_8c.html#a882713b0961ecbd2bce014022d2439c3">tx_id</a>)</td></tr>
<tr class="separator:a236df5f89f00a22be7b925f3a6de854e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e19999e967a89a9408b2ab3c0759c8"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#aa2e19999e967a89a9408b2ab3c0759c8">DNSGetTxCnt</a> (void *alstate)</td></tr>
<tr class="separator:aa2e19999e967a89a9408b2ab3c0759c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5314cb6ba856b13a49c39068fb6032ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a5314cb6ba856b13a49c39068fb6032ff">DNSGetAlstateProgress</a> (void *tx, uint8_t direction)</td></tr>
<tr class="separator:a5314cb6ba856b13a49c39068fb6032ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d3a435e01f94e19d47bc5aa104431e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#ad5d3a435e01f94e19d47bc5aa104431e">DNSGetAlstateProgressCompletionStatus</a> (uint8_t direction)</td></tr>
<tr class="memdesc:ad5d3a435e01f94e19d47bc5aa104431e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get value for 'complete' status in DNS  <a href="#ad5d3a435e01f94e19d47bc5aa104431e">More...</a><br/></td></tr>
<tr class="separator:ad5d3a435e01f94e19d47bc5aa104431e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7210bf7334be9c9481afec3008486fcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf">DNSSetEvent</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *s, uint8_t e)</td></tr>
<tr class="separator:a7210bf7334be9c9481afec3008486fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29564e9e5b500620f01230df89be7f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#ad29564e9e5b500620f01230df89be7f2">DNSStateTransactionFree</a> (void *state, uint64_t <a class="el" href="app-layer-dns-tcp_8c.html#a882713b0961ecbd2bce014022d2439c3">tx_id</a>)</td></tr>
<tr class="memdesc:ad29564e9e5b500620f01230df89be7f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">dns transaction cleanup callback  <a href="#ad29564e9e5b500620f01230df89be7f2">More...</a><br/></td></tr>
<tr class="separator:ad29564e9e5b500620f01230df89be7f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f88edf2f3631e5683930e2ecea3b7f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="app-layer-dns-common_8h.html#ad91aa8705935835f67e98a2a8a46adbb">DNSTransaction</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a8f88edf2f3631e5683930e2ecea3b7f7">DNSTransactionFindByTxId</a> (const <a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const uint16_t <a class="el" href="app-layer-dns-tcp_8c.html#a882713b0961ecbd2bce014022d2439c3">tx_id</a>)</td></tr>
<tr class="separator:a8f88edf2f3631e5683930e2ecea3b7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12557305e822910fe3a8039e6942993b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a12557305e822910fe3a8039e6942993b">DNSStateHasTxDetectState</a> (void *alstate)</td></tr>
<tr class="separator:a12557305e822910fe3a8039e6942993b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad86d1ed4ea7789f468acf4001d51a961"><td class="memItemLeft" align="right" valign="top"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#ad86d1ed4ea7789f468acf4001d51a961">DNSGetTxDetectState</a> (void *vtx)</td></tr>
<tr class="separator:ad86d1ed4ea7789f468acf4001d51a961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92419df2df0931bf389707fc487fa520"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a92419df2df0931bf389707fc487fa520">DNSSetTxDetectState</a> (void *alstate, void *vtx, <a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *s)</td></tr>
<tr class="separator:a92419df2df0931bf389707fc487fa520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291a6f0fb8d4d4887237c0d5ed5afa1c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a291a6f0fb8d4d4887237c0d5ed5afa1c">DNSStateAlloc</a> (void)</td></tr>
<tr class="separator:a291a6f0fb8d4d4887237c0d5ed5afa1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ad9b5165043891cdc51fedc4192505d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a5ad9b5165043891cdc51fedc4192505d">DNSStateFree</a> (void *s)</td></tr>
<tr class="separator:a5ad9b5165043891cdc51fedc4192505d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6904ff2ff30b06e27bddee58b3229c15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a6904ff2ff30b06e27bddee58b3229c15">DNSValidateRequestHeader</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const DNSHeader *dns_header)</td></tr>
<tr class="memdesc:a6904ff2ff30b06e27bddee58b3229c15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validation checks for DNS request header.  <a href="#a6904ff2ff30b06e27bddee58b3229c15">More...</a><br/></td></tr>
<tr class="separator:a6904ff2ff30b06e27bddee58b3229c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8347ce3b5d5d0b65e75f587e27bcb4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a2c8347ce3b5d5d0b65e75f587e27bcb4">DNSValidateResponseHeader</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const DNSHeader *dns_header)</td></tr>
<tr class="memdesc:a2c8347ce3b5d5d0b65e75f587e27bcb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validation checks for DNS response header.  <a href="#a2c8347ce3b5d5d0b65e75f587e27bcb4">More...</a><br/></td></tr>
<tr class="separator:a2c8347ce3b5d5d0b65e75f587e27bcb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8672e0d3530aae07fe8eb493c37fb55a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a8672e0d3530aae07fe8eb493c37fb55a">DNSStoreQueryInState</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const uint8_t *fqdn, const uint16_t fqdn_len, const uint16_t <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, const uint16_t <a class="el" href="app-layer-dns-common_8h.html#a23a777b6477f14886601ac4ab446d0e4">class</a>, const uint16_t <a class="el" href="app-layer-dns-tcp_8c.html#a882713b0961ecbd2bce014022d2439c3">tx_id</a>)</td></tr>
<tr class="separator:a8672e0d3530aae07fe8eb493c37fb55a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6abfbc8a4187af939f4f908237acbde"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#ab6abfbc8a4187af939f4f908237acbde">DNSStoreAnswerInState</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const int rtype, const uint8_t *fqdn, const uint16_t fqdn_len, const uint16_t <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, const uint16_t <a class="el" href="app-layer-dns-common_8h.html#a23a777b6477f14886601ac4ab446d0e4">class</a>, const uint16_t <a class="el" href="app-layer-dns-common_8h.html#a48b9f3382e0929bbd75cda2bf2838126">ttl</a>, const uint8_t *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, const uint16_t data_len, const uint16_t <a class="el" href="app-layer-dns-tcp_8c.html#a882713b0961ecbd2bce014022d2439c3">tx_id</a>)</td></tr>
<tr class="separator:ab6abfbc8a4187af939f4f908237acbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af81691096f806dbf5d37465e7cb58ca3"><td class="memItemLeft" align="right" valign="top">const uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#af81691096f806dbf5d37465e7cb58ca3">DNSReponseParse</a> (<a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *dns_state, const DNSHeader *const dns_header, const uint16_t num, const <a class="el" href="app-layer-dns-common_8h.html#afafa10a9f9e114f25c54b5c8583d5fc0">DnsListEnum</a> list, const uint8_t *const input, const uint32_t input_len, const uint8_t *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="separator:af81691096f806dbf5d37465e7cb58ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea80495f638c6adaaa3c8a3e49511ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#a5ea80495f638c6adaaa3c8a3e49511ee">DNSCreateTypeString</a> (uint16_t <a class="el" href="source-erf-file_8c.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, char *<a class="el" href="suricata-common_8h.html#ad8ab729381f270b100f3d05b6c6676fc">str</a>, size_t str_size)</td></tr>
<tr class="separator:a5ea80495f638c6adaaa3c8a3e49511ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb4e27a27ac856eef97111523644278a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#acb4e27a27ac856eef97111523644278a">DNSCreateRcodeString</a> (uint8_t rcode, char *<a class="el" href="suricata-common_8h.html#ad8ab729381f270b100f3d05b6c6676fc">str</a>, size_t str_size)</td></tr>
<tr class="separator:acb4e27a27ac856eef97111523644278a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac282d48b3b813fc5750871ad68153955"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-enum_8h.html#aa767e19b2a4cca00fe17a3e338412a95">SCEnumCharMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="app-layer-dns-common_8c.html#ac282d48b3b813fc5750871ad68153955">dns_decoder_event_table</a> []</td></tr>
<tr class="separator:ac282d48b3b813fc5750871ad68153955"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd></dl>

<p>Definition in file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a30efc81cc94c62a1227ff07f6cf34ec5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structDNSConfig__.html">DNSConfig_</a>  <a class="el" href="app-layer-dns-common_8c.html#a30efc81cc94c62a1227ff07f6cf34ec5">DNSConfig</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a793481696e1b95a257ac77e5657e83ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSAppLayerRegisterGetEventInfo </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ipproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-protos_8h.html#a043448cc6c2d329e578b260150bc5bd0">AppProto</a>&#160;</td>
          <td class="paramname"><em>alproto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00152">152</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-parser_8c_source.html#l00464">AppLayerParserRegisterGetEventInfo()</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00136">DNSStateGetEventInfo()</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_cgraph" id="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_cgraph">
<area shape="rect" id="node2" href="app-layer-parser_8c.html#a4464abdb35bc030e13e77c20fa812e31" title="AppLayerParserRegisterGet\lEventInfo" alt="" coords="286,5,471,46"/><area shape="rect" id="node4" href="app-layer-dns-common_8c.html#a7da31710bf608c5657c1d56c5c3d5be4" title="DNSStateGetEventInfo" alt="" coords="299,71,458,97"/><area shape="rect" id="node3" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="537,12,687,39"/><area shape="rect" id="node5" href="util-enum_8c.html#a2e507ba652ee97a1236829e43aace073" title="Maps a string name to an enum value from the supplied table. Please specify the last element of any m..." alt="" coords="521,71,703,97"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_icgraph" id="app-layer-dns-common_8c_a793481696e1b95a257ac77e5657e83ff_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="287,31,459,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="286,81,461,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="510,49,722,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="771,56,882,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="959,107,1057,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="957,5,1059,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="931,56,1085,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1133,56,1283,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1331,81,1381,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84161199802ac8e81f1a2e8774dc1d89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSCheckMemcap </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>want</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00088">88</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00092">DNS_DECODER_EVENT_STATE_MEMCAP_REACHED</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00248">DNSSetEvent()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00037">DNSConfig_::global_memcap</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00184">DNSState_::memuse</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00036">DNSConfig_::state_memcap</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00586">DNSStoreAnswerInState()</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00528">DNSStoreQueryInState()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_cgraph" id="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="193,12,298,39"/><area shape="rect" id="node3" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="347,5,533,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_icgraph" id="app-layer-dns-common_8c_a84161199802ac8e81f1a2e8774dc1d89_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#ab6abfbc8a4187af939f4f908237acbde" title="DNSStoreAnswerInState" alt="" coords="192,5,360,32"/><area shape="rect" id="node4" href="app-layer-dns-common_8h.html#a8672e0d3530aae07fe8eb493c37fb55a" title="DNSStoreQueryInState" alt="" coords="197,56,355,83"/><area shape="rect" id="node3" href="app-layer-dns-common_8h.html#af81691096f806dbf5d37465e7cb58ca3" title="DNSReponseParse" alt="" coords="409,5,546,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acda5b9d2927c12e46278ccdaf0edb4be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSConfigInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00041">41</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaf589cbf224b16b4dde766dee787e8f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSConfigSetGlobalMemcap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00060">60</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8c_source.html#l00037">DNSConfig_::global_memcap</a>, and <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>.</p>

</div>
</div>
<a class="anchor" id="af462eb3ba63076e0d18e540c4480664b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSConfigSetRequestFlood </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00046">46</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8c_source.html#l00035">DNSConfig_::request_flood</a>.</p>

</div>
</div>
<a class="anchor" id="a9f194cb6963010f95d263f64d390b007"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSConfigSetStateMemcap </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00051">51</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8c_source.html#l00036">DNSConfig_::state_memcap</a>.</p>

</div>
</div>
<a class="anchor" id="acb4e27a27ac856eef97111523644278a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSCreateRcodeString </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>str_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l01078">1078</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00082">DNS_RCODE_BADALG</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00078">DNS_RCODE_BADKEY</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00080">DNS_RCODE_BADMODE</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00081">DNS_RCODE_BADNAME</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00079">DNS_RCODE_BADTIME</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00083">DNS_RCODE_BADTRUNC</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00076">DNS_RCODE_BADVERS</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00064">DNS_RCODE_FORMERR</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00063">DNS_RCODE_NOERROR</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00072">DNS_RCODE_NOTAUTH</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00067">DNS_RCODE_NOTIMP</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00073">DNS_RCODE_NOTZONE</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00066">DNS_RCODE_NXDOMAIN</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00071">DNS_RCODE_NXRRSET</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00068">DNS_RCODE_REFUSED</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00065">DNS_RCODE_SERVFAIL</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00069">DNS_RCODE_YXDOMAIN</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00070">DNS_RCODE_YXRRSET</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

</div>
</div>
<a class="anchor" id="a5ea80495f638c6adaaa3c8a3e49511ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSCreateTypeString </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>str_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l01019">1019</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00035">DNS_RECORD_TYPE_A</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00045">DNS_RECORD_TYPE_AAAA</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00061">DNS_RECORD_TYPE_ANY</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">DNS_RECORD_TYPE_CNAME</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00051">DNS_RECORD_TYPE_DS</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00042">DNS_RECORD_TYPE_MX</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00049">DNS_RECORD_TYPE_NAPTR</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00036">DNS_RECORD_TYPE_NS</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00054">DNS_RECORD_TYPE_NSEC</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00056">DNS_RECORD_TYPE_NSEC3</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">DNS_RECORD_TYPE_PTR</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00053">DNS_RECORD_TYPE_RRSIG</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">DNS_RECORD_TYPE_SOA</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00047">DNS_RECORD_TYPE_SRV</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00058">DNS_RECORD_TYPE_TKEY</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00059">DNS_RECORD_TYPE_TSIG</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00043">DNS_RECORD_TYPE_TXT</a>.</p>

</div>
</div>
<a class="anchor" id="a83765134e79a71c07572db597c19d768"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSDecrMemcap </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; TODO remove later</p>
<p>&lt; TODO remove later </p>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00077">77</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00184">DNSState_::memuse</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, and <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00424">DNSStateFree()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a83765134e79a71c07572db597c19d768_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a83765134e79a71c07572db597c19d768_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a83765134e79a71c07572db597c19d768_icgraph" id="app-layer-dns-common_8c_a83765134e79a71c07572db597c19d768_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#a5ad9b5165043891cdc51fedc4192505d" title="DNSStateFree" alt="" coords="185,56,293,83"/><area shape="rect" id="node3" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="343,31,515,57"/><area shape="rect" id="node11" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="342,81,517,108"/><area shape="rect" id="node4" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="566,49,778,90"/><area shape="rect" id="node5" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="827,56,938,83"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1015,107,1113,133"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1013,5,1115,32"/><area shape="rect" id="node10" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="987,56,1141,83"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1189,56,1339,83"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1387,81,1437,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5314cb6ba856b13a49c39068fb6032ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSGetAlstateProgress </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00223">223</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00161">DNSTransaction_::replied</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00163">DNSTransaction_::reply_lost</a>, and <a class="el" href="stream_8h_source.html#l00032">STREAM_TOCLIENT</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a5314cb6ba856b13a49c39068fb6032ff_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a5314cb6ba856b13a49c39068fb6032ff_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a5314cb6ba856b13a49c39068fb6032ff_icgraph" id="app-layer-dns-common_8c_a5314cb6ba856b13a49c39068fb6032ff_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="221,31,393,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="219,81,394,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="443,49,655,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="705,56,815,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="892,107,991,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="891,5,992,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="865,56,1018,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1067,56,1216,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1264,81,1315,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad5d3a435e01f94e19d47bc5aa104431e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSGetAlstateProgressCompletionStatus </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>direction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get value for 'complete' status in DNS </p>
<p>For DNS we use a simple bool. 1 means done. </p>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00243">243</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_ad5d3a435e01f94e19d47bc5aa104431e_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_ad5d3a435e01f94e19d47bc5aa104431e_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_ad5d3a435e01f94e19d47bc5aa104431e_icgraph" id="app-layer-dns-common_8c_ad5d3a435e01f94e19d47bc5aa104431e_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="287,31,459,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="286,81,461,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="510,49,722,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="771,56,882,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="959,107,1057,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="957,5,1059,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="931,56,1085,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1133,56,1283,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1331,81,1381,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa79545b066fa2dec22ab83a9b00a1767"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a51fee95fddbd477910dd5c3ea09eab11">AppLayerDecoderEvents</a>* DNSGetEvents </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00159">159</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00171">DNSTransaction_::decoder_events</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="queue_8h_source.html#l00344">TAILQ_FOREACH</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00159">DNSTransaction_::tx_num</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_aa79545b066fa2dec22ab83a9b00a1767_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_aa79545b066fa2dec22ab83a9b00a1767_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_aa79545b066fa2dec22ab83a9b00a1767_icgraph" id="app-layer-dns-common_8c_aa79545b066fa2dec22ab83a9b00a1767_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="170,31,342,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="169,81,343,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="393,49,605,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="654,56,765,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="841,107,940,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="840,5,941,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="814,56,967,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1016,56,1165,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1213,81,1264,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a236df5f89f00a22be7b925f3a6de854e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* DNSGetTx </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alstate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00181">181</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00181">DNSState_::iter</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="queue_8h_source.html#l00344">TAILQ_FOREACH</a>, <a class="el" href="queue_8h_source.html#l00335">TAILQ_NEXT</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00159">DNSTransaction_::tx_num</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a236df5f89f00a22be7b925f3a6de854e_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a236df5f89f00a22be7b925f3a6de854e_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a236df5f89f00a22be7b925f3a6de854e_icgraph" id="app-layer-dns-common_8c_a236df5f89f00a22be7b925f3a6de854e_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="143,31,315,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="142,81,317,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="366,49,578,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="627,56,738,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="815,107,913,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="813,5,915,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="787,56,941,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="989,56,1139,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1187,81,1237,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa2e19999e967a89a9408b2ab3c0759c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t DNSGetTxCnt </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alstate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00217">217</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00182">DNSState_::transaction_max</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_aa2e19999e967a89a9408b2ab3c0759c8_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_aa2e19999e967a89a9408b2ab3c0759c8_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_aa2e19999e967a89a9408b2ab3c0759c8_icgraph" id="app-layer-dns-common_8c_aa2e19999e967a89a9408b2ab3c0759c8_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="165,31,337,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="163,81,338,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="387,49,599,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="649,56,759,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="836,107,935,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="835,5,936,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="809,56,962,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1011,56,1160,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1208,81,1259,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad86d1ed4ea7789f468acf4001d51a961"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a>* DNSGetTxDetectState </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00393">393</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00174">DNSTransaction_::de_state</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_ad86d1ed4ea7789f468acf4001d51a961_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_ad86d1ed4ea7789f468acf4001d51a961_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_ad86d1ed4ea7789f468acf4001d51a961_icgraph" id="app-layer-dns-common_8c_ad86d1ed4ea7789f468acf4001d51a961_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="213,31,385,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="211,81,386,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="435,49,647,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="697,56,807,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="884,107,983,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="883,5,984,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="857,56,1010,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1059,56,1208,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1256,81,1307,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa862924f4f882435beadabd0bf3abe47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSHasEvents </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00175">175</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00188">DNSState_::events</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_aa862924f4f882435beadabd0bf3abe47_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_aa862924f4f882435beadabd0bf3abe47_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_aa862924f4f882435beadabd0bf3abe47_icgraph" id="app-layer-dns-common_8c_aa862924f4f882435beadabd0bf3abe47_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="173,31,345,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="171,81,346,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="395,49,607,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="657,56,767,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="844,107,943,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="843,5,944,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="817,56,970,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1019,56,1168,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1216,81,1267,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a29c7da3ba981a212130793e73434ed5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSIncrMemcap </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00069">69</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00184">DNSState_::memuse</a>, and <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00408">DNSStateAlloc()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00586">DNSStoreAnswerInState()</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00528">DNSStoreQueryInState()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a29c7da3ba981a212130793e73434ed5a_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a29c7da3ba981a212130793e73434ed5a_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a29c7da3ba981a212130793e73434ed5a_icgraph" id="app-layer-dns-common_8c_a29c7da3ba981a212130793e73434ed5a_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#a291a6f0fb8d4d4887237c0d5ed5afa1c" title="DNSStateAlloc" alt="" coords="205,81,315,108"/><area shape="rect" id="node12" href="app-layer-dns-common_8h.html#ab6abfbc8a4187af939f4f908237acbde" title="DNSStoreAnswerInState" alt="" coords="176,132,344,159"/><area shape="rect" id="node14" href="app-layer-dns-common_8h.html#a8672e0d3530aae07fe8eb493c37fb55a" title="DNSStoreQueryInState" alt="" coords="181,183,339,209"/><area shape="rect" id="node3" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="394,31,566,57"/><area shape="rect" id="node11" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="393,81,567,108"/><area shape="rect" id="node4" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="617,49,829,90"/><area shape="rect" id="node5" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="878,56,989,83"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1065,107,1164,133"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1064,5,1165,32"/><area shape="rect" id="node10" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="1038,56,1191,83"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1240,56,1389,83"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1437,81,1488,108"/><area shape="rect" id="node13" href="app-layer-dns-common_8h.html#af81691096f806dbf5d37465e7cb58ca3" title="DNSReponseParse" alt="" coords="411,132,549,159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5cb83bc791b566e1318a14644d004540"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t DNSMemcapGetMemcapGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00118">118</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00645">AppLayerRegisterGlobalCounters()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a5cb83bc791b566e1318a14644d004540_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a5cb83bc791b566e1318a14644d004540_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a5cb83bc791b566e1318a14644d004540_icgraph" id="app-layer-dns-common_8c_a5cb83bc791b566e1318a14644d004540_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a3377beeacc15bacc2a730feadfb6a1ee" title="HACK to work around our broken unix manager (re)init loop. " alt="" coords="264,12,480,39"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="528,12,579,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45586f1e0b9a6d74274c8c9f4d65e6e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t DNSMemcapGetMemcapStateCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00112">112</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00645">AppLayerRegisterGlobalCounters()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a45586f1e0b9a6d74274c8c9f4d65e6e1_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a45586f1e0b9a6d74274c8c9f4d65e6e1_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a45586f1e0b9a6d74274c8c9f4d65e6e1_icgraph" id="app-layer-dns-common_8c_a45586f1e0b9a6d74274c8c9f4d65e6e1_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a3377beeacc15bacc2a730feadfb6a1ee" title="HACK to work around our broken unix manager (re)init loop. " alt="" coords="304,5,520,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="568,5,619,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a047c67dd05a49d5bb2bd5f31ec40d9b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t DNSMemcapGetMemuseCounter </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00106">106</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00645">AppLayerRegisterGlobalCounters()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a047c67dd05a49d5bb2bd5f31ec40d9b3_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a047c67dd05a49d5bb2bd5f31ec40d9b3_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a047c67dd05a49d5bb2bd5f31ec40d9b3_icgraph" id="app-layer-dns-common_8c_a047c67dd05a49d5bb2bd5f31ec40d9b3_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a3377beeacc15bacc2a730feadfb6a1ee" title="HACK to work around our broken unix manager (re)init loop. " alt="" coords="272,5,488,32"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="536,5,587,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af81691096f806dbf5d37465e7cb58ca3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t* DNSReponseParse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DNSHeader *const&#160;</td>
          <td class="paramname"><em>dns_header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="app-layer-dns-common_8h.html#afafa10a9f9e114f25c54b5c8583d5fc0">DnsListEnum</a>&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>input_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00773">773</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00114">DNSAnswerHeader_::class</a>, <a class="el" href="app-layer-htp_8h_source.html#l00506">data</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00033">DNS_MAX_SIZE</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00035">DNS_RECORD_TYPE_A</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00045">DNS_RECORD_TYPE_AAAA</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">DNS_RECORD_TYPE_CNAME</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00042">DNS_RECORD_TYPE_MX</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00036">DNS_RECORD_TYPE_NS</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">DNS_RECORD_TYPE_PTR</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">DNS_RECORD_TYPE_SOA</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00043">DNS_RECORD_TYPE_TXT</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00586">DNSStoreAnswerInState()</a>, <a class="el" href="flow-hash_8h_source.html#l00203">head</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00116">DNSAnswerHeader_::len</a>, <a class="el" href="util-print_8c_source.html#l00136">PrintRawDataFp()</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="flow-hash_8h_source.html#l00204">tail</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00115">DNSAnswerHeader_::ttl</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00113">DNSAnswerHeader_::type</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_af81691096f806dbf5d37465e7cb58ca3_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_af81691096f806dbf5d37465e7cb58ca3_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_af81691096f806dbf5d37465e7cb58ca3_cgraph" id="app-layer-dns-common_8c_af81691096f806dbf5d37465e7cb58ca3_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#ab6abfbc8a4187af939f4f908237acbde" title="DNSStoreAnswerInState" alt="" coords="192,56,360,83"/><area shape="rect" id="node8" href="util-print_8c.html#ae571482664d670a7c18ae627c32f7e25" title="PrintRawDataFp" alt="" coords="217,107,335,133"/><area shape="rect" id="node3" href="app-layer-dns-common_8c.html#a8f88edf2f3631e5683930e2ecea3b7f7" title="DNSTransactionFindByTxId" alt="" coords="408,5,595,32"/><area shape="rect" id="node4" href="app-layer-dns-common_8c.html#a84161199802ac8e81f1a2e8774dc1d89" title="DNSCheckMemcap" alt="" coords="432,56,571,83"/><area shape="rect" id="node7" href="app-layer-dns-common_8c.html#a29c7da3ba981a212130793e73434ed5a" title="DNSIncrMemcap" alt="" coords="440,107,563,133"/><area shape="rect" id="node5" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="643,56,749,83"/><area shape="rect" id="node6" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="797,49,984,90"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7210bf7334be9c9481afec3008486fcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSSetEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00248">248</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-events_8c_source.html#l00069">AppLayerDecoderEventsSetEventRaw()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00171">DNSTransaction_::decoder_events</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00188">DNSState_::events</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00088">DNSCheckMemcap()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00528">DNSStoreQueryInState()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00458">DNSValidateRequestHeader()</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00486">DNSValidateResponseHeader()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_cgraph" id="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_cgraph">
<area shape="rect" id="node2" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="160,5,347,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_icgraph" id="app-layer-dns-common_8c_a7210bf7334be9c9481afec3008486fcf_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#a84161199802ac8e81f1a2e8774dc1d89" title="DNSCheckMemcap" alt="" coords="191,56,329,83"/><area shape="rect" id="node3" href="app-layer-dns-common_8h.html#a8672e0d3530aae07fe8eb493c37fb55a" title="DNSStoreQueryInState" alt="" coords="413,5,571,32"/><area shape="rect" id="node6" href="app-layer-dns-common_8h.html#a8f868898d2442cd7cffbcb17d5d29728" title="Validation checks for DNS request header. " alt="" coords="165,107,355,133"/><area shape="rect" id="node7" href="app-layer-dns-common_8h.html#aa27c4d322534fd4004ead861b71821a2" title="Validation checks for DNS response header. " alt="" coords="161,157,359,184"/><area shape="rect" id="node4" href="app-layer-dns-common_8h.html#ab6abfbc8a4187af939f4f908237acbde" title="DNSStoreAnswerInState" alt="" coords="408,56,576,83"/><area shape="rect" id="node5" href="app-layer-dns-common_8h.html#af81691096f806dbf5d37465e7cb58ca3" title="DNSReponseParse" alt="" coords="625,56,762,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92419df2df0931bf389707fc487fa520"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSSetTxDetectState </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alstate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect-engine-state_8h.html#a37b174e37235e6bec575e889cc0b118e">DetectEngineState</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00399">399</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00174">DNSTransaction_::de_state</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00186">DNSState_::tx_with_detect_state_cnt</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a92419df2df0931bf389707fc487fa520_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a92419df2df0931bf389707fc487fa520_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a92419df2df0931bf389707fc487fa520_icgraph" id="app-layer-dns-common_8c_a92419df2df0931bf389707fc487fa520_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="213,31,385,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="211,81,386,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="435,49,647,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="697,56,807,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="884,107,983,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="883,5,984,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="857,56,1010,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1059,56,1208,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1256,81,1307,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a291a6f0fb8d4d4887237c0d5ed5afa1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* DNSStateAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00408">408</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8c_source.html#l00069">DNSIncrMemcap()</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="queue_8h_source.html#l00364">TAILQ_INIT</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_cgraph" id="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a29c7da3ba981a212130793e73434ed5a" title="DNSIncrMemcap" alt="" coords="165,5,288,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_icgraph" id="app-layer-dns-common_8c_a291a6f0fb8d4d4887237c0d5ed5afa1c_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="167,31,339,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="166,81,341,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="390,49,602,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="651,56,762,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="839,107,937,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="837,5,939,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="811,56,965,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1013,56,1163,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1211,81,1261,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5ad9b5165043891cdc51fedc4192505d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSStateFree </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TODO update if/once we alloc in a smarter way </p>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00424">424</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00194">DNSState_::buffer</a>, <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00077">DNSDecrMemcap()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00184">DNSState_::memuse</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="queue_8h_source.html#l00333">TAILQ_FIRST</a>, <a class="el" href="queue_8h_source.html#l00403">TAILQ_REMOVE</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00186">DNSState_::tx_with_detect_state_cnt</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_cgraph" id="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a83765134e79a71c07572db597c19d768" title="DNSDecrMemcap" alt="" coords="163,5,293,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_icgraph" id="app-layer-dns-common_8c_a5ad9b5165043891cdc51fedc4192505d_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="165,31,337,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="163,81,338,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="387,49,599,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="649,56,759,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="836,107,935,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="835,5,936,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="809,56,962,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1011,56,1160,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1208,81,1259,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7da31710bf608c5657c1d56c5c3d5be4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSStateGetEventInfo </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>event_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="app-layer-events_8h.html#aaa257de080ed351a6ffab15bd4af5ace">AppLayerEventType</a> *&#160;</td>
          <td class="paramname"><em>event_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00136">136</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-events_8h_source.html#l00054">APP_LAYER_EVENT_TYPE_TRANSACTION</a>, <a class="el" href="util-error_8h_source.html#l00045">SC_ERR_INVALID_ENUM_MAP</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, and <a class="el" href="util-enum_8c_source.html#l00040">SCMapEnumNameToValue()</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00152">DNSAppLayerRegisterGetEventInfo()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_cgraph" id="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_cgraph">
<area shape="rect" id="node2" href="util-enum_8c.html#a2e507ba652ee97a1236829e43aace073" title="Maps a string name to an enum value from the supplied table. Please specify the last element of any m..." alt="" coords="214,5,397,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_icgraph" id="app-layer-dns-common_8c_a7da31710bf608c5657c1d56c5c3d5be4_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#a793481696e1b95a257ac77e5657e83ff" title="DNSAppLayerRegisterGetEventInfo" alt="" coords="213,56,445,83"/><area shape="rect" id="node3" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="495,31,667,57"/><area shape="rect" id="node11" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="494,81,669,108"/><area shape="rect" id="node4" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="718,49,930,90"/><area shape="rect" id="node5" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="979,56,1090,83"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1167,107,1265,133"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="1165,5,1267,32"/><area shape="rect" id="node10" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="1139,56,1293,83"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1341,56,1491,83"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1539,81,1589,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a12557305e822910fe3a8039e6942993b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSStateHasTxDetectState </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>alstate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00387">387</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00186">DNSState_::tx_with_detect_state_cnt</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a12557305e822910fe3a8039e6942993b_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a12557305e822910fe3a8039e6942993b_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a12557305e822910fe3a8039e6942993b_icgraph" id="app-layer-dns-common_8c_a12557305e822910fe3a8039e6942993b_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="247,31,419,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="246,81,421,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="470,49,682,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="731,56,842,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="919,107,1017,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="917,5,1019,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="891,56,1045,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1093,56,1243,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1291,81,1341,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad29564e9e5b500620f01230df89be7f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSStateTransactionFree </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dns transaction cleanup callback </p>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00328">328</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-events_8h_source.html#l00038">AppLayerDecoderEvents_::cnt</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00171">DNSTransaction_::decoder_events</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00188">DNSState_::events</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="queue_8h_source.html#l00344">TAILQ_FOREACH</a>, <a class="el" href="queue_8h_source.html#l00403">TAILQ_REMOVE</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00159">DNSTransaction_::tx_num</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-tcp_8c_source.html#l00609">RegisterDNSTCPParsers()</a>, and <a class="el" href="app-layer-dns-udp_8c_source.html#l00365">RegisterDNSUDPParsers()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_ad29564e9e5b500620f01230df89be7f2_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_ad29564e9e5b500620f01230df89be7f2_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_ad29564e9e5b500620f01230df89be7f2_icgraph" id="app-layer-dns-common_8c_ad29564e9e5b500620f01230df89be7f2_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-tcp_8h.html#ac637e7cedd8afd651b1cf217d654d285" title="RegisterDNSTCPParsers" alt="" coords="231,31,403,57"/><area shape="rect" id="node10" href="app-layer-dns-udp_8h.html#a621fd6c4064a0962df00a7dff98c3e12" title="RegisterDNSUDPParsers" alt="" coords="230,81,405,108"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#ac5c64e1bddd13fdc99168538935cfab5" title="AppLayerParserRegisterProtocol\lParsers" alt="" coords="454,49,666,90"/><area shape="rect" id="node4" href="app-layer_8h.html#a13e4dfafdc60d054467da61ea15744f9" title="Setup the app layer. " alt="" coords="715,56,826,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="903,107,1001,133"/><area shape="rect" id="node8" href="util-running-modes_8h.html#ae9bfc8f4014e5f4b09938921cc5ba4fb" title="ListKeywords" alt="" coords="901,5,1003,32"/><area shape="rect" id="node9" href="util-running-modes_8h.html#ad03a2414917a2fc87f4be0370c4c8fd7" title="ListAppLayerProtocols" alt="" coords="875,56,1029,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1077,56,1227,83"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1275,81,1325,108"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab6abfbc8a4187af939f4f908237acbde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSStoreAnswerInState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>rtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>fqdn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>fqdn_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>tx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00586">586</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00149">DNSAnswerEntry_::class</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00154">DNSAnswerEntry_::data_len</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00123">DNS_LIST_ANSWER</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00124">DNS_LIST_AUTHORITY</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00088">DNSCheckMemcap()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00069">DNSIncrMemcap()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00365">DNSTransactionFindByTxId()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00153">DNSAnswerEntry_::fqdn_len</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00161">DNSTransaction_::replied</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="queue_8h_source.html#l00379">TAILQ_INSERT_TAIL</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00182">DNSState_::transaction_max</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00040">ttl</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00151">DNSAnswerEntry_::ttl</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00159">DNSTransaction_::tx_num</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00148">DNSAnswerEntry_::type</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00183">DNSState_::unreplied_cnt</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00773">DNSReponseParse()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_cgraph" id="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a84161199802ac8e81f1a2e8774dc1d89" title="DNSCheckMemcap" alt="" coords="245,12,384,39"/><area shape="rect" id="node5" href="app-layer-dns-common_8c.html#a29c7da3ba981a212130793e73434ed5a" title="DNSIncrMemcap" alt="" coords="253,63,376,89"/><area shape="rect" id="node6" href="app-layer-dns-common_8c.html#a8f88edf2f3631e5683930e2ecea3b7f7" title="DNSTransactionFindByTxId" alt="" coords="221,113,408,140"/><area shape="rect" id="node3" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="457,12,562,39"/><area shape="rect" id="node4" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="611,5,797,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_icgraph" id="app-layer-dns-common_8c_ab6abfbc8a4187af939f4f908237acbde_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#af81691096f806dbf5d37465e7cb58ca3" title="DNSReponseParse" alt="" coords="222,5,359,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8672e0d3530aae07fe8eb493c37fb55a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DNSStoreQueryInState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>fqdn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>fqdn_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>tx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00528">528</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00135">DNSQueryEntry_::class</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00091">DNS_DECODER_EVENT_FLOODED</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00088">DNSCheckMemcap()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00069">DNSIncrMemcap()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00248">DNSSetEvent()</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00365">DNSTransactionFindByTxId()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00189">DNSState_::givenup</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00136">DNSQueryEntry_::len</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00161">DNSTransaction_::replied</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00163">DNSTransaction_::reply_lost</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00035">DNSConfig_::request_flood</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="queue_8h_source.html#l00379">TAILQ_INSERT_TAIL</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00182">DNSState_::transaction_max</a>, <a class="el" href="suricata-common_8h_source.html#l00033">TRUE</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00160">DNSTransaction_::tx_id</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00159">DNSTransaction_::tx_num</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00038">type</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00134">DNSQueryEntry_::type</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00183">DNSState_::unreplied_cnt</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a8672e0d3530aae07fe8eb493c37fb55a_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a8672e0d3530aae07fe8eb493c37fb55a_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a8672e0d3530aae07fe8eb493c37fb55a_cgraph" id="app-layer-dns-common_8c_a8672e0d3530aae07fe8eb493c37fb55a_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a84161199802ac8e81f1a2e8774dc1d89" title="DNSCheckMemcap" alt="" coords="237,5,376,32"/><area shape="rect" id="node5" href="app-layer-dns-common_8c.html#a29c7da3ba981a212130793e73434ed5a" title="DNSIncrMemcap" alt="" coords="245,56,368,83"/><area shape="rect" id="node3" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="449,56,554,83"/><area shape="rect" id="node6" href="app-layer-dns-common_8c.html#a8f88edf2f3631e5683930e2ecea3b7f7" title="DNSTransactionFindByTxId" alt="" coords="213,157,400,184"/><area shape="rect" id="node4" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="603,49,789,90"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8f88edf2f3631e5683930e2ecea3b7f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="app-layer-dns-common_8h.html#ad91aa8705935835f67e98a2a8a46adbb">DNSTransaction</a>* DNSTransactionFindByTxId </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>tx_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00365">365</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00180">DNSState_::curr</a>, <a class="el" href="app-layer-htp_8h_source.html#l00507">next</a>, <a class="el" href="queue_8h_source.html#l00344">TAILQ_FOREACH</a>, and <a class="el" href="app-layer-dns-common_8h_source.html#l00160">DNSTransaction_::tx_id</a>.</p>

<p>Referenced by <a class="el" href="app-layer-dns-common_8c_source.html#l00586">DNSStoreAnswerInState()</a>, and <a class="el" href="app-layer-dns-common_8c_source.html#l00528">DNSStoreQueryInState()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a8f88edf2f3631e5683930e2ecea3b7f7_icgraph.png" border="0" usemap="#app-layer-dns-common_8c_a8f88edf2f3631e5683930e2ecea3b7f7_icgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a8f88edf2f3631e5683930e2ecea3b7f7_icgraph" id="app-layer-dns-common_8c_a8f88edf2f3631e5683930e2ecea3b7f7_icgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8h.html#ab6abfbc8a4187af939f4f908237acbde" title="DNSStoreAnswerInState" alt="" coords="240,5,408,32"/><area shape="rect" id="node4" href="app-layer-dns-common_8h.html#a8672e0d3530aae07fe8eb493c37fb55a" title="DNSStoreQueryInState" alt="" coords="245,56,403,83"/><area shape="rect" id="node3" href="app-layer-dns-common_8h.html#af81691096f806dbf5d37465e7cb58ca3" title="DNSReponseParse" alt="" coords="457,5,594,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6904ff2ff30b06e27bddee58b3229c15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSValidateRequestHeader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DNSHeader *&#160;</td>
          <td class="paramname"><em>dns_header</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validation checks for DNS request header. </p>
<p>Will set decoder events if anomalies are found.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00458">458</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00088">DNS_DECODER_EVENT_NOT_A_REQUEST</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00090">DNS_DECODER_EVENT_Z_FLAG_SET</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00248">DNSSetEvent()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">flags</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a6904ff2ff30b06e27bddee58b3229c15_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a6904ff2ff30b06e27bddee58b3229c15_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a6904ff2ff30b06e27bddee58b3229c15_cgraph" id="app-layer-dns-common_8c_a6904ff2ff30b06e27bddee58b3229c15_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="243,12,349,39"/><area shape="rect" id="node3" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="397,5,584,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2c8347ce3b5d5d0b65e75f587e27bcb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DNSValidateResponseHeader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="app-layer-dns-common_8h.html#aa4a47703d59d13f9b3f80f24a01f4d4e">DNSState</a> *&#160;</td>
          <td class="paramname"><em>dns_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DNSHeader *&#160;</td>
          <td class="paramname"><em>dns_header</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validation checks for DNS response header. </p>
<p>Will set decoder events if anomalies are found.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00486">486</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

<p>References <a class="el" href="app-layer-dns-common_8h_source.html#l00089">DNS_DECODER_EVENT_NOT_A_RESPONSE</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00090">DNS_DECODER_EVENT_Z_FLAG_SET</a>, <a class="el" href="app-layer-dns-common_8c_source.html#l00248">DNSSetEvent()</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00039">flags</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="app-layer-dns-common_8c_a2c8347ce3b5d5d0b65e75f587e27bcb4_cgraph.png" border="0" usemap="#app-layer-dns-common_8c_a2c8347ce3b5d5d0b65e75f587e27bcb4_cgraph" alt=""/></div>
<map name="app-layer-dns-common_8c_a2c8347ce3b5d5d0b65e75f587e27bcb4_cgraph" id="app-layer-dns-common_8c_a2c8347ce3b5d5d0b65e75f587e27bcb4_cgraph">
<area shape="rect" id="node2" href="app-layer-dns-common_8c.html#a7210bf7334be9c9481afec3008486fcf" title="DNSSetEvent" alt="" coords="254,12,359,39"/><area shape="rect" id="node3" href="app-layer-events_8c.html#aa19aec45221296320307ef2e2803780c" title="Set an app layer decoder event. " alt="" coords="408,5,595,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af4065c6f2fe3e47d4df784aa6cff0419"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dns_memuse&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>byte counter of current memuse </p>

</div>
</div>
<a class="anchor" id="a750d3e18b260f86461d7fa7ab12c8bdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dns_memcap_state&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>counts number of 'rejects' </p>

</div>
</div>
<a class="anchor" id="a4968b7d4e43892039cd67a9e98d03f30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SC_ATOMIC_DECLARE </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dns_memcap_global&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>counts number of 'rejects' </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac282d48b3b813fc5750871ad68153955"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-enum_8h.html#aa767e19b2a4cca00fe17a3e338412a95">SCEnumCharMap</a> dns_decoder_event_table[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    { <span class="stringliteral">&quot;UNSOLLICITED_RESPONSE&quot;</span>,      <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5ac6155019a18ae6e3e27e9a5b7baabc3e">DNS_DECODER_EVENT_UNSOLLICITED_RESPONSE</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;MALFORMED_DATA&quot;</span>,             <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5ae8d494f80428db9824512fa08d8fe061">DNS_DECODER_EVENT_MALFORMED_DATA</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;NOT_A_REQUEST&quot;</span>,              <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a66ee15090ffd0e8ec5bd8d7203aaedc7">DNS_DECODER_EVENT_NOT_A_REQUEST</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;NOT_A_RESPONSE&quot;</span>,             <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5abb03953e6465b83223697e04c3eb00bd">DNS_DECODER_EVENT_NOT_A_RESPONSE</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;Z_FLAG_SET&quot;</span>,                 <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a56c1cc2aa7825daa83e50680fda88bcb">DNS_DECODER_EVENT_Z_FLAG_SET</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;FLOODED&quot;</span>,                    <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a9ac2ab1092c964defddab4df8aca32ec">DNS_DECODER_EVENT_FLOODED</a>, },</div>
<div class="line">    { <span class="stringliteral">&quot;STATE_MEMCAP_REACHED&quot;</span>,       <a class="code" href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5addca9628414fb1074854bcbede75cd62">DNS_DECODER_EVENT_STATE_MEMCAP_REACHED</a>, },</div>
<div class="line"></div>
<div class="line">    { NULL,                         -1 },</div>
<div class="line">}</div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5a66ee15090ffd0e8ec5bd8d7203aaedc7"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a66ee15090ffd0e8ec5bd8d7203aaedc7">DNS_DECODER_EVENT_NOT_A_REQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00088">app-layer-dns-common.h:88</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5a56c1cc2aa7825daa83e50680fda88bcb"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a56c1cc2aa7825daa83e50680fda88bcb">DNS_DECODER_EVENT_Z_FLAG_SET</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00090">app-layer-dns-common.h:90</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5a9ac2ab1092c964defddab4df8aca32ec"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5a9ac2ab1092c964defddab4df8aca32ec">DNS_DECODER_EVENT_FLOODED</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00091">app-layer-dns-common.h:91</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5addca9628414fb1074854bcbede75cd62"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5addca9628414fb1074854bcbede75cd62">DNS_DECODER_EVENT_STATE_MEMCAP_REACHED</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00092">app-layer-dns-common.h:92</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5abb03953e6465b83223697e04c3eb00bd"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5abb03953e6465b83223697e04c3eb00bd">DNS_DECODER_EVENT_NOT_A_RESPONSE</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00089">app-layer-dns-common.h:89</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5ac6155019a18ae6e3e27e9a5b7baabc3e"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5ac6155019a18ae6e3e27e9a5b7baabc3e">DNS_DECODER_EVENT_UNSOLLICITED_RESPONSE</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00086">app-layer-dns-common.h:86</a></div></div>
<div class="ttc" id="app-layer-dns-common_8h_html_a99fb83031ce9923c84392b4e92f956b5ae8d494f80428db9824512fa08d8fe061"><div class="ttname"><a href="app-layer-dns-common_8h.html#a99fb83031ce9923c84392b4e92f956b5ae8d494f80428db9824512fa08d8fe061">DNS_DECODER_EVENT_MALFORMED_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="app-layer-dns-common_8h_source.html#l00087">app-layer-dns-common.h:87</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="app-layer-dns-common_8c_source.html#l00124">124</a> of file <a class="el" href="app-layer-dns-common_8c_source.html">app-layer-dns-common.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="app-layer-dns-common_8c.html">app-layer-dns-common.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:02 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
