<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: Thresholding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__threshold.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Thresholding</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:detect-engine-threshold_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-engine-threshold_8c.html">detect-engine-threshold.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:detect-threshold_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="detect-threshold_8c.html">detect-threshold.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:util-threshold-config_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-threshold-config_8c.html">util-threshold-config.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae70bc160e8b9097a4c31c34d01063431"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#gae70bc160e8b9097a4c31c34d01063431">ThresholdHostStorageId</a> (void)</td></tr>
<tr class="separator:gae70bc160e8b9097a4c31c34d01063431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56569edacd3bd0a6d0654c853b9e8903"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga56569edacd3bd0a6d0654c853b9e8903">ThresholdInit</a> (void)</td></tr>
<tr class="separator:ga56569edacd3bd0a6d0654c853b9e8903"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12823c5b56e0d076a83250e3d40270d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga12823c5b56e0d076a83250e3d40270d1">ThresholdHostHasThreshold</a> (<a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *host)</td></tr>
<tr class="separator:ga12823c5b56e0d076a83250e3d40270d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ab0e692a7482db3a13309cbb81ba065"><td class="memItemLeft" align="right" valign="top"><a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga5ab0e692a7482db3a13309cbb81ba065">SigGetThresholdTypeIter</a> (<a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *sig, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="detect_8h.html#aae9370809eda21d1e7083141555992e0">SigMatch</a> **psm, int list)</td></tr>
<tr class="memdesc:ga5ab0e692a7482db3a13309cbb81ba065"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return next DetectThresholdData for signature.  <a href="#ga5ab0e692a7482db3a13309cbb81ba065">More...</a><br/></td></tr>
<tr class="separator:ga5ab0e692a7482db3a13309cbb81ba065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71a282fae013fc07d54e467dadaee0f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga71a282fae013fc07d54e467dadaee0f3">ThresholdTimeoutCheck</a> (<a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *host, struct timeval *tv)</td></tr>
<tr class="memdesc:ga71a282fae013fc07d54e467dadaee0f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove timeout threshold hash elements.  <a href="#ga71a282fae013fc07d54e467dadaee0f3">More...</a><br/></td></tr>
<tr class="separator:ga71a282fae013fc07d54e467dadaee0f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacda64c154e2469fc2741ca70a90590d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#gacda64c154e2469fc2741ca70a90590d2">ThresholdHandlePacketSuppress</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *td, uint32_t sid, uint32_t gid)</td></tr>
<tr class="separator:gacda64c154e2469fc2741ca70a90590d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68237454fdc4e67f9da88e5dec67af84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga68237454fdc4e67f9da88e5dec67af84">ThresholdHandlePacketHost</a> (<a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *h, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *td, uint32_t sid, uint32_t gid)</td></tr>
<tr class="separator:ga68237454fdc4e67f9da88e5dec67af84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f8a2385541b16af73ce1c8a7a157577"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga0f8a2385541b16af73ce1c8a7a157577">PacketAlertThreshold</a> (<a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *de_ctx, <a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *det_ctx, <a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *td, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, <a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *s)</td></tr>
<tr class="memdesc:ga0f8a2385541b16af73ce1c8a7a157577"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make the threshold logic for signatures.  <a href="#ga0f8a2385541b16af73ce1c8a7a157577">More...</a><br/></td></tr>
<tr class="separator:ga0f8a2385541b16af73ce1c8a7a157577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5d0d51c920ab9996dccf423be2a42e75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga5d0d51c920ab9996dccf423be2a42e75">ThresholdHashInit</a> (<a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *de_ctx)</td></tr>
<tr class="memdesc:ga5d0d51c920ab9996dccf423be2a42e75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init threshold context hash tables.  <a href="#ga5d0d51c920ab9996dccf423be2a42e75">More...</a><br/></td></tr>
<tr class="separator:ga5d0d51c920ab9996dccf423be2a42e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga438c0d2d9103c7ae29bc422b972ea89f">ThresholdContextDestroy</a> (<a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *de_ctx)</td></tr>
<tr class="memdesc:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy threshold context hash tables.  <a href="#ga438c0d2d9103c7ae29bc422b972ea89f">More...</a><br/></td></tr>
<tr class="separator:ga438c0d2d9103c7ae29bc422b972ea89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49528de5969274cd2b6586bff7dbaae8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__threshold.html#ga49528de5969274cd2b6586bff7dbaae8">ThresholdListFree</a> (void *ptr)</td></tr>
<tr class="memdesc:ga49528de5969274cd2b6586bff7dbaae8"><td class="mdescLeft">&#160;</td><td class="mdescRight">this function will free all the entries of a list DetectTagDataEntry  <a href="#ga49528de5969274cd2b6586bff7dbaae8">More...</a><br/></td></tr>
<tr class="separator:ga49528de5969274cd2b6586bff7dbaae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This feature is used to reduce the number of logged alerts for noisy rules. This can be tuned to significantly reduce false alarms, and it can also be used to write a newer breed of rules. Thresholding commands limit the number of times a particular event is logged during a specified time interval. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga0f8a2385541b16af73ce1c8a7a157577"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PacketAlertThreshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#a1fcb097548c8590820e4aef659e7e731">DetectEngineThreadCtx</a> *&#160;</td>
          <td class="paramname"><em>det_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make the threshold logic for signatures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
    <tr><td class="paramname">tsh_ptr</td><td>Threshold element </td></tr>
    <tr><td class="paramname">p</td><td>Packet structure </td></tr>
    <tr><td class="paramname">s</td><td>Signature structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">2</td><td>silent match (no alert but apply actions) </td></tr>
    <tr><td class="paramname">1</td><td>alert on this event </td></tr>
    <tr><td class="paramname">0</td><td>do not alert on this event </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00607">607</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00376">Packet_::dst</a>, <a class="el" href="detect_8h_source.html#l00408">Signature_::gid</a>, <a class="el" href="host_8c_source.html#l00460">HostGetHostFromHash()</a>, <a class="el" href="host_8c_source.html#l00435">HostRelease()</a>, <a class="el" href="detect_8h_source.html#l00407">Signature_::id</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, <a class="el" href="util-debug_8h_source.html#l00312">SCReturnInt</a>, <a class="el" href="decode_8h_source.html#l00375">Packet_::src</a>, <a class="el" href="detect_8h_source.html#l00543">ThresholdCtx_::threshold_table_lock</a>, <a class="el" href="detect-engine-threshold_8c_source.html#l00252">ThresholdHandlePacketHost()</a>, <a class="el" href="detect-engine-threshold_8c_source.html#l00212">ThresholdHandlePacketSuppress()</a>, <a class="el" href="detect_8h_source.html#l00619">DetectEngineCtx_::ths_ctx</a>, <a class="el" href="detect-threshold_8h_source.html#l00060">DetectThresholdData_::track</a>, <a class="el" href="detect-detection-filter_8c_source.html#l00043">TRACK_DST</a>, <a class="el" href="detect-threshold_8h_source.html#l00040">TRACK_RULE</a>, <a class="el" href="detect-detection-filter_8c_source.html#l00044">TRACK_SRC</a>, <a class="el" href="detect-threshold_8h_source.html#l00059">DetectThresholdData_::type</a>, and <a class="el" href="detect-threshold_8h_source.html#l00036">TYPE_SUPPRESS</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga0f8a2385541b16af73ce1c8a7a157577_cgraph.png" border="0" usemap="#group__threshold_ga0f8a2385541b16af73ce1c8a7a157577_cgraph" alt=""/></div>
<map name="group__threshold_ga0f8a2385541b16af73ce1c8a7a157577_cgraph" id="group__threshold_ga0f8a2385541b16af73ce1c8a7a157577_cgraph">
<area shape="rect" id="node2" href="host_8c.html#a98f7a1c5351cf64e503718db63581b77" title="HostGetHostFromHash" alt="" coords="228,56,388,83"/><area shape="rect" id="node6" href="host_8c.html#ae1a83c8dcf278f3b546bafdb5a447218" title="HostRelease" alt="" coords="259,107,357,133"/><area shape="rect" id="node7" href="group__threshold.html#ga68237454fdc4e67f9da88e5dec67af84" title="ThresholdHandlePacketHost" alt="" coords="213,157,403,184"/><area shape="rect" id="node12" href="group__threshold.html#gacda64c154e2469fc2741ca70a90590d2" title="ThresholdHandlePacketSuppress" alt="" coords="200,208,416,235"/><area shape="rect" id="node3" href="host_8c.html#a9e457fc00e7928182853db5d7620df63" title="HostGetKey" alt="" coords="514,5,609,32"/><area shape="rect" id="node5" href="host_8c.html#ade444d54823b5cb77e9b0b3c21dc1f33" title="HostInit" alt="" coords="527,56,595,83"/><area shape="rect" id="node4" href="util-hash-lookup3_8c.html#a6b57e35d1649b351ed629d3e022bf85f" title="hashword" alt="" coords="741,5,819,32"/><area shape="rect" id="node8" href="group__hoststorage.html#ga9bbff71a8002ff811f4b58655dad683d" title="Get a value from a given Host storage. " alt="" coords="490,107,633,133"/><area shape="rect" id="node10" href="group__hoststorage.html#ga59a8081e31daa912236b7ba08a1767b5" title="Store a pointer in a given Host storage. " alt="" coords="490,157,633,184"/><area shape="rect" id="node9" href="util-storage_8c.html#ae583f91a48fb1da802d6d8aae8efaa45" title="get storage for id " alt="" coords="723,107,837,133"/><area shape="rect" id="node11" href="util-storage_8c.html#ad7892e8e521cd8a0d46229502659f562" title="set storage for id " alt="" coords="723,157,837,184"/><area shape="rect" id="node13" href="detect-engine-address_8c.html#adfe81a0041cbac2ea6edd6ce1eeeb630" title="Find the group matching address in a group head. " alt="" coords="465,208,658,235"/><area shape="rect" id="node14" href="detect-engine-address_8c.html#a7e14cdcb4fc22a39e338538aebc55405" title="Check if a particular address(ipv4 or ipv6) matches the address range in the DetectAddress instance..." alt="" coords="707,208,853,235"/><area shape="rect" id="node15" href="detect-engine-address-ipv6_8c.html#a79be8c394b318b5fd794c752c3b1b6e9" title="Compares 2 ipv6 addresses and returns if the first address(a) is greater than or equal to the second ..." alt="" coords="901,183,1016,209"/><area shape="rect" id="node18" href="detect-engine-address-ipv6_8c.html#a548ed5e713f27f6e8f1a092247890356" title="Compares 2 ipv6 addresses and returns if the first address(a) is less than or equal to the second add..." alt="" coords="903,233,1014,260"/><area shape="rect" id="node16" href="detect-engine-address-ipv6_8c.html#a305494565a12e7d6915e92372a4cf151" title="Compares 2 ipv6 addresses and returns if the addresses are equal or not. " alt="" coords="1065,208,1178,235"/><area shape="rect" id="node17" href="detect-engine-address-ipv6_8c.html#a04212e72ac187899db41957af8984c24" title="Compares 2 ipv6 addresses and returns if the first address(a) is greater than the second address(b) o..." alt="" coords="1066,157,1177,184"/><area shape="rect" id="node19" href="detect-engine-address-ipv6_8c.html#a86517d0262298eff245b4a1496b83bdc" title="Compares 2 ipv6 addresses and returns if the first address(a) is less than the second address(b) or n..." alt="" coords="1067,259,1175,285"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5ab0e692a7482db3a13309cbb81ba065"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a>* SigGetThresholdTypeIter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aa30959e56107c43037e58722919fc8c0">Signature</a> *&#160;</td>
          <td class="paramname"><em>sig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aae9370809eda21d1e7083141555992e0">SigMatch</a> **&#160;</td>
          <td class="paramname"><em>psm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return next DetectThresholdData for signature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sig</td><td>Signature pointer </td></tr>
    <tr><td class="paramname">p</td><td>Packet structure </td></tr>
    <tr><td class="paramname">sm</td><td>Pointer to a Signature Match pointer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">tsh</td><td>Return the threshold data from signature or NULL if not found </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00101">101</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="detect_8h_source.html#l00357">SigMatch_::ctx</a>, <a class="el" href="detect_8h_source.html#l01160">DETECT_DETECTION_FILTER</a>, <a class="el" href="detect_8h_source.html#l01109">DETECT_THRESHOLD</a>, <a class="el" href="detect_8h_source.html#l00359">SigMatch_::prev</a>, <a class="el" href="detect_8h_source.html#l00434">Signature_::sm_lists_tail</a>, and <a class="el" href="detect_8h_source.html#l00355">SigMatch_::type</a>.</p>

</div>
</div>
<a class="anchor" id="ga438c0d2d9103c7ae29bc422b972ea89f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdContextDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy threshold context hash tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00661">661</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="detect_8h_source.html#l00546">ThresholdCtx_::th_entry</a>, <a class="el" href="detect_8h_source.html#l00543">ThresholdCtx_::threshold_table_lock</a>, and <a class="el" href="detect_8h_source.html#l00619">DetectEngineCtx_::ths_ctx</a>.</p>

<p>Referenced by <a class="el" href="detect-engine_8c_source.html#l00894">DetectEngineCtxFree()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph.png" border="0" usemap="#group__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph" alt=""/></div>
<map name="group__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph" id="group__threshold_ga438c0d2d9103c7ae29bc422b972ea89f_icgraph">
<area shape="rect" id="node2" href="detect-engine_8h.html#a507b6b477b36478010d0946149c2d357" title="Free a DetectEngineCtx:: " alt="" coords="225,5,373,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga68237454fdc4e67f9da88e5dec67af84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHandlePacketHost </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>gid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">2</td><td>silent match (no alert but apply actions) </td></tr>
    <tr><td class="paramname">1</td><td>normal match </td></tr>
    <tr><td class="paramname">0</td><td>no match </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00252">252</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="detect-threshold_8h_source.html#l00057">DetectThresholdData_::count</a>, <a class="el" href="detect-threshold_8h_source.html#l00076">DetectThresholdEntry_::current_count</a>, <a class="el" href="host-storage_8c_source.html#l00084">HostGetStorageById()</a>, <a class="el" href="host-storage_8c_source.html#l00071">HostSetStorageById()</a>, <a class="el" href="detect-threshold_8h_source.html#l00061">DetectThresholdData_::new_action</a>, <a class="el" href="detect-threshold_8h_source.html#l00079">DetectThresholdEntry_::next</a>, <a class="el" href="decode_8h_source.html#l00798">PACKET_ALERT</a>, <a class="el" href="decode_8h_source.html#l00802">PACKET_DROP</a>, <a class="el" href="decode_8h_source.html#l00810">PACKET_PASS</a>, <a class="el" href="decode_8h_source.html#l00804">PACKET_REJECT</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="detect-threshold_8h_source.html#l00058">DetectThresholdData_::seconds</a>, <a class="el" href="detect-threshold_8h_source.html#l00044">TH_ACTION_ALERT</a>, <a class="el" href="detect-threshold_8h_source.html#l00045">TH_ACTION_DROP</a>, <a class="el" href="detect-threshold_8h_source.html#l00046">TH_ACTION_PASS</a>, <a class="el" href="detect-threshold_8h_source.html#l00049">TH_ACTION_REJECT</a>, <a class="el" href="detect-threshold_8h_source.html#l00062">DetectThresholdData_::timeout</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, <a class="el" href="detect-threshold_8h_source.html#l00074">DetectThresholdEntry_::tv_sec1</a>, <a class="el" href="detect-threshold_8h_source.html#l00071">DetectThresholdEntry_::tv_timeout</a>, <a class="el" href="detect-threshold_8h_source.html#l00075">DetectThresholdEntry_::tv_usec1</a>, <a class="el" href="detect-threshold_8h_source.html#l00059">DetectThresholdData_::type</a>, <a class="el" href="detect-threshold_8h_source.html#l00032">TYPE_BOTH</a>, <a class="el" href="detect-threshold_8h_source.html#l00034">TYPE_DETECTION</a>, <a class="el" href="detect-threshold_8h_source.html#l00031">TYPE_LIMIT</a>, <a class="el" href="detect-threshold_8h_source.html#l00035">TYPE_RATE</a>, and <a class="el" href="detect-threshold_8h_source.html#l00033">TYPE_THRESHOLD</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-threshold_8c_source.html#l00607">PacketAlertThreshold()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_cgraph.png" border="0" usemap="#group__threshold_ga68237454fdc4e67f9da88e5dec67af84_cgraph" alt=""/></div>
<map name="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_cgraph" id="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_cgraph">
<area shape="rect" id="node2" href="group__hoststorage.html#ga9bbff71a8002ff811f4b58655dad683d" title="Get a value from a given Host storage. " alt="" coords="243,5,386,32"/><area shape="rect" id="node4" href="group__hoststorage.html#ga59a8081e31daa912236b7ba08a1767b5" title="Store a pointer in a given Host storage. " alt="" coords="243,56,386,83"/><area shape="rect" id="node3" href="util-storage_8c.html#ae583f91a48fb1da802d6d8aae8efaa45" title="get storage for id " alt="" coords="435,5,549,32"/><area shape="rect" id="node5" href="util-storage_8c.html#ad7892e8e521cd8a0d46229502659f562" title="set storage for id " alt="" coords="435,56,549,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_icgraph.png" border="0" usemap="#group__threshold_ga68237454fdc4e67f9da88e5dec67af84_icgraph" alt=""/></div>
<map name="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_icgraph" id="group__threshold_ga68237454fdc4e67f9da88e5dec67af84_icgraph">
<area shape="rect" id="node2" href="group__threshold.html#ga0f8a2385541b16af73ce1c8a7a157577" title="Make the threshold logic for signatures. " alt="" coords="243,5,389,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gacda64c154e2469fc2741ca70a90590d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHandlePacketSuppress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="detect-threshold_8h.html#a780d28a447a48171dfb10ed0a93f5f2b">DetectThresholdData</a> *&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>gid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00212">212</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="detect-threshold_8h_source.html#l00064">DetectThresholdData_::addrs</a>, <a class="el" href="detect-engine-address_8c_source.html#l01867">DetectAddressLookupInHead()</a>, <a class="el" href="decode_8h_source.html#l00376">Packet_::dst</a>, <a class="el" href="flow-hash_8h_source.html#l00206">m</a>, <a class="el" href="util-error_8h_source.html#l00160">SC_ERR_INVALID_VALUE</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="decode_8h_source.html#l00375">Packet_::src</a>, <a class="el" href="detect-threshold_8h_source.html#l00060">DetectThresholdData_::track</a>, <a class="el" href="detect-detection-filter_8c_source.html#l00043">TRACK_DST</a>, <a class="el" href="detect-threshold_8h_source.html#l00041">TRACK_EITHER</a>, <a class="el" href="detect-threshold_8h_source.html#l00040">TRACK_RULE</a>, and <a class="el" href="detect-detection-filter_8c_source.html#l00044">TRACK_SRC</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-threshold_8c_source.html#l00607">PacketAlertThreshold()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_gacda64c154e2469fc2741ca70a90590d2_cgraph.png" border="0" usemap="#group__threshold_gacda64c154e2469fc2741ca70a90590d2_cgraph" alt=""/></div>
<map name="group__threshold_gacda64c154e2469fc2741ca70a90590d2_cgraph" id="group__threshold_gacda64c154e2469fc2741ca70a90590d2_cgraph">
<area shape="rect" id="node2" href="detect-engine-address_8c.html#adfe81a0041cbac2ea6edd6ce1eeeb630" title="Find the group matching address in a group head. " alt="" coords="270,56,463,83"/><area shape="rect" id="node3" href="detect-engine-address_8c.html#a7e14cdcb4fc22a39e338538aebc55405" title="Check if a particular address(ipv4 or ipv6) matches the address range in the DetectAddress instance..." alt="" coords="513,56,658,83"/><area shape="rect" id="node4" href="detect-engine-address-ipv6_8c.html#a79be8c394b318b5fd794c752c3b1b6e9" title="Compares 2 ipv6 addresses and returns if the first address(a) is greater than or equal to the second ..." alt="" coords="707,31,821,57"/><area shape="rect" id="node7" href="detect-engine-address-ipv6_8c.html#a548ed5e713f27f6e8f1a092247890356" title="Compares 2 ipv6 addresses and returns if the first address(a) is less than or equal to the second add..." alt="" coords="709,81,819,108"/><area shape="rect" id="node5" href="detect-engine-address-ipv6_8c.html#a305494565a12e7d6915e92372a4cf151" title="Compares 2 ipv6 addresses and returns if the addresses are equal or not. " alt="" coords="870,56,983,83"/><area shape="rect" id="node6" href="detect-engine-address-ipv6_8c.html#a04212e72ac187899db41957af8984c24" title="Compares 2 ipv6 addresses and returns if the first address(a) is greater than the second address(b) o..." alt="" coords="871,5,982,32"/><area shape="rect" id="node8" href="detect-engine-address-ipv6_8c.html#a86517d0262298eff245b4a1496b83bdc" title="Compares 2 ipv6 addresses and returns if the first address(a) is less than the second address(b) or n..." alt="" coords="873,107,981,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_gacda64c154e2469fc2741ca70a90590d2_icgraph.png" border="0" usemap="#group__threshold_gacda64c154e2469fc2741ca70a90590d2_icgraph" alt=""/></div>
<map name="group__threshold_gacda64c154e2469fc2741ca70a90590d2_icgraph" id="group__threshold_gacda64c154e2469fc2741ca70a90590d2_icgraph">
<area shape="rect" id="node2" href="group__threshold.html#ga0f8a2385541b16af73ce1c8a7a157577" title="Make the threshold logic for signatures. " alt="" coords="269,5,416,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga5d0d51c920ab9996dccf423be2a42e75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdHashInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="detect_8h.html#aef8d5102916f306fba1de58f5dec0eb7">DetectEngineCtx</a> *&#160;</td>
          <td class="paramname"><em>de_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init threshold context hash tables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00646">646</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="util-error_8h_source.html#l00031">SC_ERR_MEM_ALLOC</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="detect_8h_source.html#l00543">ThresholdCtx_::threshold_table_lock</a>, and <a class="el" href="detect_8h_source.html#l00619">DetectEngineCtx_::ths_ctx</a>.</p>

</div>
</div>
<a class="anchor" id="ga12823c5b56e0d076a83250e3d40270d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHostHasThreshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *&#160;</td>
          <td class="paramname"><em>host</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00085">85</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="host-storage_8c_source.html#l00084">HostGetStorageById()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph.png" border="0" usemap="#group__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph" alt=""/></div>
<map name="group__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph" id="group__threshold_ga12823c5b56e0d076a83250e3d40270d1_cgraph">
<area shape="rect" id="node2" href="group__hoststorage.html#ga9bbff71a8002ff811f4b58655dad683d" title="Get a value from a given Host storage. " alt="" coords="243,5,386,32"/><area shape="rect" id="node3" href="util-storage_8c.html#ae583f91a48fb1da802d6d8aae8efaa45" title="get storage for id " alt="" coords="435,5,549,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae70bc160e8b9097a4c31c34d01063431"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdHostStorageId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00071">71</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga56569edacd3bd0a6d0654c853b9e8903"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00076">76</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="host-storage_8c_source.html#l00059">HostStorageRegister()</a>, <a class="el" href="util-error_8h_source.html#l00238">SC_ERR_HOST_INIT</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, and <a class="el" href="detect-engine-threshold_8c_source.html#l00674">ThresholdListFree()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga56569edacd3bd0a6d0654c853b9e8903_cgraph.png" border="0" usemap="#group__threshold_ga56569edacd3bd0a6d0654c853b9e8903_cgraph" alt=""/></div>
<map name="group__threshold_ga56569edacd3bd0a6d0654c853b9e8903_cgraph" id="group__threshold_ga56569edacd3bd0a6d0654c853b9e8903_cgraph">
<area shape="rect" id="node2" href="group__hoststorage.html#ga2428ea46c982c3ecde6b0ab553974d51" title="Register a Host storage. " alt="" coords="152,5,296,32"/><area shape="rect" id="node5" href="group__threshold.html#ga49528de5969274cd2b6586bff7dbaae8" title="this function will free all the entries of a list DetectTagDataEntry " alt="" coords="161,56,287,83"/><area shape="rect" id="node3" href="util-storage_8c.html#a6c98c1f3549ce0faee1083778abd1227" title="Register new storage. " alt="" coords="345,5,461,32"/><area shape="rect" id="node4" href="util-storage_8c.html#a742cd0f5c06e15fe16178ae16c8582a2" title="StoragePrintType" alt="" coords="509,5,632,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga49528de5969274cd2b6586bff7dbaae8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ThresholdListFree </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this function will free all the entries of a list DetectTagDataEntry </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">td</td><td>pointer to DetectTagDataEntryList </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00674">674</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="detect-threshold_8h_source.html#l00079">DetectThresholdEntry_::next</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="detect-engine-threshold_8c_source.html#l00076">ThresholdInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga49528de5969274cd2b6586bff7dbaae8_icgraph.png" border="0" usemap="#group__threshold_ga49528de5969274cd2b6586bff7dbaae8_icgraph" alt=""/></div>
<map name="group__threshold_ga49528de5969274cd2b6586bff7dbaae8_icgraph" id="group__threshold_ga49528de5969274cd2b6586bff7dbaae8_icgraph">
<area shape="rect" id="node2" href="group__threshold.html#ga56569edacd3bd0a6d0654c853b9e8903" title="ThresholdInit" alt="" coords="182,5,279,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga71a282fae013fc07d54e467dadaee0f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ThresholdTimeoutCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="host_8h.html#a96ecd2a98dde44db0122ddb32252ce33">Host</a> *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct timeval *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove timeout threshold hash elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">de_ctx</td><td>Dectection Context </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="detect-engine-threshold_8c_source.html#l00140">140</a> of file <a class="el" href="detect-engine-threshold_8c_source.html">detect-engine-threshold.c</a>.</p>

<p>References <a class="el" href="host-storage_8c_source.html#l00084">HostGetStorageById()</a>, <a class="el" href="host-storage_8c_source.html#l00071">HostSetStorageById()</a>, <a class="el" href="detect-threshold_8h_source.html#l00079">DetectThresholdEntry_::next</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="detect-threshold_8h_source.html#l00073">DetectThresholdEntry_::seconds</a>, and <a class="el" href="detect-threshold_8h_source.html#l00074">DetectThresholdEntry_::tv_sec1</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__threshold_ga71a282fae013fc07d54e467dadaee0f3_cgraph.png" border="0" usemap="#group__threshold_ga71a282fae013fc07d54e467dadaee0f3_cgraph" alt=""/></div>
<map name="group__threshold_ga71a282fae013fc07d54e467dadaee0f3_cgraph" id="group__threshold_ga71a282fae013fc07d54e467dadaee0f3_cgraph">
<area shape="rect" id="node2" href="group__hoststorage.html#ga9bbff71a8002ff811f4b58655dad683d" title="Get a value from a given Host storage. " alt="" coords="219,5,362,32"/><area shape="rect" id="node4" href="group__hoststorage.html#ga59a8081e31daa912236b7ba08a1767b5" title="Store a pointer in a given Host storage. " alt="" coords="219,56,362,83"/><area shape="rect" id="node3" href="util-storage_8c.html#ae583f91a48fb1da802d6d8aae8efaa45" title="get storage for id " alt="" coords="411,5,525,32"/><area shape="rect" id="node5" href="util-storage_8c.html#ad7892e8e521cd8a0d46229502659f562" title="set storage for id " alt="" coords="411,56,525,83"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:18 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
