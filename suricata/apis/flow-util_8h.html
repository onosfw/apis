<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/flow-util.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('flow-util_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">flow-util.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="detect-engine-state_8h_source.html">detect-engine-state.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tmqh-flow_8h_source.html">tmqh-flow.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for flow-util.h:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h__incl.png" border="0" usemap="#src_2flow-util_8h" alt=""/></div>
<map name="src_2flow-util_8h" id="src_2flow-util_8h">
<area shape="rect" id="node2" href="detect-engine-state_8h.html" title="Data structures and function prototypes for keeping state for the detection engine. " alt="" coords="5,80,149,107"/><area shape="rect" id="node3" href="tmqh-flow_8h.html" title="tmqh&#45;flow.h" alt="" coords="173,80,264,107"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h__dep__incl.png" border="0" usemap="#src_2flow-util_8hdep" alt=""/></div>
<map name="src_2flow-util_8hdep" id="src_2flow-util_8hdep">
<area shape="rect" id="node2" href="app-layer-dcerpc-udp_8c.html" title="src/app&#45;layer&#45;dcerpc\l&#45;udp.c" alt="" coords="5,81,144,122"/><area shape="rect" id="node3" href="app-layer-dcerpc_8c.html" title="src/app&#45;layer&#45;dcerpc.c" alt="" coords="169,88,319,115"/><area shape="rect" id="node4" href="app-layer-detect-proto_8c.html" title="src/app&#45;layer&#45;detect\l&#45;proto.c" alt="" coords="343,81,480,122"/><area shape="rect" id="node5" href="app-layer-dns-tcp_8c.html" title="src/app&#45;layer&#45;dns&#45;tcp.c" alt="" coords="505,88,660,115"/><area shape="rect" id="node6" href="app-layer-dns-udp_8c.html" title="src/app&#45;layer&#45;dns&#45;udp.c" alt="" coords="685,88,843,115"/><area shape="rect" id="node7" href="app-layer-ftp_8c.html" title="src/app&#45;layer&#45;ftp.c" alt="" coords="867,88,993,115"/><area shape="rect" id="node8" href="app-layer-htp-body_8c.html" title="src/app&#45;layer&#45;htp&#45;body.c" alt="" coords="1019,88,1181,115"/><area shape="rect" id="node9" href="app-layer-htp-file_8c.html" title="src/app&#45;layer&#45;htp&#45;file.c" alt="" coords="1206,88,1356,115"/><area shape="rect" id="node10" href="app-layer-htp_8c.html" title="src/app&#45;layer&#45;htp.c" alt="" coords="1381,88,1512,115"/><area shape="rect" id="node11" href="app-layer-parser_8c.html" title="src/app&#45;layer&#45;parser.c" alt="" coords="1537,88,1684,115"/><area shape="rect" id="node12" href="util-base64_8h.html" title="src/util&#45;base64.h" alt="" coords="1709,88,1827,115"/><area shape="rect" id="node13" href="app-layer-smtp_8c.html" title="src/app&#45;layer&#45;smtp.c" alt="" coords="1852,88,1993,115"/><area shape="rect" id="node14" href="app-layer-ssl_8c.html" title="src/app&#45;layer&#45;ssl.c" alt="" coords="2018,88,2147,115"/><area shape="rect" id="node15" href="app-layer_8c.html" title="src/app&#45;layer.c" alt="" coords="2171,88,2279,115"/><area shape="rect" id="node16" href="detect-app-layer-event_8c.html" title="src/detect&#45;app&#45;layer\l&#45;event.c" alt="" coords="2303,81,2440,122"/><area shape="rect" id="node17" href="detect-byte-extract_8c.html" title="src/detect&#45;byte&#45;extract.c" alt="" coords="2465,88,2628,115"/><area shape="rect" id="node18" href="detect-content_8c.html" title="src/detect&#45;content.c" alt="" coords="2653,88,2792,115"/><area shape="rect" id="node19" href="detect-dce-iface_8c.html" title="src/detect&#45;dce&#45;iface.c" alt="" coords="2817,88,2964,115"/><area shape="rect" id="node20" href="detect-dce-opnum_8c.html" title="src/detect&#45;dce&#45;opnum.c" alt="" coords="2989,88,3147,115"/><area shape="rect" id="node21" href="detect-dce-stub-data_8c.html" title="src/detect&#45;dce&#45;stub\l&#45;data.c" alt="" coords="3171,81,3305,122"/><area shape="rect" id="node22" href="detect-dns-query_8c.html" title="src/detect&#45;dns&#45;query.c" alt="" coords="3331,88,3483,115"/><area shape="rect" id="node23" href="detect-engine-dcepayload_8c.html" title="src/detect&#45;engine&#45;dcepayload.c" alt="" coords="3507,88,3709,115"/><area shape="rect" id="node24" href="detect-engine-dns_8c.html" title="src/detect&#45;engine&#45;dns.c" alt="" coords="3734,88,3892,115"/><area shape="rect" id="node25" href="detect-engine-filedata-smtp_8c.html" title="src/detect&#45;engine&#45;filedata\l&#45;smtp.c" alt="" coords="3917,81,4085,122"/><area shape="rect" id="node26" href="detect-engine-hcbd_8c.html" title="Handle HTTP request body match corresponding to http_client_body keyword. " alt="" coords="4109,88,4275,115"/><area shape="rect" id="node27" href="detect-engine-hcd_8c.html" title="Handle HTTP cookie match. " alt="" coords="4299,88,4457,115"/><area shape="rect" id="node28" href="detect-engine-hhd_8c.html" title="Handle HTTP header match. " alt="" coords="4482,88,4640,115"/><area shape="rect" id="node29" href="detect-engine-hhhd_8c.html" title="Handle HTTP host header. HHHD &#45; Http Host Header Data. " alt="" coords="4665,88,4831,115"/><area shape="rect" id="node30" href="detect-engine-hmd_8c.html" title="Handle HTTP method match. " alt="" coords="4855,88,5017,115"/><area shape="rect" id="node31" href="detect-engine-hrhd_8c.html" title="Handle HTTP raw header match. " alt="" coords="5041,88,5204,115"/><area shape="rect" id="node32" href="detect-engine-hrhhd_8c.html" title="Handle HTTP host header. HRHHD &#45; Http Raw Host Header Data. " alt="" coords="5229,88,5397,115"/><area shape="rect" id="node33" href="detect-engine-hrl_8c.html" title="src/detect&#45;engine&#45;hrl.c" alt="" coords="5422,88,5572,115"/><area shape="rect" id="node34" href="detect-engine-hrud_8c.html" title="Handle HTTP raw uri match. " alt="" coords="5597,88,5760,115"/><area shape="rect" id="node35" href="detect-engine-hsbd_8c.html" title="Handle HTTP response body match corresponding to http_server_body keyword. " alt="" coords="5784,88,5949,115"/><area shape="rect" id="node36" href="detect-engine-hscd_8c.html" title="src/detect&#45;engine&#45;hscd.c" alt="" coords="5973,88,6139,115"/><area shape="rect" id="node37" href="detect-engine-hsmd_8c.html" title="src/detect&#45;engine&#45;hsmd.c" alt="" coords="6163,88,6332,115"/><area shape="rect" id="node38" href="detect-engine-hua_8c.html" title="Handle HTTP user agent match. " alt="" coords="6357,88,6515,115"/><area shape="rect" id="node39" href="detect-engine-iponly_8c.html" title="src/detect&#45;engine&#45;iponly.c" alt="" coords="6540,88,6711,115"/><area shape="rect" id="node40" href="detect-engine-proto_8c.html" title="src/detect&#45;engine&#45;proto.c" alt="" coords="6735,88,6901,115"/><area shape="rect" id="node41" href="detect-engine-sigorder_8c.html" title="src/detect&#45;engine&#45;sigorder.c" alt="" coords="6926,88,7108,115"/><area shape="rect" id="node42" href="detect-engine-state_8c.html" title="State based signature handling. " alt="" coords="7133,88,7299,115"/><area shape="rect" id="node43" href="detect-engine-tag_8c.html" title="src/detect&#45;engine&#45;tag.c" alt="" coords="7324,88,7479,115"/><area shape="rect" id="node44" href="detect-engine-uri_8c.html" title="src/detect&#45;engine&#45;uri.c" alt="" coords="7503,88,7653,115"/><area shape="rect" id="node45" href="detect-engine_8c.html" title="src/detect&#45;engine.c" alt="" coords="7679,88,7812,115"/><area shape="rect" id="node46" href="detect-file-data_8c.html" title="src/detect&#45;file&#45;data.c" alt="" coords="7836,88,7977,115"/><area shape="rect" id="node47" href="detect-fileext_8c.html" title="src/detect&#45;fileext.c" alt="" coords="8001,88,8132,115"/><area shape="rect" id="node48" href="detect-filemagic_8c.html" title="src/detect&#45;filemagic.c" alt="" coords="8156,88,8303,115"/><area shape="rect" id="node49" href="detect-filemd5_8c.html" title="src/detect&#45;filemd5.c" alt="" coords="8327,88,8464,115"/><area shape="rect" id="node50" href="detect-filename_8c.html" title="src/detect&#45;filename.c" alt="" coords="8489,88,8633,115"/></map>
</div>
</div>
<p><a href="flow-util_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a57d51f8d717d2a7dc310f599023c74a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a57d51f8d717d2a7dc310f599023c74a3">COPY_TIMESTAMP</a>(src, dst)&#160;&#160;&#160;((dst)-&gt;tv_sec = (src)-&gt;tv_sec, (dst)-&gt;tv_usec = (src)-&gt;tv_usec)</td></tr>
<tr class="separator:a57d51f8d717d2a7dc310f599023c74a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c672ebcb139c961b30432e63bef7647"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a5c672ebcb139c961b30432e63bef7647">RESET_COUNTERS</a>(f)</td></tr>
<tr class="separator:a5c672ebcb139c961b30432e63bef7647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e29475f0245aff5efa048157120b3e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a53e29475f0245aff5efa048157120b3e">FLOW_INITIALIZE</a>(f)</td></tr>
<tr class="separator:a53e29475f0245aff5efa048157120b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c75baaba44d2813cddb48bc219dba3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a51c75baaba44d2813cddb48bc219dba3">FLOW_RECYCLE</a>(f)</td></tr>
<tr class="memdesc:a51c75baaba44d2813cddb48bc219dba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to recycle a flow before it goes into the spare queue for reuse.  <a href="#a51c75baaba44d2813cddb48bc219dba3">More...</a><br/></td></tr>
<tr class="separator:a51c75baaba44d2813cddb48bc219dba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8cd231f2ee6558e668c7befac7bb214"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#ad8cd231f2ee6558e668c7befac7bb214">FLOW_DESTROY</a>(f)</td></tr>
<tr class="separator:ad8cd231f2ee6558e668c7befac7bb214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8de064e734599ba0f3ba39fdb9c89d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a0b8de064e734599ba0f3ba39fdb9c89d">FLOW_CHECK_MEMCAP</a>(size)&#160;&#160;&#160;((((uint64_t)<a class="el" href="util-atomic_8h.html#ac07c71db3cf6014ce1b646a3b40d02c5">SC_ATOMIC_GET</a>(flow_memuse) + (uint64_t)(size)) &lt;= flow_config.memcap))</td></tr>
<tr class="memdesc:a0b8de064e734599ba0f3ba39fdb9c89d"><td class="mdescLeft">&#160;</td><td class="mdescRight">check if a memory alloc would fit in the memcap  <a href="#a0b8de064e734599ba0f3ba39fdb9c89d">More...</a><br/></td></tr>
<tr class="separator:a0b8de064e734599ba0f3ba39fdb9c89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae1ba1db44e3a77c4829397d5d659c432"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#ae1ba1db44e3a77c4829397d5d659c432">FlowAlloc</a> (void)</td></tr>
<tr class="memdesc:ae1ba1db44e3a77c4829397d5d659c432"><td class="mdescLeft">&#160;</td><td class="mdescRight">allocate a flow  <a href="#ae1ba1db44e3a77c4829397d5d659c432">More...</a><br/></td></tr>
<tr class="separator:ae1ba1db44e3a77c4829397d5d659c432"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ec58fb96268052af9546dcf5253fb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a30ec58fb96268052af9546dcf5253fb3">FlowAllocDirect</a> (void)</td></tr>
<tr class="separator:a30ec58fb96268052af9546dcf5253fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4befc0a3b97d4a6f794a8b39e75a23b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#ad4befc0a3b97d4a6f794a8b39e75a23b">FlowFree</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *)</td></tr>
<tr class="memdesc:ad4befc0a3b97d4a6f794a8b39e75a23b"><td class="mdescLeft">&#160;</td><td class="mdescRight">cleanup &amp; free the memory of a flow  <a href="#ad4befc0a3b97d4a6f794a8b39e75a23b">More...</a><br/></td></tr>
<tr class="separator:ad4befc0a3b97d4a6f794a8b39e75a23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6c56d55252b820e15a001a5efb93c79"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#aa6c56d55252b820e15a001a5efb93c79">FlowGetProtoMapping</a> (uint8_t)</td></tr>
<tr class="memdesc:aa6c56d55252b820e15a001a5efb93c79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to map the protocol to the defined FLOW_PROTO_* enumeration.  <a href="#aa6c56d55252b820e15a001a5efb93c79">More...</a><br/></td></tr>
<tr class="separator:aa6c56d55252b820e15a001a5efb93c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e6253940963b9fee6c2a3948ee156da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a5e6253940963b9fee6c2a3948ee156da">FlowInit</a> (<a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *, const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *)</td></tr>
<tr class="separator:a5e6253940963b9fee6c2a3948ee156da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2258030b58194ee63d15a17a9b4a5384"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flow-util_8h.html#a2258030b58194ee63d15a17a9b4a5384">FlowGetReverseProtoMapping</a> (uint8_t rproto)</td></tr>
<tr class="separator:a2258030b58194ee63d15a17a9b4a5384"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a> </dd></dl>

<p>Definition in file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a57d51f8d717d2a7dc310f599023c74a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COPY_TIMESTAMP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">src, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dst&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((dst)-&gt;tv_sec = (src)-&gt;tv_sec, (dst)-&gt;tv_usec = (src)-&gt;tv_usec)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00030">30</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

<p>Referenced by <a class="el" href="flow-hash_8c_source.html#l00653">FlowGetFlowFromHash()</a>, <a class="el" href="flow-hash_8c_source.html#l00521">FlowGetFlowFromHashByPacket()</a>, <a class="el" href="flow-util_8c_source.html#l00126">FlowInit()</a>, and <a class="el" href="flow-hash_8c_source.html#l00565">FlowLookupFlowFromHash()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b8de064e734599ba0f3ba39fdb9c89d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_CHECK_MEMCAP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size</td><td>)</td>
          <td>&#160;&#160;&#160;((((uint64_t)<a class="el" href="util-atomic_8h.html#ac07c71db3cf6014ce1b646a3b40d02c5">SC_ATOMIC_GET</a>(flow_memuse) + (uint64_t)(size)) &lt;= flow_config.memcap))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check if a memory alloc would fit in the memcap </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>memory allocation size to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>it fits </td></tr>
    <tr><td class="paramname">0</td><td>no fit </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00142">142</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

<p>Referenced by <a class="el" href="flow-util_8c_source.html#l00049">FlowAlloc()</a>, and <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="ad8cd231f2ee6558e668c7befac7bb214"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_DESTROY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { <a class="code" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d">\</a></div>
<div class="line"><a class="code" href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d">        FlowCleanupAppLayer</a>((f)); <a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">\</a></div>
<div class="line"><a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">        SC_ATOMIC_DESTROY</a>((f)-&gt;flow_state); <a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">\</a></div>
<div class="line"><a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">        SC_ATOMIC_DESTROY</a>((f)-&gt;use_cnt); <a class="code" href="flow_8h.html#a16f423df380e1fef0f4f2c53c511d7ac">\</a></div>
<div class="line"><a class="code" href="flow_8h.html#a16f423df380e1fef0f4f2c53c511d7ac">        \</a></div>
<div class="line"><a class="code" href="flow_8h.html#a16f423df380e1fef0f4f2c53c511d7ac">        FLOWLOCK_DESTROY</a>((f)); \</div>
<div class="line">        if ((f)-&gt;de_state != NULL) { <a class="code" href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">\</a></div>
<div class="line"><a class="code" href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">            DetectEngineStateFlowFree</a>((f)-&gt;de_state); \</div>
<div class="line">        } <a class="code" href="util-var_8c.html#a87ec4a01436cbc5f9edc316ca7f8b530">\</a></div>
<div class="line"><a class="code" href="util-var_8c.html#a87ec4a01436cbc5f9edc316ca7f8b530">        GenericVarFree</a>((f)-&gt;flowvar); <a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">\</a></div>
<div class="line"><a class="code" href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">        SC_ATOMIC_DESTROY</a>((f)-&gt;autofp_tmqh_flow_qid);   \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
<div class="ttc" id="group__sigstate_html_gacfef8e2bcb55dc6ec2788c418dc4a7d6"><div class="ttname"><a href="group__sigstate.html#gacfef8e2bcb55dc6ec2788c418dc4a7d6">DetectEngineStateFlowFree</a></div><div class="ttdeci">void DetectEngineStateFlowFree(DetectEngineStateFlow *state)</div><div class="ttdef"><b>Definition:</b> <a href="detect-engine-state_8c_source.html#l00305">detect-engine-state.c:305</a></div></div>
<div class="ttc" id="util-atomic_8h_html_a3b70b093fa0d3dfbd6f3d2c60551dbcb"><div class="ttname"><a href="util-atomic_8h.html#a3b70b093fa0d3dfbd6f3d2c60551dbcb">SC_ATOMIC_DESTROY</a></div><div class="ttdeci">#define SC_ATOMIC_DESTROY(name)</div><div class="ttdoc">Destroy the lock used to protect this variable. </div><div class="ttdef"><b>Definition:</b> <a href="util-atomic_8h_source.html#l00098">util-atomic.h:98</a></div></div>
<div class="ttc" id="flow_8h_html_a16f423df380e1fef0f4f2c53c511d7ac"><div class="ttname"><a href="flow_8h.html#a16f423df380e1fef0f4f2c53c511d7ac">FLOWLOCK_DESTROY</a></div><div class="ttdeci">#define FLOWLOCK_DESTROY(fb)</div><div class="ttdef"><b>Definition:</b> <a href="flow_8h_source.html#l00206">flow.h:206</a></div></div>
<div class="ttc" id="util-var_8c_html_a87ec4a01436cbc5f9edc316ca7f8b530"><div class="ttname"><a href="util-var_8c.html#a87ec4a01436cbc5f9edc316ca7f8b530">GenericVarFree</a></div><div class="ttdeci">void GenericVarFree(GenericVar *gv)</div><div class="ttdef"><b>Definition:</b> <a href="util-var_8c_source.html#l00047">util-var.c:47</a></div></div>
<div class="ttc" id="flow_8c_html_ac544802aadaf9306d54a61942d3e597d"><div class="ttname"><a href="flow_8c.html#ac544802aadaf9306d54a61942d3e597d">FlowCleanupAppLayer</a></div><div class="ttdeci">void FlowCleanupAppLayer(Flow *f)</div><div class="ttdef"><b>Definition:</b> <a href="flow_8c_source.html#l00094">flow.c:94</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00122">122</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

<p>Referenced by <a class="el" href="flow-util_8c_source.html#l00077">FlowFree()</a>.</p>

</div>
</div>
<a class="anchor" id="a53e29475f0245aff5efa048157120b3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_INITIALIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00039">39</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

<p>Referenced by <a class="el" href="flow-util_8c_source.html#l00049">FlowAlloc()</a>.</p>

</div>
</div>
<a class="anchor" id="a51c75baaba44d2813cddb48bc219dba3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FLOW_RECYCLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>macro to recycle a flow before it goes into the spare queue for reuse. </p>
<p>Note that the lnext, lprev, hnext, hprev fields are untouched, those are managed by the queueing code. Same goes for fb (FlowBucket ptr) field. </p>

<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00083">83</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00783">FlowClearMemory()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c672ebcb139c961b30432e63bef7647"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESET_COUNTERS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div>
<div class="line">        (f)-&gt;todstpktcnt = 0; \</div>
<div class="line">        (f)-&gt;tosrcpktcnt = 0; \</div>
<div class="line">        (f)-&gt;todstbytecnt = 0; \</div>
<div class="line">        (f)-&gt;tosrcbytecnt = 0; \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="flow-util_8h_source.html#l00032">32</a> of file <a class="el" href="flow-util_8h_source.html">flow-util.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae1ba1db44e3a77c4829397d5d659c432"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a>* FlowAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>allocate a flow </p>
<p>We check against the memuse counter. If it passes that check we increment the counter first, then we try to alloc.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">f</td><td>the flow or NULL on out of memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow-util_8c_source.html#l00049">49</a> of file <a class="el" href="flow-util_8c_source.html">flow-util.c</a>.</p>

<p>References <a class="el" href="flow-util_8h_source.html#l00142">FLOW_CHECK_MEMCAP</a>, <a class="el" href="flow-util_8h_source.html#l00039">FLOW_INITIALIZE</a>, <a class="el" href="flow-storage_8c_source.html#l00034">FlowStorageSize()</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00347">FlowInitConfig()</a>, and <a class="el" href="flow_8c_source.html#l00113">FlowUpdateSpareFlows()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_cgraph.png" border="0" usemap="#flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_cgraph" alt=""/></div>
<map name="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_cgraph" id="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_cgraph">
<area shape="rect" id="node2" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="134,5,255,32"/><area shape="rect" id="node3" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="304,5,419,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_icgraph.png" border="0" usemap="#flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_icgraph" alt=""/></div>
<map name="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_icgraph" id="flow-util_8h_ae1ba1db44e3a77c4829397d5d659c432_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#a897689d742258e918e752f50cd93915e" title="initialize the configuration " alt="" coords="161,5,268,32"/><area shape="rect" id="node4" href="flow_8h.html#a0a2af32f22fdfd78a6fef1a70ee995d8" title="Make sure we have enough spare flows. " alt="" coords="134,56,295,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="344,5,395,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a30ec58fb96268052af9546dcf5253fb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a>* FlowAllocDirect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad4befc0a3b97d4a6f794a8b39e75a23b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cleanup &amp; free the memory of a flow </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>flow to clear &amp; destroy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow-util_8c_source.html#l00077">77</a> of file <a class="el" href="flow-util_8c_source.html">flow-util.c</a>.</p>

<p>References <a class="el" href="flow-util_8h_source.html#l00122">FLOW_DESTROY</a>, <a class="el" href="flow-storage_8c_source.html#l00034">FlowStorageSize()</a>, <a class="el" href="util-atomic_8h_source.html#l00125">SC_ATOMIC_SUB</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="flow_8c_source.html#l00488">FlowShutdown()</a>, and <a class="el" href="flow_8c_source.html#l00113">FlowUpdateSpareFlows()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_cgraph.png" border="0" usemap="#flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_cgraph" alt=""/></div>
<map name="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_cgraph" id="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_cgraph">
<area shape="rect" id="node2" href="flow-storage_8c.html#addf24d1bbb0b9771b4f27286db99a5dd" title="FlowStorageSize" alt="" coords="131,5,253,32"/><area shape="rect" id="node3" href="util-storage_8c.html#a7cc083db4db0385f32d65439b82827f9" title="get the size of the void array used to store the pointers " alt="" coords="301,5,416,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_icgraph.png" border="0" usemap="#flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_icgraph" alt=""/></div>
<map name="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_icgraph" id="flow-util_8h_ad4befc0a3b97d4a6f794a8b39e75a23b_icgraph">
<area shape="rect" id="node2" href="flow_8h.html#a8dae51c56800ed0e22279e49913cd15a" title="shutdown the flow engine " alt="" coords="158,5,266,32"/><area shape="rect" id="node4" href="flow_8h.html#a0a2af32f22fdfd78a6fef1a70ee995d8" title="Make sure we have enough spare flows. " alt="" coords="131,56,293,83"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="341,5,392,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6c56d55252b820e15a001a5efb93c79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t FlowGetProtoMapping </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to map the protocol to the defined FLOW_PROTO_* enumeration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proto</td><td>protocol which is needed to be mapped </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="flow-util_8c_source.html#l00092">92</a> of file <a class="el" href="flow-util_8c_source.html">flow-util.c</a>.</p>

<p>References <a class="el" href="flow-private_8h_source.html#l00065">FLOW_PROTO_DEFAULT</a>, <a class="el" href="flow-private_8h_source.html#l00063">FLOW_PROTO_ICMP</a>, <a class="el" href="flow-private_8h_source.html#l00064">FLOW_PROTO_SCTP</a>, <a class="el" href="flow-private_8h_source.html#l00061">FLOW_PROTO_TCP</a>, and <a class="el" href="flow-private_8h_source.html#l00062">FLOW_PROTO_UDP</a>.</p>

<p>Referenced by <a class="el" href="app-layer-parser_8c_source.html#l00507">AppLayerParserDestroyProtocolParserLocalStorage()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00779">AppLayerParserGetEventInfo()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00590">AppLayerParserGetEventsByTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00613">AppLayerParserGetFiles()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00789">AppLayerParserGetFirstDataDir()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00492">AppLayerParserGetProtocolParserLocalStorage()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00736">AppLayerParserGetStateProgress()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00769">AppLayerParserGetStateProgressCompletionStatus()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00798">AppLayerParserGetTransactionActive()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00760">AppLayerParserGetTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00751">AppLayerParserGetTxCnt()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00833">AppLayerParserGetTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00987">AppLayerParserHasDecoderEvents()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00823">AppLayerParserHasTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00854">AppLayerParserParse()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01055">AppLayerParserProtocolHasLogger()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01031">AppLayerParserProtocolIsTxAware()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01039">AppLayerParserProtocolIsTxEventAware()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01047">AppLayerParserProtocolSupportsTxs()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00476">AppLayerParserRegisterDetectStateFuncs()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00464">AppLayerParserRegisterGetEventInfo()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00367">AppLayerParserRegisterGetEventsFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00356">AppLayerParserRegisterGetFilesFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00452">AppLayerParserRegisterGetStateProgressCompletionStatus()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00408">AppLayerParserRegisterGetStateProgressFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00441">AppLayerParserRegisterGetTx()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00430">AppLayerParserRegisterGetTxCnt()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00378">AppLayerParserRegisterHasEventsFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00342">AppLayerParserRegisterLocalStorageFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00389">AppLayerParserRegisterLogger()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00302">AppLayerParserRegisterParser()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00317">AppLayerParserRegisterParserAcceptableDataDirection()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00328">AppLayerParserRegisterStateFuncs()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00398">AppLayerParserRegisterTruncateFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00419">AppLayerParserRegisterTxFreeFunc()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00841">AppLayerParserSetTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01075">AppLayerParserStateCleanup()</a>, <a class="el" href="app-layer-parser_8c_source.html#l01158">AppLayerParserStreamTruncated()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00816">AppLayerParserSupportsTxDetectState()</a>, <a class="el" href="app-layer-parser_8c_source.html#l00633">AppLayerTransactionGetActiveDetectLog()</a>, <a class="el" href="detect-engine_8c_source.html#l00429">DetectEngineRegisterAppInspectionEngine()</a>, <a class="el" href="flow-util_8c_source.html#l00126">FlowInit()</a>, <a class="el" href="flow_8c_source.html#l00848">FlowSetProtoEmergencyTimeout()</a>, <a class="el" href="flow_8c_source.html#l00807">FlowSetProtoFreeFunc()</a>, <a class="el" href="flow_8c_source.html#l00825">FlowSetProtoTimeout()</a>, and <a class="el" href="flow_8c_source.html#l00488">FlowShutdown()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_aa6c56d55252b820e15a001a5efb93c79_icgraph.png" border="0" usemap="#flow-util_8h_aa6c56d55252b820e15a001a5efb93c79_icgraph" alt=""/></div>
<map name="flow-util_8h_aa6c56d55252b820e15a001a5efb93c79_icgraph" id="flow-util_8h_aa6c56d55252b820e15a001a5efb93c79_icgraph">
<area shape="rect" id="node2" href="app-layer-parser_8h.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="223,5,433,46"/><area shape="rect" id="node4" href="app-layer-parser_8h.html#a3e057153e7aa3780ec153c4fa78683dc" title="AppLayerParserGetEventInfo" alt="" coords="232,71,424,97"/><area shape="rect" id="node5" href="app-layer-parser_8h.html#ad1169b8b33ecbf696a4bb4ebf6a73afe" title="AppLayerParserGetEventsByTx" alt="" coords="224,405,432,432"/><area shape="rect" id="node8" href="app-layer-parser_8h.html#a61937469c7d97a4b5d778b939d408025" title="AppLayerParserGetFiles" alt="" coords="246,121,410,148"/><area shape="rect" id="node10" href="app-layer-parser_8h.html#a8c88d6dbf8a5717a2b655d6ae7360571" title="AppLayerParserGetFirstDataDir" alt="" coords="225,223,431,249"/><area shape="rect" id="node11" href="app-layer-parser_8h.html#a2b0517e26b65ae0299677d4f097b223f" title="AppLayerParserGetProtocol\lParserLocalStorage" alt="" coords="236,274,420,315"/><area shape="rect" id="node12" href="app-layer-parser_8h.html#a40034fae4dec89b59ac20ec111eb114b" title="get the progress value for a tx/protocol " alt="" coords="219,172,437,199"/><area shape="rect" id="node13" href="app-layer-parser_8h.html#aa6d2b1e4dcee3616e0fdda0ee96e03f8" title="AppLayerParserGetStateProgress\lCompletionStatus" alt="" coords="219,339,437,381"/><area shape="rect" id="node14" href="app-layer-parser_8h.html#a94cf1238174774410af9d024b256c955" title="AppLayerParserGetTransaction\lActive" alt="" coords="226,457,430,498"/><area shape="rect" id="node15" href="app-layer-parser_8h.html#a2a0c9e0f732c9fb0240cf2f0b73613f6" title="AppLayerParserGetTx" alt="" coords="253,523,403,549"/><area shape="rect" id="node16" href="app-layer-parser_8h.html#a8fe15cbcd76f969cc497b74aeb90ee66" title="AppLayerParserGetTxCnt" alt="" coords="242,705,414,732"/><area shape="rect" id="node17" href="app-layer-parser_8h.html#a0c30716ce0c65eca306be891f35411d2" title="AppLayerParserGetTxDetect\lState" alt="" coords="233,639,423,681"/><area shape="rect" id="node6" href="app-layer-parser_8h.html#a8580f53b8295c5ebe6db119a6cf72eda" title="AppLayerParserHasDecoder\lEvents" alt="" coords="506,637,694,678"/><area shape="rect" id="node18" href="app-layer-parser_8h.html#a4cda62cba4ab99b66d81cdb8b97a21ee" title="AppLayerParserHasTxDetect\lState" alt="" coords="231,757,425,798"/><area shape="rect" id="node19" href="app-layer-parser_8h.html#a781eb6e91987a99a3b9fceb2e4af5806" title="AppLayerParserParse" alt="" coords="525,1611,675,1637"/><area shape="rect" id="node20" href="app-layer-parser_8h.html#a038a6d8558f8764eb11cfdf3f6bfbb6f" title="AppLayerParserProtocolHas\lLogger" alt="" coords="235,874,421,915"/><area shape="rect" id="node21" href="app-layer-parser_8h.html#a2d3c6b202b4889e0a59af74c6a8993e6" title="AppLayerParserProtocolIs\lTxAware" alt="" coords="241,939,415,981"/><area shape="rect" id="node22" href="app-layer-parser_8h.html#a835807416df3919a8301a8a5d87dd64a" title="AppLayerParserProtocolIs\lTxEventAware" alt="" coords="241,574,415,615"/><area shape="rect" id="node23" href="app-layer-parser_8h.html#a5d36767e076ef8376251c27326532e55" title="AppLayerParserProtocolSupportsTxs" alt="" coords="209,1056,447,1083"/><area shape="rect" id="node24" href="app-layer-parser_8h.html#ab03a428dbbc04ab52ab3b2dd518ebef5" title="AppLayerParserRegisterDetect\lStateFuncs" alt="" coords="227,1107,429,1149"/><area shape="rect" id="node25" href="app-layer-parser_8h.html#a4464abdb35bc030e13e77c20fa812e31" title="AppLayerParserRegisterGet\lEventInfo" alt="" coords="235,1173,421,1214"/><area shape="rect" id="node26" href="app-layer-parser_8h.html#a56390a33c6600d8a9028e533be702c20" title="AppLayerParserRegisterGet\lEventsFunc" alt="" coords="235,1238,421,1279"/><area shape="rect" id="node27" href="app-layer-parser_8h.html#a95085ab4844d65cbd5351cfcc312809d" title="AppLayerParserRegisterGet\lFilesFunc" alt="" coords="235,1303,421,1345"/><area shape="rect" id="node28" href="app-layer-parser_8h.html#aafb21cc825aa4d25d67e05742dcaf48f" title="AppLayerParserRegisterGet\lStateProgressCompletionStatus" alt="" coords="223,1369,433,1410"/><area shape="rect" id="node29" href="app-layer-parser_8h.html#a90ffbe5cd79ace5772526e1b1e9d8f59" title="AppLayerParserRegisterGet\lStateProgressFunc" alt="" coords="235,1434,421,1475"/><area shape="rect" id="node30" href="app-layer-parser_8h.html#a9e2aba01bb7d7e1a72c067c8cda6712a" title="AppLayerParserRegisterGetTx" alt="" coords="228,1500,428,1527"/><area shape="rect" id="node31" href="app-layer-parser_8h.html#a19b20316115ceb60724c5395a46419d2" title="AppLayerParserRegisterGet\lTxCnt" alt="" coords="235,1551,421,1593"/><area shape="rect" id="node32" href="app-layer-parser_8h.html#afeb9006eec85a4c48343f7a78e64fced" title="AppLayerParserRegisterHas\lEventsFunc" alt="" coords="234,1617,422,1658"/><area shape="rect" id="node33" href="app-layer-parser_8h.html#aae5ee628c6be608cd1a8ba32b4dc3655" title="AppLayerParserRegisterLocal\lStorageFunc" alt="" coords="231,1682,425,1723"/><area shape="rect" id="node34" href="app-layer-parser_8h.html#a1d68d99b17da0cf02a09e2788750eda5" title="AppLayerParserRegisterLogger" alt="" coords="227,1748,429,1775"/><area shape="rect" id="node35" href="app-layer-parser_8h.html#ab12da1e0fb5d53f08ad527d8c0545edb" title="Register app layer parser for the protocol. " alt="" coords="227,1799,429,1825"/><area shape="rect" id="node36" href="app-layer-parser_8h.html#a9d0e2fe5b5c9f000e32a11408336179a" title="AppLayerParserRegisterParser\lAcceptableDataDirection" alt="" coords="227,1850,429,1891"/><area shape="rect" id="node37" href="app-layer-parser_8h.html#ad55349f6defb615d8e239052f38005fe" title="AppLayerParserRegisterState\lFuncs" alt="" coords="231,1915,425,1957"/><area shape="rect" id="node38" href="app-layer-parser_8h.html#a0b0ff34db192e50a464314d84f97cb20" title="AppLayerParserRegisterTruncateFunc" alt="" coords="206,1981,450,2008"/><area shape="rect" id="node39" href="app-layer-parser_8h.html#a1e9ea8d4f67bff35ebebf383c3c7c9e6" title="AppLayerParserRegisterTx\lFreeFunc" alt="" coords="239,2033,417,2074"/><area shape="rect" id="node40" href="app-layer-parser_8h.html#a33740479fe28b79dbe57f34ef2f2d68d" title="AppLayerParserSetTxDetect\lState" alt="" coords="233,2098,423,2139"/><area shape="rect" id="node41" href="app-layer-parser_8h.html#a6553f5d0bec8c0643ce3e090803b10ac" title="AppLayerParserStateCleanup" alt="" coords="231,2164,425,2191"/><area shape="rect" id="node42" href="app-layer-parser_8h.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="221,1005,435,1032"/><area shape="rect" id="node43" href="app-layer-parser_8h.html#a548a3c3334ecdf0485eb8299c8387ac2" title="AppLayerParserSupportsTx\lDetectState" alt="" coords="237,2266,419,2307"/><area shape="rect" id="node44" href="app-layer-parser_8h.html#a5eb53f87bb84cf0033d7e4fcb651dfd8" title="active TX retrieval for normal ops: so with detection and logging " alt="" coords="227,2331,429,2373"/><area shape="rect" id="node45" href="detect-engine_8h.html#a5e7354abe2d7affd63fb5d4cfe90f129" title="Registers an app inspection engine. " alt="" coords="211,2397,445,2438"/><area shape="rect" id="node46" href="flow-util_8h.html#a5e6253940963b9fee6c2a3948ee156da" title="FlowInit" alt="" coords="294,2463,362,2489"/><area shape="rect" id="node47" href="flow_8h.html#ab1ae8442a76cc103be69b7ff88c2902b" title="Function to set the emergency timeout values for the specified protocol. " alt="" coords="221,2513,435,2540"/><area shape="rect" id="node48" href="flow_8h.html#ae6e272a7eb70dfe726b9c241c5d1b30f" title="Function to set the function to get protocol specific flow state. " alt="" coords="250,2564,406,2591"/><area shape="rect" id="node49" href="flow_8h.html#a883d764885326fa4b40e767490490191" title="Function to set the timeout values for the specified protocol. " alt="" coords="254,2615,402,2641"/><area shape="rect" id="node50" href="flow_8h.html#a8dae51c56800ed0e22279e49913cd15a" title="shutdown the flow engine " alt="" coords="274,2665,382,2692"/><area shape="rect" id="node3" href="app-layer-parser_8h.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="499,12,701,39"/><area shape="rect" id="node7" href="detect-engine-apt-event_8h.html#a29c9027e116175435d7d5de39cfaf213" title="DetectEngineAptEventInspect" alt="" coords="501,347,699,373"/><area shape="rect" id="node9" href="detect-filestore_8h.html#a1b1705dcb7a6d4e7d346c05319d76497" title="post&#45;match function for filestore " alt="" coords="513,121,687,148"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2258030b58194ee63d15a17a9b4a5384"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t FlowGetReverseProtoMapping </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rproto</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow-util_8c_source.html#l00108">108</a> of file <a class="el" href="flow-util_8c_source.html">flow-util.c</a>.</p>

<p>References <a class="el" href="flow-private_8h_source.html#l00063">FLOW_PROTO_ICMP</a>, <a class="el" href="flow-private_8h_source.html#l00064">FLOW_PROTO_SCTP</a>, <a class="el" href="flow-private_8h_source.html#l00061">FLOW_PROTO_TCP</a>, and <a class="el" href="flow-private_8h_source.html#l00062">FLOW_PROTO_UDP</a>.</p>

<p>Referenced by <a class="el" href="app-layer-parser_8c_source.html#l00194">AppLayerParserThreadCtxAlloc()</a>, and <a class="el" href="app-layer-parser_8c_source.html#l00220">AppLayerParserThreadCtxFree()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_a2258030b58194ee63d15a17a9b4a5384_icgraph.png" border="0" usemap="#flow-util_8h_a2258030b58194ee63d15a17a9b4a5384_icgraph" alt=""/></div>
<map name="flow-util_8h_a2258030b58194ee63d15a17a9b4a5384_icgraph" id="flow-util_8h_a2258030b58194ee63d15a17a9b4a5384_icgraph">
<area shape="rect" id="node2" href="app-layer-parser_8h.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="504,305,709,332"/><area shape="rect" id="node30" href="app-layer-parser_8h.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="253,356,456,383"/><area shape="rect" id="node3" href="app-layer_8h.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="802,305,961,332"/><area shape="rect" id="node4" href="group__decode.html#gac7665e2409fe6cc688c1ba7bead8cc57" title="Alloc and setup DecodeThreadVars. " alt="" coords="1092,508,1255,535"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8h.html#a5dc1a2f2120af56ff09791171c822897" title="StreamTcpReassembleInitThreadCtx" alt="" coords="1054,9,1293,36"/><area shape="rect" id="node5" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="1358,208,1509,235"/><area shape="rect" id="node11" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="1350,259,1517,285"/><area shape="rect" id="node13" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="1352,461,1515,488"/><area shape="rect" id="node15" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="1354,512,1513,539"/><area shape="rect" id="node17" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="1343,715,1524,741"/><area shape="rect" id="node19" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="1357,816,1510,843"/><area shape="rect" id="node21" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="1345,917,1521,944"/><area shape="rect" id="node23" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="1356,613,1511,640"/><area shape="rect" id="node25" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="1354,411,1513,437"/><area shape="rect" id="node6" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="1589,208,1792,235"/><area shape="rect" id="node7" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1857,487,1991,513"/><area shape="rect" id="node8" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2040,487,2139,513"/><area shape="rect" id="node9" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2187,512,2336,539"/><area shape="rect" id="node10" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2384,487,2435,513"/><area shape="rect" id="node12" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1581,259,1800,285"/><area shape="rect" id="node14" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1583,461,1798,488"/><area shape="rect" id="node16" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="1585,512,1796,539"/><area shape="rect" id="node18" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1574,715,1807,741"/><area shape="rect" id="node20" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1588,816,1793,843"/><area shape="rect" id="node22" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="1577,917,1805,944"/><area shape="rect" id="node24" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="1587,613,1794,640"/><area shape="rect" id="node26" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1585,411,1796,437"/><area shape="rect" id="node28" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="1361,5,1505,32"/><area shape="rect" id="node29" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1593,56,1789,83"/><area shape="rect" id="node31" href="app-layer_8h.html#a65223001ebb6a1f0668b9bd1ba742dd6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="515,356,699,383"/><area shape="rect" id="node32" href="group__decode.html#ga6339c663affee81d94921a3ab2860e15" title="DecodeThreadVarsFree" alt="" coords="801,508,961,535"/><area shape="rect" id="node42" href="stream-tcp-reassemble_8h.html#a5879b9a05fd13c3c9249e60a1f646bbb" title="StreamTcpReassembleFreeThreadCtx" alt="" coords="758,356,1005,383"/><area shape="rect" id="node33" href="group__afppacket.html#ga3c4a177fe643cfbf02de98b31b9a1563" title="DecodeAFPThreadDeinit" alt="" coords="1090,135,1257,161"/><area shape="rect" id="node34" href="source-erf-dag_8c.html#a4d3a683beeb01b9bf7ff6250725af6c3" title="DecodeErfDagThreadDeinit" alt="" coords="1342,157,1525,184"/><area shape="rect" id="node35" href="source-erf-file_8c.html#ad490c99f184e1a57d79a381d23658fd3" title="DecodeErfFileThreadDeinit" alt="" coords="1084,407,1263,433"/><area shape="rect" id="node36" href="source-ipfw_8c.html#a81efbe592654d1938744b11b53988c30" title="DecodeIPFWThreadDeinit" alt="" coords="1086,561,1261,588"/><area shape="rect" id="node37" href="source-napatech_8c.html#a16fe31e46b66b413c5d2f685476da38d" title="NapatechDecodeThreadDeinit" alt="" coords="1075,708,1272,735"/><area shape="rect" id="node38" href="source-nfq_8c.html#ab2b0780dd2b06a06a328601656415f9b" title="DecodeNFQThreadDeinit" alt="" coords="1089,796,1258,823"/><area shape="rect" id="node39" href="source-pcap-file_8c.html#afb35954ee3770828d4f43991f0d1447f" title="DecodePcapFileThreadDeinit" alt="" coords="1077,923,1269,949"/><area shape="rect" id="node40" href="source-pcap_8c.html#ae70054297eb6079e7d391aa329e92b3e" title="DecodePcapThreadDeinit" alt="" coords="1088,639,1259,665"/><area shape="rect" id="node41" href="source-pfring_8c.html#a87b1c0c7fe35d1fce94ad778f80fd5b3" title="DecodePfringThreadDeinit" alt="" coords="1086,331,1261,357"/><area shape="rect" id="node43" href="stream-tcp_8h.html#a108137f5e3fa9caa0aab96a14df9b1cc" title="StreamTcpThreadDeinit" alt="" coords="1093,68,1253,95"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5e6253940963b9fee6c2a3948ee156da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FlowInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="flow_8h.html#a7669d014b29ca423cad5940bba00575b">Flow</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="flow-util_8c_source.html#l00126">126</a> of file <a class="el" href="flow-util_8c_source.html">flow-util.c</a>.</p>

<p>References <a class="el" href="flow_8h_source.html#l00311">Flow_::code</a>, <a class="el" href="decode_8h_source.html#l00383">Packet_::code</a>, <a class="el" href="flow-util_8h_source.html#l00030">COPY_TIMESTAMP</a>, <a class="el" href="flow_8h_source.html#l00310">Flow_::dp</a>, <a class="el" href="flow_8h_source.html#l00304">Flow_::dst</a>, <a class="el" href="flow_8h_source.html#l00339">Flow_::flags</a>, <a class="el" href="flow_8h_source.html#l00096">FLOW_IPV4</a>, <a class="el" href="flow_8h_source.html#l00098">FLOW_IPV6</a>, <a class="el" href="flow_8h_source.html#l00138">FLOW_SET_IPV4_DST_ADDR_FROM_PACKET</a>, <a class="el" href="flow_8h_source.html#l00131">FLOW_SET_IPV4_SRC_ADDR_FROM_PACKET</a>, <a class="el" href="flow_8h_source.html#l00162">FLOW_SET_IPV6_DST_ADDR_FROM_PACKET</a>, <a class="el" href="flow_8h_source.html#l00155">FLOW_SET_IPV6_SRC_ADDR_FROM_PACKET</a>, <a class="el" href="flow-util_8c_source.html#l00092">FlowGetProtoMapping()</a>, <a class="el" href="decode_8h_source.html#l00470">Packet_::icmpv4h</a>, <a class="el" href="decode_8h_source.html#l00472">Packet_::icmpv6h</a>, <a class="el" href="decode_8h_source.html#l00240">PKT_IS_IPV4</a>, <a class="el" href="decode_8h_source.html#l00241">PKT_IS_IPV6</a>, <a class="el" href="flow_8h_source.html#l00313">Flow_::proto</a>, <a class="el" href="decode_8h_source.html#l00385">Packet_::proto</a>, <a class="el" href="flow_8h_source.html#l00359">Flow_::protomap</a>, <a class="el" href="flow_8h_source.html#l00314">Flow_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00388">Packet_::recursion_level</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="decode_8h_source.html#l00468">Packet_::sctph</a>, <a class="el" href="decode_8h_source.html#l00197">SET_SCTP_DST_PORT</a>, <a class="el" href="decode_8h_source.html#l00193">SET_SCTP_SRC_PORT</a>, <a class="el" href="decode_8h_source.html#l00178">SET_TCP_DST_PORT</a>, <a class="el" href="decode_8h_source.html#l00174">SET_TCP_SRC_PORT</a>, <a class="el" href="decode_8h_source.html#l00187">SET_UDP_DST_PORT</a>, <a class="el" href="decode_8h_source.html#l00184">SET_UDP_SRC_PORT</a>, <a class="el" href="flow_8h_source.html#l00306">Flow_::sp</a>, <a class="el" href="flow_8h_source.html#l00304">Flow_::src</a>, <a class="el" href="flow_8h_source.html#l00408">Flow_::startts</a>, <a class="el" href="decode_8h_source.html#l00464">Packet_::tcph</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, <a class="el" href="flow_8h_source.html#l00307">Flow_::type</a>, <a class="el" href="decode_8h_source.html#l00379">Packet_::type</a>, <a class="el" href="decode_8h_source.html#l00466">Packet_::udph</a>, <a class="el" href="flow_8h_source.html#l00315">Flow_::vlan_id</a>, and <a class="el" href="decode_8h_source.html#l00390">Packet_::vlan_id</a>.</p>

<p>Referenced by <a class="el" href="flow-hash_8c_source.html#l00653">FlowGetFlowFromHash()</a>, and <a class="el" href="flow-hash_8c_source.html#l00521">FlowGetFlowFromHashByPacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_cgraph.png" border="0" usemap="#flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_cgraph" alt=""/></div>
<map name="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_cgraph" id="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_cgraph">
<area shape="rect" id="node2" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="123,5,274,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_icgraph.png" border="0" usemap="#flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_icgraph" alt=""/></div>
<map name="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_icgraph" id="flow-util_8h_a5e6253940963b9fee6c2a3948ee156da_icgraph">
<area shape="rect" id="node2" href="flow-hash_8h.html#a35d0df650b2a8159684cca315da5cd5a" title="Get Flow for packet. " alt="" coords="152,1204,312,1231"/><area shape="rect" id="node47" href="flow_8h.html#a628b6bcbde30406b081f469cc641386e" title="FlowGetFlowFromHashByPacket" alt="" coords="123,1255,341,1281"/><area shape="rect" id="node3" href="flow_8h.html#ae727a896e38d8ebdce4b7b050d08c178" title="Entry point for packet flow handling. " alt="" coords="390,1204,522,1231"/><area shape="rect" id="node4" href="decode_8h.html#a03b94d79586f4abbd8b762f75de608c8" title="Main ICMPv4 decoding function. " alt="" coords="571,1153,688,1180"/><area shape="rect" id="node44" href="decode_8h.html#af09d0f9b3af3be970dbe770c79e66cce" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="736,1660,853,1687"/><area shape="rect" id="node45" href="decode_8h.html#a04bd1d44001e393003da2420291028e1" title="DecodeSCTP" alt="" coords="578,1255,681,1281"/><area shape="rect" id="node46" href="decode_8h.html#a1683201a43f216e90e02810223202957" title="DecodeTCP" alt="" coords="582,1204,677,1231"/><area shape="rect" id="node22" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="2003,420,2099,447"/><area shape="rect" id="node5" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="747,1153,843,1180"/><area shape="rect" id="node6" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="902,775,1018,801"/><area shape="rect" id="node24" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="2432,1508,2533,1535"/><area shape="rect" id="node26" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2431,1036,2534,1063"/><area shape="rect" id="node27" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="2435,1660,2530,1687"/><area shape="rect" id="node29" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="2668,1457,2759,1484"/><area shape="rect" id="node34" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="2666,673,2761,700"/><area shape="rect" id="node35" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="2403,980,2563,1007"/><area shape="rect" id="node38" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="2922,927,3017,953"/><area shape="rect" id="node37" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="2928,876,3011,903"/><area shape="rect" id="node18" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1245,623,1352,649"/><area shape="rect" id="node36" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="2662,953,2765,980"/><area shape="rect" id="node7" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="3165,643,3259,669"/><area shape="rect" id="node13" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1245,319,1353,345"/><area shape="rect" id="node15" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1465,369,1570,396"/><area shape="rect" id="node17" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1067,623,1189,649"/><area shape="rect" id="node30" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="3163,769,3261,796"/><area shape="rect" id="node40" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1077,471,1179,497"/><area shape="rect" id="node42" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1237,724,1360,751"/><area shape="rect" id="node32" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="3123,857,3301,884"/><area shape="rect" id="node8" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="3364,643,3567,669"/><area shape="rect" id="node9" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="3630,643,3765,669"/><area shape="rect" id="node10" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="3813,643,3912,669"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="3960,617,4109,644"/><area shape="rect" id="node12" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="4157,643,4208,669"/><area shape="rect" id="node14" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1408,167,1627,193"/><area shape="rect" id="node16" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1943,369,2158,396"/><area shape="rect" id="node19" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="1439,319,1595,345"/><area shape="rect" id="node20" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1732,268,1828,295"/><area shape="rect" id="node21" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1727,319,1833,345"/><area shape="rect" id="node23" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="2237,1305,2333,1332"/><area shape="rect" id="node39" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="2217,420,2354,447"/><area shape="rect" id="node25" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2864,1288,3075,1315"/><area shape="rect" id="node28" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="2611,1609,2816,1636"/><area shape="rect" id="node31" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="3362,731,3569,757"/><area shape="rect" id="node33" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="3350,848,3581,875"/><area shape="rect" id="node41" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1675,471,1885,497"/><area shape="rect" id="node43" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1934,673,2167,700"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="flow-util_8h.html">flow-util.h</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:08 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
