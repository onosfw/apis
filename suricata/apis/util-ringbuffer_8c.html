<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/util-ringbuffer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('util-ringbuffer_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util-ringbuffer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-ringbuffer_8h_source.html">util-ringbuffer.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-atomic_8h_source.html">util-atomic.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util-ringbuffer.c:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c__incl.png" border="0" usemap="#src_2util-ringbuffer_8c" alt=""/></div>
<map name="src_2util-ringbuffer_8c" id="src_2util-ringbuffer_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="1845,155,1979,181"/><area shape="rect" id="node46" href="suricata_8h.html" title="suricata.h" alt="" coords="2405,80,2483,107"/><area shape="rect" id="node49" href="util-ringbuffer_8h.html" title="util&#45;ringbuffer.h" alt="" coords="2547,528,2655,555"/><area shape="rect" id="node35" href="util-atomic_8h.html" title="util&#45;atomic.h" alt="" coords="2555,603,2648,629"/><area shape="rect" id="node50" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="2731,80,2828,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="690,229,763,256"/><area shape="rect" id="node26" href="threads_8h.html" title="threads.h" alt="" coords="1867,603,1943,629"/><area shape="rect" id="node29" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="1837,229,1987,256"/><area shape="rect" id="node30" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="1594,379,1683,405"/><area shape="rect" id="node32" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="1757,453,1837,480"/><area shape="rect" id="node34" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="2261,528,2344,555"/><area shape="rect" id="node36" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="1622,229,1761,256"/><area shape="rect" id="node43" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="2011,229,2113,256"/><area shape="rect" id="node44" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="2138,229,2216,256"/><area shape="rect" id="node45" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="2241,229,2319,256"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="428,603,511,629"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="263,379,317,405"/><area shape="rect" id="node15" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="61,304,160,331"/><area shape="rect" id="node16" href="htp__config_8h.html" title="htp_config.h" alt="" coords="1047,304,1140,331"/><area shape="rect" id="node17" href="htp__connection__parser_8h.html" title="htp_connection_parser.h" alt="" coords="1165,304,1328,331"/><area shape="rect" id="node18" href="htp__decompressors_8h.html" title="htp_decompressors.h" alt="" coords="1353,304,1500,331"/><area shape="rect" id="node20" href="htp__hooks_8h.html" title="htp_hooks.h" alt="" coords="1524,304,1617,331"/><area shape="rect" id="node14" href="htp__list_8h.html" title="htp_list.h" alt="" coords="175,528,249,555"/><area shape="rect" id="node21" href="htp__multipart_8h.html" title="htp_multipart.h" alt="" coords="237,304,344,331"/><area shape="rect" id="node22" href="htp__table_8h.html" title="htp_table.h" alt="" coords="471,379,557,405"/><area shape="rect" id="node23" href="htp__transaction_8h.html" title="htp_transaction.h" alt="" coords="369,304,492,331"/><area shape="rect" id="node24" href="htp__urlencoded_8h.html" title="htp_urlencoded.h" alt="" coords="517,304,637,331"/><area shape="rect" id="node25" href="htp__utf8__decoder_8h.html" title="htp_utf8_decoder.h" alt="" coords="789,379,923,405"/><area shape="rect" id="node13" href="bstr__builder_8h.html" title="bstr_builder.h" alt="" coords="118,453,217,480"/><area shape="rect" id="node27" href="util-cpu_8h.html" title="util&#45;cpu.h" alt="" coords="1868,677,1943,704"/><area shape="rect" id="node31" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="1595,453,1681,480"/><area shape="rect" id="node33" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="1445,453,1571,480"/><area shape="rect" id="node37" href="decode_8h.html" title="decode.h" alt="" coords="2231,453,2305,480"/><area shape="rect" id="node41" href="detect_8h.html" title="detect.h" alt="" coords="1692,304,1761,331"/><area shape="rect" id="node38" href="threadvars_8h.html" title="threadvars.h" alt="" coords="1991,528,2085,555"/><area shape="rect" id="node39" href="decode-events_8h.html" title="decode&#45;events.h" alt="" coords="2118,528,2236,555"/><area shape="rect" id="node40" href="source-nflog_8h.html" title="source&#45;nflog.h" alt="" coords="2368,528,2472,555"/><area shape="rect" id="node42" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="2062,379,2172,405"/><area shape="rect" id="node47" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="2395,155,2492,181"/></map>
</div>
</div>
<p><a href="util-ringbuffer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a757ffb434a1b913b1998ce37c3caf1af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a757ffb434a1b913b1998ce37c3caf1af">USLEEP_TIME</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a757ffb434a1b913b1998ce37c3caf1af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae2456a2930a748c56ea058ea435396b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#ae2456a2930a748c56ea058ea435396b4">RingBufferWait</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:ae2456a2930a748c56ea058ea435396b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">wait function for condition where ringbuffer is either full or empty.  <a href="#ae2456a2930a748c56ea058ea435396b4">More...</a><br/></td></tr>
<tr class="separator:ae2456a2930a748c56ea058ea435396b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19598a53bd0691276f27b0ea0510680f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a19598a53bd0691276f27b0ea0510680f">RingBuffer8Shutdown</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="memdesc:a19598a53bd0691276f27b0ea0510680f"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell the ringbuffer to shut down  <a href="#a19598a53bd0691276f27b0ea0510680f">More...</a><br/></td></tr>
<tr class="separator:a19598a53bd0691276f27b0ea0510680f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919e5c55673b3857a5da6f0eecbe468c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a919e5c55673b3857a5da6f0eecbe468c">RingBuffer8IsEmpty</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="memdesc:a919e5c55673b3857a5da6f0eecbe468c"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is empty (no data in it)  <a href="#a919e5c55673b3857a5da6f0eecbe468c">More...</a><br/></td></tr>
<tr class="separator:a919e5c55673b3857a5da6f0eecbe468c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be4501cd1384866ec4571020ddf0cbd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a0be4501cd1384866ec4571020ddf0cbd">RingBuffer8IsFull</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="memdesc:a0be4501cd1384866ec4571020ddf0cbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is full (no more data will fit)  <a href="#a0be4501cd1384866ec4571020ddf0cbd">More...</a><br/></td></tr>
<tr class="separator:a0be4501cd1384866ec4571020ddf0cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1aecf3c9534eb1a7e55fbc89fec2ae0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#ab1aecf3c9534eb1a7e55fbc89fec2ae0">RingBufferShutdown</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:ab1aecf3c9534eb1a7e55fbc89fec2ae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">tell the ringbuffer to shut down  <a href="#ab1aecf3c9534eb1a7e55fbc89fec2ae0">More...</a><br/></td></tr>
<tr class="separator:ab1aecf3c9534eb1a7e55fbc89fec2ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d1ea0bc21f5454f004587aa3899c8b"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a06d1ea0bc21f5454f004587aa3899c8b">RingBufferSize</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:a06d1ea0bc21f5454f004587aa3899c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">get number of items in the ringbuffer  <a href="#a06d1ea0bc21f5454f004587aa3899c8b">More...</a><br/></td></tr>
<tr class="separator:a06d1ea0bc21f5454f004587aa3899c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b48d5ccc4ff38e1fe342067030fa42"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a58b48d5ccc4ff38e1fe342067030fa42">RingBufferIsEmpty</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:a58b48d5ccc4ff38e1fe342067030fa42"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is empty (no data in it)  <a href="#a58b48d5ccc4ff38e1fe342067030fa42">More...</a><br/></td></tr>
<tr class="separator:a58b48d5ccc4ff38e1fe342067030fa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54aed7f7ef8af5b1205402f10b475c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#ad54aed7f7ef8af5b1205402f10b475c1">RingBufferIsFull</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:ad54aed7f7ef8af5b1205402f10b475c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ringbuffer is full (no more data will fit)  <a href="#ad54aed7f7ef8af5b1205402f10b475c1">More...</a><br/></td></tr>
<tr class="separator:ad54aed7f7ef8af5b1205402f10b475c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604738970be3f93786c75ed9620e4bc3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a604738970be3f93786c75ed9620e4bc3">RingBufferSrSw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="separator:a604738970be3f93786c75ed9620e4bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971e19a338bc65164554d32cac757cf8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a971e19a338bc65164554d32cac757cf8">RingBufferSrSw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb, void *ptr)</td></tr>
<tr class="separator:a971e19a338bc65164554d32cac757cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4caf681989b1be8e5c143aea153a77b3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a4caf681989b1be8e5c143aea153a77b3">RingBufferSrMw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="separator:a4caf681989b1be8e5c143aea153a77b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8e2f49487768b5a86a08b07cc292ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#abe8e2f49487768b5a86a08b07cc292ff">RingBufferSrMw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb, void *ptr)</td></tr>
<tr class="memdesc:abe8e2f49487768b5a86a08b07cc292ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#abe8e2f49487768b5a86a08b07cc292ff">More...</a><br/></td></tr>
<tr class="separator:abe8e2f49487768b5a86a08b07cc292ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a250a984b762faeb0d323c86c98137008"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a250a984b762faeb0d323c86c98137008">RingBufferMrSw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="memdesc:a250a984b762faeb0d323c86c98137008"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#a250a984b762faeb0d323c86c98137008">More...</a><br/></td></tr>
<tr class="separator:a250a984b762faeb0d323c86c98137008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fec59950bfb15ba419f30613f200c3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a3fec59950bfb15ba419f30613f200c3a">RingBufferMrSw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb, void *ptr)</td></tr>
<tr class="memdesc:a3fec59950bfb15ba419f30613f200c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer  <a href="#a3fec59950bfb15ba419f30613f200c3a">More...</a><br/></td></tr>
<tr class="separator:a3fec59950bfb15ba419f30613f200c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a081344e87a2f69906e4b464f7831f70c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a081344e87a2f69906e4b464f7831f70c">RingBufferMrSwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:a081344e87a2f69906e4b464f7831f70c"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#a081344e87a2f69906e4b464f7831f70c">More...</a><br/></td></tr>
<tr class="separator:a081344e87a2f69906e4b464f7831f70c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8ed23c2920f80759d4b348852cf4da8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#ad8ed23c2920f80759d4b348852cf4da8">RingBufferMrSwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb, void *ptr)</td></tr>
<tr class="memdesc:ad8ed23c2920f80759d4b348852cf4da8"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer  <a href="#ad8ed23c2920f80759d4b348852cf4da8">More...</a><br/></td></tr>
<tr class="separator:ad8ed23c2920f80759d4b348852cf4da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d7cfaf1dae8850938041190f9b2b67"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a81d7cfaf1dae8850938041190f9b2b67">RingBufferSrSwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="separator:a81d7cfaf1dae8850938041190f9b2b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0c375873ca0398aa8a164af31392aa5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#ad0c375873ca0398aa8a164af31392aa5">RingBufferSrSwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb, void *ptr)</td></tr>
<tr class="separator:ad0c375873ca0398aa8a164af31392aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9bd0d2554bd97dd580928082c311d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a8c9bd0d2554bd97dd580928082c311d7">RingBuffer8Init</a> (void)</td></tr>
<tr class="separator:a8c9bd0d2554bd97dd580928082c311d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea29eefd9492e8802123d4505c3a557"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#aeea29eefd9492e8802123d4505c3a557">RingBuffer8Destroy</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="separator:aeea29eefd9492e8802123d4505c3a557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ce56d348be435c4368b4b438a134210"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a4ce56d348be435c4368b4b438a134210">RingBufferMrMw8Get</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb)</td></tr>
<tr class="memdesc:a4ce56d348be435c4368b4b438a134210"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#a4ce56d348be435c4368b4b438a134210">More...</a><br/></td></tr>
<tr class="separator:a4ce56d348be435c4368b4b438a134210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb8ead49b75ab19194269fa5f61a46d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#aceb8ead49b75ab19194269fa5f61a46d">RingBufferMrMw8Put</a> (<a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *rb, void *ptr)</td></tr>
<tr class="memdesc:aceb8ead49b75ab19194269fa5f61a46d"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#aceb8ead49b75ab19194269fa5f61a46d">More...</a><br/></td></tr>
<tr class="separator:aceb8ead49b75ab19194269fa5f61a46d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5486c1beda57f408df0e40d5b2a54d12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a5486c1beda57f408df0e40d5b2a54d12">RingBufferInit</a> (void)</td></tr>
<tr class="separator:a5486c1beda57f408df0e40d5b2a54d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc80974450209a3a755b4d6f804ec600"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#abc80974450209a3a755b4d6f804ec600">RingBufferDestroy</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="separator:abc80974450209a3a755b4d6f804ec600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bcd6e071ffbd03ae55c64078c5e4e1e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a0bcd6e071ffbd03ae55c64078c5e4e1e">RingBufferMrMwGet</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:a0bcd6e071ffbd03ae55c64078c5e4e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#a0bcd6e071ffbd03ae55c64078c5e4e1e">More...</a><br/></td></tr>
<tr class="separator:a0bcd6e071ffbd03ae55c64078c5e4e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee88de7260dbd29085ed67d7693925e4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#aee88de7260dbd29085ed67d7693925e4">RingBufferMrMwGetNoWait</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb)</td></tr>
<tr class="memdesc:aee88de7260dbd29085ed67d7693925e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">get the next ptr from the ring buffer  <a href="#aee88de7260dbd29085ed67d7693925e4">More...</a><br/></td></tr>
<tr class="separator:aee88de7260dbd29085ed67d7693925e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26cf24b26c1deaf69b277853afb7774f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a26cf24b26c1deaf69b277853afb7774f">RingBufferMrMwPut</a> (<a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *rb, void *ptr)</td></tr>
<tr class="memdesc:a26cf24b26c1deaf69b277853afb7774f"><td class="mdescLeft">&#160;</td><td class="mdescRight">put a ptr in the RingBuffer.  <a href="#a26cf24b26c1deaf69b277853afb7774f">More...</a><br/></td></tr>
<tr class="separator:a26cf24b26c1deaf69b277853afb7774f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93bf84ba3dce3bd69c97f8634368b104"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util-ringbuffer_8c.html#a93bf84ba3dce3bd69c97f8634368b104">DetectRingBufferRegisterTests</a> (void)</td></tr>
<tr class="separator:a93bf84ba3dce3bd69c97f8634368b104"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a></dd></dl>
<p>Ringbuffer implementation that is lockless for the most part IF atomic operations are available.</p>
<p>Two sizes are implemented currently: 256 and 65536. Those sizes are chosen for simplicity when working with the read and write indexes. Both can just wrap around.</p>
<p>Implemented are: Single reader, single writer (lockless) Single reader, multi writer (partly locked) Multi reader, single writer (lockless) Multi reader, multi writer (partly locked) </p>

<p>Definition in file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a757ffb434a1b913b1998ce37c3caf1af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USLEEP_TIME&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00042">42</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a93bf84ba3dce3bd69c97f8634368b104"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DetectRingBufferRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l01078">1078</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a93bf84ba3dce3bd69c97f8634368b104_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a93bf84ba3dce3bd69c97f8634368b104_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a93bf84ba3dce3bd69c97f8634368b104_icgraph" id="util-ringbuffer_8c_a93bf84ba3dce3bd69c97f8634368b104_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="227,12,325,39"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="571,12,621,39"/><area shape="rect" id="node4" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="373,37,523,64"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeea29eefd9492e8802123d4505c3a557"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBuffer8Destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00527">527</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00085">SCCondDestroy</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00102">SCSpinDestroy</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00079">TmqhRingBufferDestroy()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_aeea29eefd9492e8802123d4505c3a557_icgraph.png" border="0" usemap="#util-ringbuffer_8c_aeea29eefd9492e8802123d4505c3a557_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_aeea29eefd9492e8802123d4505c3a557_icgraph" id="util-ringbuffer_8c_aeea29eefd9492e8802123d4505c3a557_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8h.html#a8d2b93c65a0c553709d38b1ee4d2722f" title="TmqhRingBufferDestroy" alt="" coords="192,5,355,32"/><area shape="rect" id="node3" href="tm-queuehandlers_8h.html#aea1d15fe6fe83327a9b6086ba3037e9c" title="Clean up registration time allocs. " alt="" coords="403,5,506,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="555,5,605,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c9bd0d2554bd97dd580928082c311d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a>* RingBuffer8Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00507">507</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00083">SCCondInit</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00101">SCSpinInit</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00050">TmqhRingBufferRegister()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a8c9bd0d2554bd97dd580928082c311d7_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a8c9bd0d2554bd97dd580928082c311d7_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a8c9bd0d2554bd97dd580928082c311d7_icgraph" id="util-ringbuffer_8c_a8c9bd0d2554bd97dd580928082c311d7_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="163,5,330,32"/><area shape="rect" id="node3" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="379,5,469,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a919e5c55673b3857a5da6f0eecbe468c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBuffer8IsEmpty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is empty (no data in it) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00114">114</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="a0be4501cd1384866ec4571020ddf0cbd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBuffer8IsFull </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is full (no more data will fit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00130">130</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="a19598a53bd0691276f27b0ea0510680f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBuffer8Shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tell the ringbuffer to shut down </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00099">99</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00087">TmqhInputRingBufferShutdownHandler()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a19598a53bd0691276f27b0ea0510680f_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a19598a53bd0691276f27b0ea0510680f_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a19598a53bd0691276f27b0ea0510680f_icgraph" id="util-ringbuffer_8c_a19598a53bd0691276f27b0ea0510680f_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ad6a7a3e20a7c011fa09a6de58fed404e" title="TmqhInputRingBufferShutdown\lHandler" alt="" coords="203,5,407,46"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="457,12,623,39"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="673,12,762,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abc80974450209a3a755b4d6f804ec600"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferDestroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00664">664</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00098">SC_ATOMIC_DESTROY</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00085">SCCondDestroy</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00057">SCMutexDestroy</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00102">SCSpinDestroy</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="a5486c1beda57f408df0e40d5b2a54d12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a>* RingBufferInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00644">644</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00082">SC_ATOMIC_INIT</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00083">SCCondInit</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00059">SCMutexInit</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00101">SCSpinInit</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="a58b48d5ccc4ff38e1fe342067030fa42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferIsEmpty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is empty (no data in it) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00166">166</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="ad54aed7f7ef8af5b1205402f10b475c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferIsFull </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ringbuffer is full (no more data will fit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>empty </td></tr>
    <tr><td class="paramname">0</td><td>not empty </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00182">182</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>.</p>

</div>
</div>
<a class="anchor" id="a4ce56d348be435c4368b4b438a134210"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00550">550</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="aceb8ead49b75ab19194269fa5f61a46d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrMw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00606">606</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="a0bcd6e071ffbd03ae55c64078c5e4e1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00688">688</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="aee88de7260dbd29085ed67d7693925e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrMwGetNoWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another.</p>
<p>This version does NOT enter a wait if the buffer is empty loop.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>pointer to the data, or NULL if buffer is empty </td></tr>
  </table>
  </dd>
</dl>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00737">737</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

</div>
</div>
<a class="anchor" id="a26cf24b26c1deaf69b277853afb7774f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrMwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00791">791</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00075">RingBuffer16_::spin</a>.</p>

</div>
</div>
<a class="anchor" id="a250a984b762faeb0d323c86c98137008"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrSw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00322">322</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00101">TmqhInputRingBufferMrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a250a984b762faeb0d323c86c98137008_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a250a984b762faeb0d323c86c98137008_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a250a984b762faeb0d323c86c98137008_icgraph" id="util-ringbuffer_8c_a250a984b762faeb0d323c86c98137008_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a6fe4bab27eee8c75189b83314cbdc8cf" title="TmqhInputRingBufferMrSw" alt="" coords="201,5,381,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="430,5,597,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="646,5,735,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fec59950bfb15ba419f30613f200c3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrSw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00364">364</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00112">TmqhOutputRingBufferMrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a3fec59950bfb15ba419f30613f200c3a_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a3fec59950bfb15ba419f30613f200c3a_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a3fec59950bfb15ba419f30613f200c3a_icgraph" id="util-ringbuffer_8c_a3fec59950bfb15ba419f30613f200c3a_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ab6ca8f2aedefe7a7fa698be4d43610ce" title="TmqhOutputRingBufferMrSw" alt="" coords="201,5,391,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="441,5,607,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="657,5,746,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a081344e87a2f69906e4b464f7831f70c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferMrSwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get the next ptr from the ring buffer </p>
<p>Because we allow for multiple readers we take great care in making sure that the threads don't interfere with one another. </p>
<p>local pointer for data races. If SCAtomicCompareAndSwap (CAS) fails we increase our local array idx to try the next array member until we succeed. Or when the buffer is empty again we jump back to the waiting loop. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00396">396</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00223">SC_ATOMIC_CAS</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ad8ed23c2920f80759d4b348852cf4da8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferMrSwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00438">438</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ab1aecf3c9534eb1a7e55fbc89fec2ae0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferShutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tell the ringbuffer to shut down </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00143">143</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="a06d1ea0bc21f5454f004587aa3899c8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t RingBufferSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get number of items in the ringbuffer </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00152">152</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, and <a class="el" href="util-debug_8h_source.html#l00314">SCReturnUInt</a>.</p>

</div>
</div>
<a class="anchor" id="a4caf681989b1be8e5c143aea153a77b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrMw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00237">237</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00135">TmqhInputRingBufferSrMw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a4caf681989b1be8e5c143aea153a77b3_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a4caf681989b1be8e5c143aea153a77b3_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a4caf681989b1be8e5c143aea153a77b3_icgraph" id="util-ringbuffer_8c_a4caf681989b1be8e5c143aea153a77b3_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a735eb7a691b851c1269451cd730c99aa" title="TmqhInputRingBufferSrMw" alt="" coords="201,5,381,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="430,5,597,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="646,5,735,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abe8e2f49487768b5a86a08b07cc292ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrMw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>put a ptr in the RingBuffer. </p>
<p>As we support multiple writers we need to protect 2 things:</p>
<ol type="1">
<li>writing the ptr to the array</li>
<li>incrementing the rb-&gt;write idx</li>
</ol>
<p>We can't do both at the same time in one atomic operation, so we need to (spin) lock it. We do increment rb-&gt;write atomically after that, so that we don't need to use the lock in our *Get function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>the ringbuffer </td></tr>
    <tr><td class="paramname">ptr</td><td>ptr to store</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>ok </td></tr>
    <tr><td class="paramname">-1</td><td>wait loop interrupted because of engine flags </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00277">277</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00098">SCSpinLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00100">SCSpinUnlock</a>, <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00062">RingBuffer8_::spin</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00146">TmqhOutputRingBufferSrMw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_abe8e2f49487768b5a86a08b07cc292ff_icgraph.png" border="0" usemap="#util-ringbuffer_8c_abe8e2f49487768b5a86a08b07cc292ff_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_abe8e2f49487768b5a86a08b07cc292ff_icgraph" id="util-ringbuffer_8c_abe8e2f49487768b5a86a08b07cc292ff_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a33f77a32b182057d677167fd85d933c8" title="TmqhOutputRingBufferSrMw" alt="" coords="201,5,391,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="441,5,607,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="657,5,746,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a604738970be3f93786c75ed9620e4bc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrSw8Get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Reader, Single Writer ring buffer, fixed at 256 items so we can use unsigned char's that just wrap around </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00193">193</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00118">TmqhInputRingBufferSrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a604738970be3f93786c75ed9620e4bc3_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a604738970be3f93786c75ed9620e4bc3_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a604738970be3f93786c75ed9620e4bc3_icgraph" id="util-ringbuffer_8c_a604738970be3f93786c75ed9620e4bc3_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#a60d8febb3e99562c399a9cfb747ca64f" title="TmqhInputRingBufferSrSw" alt="" coords="197,5,376,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="425,5,591,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="641,5,730,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a971e19a338bc65164554d32cac757cf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrSw8Put </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#abb2617232adbf8748251b048ebc04ae6">RingBuffer8</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00215">215</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00063">RingBuffer8_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00057">RingBuffer8_::shutdown</a>.</p>

<p>Referenced by <a class="el" href="tmqh-ringbuffer_8c_source.html#l00129">TmqhOutputRingBufferSrSw()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util-ringbuffer_8c_a971e19a338bc65164554d32cac757cf8_icgraph.png" border="0" usemap="#util-ringbuffer_8c_a971e19a338bc65164554d32cac757cf8_icgraph" alt=""/></div>
<map name="util-ringbuffer_8c_a971e19a338bc65164554d32cac757cf8_icgraph" id="util-ringbuffer_8c_a971e19a338bc65164554d32cac757cf8_icgraph">
<area shape="rect" id="node2" href="tmqh-ringbuffer_8c.html#ad470e0f4c1340113cc579f58dd25b95d" title="TmqhOutputRingBufferSrSw" alt="" coords="198,5,386,32"/><area shape="rect" id="node3" href="tmqh-ringbuffer_8h.html#abbe1d6f93f69352a8e7b9dea54980f8d" title="TmqhRingBufferRegister . " alt="" coords="435,5,602,32"/><area shape="rect" id="node4" href="tm-queuehandlers_8h.html#a58283282aed172d5cc1839bf01c21bc2" title="TmqhSetup" alt="" coords="651,5,741,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a81d7cfaf1dae8850938041190f9b2b67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* RingBufferSrSwGet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Single Reader, Single Writer ring buffer, fixed at 65536 items so we can use unsigned shorts that just wrap around </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00463">463</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ad0c375873ca0398aa8a164af31392aa5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RingBufferSrSwPut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00485">485</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

<p>References <a class="el" href="util-ringbuffer_8h_source.html#l00076">RingBuffer16_::array</a>, <a class="el" href="util-atomic_8h_source.html#l00108">SC_ATOMIC_ADD</a>, <a class="el" href="util-atomic_8h_source.html#l00193">SC_ATOMIC_GET</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00084">SCCondSignal</a>, and <a class="el" href="util-ringbuffer_8h_source.html#l00070">RingBuffer16_::shutdown</a>.</p>

</div>
</div>
<a class="anchor" id="ae2456a2930a748c56ea058ea435396b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RingBufferWait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-ringbuffer_8h.html#a6c225cf41c2c691ed53b953cca7824a6">RingBuffer16</a> *&#160;</td>
          <td class="paramname"><em>rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>wait function for condition where ringbuffer is either full or empty. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rb</td><td>ringbuffer</td></tr>
  </table>
  </dd>
</dl>
<p>Based on RINGBUFFER_MUTEX_WAIT define, we either sleep and spin or use thread condition to wait. </p>

<p>Definition at line <a class="el" href="util-ringbuffer_8c_source.html#l00090">90</a> of file <a class="el" href="util-ringbuffer_8c_source.html">util-ringbuffer.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="util-ringbuffer_8c.html">util-ringbuffer.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:17 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
