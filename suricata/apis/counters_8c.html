<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: src/counters.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('counters_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">counters.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="suricata-common_8h_source.html">suricata-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="suricata_8h_source.html">suricata.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="counters_8h_source.html">counters.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threadvars_8h_source.html">threadvars.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tm-threads_8h_source.html">tm-threads.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="conf_8h_source.html">conf.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-time_8h_source.html">util-time.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-unittest_8h_source.html">util-unittest.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-debug_8h_source.html">util-debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-privs_8h_source.html">util-privs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="util-signal_8h_source.html">util-signal.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="unix-manager_8h_source.html">unix-manager.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="output_8h_source.html">output.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for counters.c:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c__incl.png" border="0" usemap="#src_2counters_8c" alt=""/></div>
<map name="src_2counters_8c" id="src_2counters_8c">
<area shape="rect" id="node2" href="suricata-common_8h.html" title="suricata&#45;common.h" alt="" coords="928,453,1061,480"/><area shape="rect" id="node24" href="suricata_8h.html" title="suricata.h" alt="" coords="1666,379,1744,405"/><area shape="rect" id="node28" href="counters_8h.html" title="counters.h" alt="" coords="840,379,923,405"/><area shape="rect" id="node29" href="threadvars_8h.html" title="threadvars.h" alt="" coords="1178,304,1272,331"/><area shape="rect" id="node33" href="tm-threads_8h.html" title="tm&#45;threads.h" alt="" coords="1402,155,1496,181"/><area shape="rect" id="node36" href="conf_8h.html" title="conf.h" alt="" coords="1749,80,1808,107"/><area shape="rect" id="node38" href="util-time_8h.html" title="util&#45;time.h" alt="" coords="1833,80,1911,107"/><area shape="rect" id="node39" href="util-unittest_8h.html" title="util&#45;unittest.h" alt="" coords="1935,80,2032,107"/><area shape="rect" id="node15" href="util-debug_8h.html" title="util&#45;debug.h" alt="" coords="425,528,513,555"/><area shape="rect" id="node40" href="util-privs_8h.html" title="util&#45;privs.h" alt="" coords="2057,80,2140,107"/><area shape="rect" id="node41" href="util-signal_8h.html" title="util&#45;signal.h" alt="" coords="2164,80,2252,107"/><area shape="rect" id="node42" href="unix-manager_8h.html" title="unix&#45;manager.h" alt="" coords="2277,80,2387,107"/><area shape="rect" id="node43" href="output_8h.html" title="output.h" alt="" coords="1656,80,1725,107"/><area shape="rect" id="node4" href="htp_8h.html" title="htp/htp.h" alt="" coords="1138,528,1211,555"/><area shape="rect" id="node13" href="threads_8h.html" title="threads.h" alt="" coords="1370,677,1445,704"/><area shape="rect" id="node14" href="tm-threads-common_8h.html" title="tm&#45;threads&#45;common.h" alt="" coords="1341,528,1491,555"/><area shape="rect" id="node17" href="util-error_8h.html" title="util&#45;error.h" alt="" coords="525,603,605,629"/><area shape="rect" id="node19" href="util-mem_8h.html" title="util&#45;mem.h" alt="" coords="5,677,88,704"/><area shape="rect" id="node20" href="detect-engine-alert_8h.html" title="detect&#45;engine&#45;alert.h" alt="" coords="590,528,729,555"/><area shape="rect" id="node21" href="util-optimize_8h.html" title="util&#45;optimize.h" alt="" coords="754,528,856,555"/><area shape="rect" id="node22" href="util-path_8h.html" title="util&#45;path.h" alt="" coords="881,528,959,555"/><area shape="rect" id="node23" href="util-conf_8h.html" title="util&#45;conf.h" alt="" coords="1035,528,1113,555"/><area shape="rect" id="node7" href="htp__core_8h.html" title="htp_core.h" alt="" coords="1120,603,1203,629"/><area shape="rect" id="node8" href="bstr_8h.html" title="bstr.h" alt="" coords="654,677,708,704"/><area shape="rect" id="node11" href="htp__base64_8h.html" title="htp_base64.h" alt="" coords="713,603,812,629"/><area shape="rect" id="node12" href="htp__config_8h.html" title="htp_config.h" alt="" coords="1227,603,1320,629"/><area shape="rect" id="node16" href="util-enum_8h.html" title="util&#45;enum.h" alt="" coords="163,603,249,629"/><area shape="rect" id="node18" href="util-debug-filters_8h.html" title="util&#45;debug&#45;filters.h" alt="" coords="275,603,400,629"/><area shape="rect" id="node25" href="packet-queue_8h.html" title="packet&#45;queue.h" alt="" coords="1566,453,1676,480"/><area shape="rect" id="node26" href="data-queue_8h.html" title="data&#45;queue.h" alt="" coords="1701,453,1797,480"/><area shape="rect" id="node30" href="util-mpm_8h.html" title="util&#45;mpm.h" alt="" coords="1184,379,1267,405"/><area shape="rect" id="node31" href="util-affinity_8h.html" title="util&#45;affinity.h" alt="" coords="947,379,1040,405"/><area shape="rect" id="node32" href="tm-queues_8h.html" title="tm&#45;queues.h" alt="" coords="1065,379,1159,405"/><area shape="rect" id="node34" href="tmqh-packetpool_8h.html" title="tmqh&#45;packetpool.h" alt="" coords="1494,304,1623,331"/><area shape="rect" id="node35" href="tm-modules_8h.html" title="tm&#45;modules.h" alt="" coords="1355,229,1456,256"/><area shape="rect" id="node37" href="queue_8h.html" title="queue.h" alt="" coords="2527,155,2595,181"/><area shape="rect" id="node44" href="output-packet_8h.html" title="output&#45;packet.h" alt="" coords="2028,155,2140,181"/><area shape="rect" id="node45" href="output-tx_8h.html" title="output&#45;tx.h" alt="" coords="2165,155,2248,181"/><area shape="rect" id="node46" href="output-file_8h.html" title="output&#45;file.h" alt="" coords="2273,155,2364,181"/><area shape="rect" id="node47" href="output-filedata_8h.html" title="output&#45;filedata.h" alt="" coords="2388,155,2503,181"/><area shape="rect" id="node48" href="output-flow_8h.html" title="output&#45;flow.h" alt="" coords="1573,155,1669,181"/><area shape="rect" id="node49" href="output-streaming_8h.html" title="output&#45;streaming.h" alt="" coords="1695,155,1825,181"/><area shape="rect" id="node50" href="output-stats_8h.html" title="output&#45;stats.h" alt="" coords="1901,155,2003,181"/></map>
</div>
</div>
<p><a href="counters_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structStatsThreadStore__.html">StatsThreadStore_</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">per thread store of counters  <a href="structStatsThreadStore__.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structStatsGlobalContext__.html">StatsGlobalContext_</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the output interface context for the counter api.  <a href="structStatsGlobalContext__.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structCountersIdType__.html">CountersIdType_</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af5ff0e707027e7bdd17a015e0c2b0df3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#af5ff0e707027e7bdd17a015e0c2b0df3">STATS_WUT_TTS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:af5ff0e707027e7bdd17a015e0c2b0df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618f65abfdf415113b708dc311f8f995"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a618f65abfdf415113b708dc311f8f995">STATS_MGMTT_TTS</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:a618f65abfdf415113b708dc311f8f995"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a26a596808517ded6cddb8174bc15e1a3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structStatsThreadStore__.html">StatsThreadStore_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a26a596808517ded6cddb8174bc15e1a3">StatsThreadStore</a></td></tr>
<tr class="memdesc:a26a596808517ded6cddb8174bc15e1a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">per thread store of counters  <a href="#a26a596808517ded6cddb8174bc15e1a3">More...</a><br/></td></tr>
<tr class="separator:a26a596808517ded6cddb8174bc15e1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc4b729f74b54f4838d2039c8230aa8a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structStatsGlobalContext__.html">StatsGlobalContext_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#abc4b729f74b54f4838d2039c8230aa8a">StatsGlobalContext</a></td></tr>
<tr class="memdesc:abc4b729f74b54f4838d2039c8230aa8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the output interface context for the counter api.  <a href="#abc4b729f74b54f4838d2039c8230aa8a">More...</a><br/></td></tr>
<tr class="separator:abc4b729f74b54f4838d2039c8230aa8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73378fc35f0ed111dba7fbfbb86a8351"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structCountersIdType__.html">CountersIdType_</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a73378fc35f0ed111dba7fbfbb86a8351">CountersIdType</a></td></tr>
<tr class="separator:a73378fc35f0ed111dba7fbfbb86a8351"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a94798fdadfbf49a7c658ace669a1d310"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br/>
&#160;&#160;<a class="el" href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310af59a40a1fccabf48d4bede0362179448">STATS_TYPE_NORMAL</a> = 1, 
<a class="el" href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310af4f080e5b22e2daf2aecc2740c9d8660">STATS_TYPE_AVERAGE</a> = 2, 
<a class="el" href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310a862a259df2898f997e1863d90014744f">STATS_TYPE_MAXIMUM</a> = 3, 
<a class="el" href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310a50b16321e6e198bcfb2b5dda80d41b06">STATS_TYPE_FUNC</a> = 4, 
<br/>
&#160;&#160;<a class="el" href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310a4c25617f3204c71712ab80f63b762d48">STATS_TYPE_MAX</a> = 5
<br/>
 }</td></tr>
<tr class="memdesc:a94798fdadfbf49a7c658ace669a1d310"><td class="mdescLeft">&#160;</td><td class="mdescRight">Different kinds of qualifier that can be used to modify the behaviour of the counter to be registered.  <a href="counters_8c.html#a94798fdadfbf49a7c658ace669a1d310">More...</a><br/></td></tr>
<tr class="separator:a94798fdadfbf49a7c658ace669a1d310"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af4062b3f41f722538a52f7361ce31306"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#af4062b3f41f722538a52f7361ce31306">StatsReleaseCounters</a> (<a class="el" href="counters_8h.html#a6e8fcf42df158b265285fc4cd5ee4069">StatsCounter</a> *<a class="el" href="tmqh-packetpool_8h.html#a43e8a95b1add8e9be0df059a19dab517">head</a>)</td></tr>
<tr class="memdesc:af4062b3f41f722538a52f7361ce31306"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases counters.  <a href="#af4062b3f41f722538a52f7361ce31306">More...</a><br/></td></tr>
<tr class="separator:af4062b3f41f722538a52f7361ce31306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe875414dd4620c523f895a83d365c4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#afe875414dd4620c523f895a83d365c4b">StatsAddUI64</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t id, uint64_t x)</td></tr>
<tr class="memdesc:afe875414dd4620c523f895a83d365c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a value of type uint64_t to the local counter.  <a href="#afe875414dd4620c523f895a83d365c4b">More...</a><br/></td></tr>
<tr class="separator:afe875414dd4620c523f895a83d365c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6ddff16e99087dbf6c4b13f7aa5ab6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6">StatsIncr</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t id)</td></tr>
<tr class="memdesc:aec6ddff16e99087dbf6c4b13f7aa5ab6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments the local counter.  <a href="#aec6ddff16e99087dbf6c4b13f7aa5ab6">More...</a><br/></td></tr>
<tr class="separator:aec6ddff16e99087dbf6c4b13f7aa5ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba1b0562d8156303e65898f0cff186f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#aba1b0562d8156303e65898f0cff186f0">StatsSetUI64</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t id, uint64_t x)</td></tr>
<tr class="memdesc:aba1b0562d8156303e65898f0cff186f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a value of type double to the local counter.  <a href="#aba1b0562d8156303e65898f0cff186f0">More...</a><br/></td></tr>
<tr class="separator:aba1b0562d8156303e65898f0cff186f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d32cce129f992813ebdbd46e0b5241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a82d32cce129f992813ebdbd46e0b5241">StatsInit</a> (void)</td></tr>
<tr class="memdesc:a82d32cce129f992813ebdbd46e0b5241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the perf counter api. Things are hard coded currently. More work to be done when we implement multiple interfaces.  <a href="#a82d32cce129f992813ebdbd46e0b5241">More...</a><br/></td></tr>
<tr class="separator:a82d32cce129f992813ebdbd46e0b5241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78d358130d3cd8897be6f81a940d2c2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a78d358130d3cd8897be6f81a940d2c2f">StatsSetupPostConfig</a> (void)</td></tr>
<tr class="separator:a78d358130d3cd8897be6f81a940d2c2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cd088e883d698355768801db6f5e9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a21cd088e883d698355768801db6f5e9d">StatsSpawnThreads</a> (void)</td></tr>
<tr class="memdesc:a21cd088e883d698355768801db6f5e9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spawns the wakeup, and the management thread used by the stats api.  <a href="#a21cd088e883d698355768801db6f5e9d">More...</a><br/></td></tr>
<tr class="separator:a21cd088e883d698355768801db6f5e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bae5ee323fcf0d82c933600b870eb93"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93">StatsRegisterCounter</a> (char *name, struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *tv)</td></tr>
<tr class="memdesc:a7bae5ee323fcf0d82c933600b870eb93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a normal, unqualified counter.  <a href="#a7bae5ee323fcf0d82c933600b870eb93">More...</a><br/></td></tr>
<tr class="separator:a7bae5ee323fcf0d82c933600b870eb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85284c96fa9935606e5cac996152bb58"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a85284c96fa9935606e5cac996152bb58">StatsRegisterAvgCounter</a> (char *name, struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *tv)</td></tr>
<tr class="memdesc:a85284c96fa9935606e5cac996152bb58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a counter, whose value holds the average of all the values assigned to it.  <a href="#a85284c96fa9935606e5cac996152bb58">More...</a><br/></td></tr>
<tr class="separator:a85284c96fa9935606e5cac996152bb58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a218da697828635f6781d521c305eadf4"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a218da697828635f6781d521c305eadf4">StatsRegisterMaxCounter</a> (char *name, struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *tv)</td></tr>
<tr class="memdesc:a218da697828635f6781d521c305eadf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a counter, whose value holds the maximum of all the values assigned to it.  <a href="#a218da697828635f6781d521c305eadf4">More...</a><br/></td></tr>
<tr class="separator:a218da697828635f6781d521c305eadf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e153d15fc6ea022e954f38fd80fbc0a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a6e153d15fc6ea022e954f38fd80fbc0a">StatsRegisterGlobalCounter</a> (char *name, uint64_t(*Func)(void))</td></tr>
<tr class="memdesc:a6e153d15fc6ea022e954f38fd80fbc0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a counter, which represents a global value.  <a href="#a6e153d15fc6ea022e954f38fd80fbc0a">More...</a><br/></td></tr>
<tr class="separator:a6e153d15fc6ea022e954f38fd80fbc0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a4d821367c0b61abfed6afe23a9b6d"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a12a4d821367c0b61abfed6afe23a9b6d">CountersIdHashFunc</a> (<a class="el" href="util-hash_8h.html#abd156b13da7154b211396fcd9ec085fb">HashTable</a> *ht, void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, uint16_t datalen)</td></tr>
<tr class="separator:a12a4d821367c0b61abfed6afe23a9b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45cc93ae923e9336540fd803c6e5d17"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#ae45cc93ae923e9336540fd803c6e5d17">CountersIdHashCompareFunc</a> (void *data1, uint16_t datalen1, void *data2, uint16_t datalen2)</td></tr>
<tr class="separator:ae45cc93ae923e9336540fd803c6e5d17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3005fc6769c45057f96d463e0d699e61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a3005fc6769c45057f96d463e0d699e61">CountersIdHashFreeFunc</a> (void *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>)</td></tr>
<tr class="separator:a3005fc6769c45057f96d463e0d699e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7252392837ab3054a2a0b0aaf7c06c17"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17">StatsSetupPrivate</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="separator:a7252392837ab3054a2a0b0aaf7c06c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af130407b17bce27c0a89eecd53efeb09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#af130407b17bce27c0a89eecd53efeb09">StatsUpdateCounterArray</a> (<a class="el" href="counters_8h.html#a876fcfe221f90e529e55a50dc1f69084">StatsPrivateThreadContext</a> *pca, <a class="el" href="counters_8h.html#a6361db03b0a1612164875dcd55872559">StatsPublicThreadContext</a> *pctx)</td></tr>
<tr class="memdesc:af130407b17bce27c0a89eecd53efeb09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Syncs the counter array with the global counter variables.  <a href="#af130407b17bce27c0a89eecd53efeb09">More...</a><br/></td></tr>
<tr class="separator:af130407b17bce27c0a89eecd53efeb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4644bd08c832fcdb916e0b4bf2b5428"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#ae4644bd08c832fcdb916e0b4bf2b5428">StatsGetLocalCounterValue</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, uint16_t id)</td></tr>
<tr class="memdesc:ae4644bd08c832fcdb916e0b4bf2b5428"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the value of the local copy of the counter that hold this id.  <a href="#ae4644bd08c832fcdb916e0b4bf2b5428">More...</a><br/></td></tr>
<tr class="separator:ae4644bd08c832fcdb916e0b4bf2b5428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee803842fac9bfca7a1d7d47e8028d15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#aee803842fac9bfca7a1d7d47e8028d15">StatsReleaseResources</a> ()</td></tr>
<tr class="memdesc:aee803842fac9bfca7a1d7d47e8028d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the resources alloted by the Stats API.  <a href="#aee803842fac9bfca7a1d7d47e8028d15">More...</a><br/></td></tr>
<tr class="separator:aee803842fac9bfca7a1d7d47e8028d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabceecc6ca3d6be4cc51adbf23597ff8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#aabceecc6ca3d6be4cc51adbf23597ff8">StatsReleasePrivateThreadContext</a> (<a class="el" href="counters_8h.html#a876fcfe221f90e529e55a50dc1f69084">StatsPrivateThreadContext</a> *pca)</td></tr>
<tr class="memdesc:aabceecc6ca3d6be4cc51adbf23597ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the StatsPrivateThreadContext allocated by the user, for storing and updating local counter values.  <a href="#aabceecc6ca3d6be4cc51adbf23597ff8">More...</a><br/></td></tr>
<tr class="separator:aabceecc6ca3d6be4cc51adbf23597ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09bd1636d92f10107f55cf59f5b4a30f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a09bd1636d92f10107f55cf59f5b4a30f">StatsThreadCleanup</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="separator:a09bd1636d92f10107f55cf59f5b4a30f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b026ed93df6494c3bd79e2ce8ef41e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="counters_8c.html#a9b026ed93df6494c3bd79e2ce8ef41e1">StatsRegisterTests</a> ()</td></tr>
<tr class="separator:a9b026ed93df6494c3bd79e2ce8ef41e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Anoop Saldanha <a href="#" onclick="location.href='mai'+'lto:'+'ano'+'op'+'sal'+'da'+'nha'+'@g'+'mai'+'l.'+'com'; return false;">anoop<span style="display: none;">.nosp@m.</span>sald<span style="display: none;">.nosp@m.</span>anha@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> </dd>
<dd>
Victor Julien <a href="#" onclick="location.href='mai'+'lto:'+'vic'+'to'+'r@i'+'nl'+'ini'+'ac'+'.ne'+'t'; return false;">victo<span style="display: none;">.nosp@m.</span>r@in<span style="display: none;">.nosp@m.</span>linia<span style="display: none;">.nosp@m.</span>c.ne<span style="display: none;">.nosp@m.</span>t</a></dd></dl>
<p>Engine stats API </p>

<p>Definition in file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a618f65abfdf415113b708dc311f8f995"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATS_MGMTT_TTS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00045">45</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

</div>
</div>
<a class="anchor" id="af5ff0e707027e7bdd17a015e0c2b0df3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATS_WUT_TTS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00042">42</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a73378fc35f0ed111dba7fbfbb86a8351"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structCountersIdType__.html">CountersIdType_</a>  <a class="el" href="counters_8c.html#a73378fc35f0ed111dba7fbfbb86a8351">CountersIdType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="abc4b729f74b54f4838d2039c8230aa8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structStatsGlobalContext__.html">StatsGlobalContext_</a>  <a class="el" href="counters_8c.html#abc4b729f74b54f4838d2039c8230aa8a">StatsGlobalContext</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Holds the output interface context for the counter api. </p>

</div>
</div>
<a class="anchor" id="a26a596808517ded6cddb8174bc15e1a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structStatsThreadStore__.html">StatsThreadStore_</a>  <a class="el" href="counters_8c.html#a26a596808517ded6cddb8174bc15e1a3">StatsThreadStore</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>per thread store of counters </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Different kinds of qualifier that can be used to modify the behaviour of the counter to be registered. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310af59a40a1fccabf48d4bede0362179448"></a>STATS_TYPE_NORMAL</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310af4f080e5b22e2daf2aecc2740c9d8660"></a>STATS_TYPE_AVERAGE</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310a862a259df2898f997e1863d90014744f"></a>STATS_TYPE_MAXIMUM</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310a50b16321e6e198bcfb2b5dda80d41b06"></a>STATS_TYPE_FUNC</em>&nbsp;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a94798fdadfbf49a7c658ace669a1d310a4c25617f3204c71712ab80f63b762d48"></a>STATS_TYPE_MAX</em>&nbsp;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00051">51</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae45cc93ae923e9336540fd803c6e5d17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char CountersIdHashCompareFunc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>datalen1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>datalen2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00947">947</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="counters_8c_source.html#l00928">CountersIdType_::string</a>.</p>

</div>
</div>
<a class="anchor" id="a3005fc6769c45057f96d463e0d699e61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CountersIdHashFreeFunc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00971">971</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

</div>
</div>
<a class="anchor" id="a12a4d821367c0b61abfed6afe23a9b6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t CountersIdHashFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="util-hash_8h.html#abd156b13da7154b211396fcd9ec085fb">HashTable</a> *&#160;</td>
          <td class="paramname"><em>ht</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00931">931</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="util-hash_8h_source.html#l00037">HashTable_::array_size</a>, <a class="el" href="app-layer-dns-common_8h_source.html#l00041">len</a>, and <a class="el" href="counters_8c_source.html#l00928">CountersIdType_::string</a>.</p>

</div>
</div>
<a class="anchor" id="afe875414dd4620c523f895a83d365c4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsAddUI64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a value of type uint64_t to the local counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>ID of the counter as set by the API </td></tr>
    <tr><td class="paramname">pca</td><td>Counter array that holds the local counter for this TM </td></tr>
    <tr><td class="paramname">x</td><td>Value to add to this local counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00130">130</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="counters_8h_source.html#l00103">StatsPrivateThreadContext_::initialized</a>, <a class="el" href="threadvars_8h_source.html#l00113">ThreadVars_::perf_private_ctx</a>, <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>, <a class="el" href="counters_8h_source.html#l00090">StatsLocalCounter_::updates</a>, and <a class="el" href="counters_8h_source.html#l00087">StatsLocalCounter_::value</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00426">DecodeUpdatePacketCounters()</a>, and <a class="el" href="detect_8c_source.html#l01232">SigMatchSignatures()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_afe875414dd4620c523f895a83d365c4b_icgraph.png" border="0" usemap="#counters_8c_afe875414dd4620c523f895a83d365c4b_icgraph" alt=""/></div>
<map name="counters_8c_afe875414dd4620c523f895a83d365c4b_icgraph" id="counters_8c_afe875414dd4620c523f895a83d365c4b_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga80f244d5793581bd92abab9e8f83ef0c" title="DecodeUpdatePacketCounters" alt="" coords="157,233,360,260"/><area shape="rect" id="node25" href="detect_8h.html#a61bb19b95a3c2e79149321a3c97f2db0" title="Signature match function. " alt="" coords="189,360,328,387"/><area shape="rect" id="node3" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="423,5,516,32"/><area shape="rect" id="node9" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="415,56,523,83"/><area shape="rect" id="node11" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="417,107,522,133"/><area shape="rect" id="node13" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="419,157,520,184"/><area shape="rect" id="node15" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="408,208,531,235"/><area shape="rect" id="node17" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="422,259,517,285"/><area shape="rect" id="node19" href="source-pcap-file_8c.html#a41c54f12c157322cb9fb519cf29ee5e6" title="DecodePcapFile" alt="" coords="410,309,529,336"/><area shape="rect" id="node21" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="421,360,518,387"/><area shape="rect" id="node23" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="419,411,520,437"/><area shape="rect" id="node4" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="595,5,797,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="862,233,997,260"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1045,233,1144,260"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1192,208,1341,235"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1389,233,1440,260"/><area shape="rect" id="node10" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="587,56,805,83"/><area shape="rect" id="node12" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="589,107,803,133"/><area shape="rect" id="node14" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="591,157,801,184"/><area shape="rect" id="node16" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="579,208,813,235"/><area shape="rect" id="node18" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="593,259,799,285"/><area shape="rect" id="node20" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="582,309,810,336"/><area shape="rect" id="node22" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="593,360,799,387"/><area shape="rect" id="node24" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="591,411,801,437"/><area shape="rect" id="node26" href="detect_8c.html#aef746f215cb23d3da4e714086e5674ef" title="Detection engine thread wrapper. " alt="" coords="439,461,500,488"/><area shape="rect" id="node27" href="detect_8h.html#ae7a6e0f8b7fbe88c9c7ca064b7892c7c" title="TmModuleDetectRegister" alt="" coords="611,461,781,488"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae4644bd08c832fcdb916e0b4bf2b5428"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t StatsGetLocalCounterValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the value of the local copy of the counter that hold this id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tv</td><td>threadvars </td></tr>
    <tr><td class="paramname">id</td><td>The counter id.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l01161">1161</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="threadvars_8h_source.html#l00113">ThreadVars_::perf_private_ctx</a>, <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>, and <a class="el" href="counters_8h_source.html#l00087">StatsLocalCounter_::value</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01795">ReceiveAFPThreadExitStats()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00556">ReceiveErfDagThreadExitStats()</a>, and <a class="el" href="source-pfring_8c_source.html#l00568">ReceivePfringThreadExitStats()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_ae4644bd08c832fcdb916e0b4bf2b5428_icgraph.png" border="0" usemap="#counters_8c_ae4644bd08c832fcdb916e0b4bf2b5428_icgraph" alt=""/></div>
<map name="counters_8c_ae4644bd08c832fcdb916e0b4bf2b5428_icgraph" id="counters_8c_ae4644bd08c832fcdb916e0b4bf2b5428_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#ga4c9cbb8150024279865f2a4373ec7597" title="This function prints stats to the screen at exit. " alt="" coords="245,5,435,32"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#af64532adecd9cffc72c52cc62514f16f" title="Print some stats to the log at program exit. " alt="" coords="237,56,443,83"/><area shape="rect" id="node10" href="source-pfring_8c.html#a3a633f184fef795ee95963d00aa25e31" title="This function prints stats to the screen at exit. " alt="" coords="241,107,439,133"/><area shape="rect" id="node3" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="498,5,705,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="761,56,895,83"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="944,56,1043,83"/><area shape="rect" id="node6" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1091,31,1240,57"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1288,56,1339,83"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#a91e9820c732f0cc1d556b6ae671094b1" title="Register the ERF file receiver (reader) module. " alt="" coords="491,56,712,83"/><area shape="rect" id="node11" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="494,107,709,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aec6ddff16e99087dbf6c4b13f7aa5ab6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsIncr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increments the local counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Index of the counter in the counter array </td></tr>
    <tr><td class="paramname">pca</td><td>Counter array that holds the local counters for this TM </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00151">151</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="counters_8h_source.html#l00103">StatsPrivateThreadContext_::initialized</a>, <a class="el" href="threadvars_8h_source.html#l00113">ThreadVars_::perf_private_ctx</a>, <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>, <a class="el" href="counters_8h_source.html#l00090">StatsLocalCounter_::updates</a>, and <a class="el" href="counters_8h_source.html#l00087">StatsLocalCounter_::value</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00550">CaptureStatsUpdate()</a>, <a class="el" href="source-af-packet_8c_source.html#l01844">DecodeAFP()</a>, <a class="el" href="decode-erspan_8c_source.html#l00046">DecodeERSPAN()</a>, <a class="el" href="decode-ethernet_8c_source.html#l00041">DecodeEthernet()</a>, <a class="el" href="decode-gre_8c_source.html#l00046">DecodeGRE()</a>, <a class="el" href="decode-icmpv4_8c_source.html#l00154">DecodeICMPV4()</a>, <a class="el" href="decode-icmpv6_8c_source.html#l00167">DecodeICMPV6()</a>, <a class="el" href="decode-ipv4_8c_source.html#l00520">DecodeIPV4()</a>, <a class="el" href="decode-ipv6_8c_source.html#l00600">DecodeIPV6()</a>, <a class="el" href="decode-mpls_8c_source.html#l00047">DecodeMPLS()</a>, <a class="el" href="decode-null_8c_source.html#l00048">DecodeNull()</a>, <a class="el" href="source-pfring_8c_source.html#l00619">DecodePfring()</a>, <a class="el" href="decode-ppp_8c_source.html#l00043">DecodePPP()</a>, <a class="el" href="decode-pppoe_8c_source.html#l00050">DecodePPPOEDiscovery()</a>, <a class="el" href="decode-pppoe_8c_source.html#l00129">DecodePPPOESession()</a>, <a class="el" href="decode-raw_8c_source.html#l00046">DecodeRaw()</a>, <a class="el" href="decode-sctp_8c_source.html#l00062">DecodeSCTP()</a>, <a class="el" href="decode-sll_8c_source.html#l00039">DecodeSll()</a>, <a class="el" href="decode-tcp_8c_source.html#l00187">DecodeTCP()</a>, <a class="el" href="decode-teredo_8c_source.html#l00047">DecodeTeredo()</a>, <a class="el" href="decode-udp_8c_source.html#l00073">DecodeUDP()</a>, <a class="el" href="decode_8c_source.html#l00426">DecodeUpdatePacketCounters()</a>, <a class="el" href="decode-vlan_8c_source.html#l00059">DecodeVLAN()</a>, <a class="el" href="defrag_8c_source.html#l00908">Defrag()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02561">DoHandleGap()</a>, <a class="el" href="decode_8c_source.html#l00109">PacketDecodeFinalize()</a>, <a class="el" href="stream-tcp_8c_source.html#l05023">StreamTcp()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l03611">StreamTcpGetSegment()</a>, <a class="el" href="stream-tcp_8c_source.html#l04451">StreamTcpPacket()</a>, <a class="el" href="stream-tcp_8c_source.html#l05856">StreamTcpPseudoPacketCreateStreamEndPacket()</a>, <a class="el" href="stream-tcp-reassemble_8c_source.html#l02878">StreamTcpReassembleAppLayer()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l01883">StreamTcpReassembleHandleSegmentHandleData()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_aec6ddff16e99087dbf6c4b13f7aa5ab6_icgraph.png" border="0" usemap="#counters_8c_aec6ddff16e99087dbf6c4b13f7aa5ab6_icgraph" alt=""/></div>
<map name="counters_8c_aec6ddff16e99087dbf6c4b13f7aa5ab6_icgraph" id="counters_8c_aec6ddff16e99087dbf6c4b13f7aa5ab6_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5" title="CaptureStatsUpdate" alt="" coords="163,5,304,32"/><area shape="rect" id="node4" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1625,1019,1719,1045"/><area shape="rect" id="node6" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1611,600,1733,627"/><area shape="rect" id="node8" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1366,1019,1482,1045"/><area shape="rect" id="node17" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="185,512,281,539"/><area shape="rect" id="node27" href="decode_8h.html#a03b94d79586f4abbd8b762f75de608c8" title="Main ICMPv4 decoding function. " alt="" coords="175,563,292,589"/><area shape="rect" id="node28" href="decode_8h.html#af09d0f9b3af3be970dbe770c79e66cce" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="436,968,553,995"/><area shape="rect" id="node18" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="703,639,799,665"/><area shape="rect" id="node29" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="703,816,799,843"/><area shape="rect" id="node9" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1621,765,1723,792"/><area shape="rect" id="node19" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="953,259,1044,285"/><area shape="rect" id="node15" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1621,1069,1723,1096"/><area shape="rect" id="node20" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1377,360,1471,387"/><area shape="rect" id="node30" href="decode_8h.html#a129f620dd41c19979357cf97a4670f72" title="Main decoding function for PPPOE Discovery packets. " alt="" coords="913,1120,1085,1147"/><area shape="rect" id="node21" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="919,1019,1079,1045"/><area shape="rect" id="node24" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1163,613,1258,640"/><area shape="rect" id="node31" href="decode_8h.html#a04bd1d44001e393003da2420291028e1" title="DecodeSCTP" alt="" coords="443,664,546,691"/><area shape="rect" id="node23" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1383,867,1465,893"/><area shape="rect" id="node32" href="decode_8h.html#a1683201a43f216e90e02810223202957" title="DecodeTCP" alt="" coords="447,715,542,741"/><area shape="rect" id="node33" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="180,867,287,893"/><area shape="rect" id="node34" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="447,816,543,843"/><area shape="rect" id="node36" href="group__decode.html#ga80f244d5793581bd92abab9e8f83ef0c" title="DecodeUpdatePacketCounters" alt="" coords="1323,1221,1525,1248"/><area shape="rect" id="node22" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1159,968,1262,995"/><area shape="rect" id="node38" href="defrag_8h.html#a65e941e1af128cd670b9c3191edfd470" title="Entry point for IPv4 and IPv6 fragments. " alt="" coords="464,765,525,792"/><area shape="rect" id="node39" href="stream-tcp-reassemble_8c.html#a401bd2a63bec40a406b0cf3e95d6415d" title="DoHandleGap" alt="" coords="181,1829,285,1856"/><area shape="rect" id="node47" href="group__decode.html#ga34b0a10ee3a77793bddbc8f8eceb832f" title="Finalize decoding of a packet. " alt="" coords="1347,1272,1501,1299"/><area shape="rect" id="node45" href="stream-tcp_8c.html#adb13fb0808d68f1cbd9757cdc419fdab" title="StreamTcp" alt="" coords="1381,1939,1467,1965"/><area shape="rect" id="node48" href="stream-tcp-reassemble_8h.html#a7e32681e3e7f0f0a9b641a94649800c4" title="Function to get the segment of required length from the pool. " alt="" coords="154,1728,313,1755"/><area shape="rect" id="node44" href="stream-tcp_8h.html#a248c85404fa06db3bc2b7d8d2f8de3a0" title="StreamTcpPacket" alt="" coords="1147,1880,1274,1907"/><area shape="rect" id="node50" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="128,1881,339,1922"/><area shape="rect" id="node40" href="stream-tcp-reassemble_8h.html#acfcce88649a7bc46af58419da7fc5b28" title="Update the stream reassembly upon receiving an ACK packet. " alt="" coords="387,1880,602,1907"/><area shape="rect" id="node49" href="stream-tcp-reassemble_8c.html#a75ed0e6a51ad7ee4418623e1db12fc8f" title="Insert a packets TCP data into the stream reassembly engine. " alt="" coords="395,1763,595,1805"/><area shape="rect" id="node3" href="source-nfq_8c.html#a6033429b6ace5a1477225b4ea2a392fa" title="NFQ verdict module packet entry function. " alt="" coords="449,5,540,32"/><area shape="rect" id="node5" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="1823,1019,2025,1045"/><area shape="rect" id="node7" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1871,657,1977,684"/><area shape="rect" id="node10" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1618,1221,1726,1248"/><area shape="rect" id="node11" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1619,1120,1725,1147"/><area shape="rect" id="node12" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1611,1171,1733,1197"/><area shape="rect" id="node13" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1583,651,1761,677"/><area shape="rect" id="node14" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1623,867,1721,893"/><area shape="rect" id="node16" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1819,1069,2029,1096"/><area shape="rect" id="node25" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1621,1323,1723,1349"/><area shape="rect" id="node26" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1625,1373,1719,1400"/><area shape="rect" id="node35" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="682,867,819,893"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a41c54f12c157322cb9fb519cf29ee5e6" title="DecodePcapFile" alt="" coords="1613,1272,1731,1299"/><area shape="rect" id="node41" href="app-layer_8h.html#a1db17b7abcebc2b7617ed11f3562b392" title="Handles reassembled tcp stream. " alt="" coords="664,1829,837,1856"/><area shape="rect" id="node42" href="stream-tcp-reassemble_8c.html#a6b7f7667924193878624cfd69065b4a4" title="update app layer and raw reassembly " alt="" coords="651,1931,851,1973"/><area shape="rect" id="node43" href="stream-tcp-reassemble_8h.html#a0b9412d2d180b6ef0a1c916a9834c4cd" title="StreamTcpReassembleHandle\lSegment" alt="" coords="899,1873,1099,1914"/><area shape="rect" id="node46" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="1574,1939,1770,1965"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82d32cce129f992813ebdbd46e0b5241"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the perf counter api. Things are hard coded currently. More work to be done when we implement multiple interfaces. </p>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00773">773</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8c_source.html#l00086">StatsGlobalContext_::global_counter_ctx</a>, <a class="el" href="util-error_8h_source.html#l00203">SC_ERR_FATAL</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, and <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a82d32cce129f992813ebdbd46e0b5241_icgraph.png" border="0" usemap="#counters_8c_a82d32cce129f992813ebdbd46e0b5241_icgraph" alt=""/></div>
<map name="counters_8c_a82d32cce129f992813ebdbd46e0b5241_icgraph" id="counters_8c_a82d32cce129f992813ebdbd46e0b5241_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="125,5,176,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85284c96fa9935606e5cac996152bb58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t StatsRegisterAvgCounter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a counter, whose value holds the average of all the values assigned to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the counter, to be registered </td></tr>
    <tr><td class="paramname">tv</td><td>Pointer to the ThreadVars instance for which the counter would be registered</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">id</td><td>Counter id for the newly registered counter, or the already present counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00871">871</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00110">ThreadVars_::perf_public_ctx</a>, <a class="el" href="counters_8c_source.html#l00053">STATS_TYPE_AVERAGE</a>, and <a class="el" href="threadvars_8h_source.html#l00063">ThreadVars_::thread_group_name</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00377">DecodeRegisterPerfCounters()</a>, and <a class="el" href="detect-engine_8c_source.html#l01368">DetectEngineThreadCtxInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a85284c96fa9935606e5cac996152bb58_icgraph.png" border="0" usemap="#counters_8c_a85284c96fa9935606e5cac996152bb58_icgraph" alt=""/></div>
<map name="counters_8c_a85284c96fa9935606e5cac996152bb58_icgraph" id="counters_8c_a85284c96fa9935606e5cac996152bb58_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga30a380d9d448ff265b6b9d5d3f81d4e4" title="DecodeRegisterPerfCounters" alt="" coords="225,208,418,235"/><area shape="rect" id="node25" href="detect-engine_8h.html#a72c337802af74e71c4ea8fca8a68978c" title="initialize thread specific detection engine context " alt="" coords="231,259,411,285"/><area shape="rect" id="node3" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="482,5,633,32"/><area shape="rect" id="node9" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="474,56,641,83"/><area shape="rect" id="node11" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="476,107,639,133"/><area shape="rect" id="node13" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="478,157,637,184"/><area shape="rect" id="node15" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="467,208,648,235"/><area shape="rect" id="node17" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="481,259,634,285"/><area shape="rect" id="node19" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="469,309,645,336"/><area shape="rect" id="node21" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="480,360,635,387"/><area shape="rect" id="node23" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="478,411,637,437"/><area shape="rect" id="node4" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="712,5,915,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="979,208,1114,235"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1163,208,1261,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1309,183,1459,209"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1507,208,1557,235"/><area shape="rect" id="node10" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="704,56,923,83"/><area shape="rect" id="node12" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="706,107,921,133"/><area shape="rect" id="node14" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="708,157,919,184"/><area shape="rect" id="node16" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="697,208,930,235"/><area shape="rect" id="node18" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="711,259,916,285"/><area shape="rect" id="node20" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="699,309,927,336"/><area shape="rect" id="node22" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="710,360,917,387"/><area shape="rect" id="node24" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="708,411,919,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7bae5ee323fcf0d82c933600b870eb93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t StatsRegisterCounter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a normal, unqualified counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the counter, to be registered </td></tr>
    <tr><td class="paramname">tv</td><td>Pointer to the ThreadVars instance for which the counter would be registered</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">id</td><td>Counter id for the newly registered counter, or the already present counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00850">850</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00110">ThreadVars_::perf_public_ctx</a>, <a class="el" href="counters_8c_source.html#l00052">STATS_TYPE_NORMAL</a>, and <a class="el" href="threadvars_8h_source.html#l00063">ThreadVars_::thread_group_name</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00563">CaptureStatsSetup()</a>, <a class="el" href="decode_8c_source.html#l00377">DecodeRegisterPerfCounters()</a>, <a class="el" href="detect-engine_8c_source.html#l01368">DetectEngineThreadCtxInit()</a>, <a class="el" href="source-af-packet_8c_source.html#l01662">ReceiveAFPThreadInit()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00182">ReceiveErfDagThreadInit()</a>, <a class="el" href="source-pcap_8c_source.html#l00535">ReceivePcapThreadInit()</a>, <a class="el" href="source-pfring_8c_source.html#l00396">ReceivePfringThreadInit()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05074">StreamTcpThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a7bae5ee323fcf0d82c933600b870eb93_icgraph.png" border="0" usemap="#counters_8c_a7bae5ee323fcf0d82c933600b870eb93_icgraph" alt=""/></div>
<map name="counters_8c_a7bae5ee323fcf0d82c933600b870eb93_icgraph" id="counters_8c_a7bae5ee323fcf0d82c933600b870eb93_icgraph">
<area shape="rect" id="node2" href="group__decode.html#gaf1bed034bb99c0f39628191847689b3a" title="CaptureStatsSetup" alt="" coords="233,107,367,133"/><area shape="rect" id="node9" href="group__decode.html#ga30a380d9d448ff265b6b9d5d3f81d4e4" title="DecodeRegisterPerfCounters" alt="" coords="203,284,397,311"/><area shape="rect" id="node28" href="detect-engine_8h.html#a72c337802af74e71c4ea8fca8a68978c" title="initialize thread specific detection engine context " alt="" coords="210,461,390,488"/><area shape="rect" id="node29" href="group__afppacket.html#ga63a4c87b1c785d124cbcebe19feb0125" title="Init function for ReceiveAFP. " alt="" coords="223,512,377,539"/><area shape="rect" id="node31" href="source-erf-dag_8c.html#a6b575ca1df93dcdfe66995849a62b435" title="Initialize the ERF receiver thread, generate a single ErfDagThreadVar structure for each thread..." alt="" coords="215,563,385,589"/><area shape="rect" id="node33" href="source-pcap_8c.html#ae2500197e003217f72c3f80adeb75b79" title="Init function for ReceivePcap. " alt="" coords="221,613,379,640"/><area shape="rect" id="node35" href="source-pfring_8c.html#ab74f8ec75fde76ef8ab9ec1b6c7bead1" title="Init function for RecievePfring. " alt="" coords="219,664,381,691"/><area shape="rect" id="node37" href="stream-tcp_8h.html#a92a4a607332f606574d63bd2ec158ebe" title="StreamTcpThreadInit" alt="" coords="228,715,372,741"/><area shape="rect" id="node3" href="source-nfq_8c.html#acd1cd050a85be381cc3bbdedf383009b" title="VerdictNFQThreadInit" alt="" coords="479,5,628,32"/><area shape="rect" id="node4" href="source-nfq_8c.html#a72f89d52fdea56362998f329f2052ddc" title="TmModuleVerdictNFQRegister" alt="" coords="726,5,927,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="993,360,1127,387"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1176,360,1275,387"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1323,335,1472,361"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1520,360,1571,387"/><area shape="rect" id="node10" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="478,56,629,83"/><area shape="rect" id="node12" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="470,107,637,133"/><area shape="rect" id="node14" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="472,157,635,184"/><area shape="rect" id="node16" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="474,208,633,235"/><area shape="rect" id="node18" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="463,259,644,285"/><area shape="rect" id="node20" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="477,309,630,336"/><area shape="rect" id="node22" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="465,360,641,387"/><area shape="rect" id="node24" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="476,411,631,437"/><area shape="rect" id="node26" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="474,461,633,488"/><area shape="rect" id="node11" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="725,56,928,83"/><area shape="rect" id="node13" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="717,107,936,133"/><area shape="rect" id="node15" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="719,157,934,184"/><area shape="rect" id="node17" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="721,208,932,235"/><area shape="rect" id="node19" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="710,259,943,285"/><area shape="rect" id="node21" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="724,309,929,336"/><area shape="rect" id="node23" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="713,360,941,387"/><area shape="rect" id="node25" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="723,411,930,437"/><area shape="rect" id="node27" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="721,461,932,488"/><area shape="rect" id="node30" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="723,512,930,539"/><area shape="rect" id="node32" href="source-erf-dag_8h.html#a91e9820c732f0cc1d556b6ae671094b1" title="Register the ERF file receiver (reader) module. " alt="" coords="716,563,937,589"/><area shape="rect" id="node34" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="721,613,932,640"/><area shape="rect" id="node36" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="446,664,661,691"/><area shape="rect" id="node38" href="stream-tcp_8h.html#ac7570830e107bef9adb9c4a729222114" title="TmModuleStreamTcpRegister" alt="" coords="455,715,651,741"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e153d15fc6ea022e954f38fd80fbc0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t StatsRegisterGlobalCounter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t(*)(void)&#160;</td>
          <td class="paramname"><em>Func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a counter, which represents a global value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the counter, to be registered </td></tr>
    <tr><td class="paramname">Func</td><td>Function Pointer returning a uint64_t</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">id</td><td>Counter id for the newly registered counter, or the already present counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00911">911</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8c_source.html#l00086">StatsGlobalContext_::global_counter_ctx</a>, and <a class="el" href="counters_8c_source.html#l00055">STATS_TYPE_FUNC</a>.</p>

<p>Referenced by <a class="el" href="app-layer_8c_source.html#l00645">AppLayerRegisterGlobalCounters()</a>, <a class="el" href="flow-manager_8c_source.html#l00709">FlowManagerThreadSpawn()</a>, <a class="el" href="stream-tcp_8c_source.html#l00346">StreamTcpInitConfig()</a>, and <a class="el" href="stream-tcp-reassemble_8c_source.html#l00505">StreamTcpReassembleInit()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a6e153d15fc6ea022e954f38fd80fbc0a_icgraph.png" border="0" usemap="#counters_8c_a6e153d15fc6ea022e954f38fd80fbc0a_icgraph" alt=""/></div>
<map name="counters_8c_a6e153d15fc6ea022e954f38fd80fbc0a_icgraph" id="counters_8c_a6e153d15fc6ea022e954f38fd80fbc0a_icgraph">
<area shape="rect" id="node2" href="app-layer_8h.html#a3377beeacc15bacc2a730feadfb6a1ee" title="HACK to work around our broken unix manager (re)init loop. " alt="" coords="469,5,685,32"/><area shape="rect" id="node4" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="241,56,421,83"/><area shape="rect" id="node5" href="stream-tcp_8h.html#ae02dc80698f907951c8c9dc972093fde" title="To initialize the stream global configuration data. " alt="" coords="506,107,649,133"/><area shape="rect" id="node6" href="stream-tcp-reassemble_8h.html#a2f8cd20652930aa841051d6ec5455819" title="StreamTcpReassembleInit" alt="" coords="242,157,419,184"/><area shape="rect" id="node3" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="733,56,784,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a218da697828635f6781d521c305eadf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t StatsRegisterMaxCounter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structThreadVars__.html">ThreadVars_</a> *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a counter, whose value holds the maximum of all the values assigned to it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the counter, to be registered </td></tr>
    <tr><td class="paramname">tv</td><td>Pointer to the ThreadVars instance for which the counter would be registered</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>counter id for the newly registered counter, or the already present counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00892">892</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>, <a class="el" href="threadvars_8h_source.html#l00110">ThreadVars_::perf_public_ctx</a>, <a class="el" href="counters_8c_source.html#l00054">STATS_TYPE_MAXIMUM</a>, and <a class="el" href="threadvars_8h_source.html#l00063">ThreadVars_::thread_group_name</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00377">DecodeRegisterPerfCounters()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a218da697828635f6781d521c305eadf4_icgraph.png" border="0" usemap="#counters_8c_a218da697828635f6781d521c305eadf4_icgraph" alt=""/></div>
<map name="counters_8c_a218da697828635f6781d521c305eadf4_icgraph" id="counters_8c_a218da697828635f6781d521c305eadf4_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga30a380d9d448ff265b6b9d5d3f81d4e4" title="DecodeRegisterPerfCounters" alt="" coords="227,208,421,235"/><area shape="rect" id="node3" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="485,5,635,32"/><area shape="rect" id="node9" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="477,56,643,83"/><area shape="rect" id="node11" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="479,107,641,133"/><area shape="rect" id="node13" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="481,157,639,184"/><area shape="rect" id="node15" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="469,208,651,235"/><area shape="rect" id="node17" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="483,259,637,285"/><area shape="rect" id="node19" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="472,309,648,336"/><area shape="rect" id="node21" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="483,360,637,387"/><area shape="rect" id="node23" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="481,411,639,437"/><area shape="rect" id="node4" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="715,5,917,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="982,208,1117,235"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1165,208,1264,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1312,183,1461,209"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1509,208,1560,235"/><area shape="rect" id="node10" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="707,56,925,83"/><area shape="rect" id="node12" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="709,107,923,133"/><area shape="rect" id="node14" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="711,157,921,184"/><area shape="rect" id="node16" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="699,208,933,235"/><area shape="rect" id="node18" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="713,259,919,285"/><area shape="rect" id="node20" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="702,309,930,336"/><area shape="rect" id="node22" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="713,360,919,387"/><area shape="rect" id="node24" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="711,411,921,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9b026ed93df6494c3bd79e2ce8ef41e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsRegisterTests </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l01485">1485</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>Referenced by <a class="el" href="runmode-unittests_8c_source.html#l00135">RunUnittests()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a9b026ed93df6494c3bd79e2ce8ef41e1_icgraph.png" border="0" usemap="#counters_8c_a9b026ed93df6494c3bd79e2ce8ef41e1_icgraph" alt=""/></div>
<map name="counters_8c_a9b026ed93df6494c3bd79e2ce8ef41e1_icgraph" id="counters_8c_a9b026ed93df6494c3bd79e2ce8ef41e1_icgraph">
<area shape="rect" id="node2" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="189,31,288,57"/><area shape="rect" id="node3" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="336,5,485,32"/><area shape="rect" id="node4" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="533,31,584,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af4062b3f41f722538a52f7361ce31306"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsReleaseCounters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="counters_8h.html#a6e8fcf42df158b265285fc4cd5ee4069">StatsCounter</a> *&#160;</td>
          <td class="paramname"><em>head</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases counters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">head</td><td>Pointer to the head of the list of perf counters that have to be freed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l01186">1186</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="flow-hash_8h_source.html#l00203">head</a>, and <a class="el" href="counters_8h_source.html#l00055">StatsCounter_::next</a>.</p>

</div>
</div>
<a class="anchor" id="aabceecc6ca3d6be4cc51adbf23597ff8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsReleasePrivateThreadContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="counters_8h.html#a876fcfe221f90e529e55a50dc1f69084">StatsPrivateThreadContext</a> *&#160;</td>
          <td class="paramname"><em>pca</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the StatsPrivateThreadContext allocated by the user, for storing and updating local counter values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pca</td><td>Pointer to the StatsPrivateThreadContext </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l01205">1205</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="counters_8h_source.html#l00103">StatsPrivateThreadContext_::initialized</a>, <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>, and <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>.</p>

<p>Referenced by <a class="el" href="counters_8c_source.html#l01219">StatsThreadCleanup()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_aabceecc6ca3d6be4cc51adbf23597ff8_icgraph.png" border="0" usemap="#counters_8c_aabceecc6ca3d6be4cc51adbf23597ff8_icgraph" alt=""/></div>
<map name="counters_8c_aabceecc6ca3d6be4cc51adbf23597ff8_icgraph" id="counters_8c_aabceecc6ca3d6be4cc51adbf23597ff8_icgraph">
<area shape="rect" id="node2" href="counters_8h.html#a5bc1f9a7f4e23e58bd94a70bff7d611e" title="StatsThreadCleanup" alt="" coords="237,12,379,39"/><area shape="rect" id="node3" href="tm-threads_8c.html#a1658ac1d3a66d7c50006fc125933c2c1" title="TmThreadFree" alt="" coords="427,12,533,39"/><area shape="rect" id="node4" href="tm-threads_8h.html#a10e0a9360bef968f5e7f26d483c5767a" title="TmThreadClearThreadsFamily" alt="" coords="582,12,781,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee803842fac9bfca7a1d7d47e8028d15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsReleaseResources </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the resources alloted by the Stats API. </p>

<p>Definition at line <a class="el" href="counters_8c_source.html#l01173">1173</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_aee803842fac9bfca7a1d7d47e8028d15_icgraph.png" border="0" usemap="#counters_8c_aee803842fac9bfca7a1d7d47e8028d15_icgraph" alt=""/></div>
<map name="counters_8c_aee803842fac9bfca7a1d7d47e8028d15_icgraph" id="counters_8c_aee803842fac9bfca7a1d7d47e8028d15_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="219,5,269,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aba1b0562d8156303e65898f0cff186f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsSetUI64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets a value of type double to the local counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Index of the local counter in the counter array </td></tr>
    <tr><td class="paramname">pca</td><td>Pointer to the StatsPrivateThreadContext </td></tr>
    <tr><td class="paramname">x</td><td>The value to set for the counter </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00173">173</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="suricata-common_8h_source.html#l00216">BUG_ON</a>, <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="counters_8h_source.html#l00103">StatsPrivateThreadContext_::initialized</a>, <a class="el" href="counters_8h_source.html#l00081">StatsLocalCounter_::pc</a>, <a class="el" href="threadvars_8h_source.html#l00113">ThreadVars_::perf_private_ctx</a>, <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>, <a class="el" href="counters_8c_source.html#l00054">STATS_TYPE_MAXIMUM</a>, <a class="el" href="counters_8c_source.html#l00052">STATS_TYPE_NORMAL</a>, <a class="el" href="counters_8h_source.html#l00035">StatsCounter_::type</a>, <a class="el" href="counters_8h_source.html#l00090">StatsLocalCounter_::updates</a>, and <a class="el" href="counters_8h_source.html#l00087">StatsLocalCounter_::value</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00426">DecodeUpdatePacketCounters()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_aba1b0562d8156303e65898f0cff186f0_icgraph.png" border="0" usemap="#counters_8c_aba1b0562d8156303e65898f0cff186f0_icgraph" alt=""/></div>
<map name="counters_8c_aba1b0562d8156303e65898f0cff186f0_icgraph" id="counters_8c_aba1b0562d8156303e65898f0cff186f0_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga80f244d5793581bd92abab9e8f83ef0c" title="DecodeUpdatePacketCounters" alt="" coords="155,208,357,235"/><area shape="rect" id="node3" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="420,5,513,32"/><area shape="rect" id="node9" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="413,56,521,83"/><area shape="rect" id="node11" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="414,107,519,133"/><area shape="rect" id="node13" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="416,157,517,184"/><area shape="rect" id="node15" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="405,208,528,235"/><area shape="rect" id="node17" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="419,259,514,285"/><area shape="rect" id="node19" href="source-pcap-file_8c.html#a41c54f12c157322cb9fb519cf29ee5e6" title="DecodePcapFile" alt="" coords="407,309,526,336"/><area shape="rect" id="node21" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="418,360,515,387"/><area shape="rect" id="node23" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="416,411,517,437"/><area shape="rect" id="node4" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="592,5,795,32"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="859,208,994,235"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1043,208,1141,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1189,183,1339,209"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1387,208,1437,235"/><area shape="rect" id="node10" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="584,56,803,83"/><area shape="rect" id="node12" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="586,107,801,133"/><area shape="rect" id="node14" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="588,157,799,184"/><area shape="rect" id="node16" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="577,208,810,235"/><area shape="rect" id="node18" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="591,259,796,285"/><area shape="rect" id="node20" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="579,309,807,336"/><area shape="rect" id="node22" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="590,360,797,387"/><area shape="rect" id="node24" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="588,411,799,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a78d358130d3cd8897be6f81a940d2c2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsSetupPostConfig </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l00785">785</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a78d358130d3cd8897be6f81a940d2c2f_icgraph.png" border="0" usemap="#counters_8c_a78d358130d3cd8897be6f81a940d2c2f_icgraph" alt=""/></div>
<map name="counters_8c_a78d358130d3cd8897be6f81a940d2c2f_icgraph" id="counters_8c_a78d358130d3cd8897be6f81a940d2c2f_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="205,5,256,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7252392837ab3054a2a0b0aaf7c06c17"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StatsSetupPrivate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l01112">1112</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00062">ThreadVars_::name</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l00255">TmThreadsSlotPktAcqLoop()</a>, and <a class="el" href="tm-threads_8c_source.html#l00392">TmThreadsSlotVar()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a7252392837ab3054a2a0b0aaf7c06c17_icgraph.png" border="0" usemap="#counters_8c_a7252392837ab3054a2a0b0aaf7c06c17_icgraph" alt=""/></div>
<map name="counters_8c_a7252392837ab3054a2a0b0aaf7c06c17_icgraph" id="counters_8c_a7252392837ab3054a2a0b0aaf7c06c17_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="182,669,365,696"/><area shape="rect" id="node43" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="208,720,339,747"/><area shape="rect" id="node3" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="413,695,544,721"/><area shape="rect" id="node4" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="592,695,712,721"/><area shape="rect" id="node5" href="tm-threads_8h.html#a3a9723ec915f969865c976c6b7b52252" title="Creates and returns a TV instance for a Packet Processing Thread. This function doesn&#39;t support custo..." alt="" coords="777,183,983,209"/><area shape="rect" id="node35" href="tm-threads_8h.html#ae47f93ac82b266764653a7d9e44220d2" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="783,665,977,692"/><area shape="rect" id="node37" href="tm-threads_8h.html#ace687797a257f61387245ec3ec403916" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="1539,715,1733,757"/><area shape="rect" id="node40" href="tm-threads_8h.html#a0ad83f5fc0de8d0ee23346b19ddf5c3d" title="Creates and returns the TV instance for a Command thread (CMD). This function supports only custom sl..." alt="" coords="761,779,999,805"/><area shape="rect" id="node6" href="runmode-erf-file_8h.html#a915f2f8caa7767da0f772a01421d9739" title="RunModeErfFileSingle" alt="" coords="1077,5,1229,32"/><area shape="rect" id="node10" href="runmode-erf-file_8h.html#a4d406431f0ab63d3143b81d3f600b09a" title="RunModeErfFileAutoFp" alt="" coords="1074,56,1233,83"/><area shape="rect" id="node11" href="runmode-pcap-file_8h.html#a0b2361b53d1001da4064cac92706a590" title="Single thread version of the Pcap file processing. " alt="" coords="1071,107,1236,133"/><area shape="rect" id="node13" href="runmode-pcap-file_8h.html#a8b3fac464c73a6e2f8bfd8175a9dbc96" title="RunModeFilePcapAutoFp set up the following thread packet handlers: " alt="" coords="1068,157,1239,184"/><area shape="rect" id="node14" href="util-runmodes_8h.html#aa945fa897a11a3aca339503ccdeda468" title="RunModeSetLiveCaptureAutoFp" alt="" coords="1048,461,1259,488"/><area shape="rect" id="node27" href="util-runmodes_8h.html#a263673ca878720aa97c381465d02381b" title="RunModeSetIPSAutoFp" alt="" coords="1072,259,1235,285"/><area shape="rect" id="node32" href="util-runmodes_8h.html#a6dd10c519f023a760231bf09302de3d7" title="RunModeSetIPSWorker" alt="" coords="1072,208,1235,235"/><area shape="rect" id="node7" href="runmode-erf-file_8h.html#a2fa5ee6e088800426e896df9aeff1048" title="RunModeErfFileRegister" alt="" coords="1316,56,1481,83"/><area shape="rect" id="node8" href="runmodes_8h.html#aa5565123b11fa026e96b91b23db91ba9" title="Register all runmodes in the engine. " alt="" coords="1787,411,1978,437"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2032,680,2083,707"/><area shape="rect" id="node12" href="runmode-pcap-file_8h.html#ac0d7c8cc1a9e09f97cb2fa18dfb6c554" title="RunModeFilePcapRegister" alt="" coords="1309,107,1488,133"/><area shape="rect" id="node15" href="runmode-af-packet_8h.html#af741b481e72c7d4e52637797fa320ea6" title="RunModeIdsAFPAutoFp" alt="" coords="1317,613,1481,640"/><area shape="rect" id="node17" href="runmode-erf-dag_8h.html#a70b2fc6e66952233a4152397b09c64c4" title="RunModeIdsErfDagAutoFp" alt="" coords="1309,360,1488,387"/><area shape="rect" id="node19" href="runmode-netmap_8h.html#a8dfba4755e54c47d166ebfc0fa9297b4" title="RunModeIdsNetmapAutoFp" alt="" coords="1307,411,1491,437"/><area shape="rect" id="node21" href="runmode-nflog_8h.html#a90b0f9d4cb07d2038585ce39116e5f76" title="RunModeIdsNflogAutoFp" alt="" coords="1314,461,1483,488"/><area shape="rect" id="node23" href="runmode-pcap_8h.html#a5a917ab959eb97ad190049c17ace53be" title="RunModIdsPcapAutoFp set up the following thread packet handlers: " alt="" coords="1315,512,1483,539"/><area shape="rect" id="node25" href="runmode-pfring_8h.html#a03d46b27b5c687483ac9f89476f490b6" title="RunModeIdsPfringAutoFp" alt="" coords="1313,563,1485,589"/><area shape="rect" id="node16" href="runmode-af-packet_8h.html#abf510dda35701437fc571d5b5f0f1f6e" title="RunModeIdsAFPRegister" alt="" coords="1551,613,1721,640"/><area shape="rect" id="node18" href="runmode-erf-dag_8h.html#a48e70c4e7988fa65ee295b869150cfa6" title="RunModeErfDagRegister" alt="" coords="1552,360,1720,387"/><area shape="rect" id="node20" href="runmode-netmap_8h.html#a8b229716bfd3fd0ed1c627350b1fb7da" title="RunModeIdsNetmapRegister" alt="" coords="1541,411,1731,437"/><area shape="rect" id="node22" href="runmode-nflog_8h.html#aaabe731f1245f1a7f8cfb9a1e9bd417b" title="RunModeIdsNflogRegister" alt="" coords="1548,461,1724,488"/><area shape="rect" id="node24" href="runmode-pcap_8h.html#a16e1fcee3ffd97b1987150fdd11cbbd5" title="RunModeIdsPcapRegister" alt="" coords="1549,512,1723,539"/><area shape="rect" id="node26" href="runmode-pfring_8h.html#a60ccf23e33d96ce4ad0e111902f1984b" title="RunModeIdsPfringRegister" alt="" coords="1547,563,1725,589"/><area shape="rect" id="node28" href="runmode-ipfw_8h.html#ab98f939c839da52cdfa459f4369c7881" title="RunModeIpsIPFWAutoFp" alt="" coords="1313,259,1485,285"/><area shape="rect" id="node30" href="runmode-nfq_8h.html#a74ab8fb81b460f68e5b2989c9575e41a" title="RunModeIpsNFQAutoFp" alt="" coords="1315,309,1482,336"/><area shape="rect" id="node29" href="runmode-ipfw_8h.html#ae06ebfcccd6f11438a720a3b5753e5ac" title="RunModeIpsIPFWRegister" alt="" coords="1547,259,1725,285"/><area shape="rect" id="node31" href="runmode-nfq_8h.html#a9357135b637234befb24cfcefde1e95e" title="RunModeIpsNFQRegister" alt="" coords="1549,309,1723,336"/><area shape="rect" id="node33" href="runmode-ipfw_8h.html#a17d8ec657d20d82a53849a56e9db4b82" title="RunModeIpsIPFWWorker" alt="" coords="1313,157,1485,184"/><area shape="rect" id="node34" href="runmode-nfq_8h.html#aa10ad0e1cc7e8cb8738e88d97a4722d5" title="RunModeIpsNFQWorker" alt="" coords="1315,208,1482,235"/><area shape="rect" id="node36" href="counters_8h.html#a21cd088e883d698355768801db6f5e9d" title="Spawns the wakeup, and the management thread used by the stats api. " alt="" coords="1813,629,1953,656"/><area shape="rect" id="node38" href="flow-manager_8h.html#a20dbca5b9bd98fe6c7a3de02d6487a4c" title="spawn the flow manager thread " alt="" coords="1793,731,1973,757"/><area shape="rect" id="node39" href="flow-manager_8h.html#a83c270c95bd002fd66653df0b56224db" title="spawn the flow recycler thread " alt="" coords="1791,680,1974,707"/><area shape="rect" id="node41" href="detect-engine-loader_8h.html#adf5194d673bf98d3bb964e10ec1872e5" title="spawn the detect loader manager thread " alt="" coords="1063,780,1243,807"/><area shape="rect" id="node42" href="detect-engine_8h.html#a3dd8dd8e9160b754f6be5b7136f5f891" title="setup multi&#45;detect / multi&#45;tenancy " alt="" coords="1781,781,1984,808"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21cd088e883d698355768801db6f5e9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsSpawnThreads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spawns the wakeup, and the management thread used by the stats api. </p>
<p>The threads use the condition variable in the thread vars to control their wait loops to make sure the main thread can quickly kill them. </p>

<p>Definition at line <a class="el" href="counters_8c_source.html#l00796">796</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="util-error_8h_source.html#l00078">SC_ERR_THREAD_CREATE</a>, <a class="el" href="util-error_8h_source.html#l00076">SC_ERR_THREAD_SPAWN</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-debug_8h_source.html#l00310">SCReturn</a>, <a class="el" href="tm-threads_8c_source.html#l01178">TmThreadCreateMgmtThread()</a>, and <a class="el" href="tm-threads_8c_source.html#l01689">TmThreadSpawn()</a>.</p>

<p>Referenced by <a class="el" href="suricata_8c_source.html#l02154">main()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a21cd088e883d698355768801db6f5e9d_cgraph.png" border="0" usemap="#counters_8c_a21cd088e883d698355768801db6f5e9d_cgraph" alt=""/></div>
<map name="counters_8c_a21cd088e883d698355768801db6f5e9d_cgraph" id="counters_8c_a21cd088e883d698355768801db6f5e9d_cgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a79b66d870752829f5f0ccb6c91b76dac" title="Creates and returns the TV instance for a Management thread(MGMT). This function supports only custom..." alt="" coords="195,625,389,652"/><area shape="rect" id="node40" href="tm-threads_8c.html#af5c7ad411065ae98710138b400f84633" title="Spawns a thread associated with the ThreadVars instance tv. " alt="" coords="231,713,353,740"/><area shape="rect" id="node3" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="467,485,587,512"/><area shape="rect" id="node38" href="tm-threads_8c.html#a7b792091fc079fe5b2cf755e5f53849a" title="TmThreadsRegisterThread" alt="" coords="438,593,615,620"/><area shape="rect" id="node39" href="tm-threads_8c.html#ae91e211f1f8350abcd67b23c58dcf577" title="TmThreadSetCPU" alt="" coords="461,644,592,671"/><area shape="rect" id="node4" href="tm-threads_8c.html#a901bedcd2161f466a67de9a4ad88aba8" title="Set a thread flag. " alt="" coords="1461,181,1595,208"/><area shape="rect" id="node5" href="tm-queues_8c.html#ace94ae034c7dd71ab2c4057283bb54b5" title="TmqGetQueueByName" alt="" coords="690,536,849,563"/><area shape="rect" id="node6" href="tm-queues_8c.html#a69e4ed1bf80a56d98afbb5992f6c4093" title="TmqCreateQueue" alt="" coords="707,587,832,613"/><area shape="rect" id="node7" href="tm-queuehandlers_8c.html#a9f14e45e62be8d624dc2dfb57c809545" title="TmqhGetQueueHandlerByName" alt="" coords="664,5,875,32"/><area shape="rect" id="node8" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="704,485,835,512"/><area shape="rect" id="node37" href="tm-threads_8c.html#a33a706eef27334eebefb3f0653a37b44" title="Initializes the mutex and condition variables for this TV. " alt="" coords="709,435,829,461"/><area shape="rect" id="node9" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="949,485,1080,512"/><area shape="rect" id="node33" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="923,739,1106,765"/><area shape="rect" id="node10" href="util-signal_8c.html#ace72889703113c3d3185d67fc715461e" title="UtilSignalBlock" alt="" coords="1203,587,1314,613"/><area shape="rect" id="node11" href="tmqh-packetpool_8c.html#ac12e370bb1f5ccbe943cf34454ab7b11" title="PacketPoolInitEmpty" alt="" coords="1186,157,1331,184"/><area shape="rect" id="node12" href="tm-threads_8c.html#aeda67fab252b97fe5f158ba053a45de7" title="Set the thread options (cpu affinitythread). Priority should be already set by pthread_create. " alt="" coords="1179,739,1339,765"/><area shape="rect" id="node17" href="suricata_8c.html#ae44adde25e112c3693ed1cbb5e6597c0" title="EngineKill" alt="" coords="1219,637,1299,664"/><area shape="rect" id="node18" href="counters_8c.html#a7252392837ab3054a2a0b0aaf7c06c17" title="StatsSetupPrivate" alt="" coords="1195,485,1323,512"/><area shape="rect" id="node19" href="tm-threads_8c.html#a3051b9f7e147aecbdfef8a693987e8f3" title="Check if a thread flag is set. " alt="" coords="1453,891,1603,917"/><area shape="rect" id="node20" href="tm-threads_8c.html#a9dec77fa2aee796d6435afa70f1ee475" title="Tests if the thread represented in the arg has been unpaused or not. " alt="" coords="1155,840,1363,867"/><area shape="rect" id="node21" href="tm-threads_8c.html#a1a2a3d971bdab1af519d4aabd46b8f5d" title="Unset a thread flag. " alt="" coords="1185,536,1333,563"/><area shape="rect" id="node22" href="tm-threads_8c.html#a3e6a7d6f5867c6909351b1ee45dc2a0b" title="Separate run function so we can call it recursively. " alt="" coords="1181,283,1336,309"/><area shape="rect" id="node25" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1723,333,1882,360"/><area shape="rect" id="node24" href="packet-queue_8c.html#a609973832178eed5f62ea8939417b366" title="PacketDequeue" alt="" coords="1745,232,1860,259"/><area shape="rect" id="node23" href="tmqh-packetpool_8c.html#a88e2aa59717ee175827019cf8b6697bf" title="Release all the packets in the queue back to the packetpool. Mainly used by threads that have failed..." alt="" coords="1411,333,1645,360"/><area shape="rect" id="node29" href="tm-threads_8c.html#afbb02380645247d1256fe2a20701e92a" title="Waits till the specified flag(s) is(are) set. We don&#39;t bother if the kill flag has been set or not on..." alt="" coords="1183,891,1335,917"/><area shape="rect" id="node30" href="tmqh-packetpool_8c.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="1191,789,1326,816"/><area shape="rect" id="node13" href="tm-threads_8c.html#a2281ca1569730c81dffeb4779b399cef" title="Adjusting nice value for threads. " alt="" coords="1466,688,1590,715"/><area shape="rect" id="node14" href="util-affinity_8c.html#a60e0581f091ba45f813af9b17cba2cc8" title="Return next cpu to use for a given thread family. " alt="" coords="1457,739,1599,765"/><area shape="rect" id="node15" href="util-cpu_8c.html#a4f36ee9e70d73c5d8fb86fa6a86c44e2" title="Get the number of cpus online in the system. " alt="" coords="1693,739,1912,765"/><area shape="rect" id="node16" href="util-cpu_8c.html#a76e3d657a52ccbf2d4c788d1b51a454f" title="Get the number of cpus configured in the system. " alt="" coords="1961,739,2205,765"/><area shape="rect" id="node26" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1999,333,2166,360"/><area shape="rect" id="node27" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="2254,333,2469,360"/><area shape="rect" id="node28" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="2518,333,2605,360"/><area shape="rect" id="node31" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="1758,916,1847,943"/><area shape="rect" id="node32" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="1453,789,1603,816"/><area shape="rect" id="node34" href="tmqh-packetpool_8c.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1205,1043,1312,1069"/><area shape="rect" id="node36" href="suricata_8c.html#a0bfd2bf05c54da8f7fd1c538858e631b" title="Used to indicate that the current task is done. " alt="" coords="1212,992,1305,1019"/><area shape="rect" id="node35" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="1457,992,1599,1019"/><area shape="rect" id="node41" href="tm-threads_8c.html#a30ae4af36f2b0389107a54a8dc00691c" title="Appends this TV to tv_root based on its type. " alt="" coords="464,713,589,740"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a21cd088e883d698355768801db6f5e9d_icgraph.png" border="0" usemap="#counters_8c_a21cd088e883d698355768801db6f5e9d_icgraph" alt=""/></div>
<map name="counters_8c_a21cd088e883d698355768801db6f5e9d_icgraph" id="counters_8c_a21cd088e883d698355768801db6f5e9d_icgraph">
<area shape="rect" id="node2" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="195,5,245,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09bd1636d92f10107f55cf59f5b4a30f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StatsThreadCleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="counters_8c_source.html#l01219">1219</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="threadvars_8h_source.html#l00113">ThreadVars_::perf_private_ctx</a>, <a class="el" href="threadvars_8h_source.html#l00110">ThreadVars_::perf_public_ctx</a>, and <a class="el" href="counters_8c_source.html#l01205">StatsReleasePrivateThreadContext()</a>.</p>

<p>Referenced by <a class="el" href="tm-threads_8c_source.html#l01642">TmThreadFree()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_cgraph.png" border="0" usemap="#counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_cgraph" alt=""/></div>
<map name="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_cgraph" id="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#aabceecc6ca3d6be4cc51adbf23597ff8" title="Releases the StatsPrivateThreadContext allocated by the user, for storing and updating local counter ..." alt="" coords="195,5,378,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_icgraph.png" border="0" usemap="#counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_icgraph" alt=""/></div>
<map name="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_icgraph" id="counters_8c_a09bd1636d92f10107f55cf59f5b4a30f_icgraph">
<area shape="rect" id="node2" href="tm-threads_8c.html#a1658ac1d3a66d7c50006fc125933c2c1" title="TmThreadFree" alt="" coords="195,5,301,32"/><area shape="rect" id="node3" href="tm-threads_8h.html#a10e0a9360bef968f5e7f26d483c5767a" title="TmThreadClearThreadsFamily" alt="" coords="350,5,549,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af130407b17bce27c0a89eecd53efeb09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int StatsUpdateCounterArray </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="counters_8h.html#a876fcfe221f90e529e55a50dc1f69084">StatsPrivateThreadContext</a> *&#160;</td>
          <td class="paramname"><em>pca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="counters_8h.html#a6361db03b0a1612164875dcd55872559">StatsPublicThreadContext</a> *&#160;</td>
          <td class="paramname"><em>pctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Syncs the counter array with the global counter variables. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pca</td><td>Pointer to the StatsPrivateThreadContext </td></tr>
    <tr><td class="paramname">pctx</td><td>Pointer the the tv's StatsPublicThreadContext</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="counters_8c_source.html#l01129">1129</a> of file <a class="el" href="counters_8c_source.html">counters.c</a>.</p>

<p>References <a class="el" href="counters_8h_source.html#l00098">StatsPrivateThreadContext_::head</a>, <a class="el" href="counters_8h_source.html#l00072">StatsPublicThreadContext_::m</a>, <a class="el" href="counters_8h_source.html#l00063">StatsPublicThreadContext_::perf_flag</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00064">SCMutexLock</a>, <a class="el" href="threads-arch-tile_8h_source.html#l00073">SCMutexUnlock</a>, and <a class="el" href="counters_8h_source.html#l00101">StatsPrivateThreadContext_::size</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="counters_8c.html">counters.c</a></li>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:03 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
