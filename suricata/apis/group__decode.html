<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>suricata: Packet decoding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">suricata
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__decode.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Packet decoding</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code in charge of protocol decoding.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:decode-erspan_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-erspan_8c.html">decode-erspan.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-ethernet_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-ethernet_8c.html">decode-ethernet.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-gre_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-gre_8c.html">decode-gre.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-icmpv4_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-icmpv4_8c.html">decode-icmpv4.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-icmpv6_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-icmpv6_8c.html">decode-icmpv6.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-ipv4_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-ipv4_8c.html">decode-ipv4.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-ipv6_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-ipv6_8c.html">decode-ipv6.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-null_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-null_8c.html">decode-null.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-ppp_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-ppp_8c.html">decode-ppp.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-pppoe_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-pppoe_8c.html">decode-pppoe.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-raw_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-raw_8c.html">decode-raw.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-sctp_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-sctp_8c.html">decode-sctp.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-sll_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-sll_8c.html">decode-sll.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-tcp_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-tcp_8c.html">decode-tcp.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-template_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-template_8c.html">decode-template.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-teredo_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-teredo_8c.html">decode-teredo.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-udp_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-udp_8c.html">decode-udp.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode-vlan_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode-vlan_8c.html">decode-vlan.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:decode_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="decode_8c.html">decode.c</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3d5a53f9af62c80797e8095c7e95e947"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947">DecodeTunnel</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint8_t *pkt, uint16_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq, enum <a class="el" href="decode_8h.html#a6bb493f9ee8010c70ce6c3858f5a0815">DecodeTunnelProto</a> <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>)</td></tr>
<tr class="separator:ga3d5a53f9af62c80797e8095c7e95e947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbb7a223135dab327a0f78a96f931889"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889">PacketFree</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:gadbb7a223135dab327a0f78a96f931889"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a malloced packet.  <a href="#gadbb7a223135dab327a0f78a96f931889">More...</a><br/></td></tr>
<tr class="separator:gadbb7a223135dab327a0f78a96f931889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34b0a10ee3a77793bddbc8f8eceb832f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga34b0a10ee3a77793bddbc8f8eceb832f">PacketDecodeFinalize</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:ga34b0a10ee3a77793bddbc8f8eceb832f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize decoding of a packet.  <a href="#ga34b0a10ee3a77793bddbc8f8eceb832f">More...</a><br/></td></tr>
<tr class="separator:ga34b0a10ee3a77793bddbc8f8eceb832f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd3d2505353dbc2b396776da9afbcd74"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74">PacketGetFromAlloc</a> (void)</td></tr>
<tr class="memdesc:gadd3d2505353dbc2b396776da9afbcd74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a malloced packet.  <a href="#gadd3d2505353dbc2b396776da9afbcd74">More...</a><br/></td></tr>
<tr class="separator:gadd3d2505353dbc2b396776da9afbcd74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9ba0322fe2563acde4b409301b9a39d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gad9ba0322fe2563acde4b409301b9a39d">PacketFreeOrRelease</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="memdesc:gad9ba0322fe2563acde4b409301b9a39d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a packet to where it was allocated.  <a href="#gad9ba0322fe2563acde4b409301b9a39d">More...</a><br/></td></tr>
<tr class="separator:gad9ba0322fe2563acde4b409301b9a39d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9517a36d0462938ef712e5e6640d5f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6">PacketGetFromQueueOrAlloc</a> (void)</td></tr>
<tr class="memdesc:gab9517a36d0462938ef712e5e6640d5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packet that is free'd again after processing.  <a href="#gab9517a36d0462938ef712e5e6640d5f6">More...</a><br/></td></tr>
<tr class="separator:gab9517a36d0462938ef712e5e6640d5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75e1aa7780434c2c66943eaf33028d0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga75e1aa7780434c2c66943eaf33028d0b">PacketCallocExtPkt</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, int datalen)</td></tr>
<tr class="separator:ga75e1aa7780434c2c66943eaf33028d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fcac3c41c0cab4466ac184d2719e24e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e">PacketCopyDataOffset</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, int offset, uint8_t *<a class="el" href="app-layer-htp_8h.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, int datalen)</td></tr>
<tr class="memdesc:ga4fcac3c41c0cab4466ac184d2719e24e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy data to Packet payload at given offset.  <a href="#ga4fcac3c41c0cab4466ac184d2719e24e">More...</a><br/></td></tr>
<tr class="separator:ga4fcac3c41c0cab4466ac184d2719e24e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6e35d6641ed3e55adc0ac5ea698fe4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a">PacketCopyData</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint8_t *pktdata, int pktlen)</td></tr>
<tr class="memdesc:gac6e35d6641ed3e55adc0ac5ea698fe4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy data to Packet payload and set packet length.  <a href="#gac6e35d6641ed3e55adc0ac5ea698fe4a">More...</a><br/></td></tr>
<tr class="separator:gac6e35d6641ed3e55adc0ac5ea698fe4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga289ef60badcd4b221fadd90590249d15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15">PacketTunnelPktSetup</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *parent, uint8_t *pkt, uint16_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, enum <a class="el" href="decode_8h.html#a6bb493f9ee8010c70ce6c3858f5a0815">DecodeTunnelProto</a> <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>, <a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *pq)</td></tr>
<tr class="memdesc:ga289ef60badcd4b221fadd90590249d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup a pseudo packet (tunnel)  <a href="#ga289ef60badcd4b221fadd90590249d15">More...</a><br/></td></tr>
<tr class="separator:ga289ef60badcd4b221fadd90590249d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a2a9e86342d10a67ce9178598793597"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597">PacketDefragPktSetup</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *parent, uint8_t *pkt, uint16_t <a class="el" href="data-queue_8h.html#a8aed22e2c7b283705ec82e0120515618">len</a>, uint8_t <a class="el" href="decode-template_8h.html#adaae928b69788f774db092e75f1c4fb7">proto</a>)</td></tr>
<tr class="memdesc:ga6a2a9e86342d10a67ce9178598793597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup a pseudo packet (reassembled frags)  <a href="#ga6a2a9e86342d10a67ce9178598793597">More...</a><br/></td></tr>
<tr class="separator:ga6a2a9e86342d10a67ce9178598793597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23b8b588f6c258541769c1e94347a947"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga23b8b588f6c258541769c1e94347a947">PacketDefragPktSetupParent</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *parent)</td></tr>
<tr class="memdesc:ga23b8b588f6c258541769c1e94347a947"><td class="mdescLeft">&#160;</td><td class="mdescRight">inform defrag "parent" that a pseudo packet is now assosiated to it.  <a href="#ga23b8b588f6c258541769c1e94347a947">More...</a><br/></td></tr>
<tr class="separator:ga23b8b588f6c258541769c1e94347a947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga30a380d9d448ff265b6b9d5d3f81d4e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga30a380d9d448ff265b6b9d5d3f81d4e4">DecodeRegisterPerfCounters</a> (<a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, <a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="separator:ga30a380d9d448ff265b6b9d5d3f81d4e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80f244d5793581bd92abab9e8f83ef0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga80f244d5793581bd92abab9e8f83ef0c">DecodeUpdatePacketCounters</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, const <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv, const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:ga80f244d5793581bd92abab9e8f83ef0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7399e13976d381fa205e1958b03559d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga7399e13976d381fa205e1958b03559d7">AddressDebugPrint</a> (<a class="el" href="decode_8h.html#a8abc33dbf209112e8c582237fccd9af2">Address</a> *a)</td></tr>
<tr class="memdesc:ga7399e13976d381fa205e1958b03559d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debug print function for printing addresses.  <a href="#ga7399e13976d381fa205e1958b03559d7">More...</a><br/></td></tr>
<tr class="separator:ga7399e13976d381fa205e1958b03559d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7665e2409fe6cc688c1ba7bead8cc57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gac7665e2409fe6cc688c1ba7bead8cc57">DecodeThreadVarsAlloc</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv)</td></tr>
<tr class="memdesc:gac7665e2409fe6cc688c1ba7bead8cc57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alloc and setup DecodeThreadVars.  <a href="#gac7665e2409fe6cc688c1ba7bead8cc57">More...</a><br/></td></tr>
<tr class="separator:gac7665e2409fe6cc688c1ba7bead8cc57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6339c663affee81d94921a3ab2860e15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga6339c663affee81d94921a3ab2860e15">DecodeThreadVarsFree</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *dtv)</td></tr>
<tr class="separator:ga6339c663affee81d94921a3ab2860e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1b2af622dbb515f30ce521db6c3a93c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga1b2af622dbb515f30ce521db6c3a93c9">PacketSetData</a> (<a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p, uint8_t *pktdata, int pktlen)</td></tr>
<tr class="memdesc:ga1b2af622dbb515f30ce521db6c3a93c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set data for Packet and set length when zeo copy is used.  <a href="#ga1b2af622dbb515f30ce521db6c3a93c9">More...</a><br/></td></tr>
<tr class="separator:ga1b2af622dbb515f30ce521db6c3a93c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad9efa0fb28aaf19e0bcc56f12534bb14"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gad9efa0fb28aaf19e0bcc56f12534bb14">PktSrcToString</a> (enum <a class="el" href="decode_8h.html#aefc62937f305eb5e11ff205a5fd056b0">PktSrcEnum</a> pkt_src)</td></tr>
<tr class="separator:gad9efa0fb28aaf19e0bcc56f12534bb14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5">CaptureStatsUpdate</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#a358ee0744cddc90b20e1177dd4242977">CaptureStats</a> *s, const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *p)</td></tr>
<tr class="separator:ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1bed034bb99c0f39628191847689b3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__decode.html#gaf1bed034bb99c0f39628191847689b3a">CaptureStatsSetup</a> (<a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *tv, <a class="el" href="decode_8h.html#a358ee0744cddc90b20e1177dd4242977">CaptureStats</a> *s)</td></tr>
<tr class="separator:gaf1bed034bb99c0f39628191847689b3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Code in charge of protocol decoding. </p>
<p>The task of decoding packets is made in different files and as Suricata is supporting encapsulation there is a potential recursivity in the call.</p>
<p>For each protocol a DecodePROTO function is provided. For example we have <a class="el" href="decode-ipv4_8c.html#ad21e971ed8a39cbd704e59c535c09696">DecodeIPV4()</a> for IPv4 and <a class="el" href="decode-ppp_8c.html#aa1cb8247d5f82507327372a9af7daa71">DecodePPP()</a> for PPP.</p>
<p>These functions have all a pkt and and a len argument which are respectively a pointer to the protocol data and the length of this protocol data.</p>
<dl class="section attention"><dt>Attention</dt><dd>The pkt parameter must point to the effective data because it will be used later to set per protocol pointer like <a class="el" href="structPacket__.html#a26c072f57085fde64be3a3c5d35a31ab">Packet::tcph</a> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga7399e13976d381fa205e1958b03559d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddressDebugPrint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a8abc33dbf209112e8c582237fccd9af2">Address</a> *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Debug print function for printing addresses. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td>object</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000042">Todo:</a></b></dt><dd>IPv6 </dd></dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00443">443</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00104">Address_::family</a>, <a class="el" href="util-print_8c_source.html#l00260">PrintInet()</a>, and <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga7399e13976d381fa205e1958b03559d7_cgraph.png" border="0" usemap="#group__decode_ga7399e13976d381fa205e1958b03559d7_cgraph" alt=""/></div>
<map name="group__decode_ga7399e13976d381fa205e1958b03559d7_cgraph" id="group__decode_ga7399e13976d381fa205e1958b03559d7_cgraph">
<area shape="rect" id="node2" href="util-print_8c.html#a90bfafc4dfabddab2662c4b7bf6f7d03" title="PrintInet" alt="" coords="190,5,261,32"/><area shape="rect" id="node3" href="win32-misc_8h.html#a8b4e65d5530474709182ee0d9faa6dda" title="inet_ntop" alt="" coords="309,5,384,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaf1bed034bb99c0f39628191847689b3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CaptureStatsSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a358ee0744cddc90b20e1177dd4242977">CaptureStats</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00563">563</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00640">CaptureStats_::counter_ips_accepted</a>, <a class="el" href="decode_8h_source.html#l00641">CaptureStats_::counter_ips_blocked</a>, <a class="el" href="decode_8h_source.html#l00642">CaptureStats_::counter_ips_rejected</a>, <a class="el" href="decode_8h_source.html#l00643">CaptureStats_::counter_ips_replaced</a>, and <a class="el" href="counters_8c_source.html#l00850">StatsRegisterCounter()</a>.</p>

<p>Referenced by <a class="el" href="source-nfq_8c_source.html#l00758">VerdictNFQThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gaf1bed034bb99c0f39628191847689b3a_cgraph.png" border="0" usemap="#group__decode_gaf1bed034bb99c0f39628191847689b3a_cgraph" alt=""/></div>
<map name="group__decode_gaf1bed034bb99c0f39628191847689b3a_cgraph" id="group__decode_gaf1bed034bb99c0f39628191847689b3a_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="187,5,335,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gaf1bed034bb99c0f39628191847689b3a_icgraph.png" border="0" usemap="#group__decode_gaf1bed034bb99c0f39628191847689b3a_icgraph" alt=""/></div>
<map name="group__decode_gaf1bed034bb99c0f39628191847689b3a_icgraph" id="group__decode_gaf1bed034bb99c0f39628191847689b3a_icgraph">
<area shape="rect" id="node2" href="source-nfq_8c.html#acd1cd050a85be381cc3bbdedf383009b" title="VerdictNFQThreadInit" alt="" coords="187,5,336,32"/><area shape="rect" id="node3" href="source-nfq_8c.html#a72f89d52fdea56362998f329f2052ddc" title="TmModuleVerdictNFQRegister" alt="" coords="385,5,586,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="635,5,770,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="819,5,917,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1163,5,1213,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="965,31,1115,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CaptureStatsUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a358ee0744cddc90b20e1177dd4242977">CaptureStats</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00550">550</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="action-globals_8h_source.html#l00030">ACTION_DROP</a>, <a class="el" href="action-globals_8h_source.html#l00031">ACTION_REJECT</a>, <a class="el" href="action-globals_8h_source.html#l00033">ACTION_REJECT_BOTH</a>, <a class="el" href="action-globals_8h_source.html#l00032">ACTION_REJECT_DST</a>, <a class="el" href="decode_8h_source.html#l00640">CaptureStats_::counter_ips_accepted</a>, <a class="el" href="decode_8h_source.html#l00641">CaptureStats_::counter_ips_blocked</a>, <a class="el" href="decode_8h_source.html#l00642">CaptureStats_::counter_ips_rejected</a>, <a class="el" href="decode_8h_source.html#l00643">CaptureStats_::counter_ips_replaced</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00812">PACKET_TEST_ACTION</a>, <a class="el" href="decode_8h_source.html#l01027">PKT_STREAM_MODIFIED</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="source-nfq_8c_source.html#l01174">VerdictNFQ()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_cgraph.png" border="0" usemap="#group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_cgraph" alt=""/></div>
<map name="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_cgraph" id="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="195,5,269,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_icgraph.png" border="0" usemap="#group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_icgraph" alt=""/></div>
<map name="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_icgraph" id="group__decode_ga72c6cf9d15bc6b8f4d9c2d16b7a5a5a5_icgraph">
<area shape="rect" id="node2" href="source-nfq_8c.html#a6033429b6ace5a1477225b4ea2a392fa" title="NFQ verdict module packet entry function. " alt="" coords="195,5,285,32"/><area shape="rect" id="node3" href="source-nfq_8c.html#a72f89d52fdea56362998f329f2052ddc" title="TmModuleVerdictNFQRegister" alt="" coords="334,5,535,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="585,5,719,32"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="768,5,867,32"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1112,5,1163,32"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="915,31,1064,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga30a380d9d448ff265b6b9d5d3f81d4e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DecodeRegisterPerfCounters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00377">377</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00590">DecodeThreadVars_::counter_avg_pkt_size</a>, <a class="el" href="decode_8h_source.html#l00589">DecodeThreadVars_::counter_bytes</a>, <a class="el" href="decode_8h_source.html#l00619">DecodeThreadVars_::counter_defrag_ipv4_fragments</a>, <a class="el" href="decode_8h_source.html#l00620">DecodeThreadVars_::counter_defrag_ipv4_reassembled</a>, <a class="el" href="decode_8h_source.html#l00621">DecodeThreadVars_::counter_defrag_ipv4_timeouts</a>, <a class="el" href="decode_8h_source.html#l00622">DecodeThreadVars_::counter_defrag_ipv6_fragments</a>, <a class="el" href="decode_8h_source.html#l00623">DecodeThreadVars_::counter_defrag_ipv6_reassembled</a>, <a class="el" href="decode_8h_source.html#l00624">DecodeThreadVars_::counter_defrag_ipv6_timeouts</a>, <a class="el" href="decode_8h_source.html#l00625">DecodeThreadVars_::counter_defrag_max_hit</a>, <a class="el" href="decode_8h_source.html#l00616">DecodeThreadVars_::counter_erspan</a>, <a class="el" href="decode_8h_source.html#l00595">DecodeThreadVars_::counter_eth</a>, <a class="el" href="decode_8h_source.html#l00627">DecodeThreadVars_::counter_flow_memcap</a>, <a class="el" href="decode_8h_source.html#l00608">DecodeThreadVars_::counter_gre</a>, <a class="el" href="decode_8h_source.html#l00600">DecodeThreadVars_::counter_icmpv4</a>, <a class="el" href="decode_8h_source.html#l00601">DecodeThreadVars_::counter_icmpv6</a>, <a class="el" href="decode_8h_source.html#l00593">DecodeThreadVars_::counter_invalid</a>, <a class="el" href="decode_8h_source.html#l00596">DecodeThreadVars_::counter_ipv4</a>, <a class="el" href="decode_8h_source.html#l00614">DecodeThreadVars_::counter_ipv4inipv6</a>, <a class="el" href="decode_8h_source.html#l00597">DecodeThreadVars_::counter_ipv6</a>, <a class="el" href="decode_8h_source.html#l00615">DecodeThreadVars_::counter_ipv6inipv6</a>, <a class="el" href="decode_8h_source.html#l00591">DecodeThreadVars_::counter_max_pkt_size</a>, <a class="el" href="decode_8h_source.html#l00613">DecodeThreadVars_::counter_mpls</a>, <a class="el" href="decode_8h_source.html#l00605">DecodeThreadVars_::counter_null</a>, <a class="el" href="decode_8h_source.html#l00588">DecodeThreadVars_::counter_pkts</a>, <a class="el" href="decode_8h_source.html#l00607">DecodeThreadVars_::counter_ppp</a>, <a class="el" href="decode_8h_source.html#l00611">DecodeThreadVars_::counter_pppoe</a>, <a class="el" href="decode_8h_source.html#l00604">DecodeThreadVars_::counter_raw</a>, <a class="el" href="decode_8h_source.html#l00606">DecodeThreadVars_::counter_sctp</a>, <a class="el" href="decode_8h_source.html#l00603">DecodeThreadVars_::counter_sll</a>, <a class="el" href="decode_8h_source.html#l00598">DecodeThreadVars_::counter_tcp</a>, <a class="el" href="decode_8h_source.html#l00612">DecodeThreadVars_::counter_teredo</a>, <a class="el" href="decode_8h_source.html#l00599">DecodeThreadVars_::counter_udp</a>, <a class="el" href="decode_8h_source.html#l00609">DecodeThreadVars_::counter_vlan</a>, <a class="el" href="decode_8h_source.html#l00610">DecodeThreadVars_::counter_vlan_qinq</a>, <a class="el" href="counters_8c_source.html#l00871">StatsRegisterAvgCounter()</a>, <a class="el" href="counters_8c_source.html#l00850">StatsRegisterCounter()</a>, and <a class="el" href="counters_8c_source.html#l00892">StatsRegisterMaxCounter()</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01886">DecodeAFPThreadInit()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00645">DecodeErfDagThreadInit()</a>, <a class="el" href="source-erf-file_8c_source.html#l00246">DecodeErfFileThreadInit()</a>, <a class="el" href="source-ipfw_8c_source.html#l00485">DecodeIPFWThreadInit()</a>, <a class="el" href="source-nfq_8c_source.html#l01254">DecodeNFQThreadInit()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00441">DecodePcapFileThreadInit()</a>, <a class="el" href="source-pcap_8c_source.html#l00736">DecodePcapThreadInit()</a>, <a class="el" href="source-pfring_8c_source.html#l00652">DecodePfringThreadInit()</a>, and <a class="el" href="source-napatech_8c_source.html#l00378">NapatechDecodeThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_cgraph.png" border="0" usemap="#group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_cgraph" alt=""/></div>
<map name="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_cgraph" id="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#a85284c96fa9935606e5cac996152bb58" title="Registers a counter, whose value holds the average of all the values assigned to it. " alt="" coords="249,5,420,32"/><area shape="rect" id="node3" href="counters_8c.html#a7bae5ee323fcf0d82c933600b870eb93" title="Registers a normal, unqualified counter. " alt="" coords="261,56,409,83"/><area shape="rect" id="node4" href="counters_8c.html#a218da697828635f6781d521c305eadf4" title="Registers a counter, whose value holds the maximum of all the values assigned to it. " alt="" coords="248,107,421,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_icgraph.png" border="0" usemap="#group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_icgraph" alt=""/></div>
<map name="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_icgraph" id="group__decode_ga30a380d9d448ff265b6b9d5d3f81d4e4_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="263,5,414,32"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="255,56,422,83"/><area shape="rect" id="node10" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="257,107,420,133"/><area shape="rect" id="node12" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="259,157,418,184"/><area shape="rect" id="node14" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="262,208,415,235"/><area shape="rect" id="node16" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="251,259,427,285"/><area shape="rect" id="node18" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="261,309,416,336"/><area shape="rect" id="node20" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="259,360,418,387"/><area shape="rect" id="node22" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="248,411,429,437"/><area shape="rect" id="node3" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="493,5,696,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="761,208,895,235"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="944,208,1043,235"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1288,208,1339,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1091,233,1240,260"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="485,56,704,83"/><area shape="rect" id="node11" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="487,107,702,133"/><area shape="rect" id="node13" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="489,157,700,184"/><area shape="rect" id="node15" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="492,208,697,235"/><area shape="rect" id="node17" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="481,259,709,285"/><area shape="rect" id="node19" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="491,309,698,336"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="489,360,700,387"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="478,411,711,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac7665e2409fe6cc688c1ba7bead8cc57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a>* DecodeThreadVarsAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alloc and setup DecodeThreadVars. </p>
<p>set config defaults </p>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00460">460</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00583">DecodeThreadVars_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00595">AppLayerGetCtxThread()</a>, <a class="el" href="conf_8c_source.html#l00442">ConfGetBool()</a>, <a class="el" href="decode_8c_source.html#l00486">DecodeThreadVarsFree()</a>, <a class="el" href="decode_8h_source.html#l00631">DecodeThreadVars_::output_flow_thread_data</a>, <a class="el" href="output-flow_8c_source.html#l00126">OutputFlowLogThreadInit()</a>, <a class="el" href="util-error_8h_source.html#l00079">SC_ERR_THREAD_INIT</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-debug_8h_source.html#l00272">SCLogError</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, and <a class="el" href="decode_8h_source.html#l00585">DecodeThreadVars_::vlan_disabled</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01886">DecodeAFPThreadInit()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00645">DecodeErfDagThreadInit()</a>, <a class="el" href="source-erf-file_8c_source.html#l00246">DecodeErfFileThreadInit()</a>, <a class="el" href="source-ipfw_8c_source.html#l00485">DecodeIPFWThreadInit()</a>, <a class="el" href="source-nfq_8c_source.html#l01254">DecodeNFQThreadInit()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00441">DecodePcapFileThreadInit()</a>, <a class="el" href="source-pcap_8c_source.html#l00736">DecodePcapThreadInit()</a>, <a class="el" href="source-pfring_8c_source.html#l00652">DecodePfringThreadInit()</a>, and <a class="el" href="source-napatech_8c_source.html#l00378">NapatechDecodeThreadInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_cgraph.png" border="0" usemap="#group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_cgraph" alt=""/></div>
<map name="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_cgraph" id="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#aa4aa5e8ee44572efd7b8db73c997f0ea" title="Creates a new app layer thread context. " alt="" coords="221,148,379,175"/><area shape="rect" id="node15" href="conf_8c.html#ad05ff3c317a042691169abc26475bb19" title="Retrieve a configuration value as an boolen. " alt="" coords="251,325,349,352"/><area shape="rect" id="node21" href="group__decode.html#ga6339c663affee81d94921a3ab2860e15" title="DecodeThreadVarsFree" alt="" coords="220,224,380,251"/><area shape="rect" id="node24" href="output-flow_8c.html#a25446d9a0b1e4fcc38d013d55288c1fa" title="thread init for the flow logger This will run the thread init functions for the individual registered..." alt="" coords="216,275,384,301"/><area shape="rect" id="node3" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="435,173,619,200"/><area shape="rect" id="node11" href="app-layer-parser_8c.html#a1c63a0c4330ed49065ed530ed50940dd" title="Gets a new app layer protocol&#39;s parser thread context. " alt="" coords="669,123,875,149"/><area shape="rect" id="node13" href="app-layer-detect-proto_8c.html#a8b43711ceaf0ad0aada2bd438480dddd" title="Inits and returns an app layer protocol detection thread context. " alt="" coords="432,57,621,98"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="671,177,873,204"/><area shape="rect" id="node8" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="675,57,869,98"/><area shape="rect" id="node5" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="923,229,1133,270"/><area shape="rect" id="node7" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="928,177,1128,204"/><area shape="rect" id="node6" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="1182,177,1333,204"/><area shape="rect" id="node9" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="991,60,1065,87"/><area shape="rect" id="node10" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="1209,60,1306,87"/><area shape="rect" id="node12" href="app-layer-parser_8c.html#a2b0517e26b65ae0299677d4f097b223f" title="AppLayerParserGetProtocol\lParserLocalStorage" alt="" coords="936,111,1120,153"/><area shape="rect" id="node14" href="util-mpm_8c.html#aef0b59171845a87218792da6eb8cdfea" title="Setup a pmq. " alt="" coords="731,5,813,32"/><area shape="rect" id="node16" href="conf_8c.html#aa9a73ee6024346fb296f427369e56f40" title="Retrieve the value of a configuration node. " alt="" coords="491,376,562,403"/><area shape="rect" id="node20" href="conf_8c.html#aade6334a8339003368930c54f9da6a0f" title="Check if a value is true. " alt="" coords="473,325,580,352"/><area shape="rect" id="node17" href="conf_8c.html#a61d153ebd102e46aac77547f9ca8e24a" title="Get a ConfNode by name. " alt="" coords="721,376,823,403"/><area shape="rect" id="node18" href="conf_8c.html#a0cb759d7f1e8abc9102f4317ff6b7e62" title="Lookup a child configuration node by name. " alt="" coords="951,351,1105,377"/><area shape="rect" id="node19" href="suricata-common_8h.html#aeb79f86261de904967d433c1b5e9a1de" title="strlcpy" alt="" coords="997,401,1059,428"/><area shape="rect" id="node22" href="output-flow_8c.html#a4435c7a5c922d293aaecf43a6d7f2b0c" title="OutputFlowLogThreadDeinit" alt="" coords="435,224,619,251"/><area shape="rect" id="node23" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="695,252,849,279"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_icgraph.png" border="0" usemap="#group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_icgraph" alt=""/></div>
<map name="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_icgraph" id="group__decode_gac7665e2409fe6cc688c1ba7bead8cc57_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="231,5,382,32"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="223,56,390,83"/><area shape="rect" id="node10" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="225,107,388,133"/><area shape="rect" id="node12" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="227,157,386,184"/><area shape="rect" id="node14" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="230,208,383,235"/><area shape="rect" id="node16" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="219,259,395,285"/><area shape="rect" id="node18" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="229,309,384,336"/><area shape="rect" id="node20" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="227,360,386,387"/><area shape="rect" id="node22" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="216,411,397,437"/><area shape="rect" id="node3" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="461,5,664,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="729,208,863,235"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="912,208,1011,235"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1256,208,1307,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1059,233,1208,260"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="453,56,672,83"/><area shape="rect" id="node11" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="455,107,670,133"/><area shape="rect" id="node13" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="457,157,668,184"/><area shape="rect" id="node15" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="460,208,665,235"/><area shape="rect" id="node17" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="449,259,677,285"/><area shape="rect" id="node19" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="459,309,666,336"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="457,360,668,387"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="446,411,679,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6339c663affee81d94921a3ab2860e15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DecodeThreadVarsFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00486">486</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00583">DecodeThreadVars_::app_tctx</a>, <a class="el" href="app-layer_8c_source.html#l00617">AppLayerDestroyCtxThread()</a>, <a class="el" href="decode_8h_source.html#l00631">DecodeThreadVars_::output_flow_thread_data</a>, <a class="el" href="output-flow_8c_source.html#l00175">OutputFlowLogThreadDeinit()</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01908">DecodeAFPThreadDeinit()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00663">DecodeErfDagThreadDeinit()</a>, <a class="el" href="source-erf-file_8c_source.html#l00262">DecodeErfFileThreadDeinit()</a>, <a class="el" href="source-ipfw_8c_source.html#l00500">DecodeIPFWThreadDeinit()</a>, <a class="el" href="source-nfq_8c_source.html#l01269">DecodeNFQThreadDeinit()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00462">DecodePcapFileThreadDeinit()</a>, <a class="el" href="source-pcap_8c_source.html#l00758">DecodePcapThreadDeinit()</a>, <a class="el" href="source-pfring_8c_source.html#l00673">DecodePfringThreadDeinit()</a>, <a class="el" href="decode_8c_source.html#l00460">DecodeThreadVarsAlloc()</a>, and <a class="el" href="source-napatech_8c_source.html#l00395">NapatechDecodeThreadDeinit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga6339c663affee81d94921a3ab2860e15_cgraph.png" border="0" usemap="#group__decode_ga6339c663affee81d94921a3ab2860e15_cgraph" alt=""/></div>
<map name="group__decode_ga6339c663affee81d94921a3ab2860e15_cgraph" id="group__decode_ga6339c663affee81d94921a3ab2860e15_cgraph">
<area shape="rect" id="node2" href="app-layer_8c.html#ac11ba71f5c16ec06b4e64b61ee86a5d6" title="Destroys the context created by AppLayeGetCtxThread(). " alt="" coords="213,125,397,152"/><area shape="rect" id="node10" href="output-flow_8c.html#a4435c7a5c922d293aaecf43a6d7f2b0c" title="OutputFlowLogThreadDeinit" alt="" coords="213,180,397,207"/><area shape="rect" id="node3" href="app-layer-parser_8c.html#a5ea726897ab9fae1e13724d7a342de1b" title="Destroys the app layer parser thread context obtained using AppLayerParserThreadCtxAlloc(). " alt="" coords="445,67,648,93"/><area shape="rect" id="node7" href="app-layer-detect-proto_8c.html#af925107e0ba823688508c7c03cacc920" title="Destroys the app layer protocol detection thread context. " alt="" coords="450,118,643,159"/><area shape="rect" id="node4" href="app-layer-parser_8c.html#a55c82f8c0b2de8f7a7af6ff13b3ccc61" title="AppLayerParserDestroyProtocol\lParserLocalStorage" alt="" coords="697,5,906,46"/><area shape="rect" id="node6" href="flow-util_8c.html#a2258030b58194ee63d15a17a9b4a5384" title="FlowGetReverseProtoMapping" alt="" coords="701,71,901,97"/><area shape="rect" id="node5" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="955,12,1106,39"/><area shape="rect" id="node8" href="util-mpm_8c.html#a008e7642096b8fc6661fd89b1dcf837b" title="Cleanup and free a Pmq. " alt="" coords="764,125,839,152"/><area shape="rect" id="node9" href="util-mpm_8c.html#a2a2264519fb4b8ba76f450a10f48f62f" title="Cleanup a Pmq. " alt="" coords="982,125,1079,152"/><area shape="rect" id="node11" href="tm-modules_8c.html#a3a0bd493c799543f1b0b8c7e8c67e283" title="get a tm module ptr by name " alt="" coords="469,184,624,211"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga6339c663affee81d94921a3ab2860e15_icgraph.png" border="0" usemap="#group__decode_ga6339c663affee81d94921a3ab2860e15_icgraph" alt=""/></div>
<map name="group__decode_ga6339c663affee81d94921a3ab2860e15_icgraph" id="group__decode_ga6339c663affee81d94921a3ab2860e15_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#ga3c4a177fe643cfbf02de98b31b9a1563" title="DecodeAFPThreadDeinit" alt="" coords="466,244,633,271"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#a4d3a683beeb01b9bf7ff6250725af6c3" title="DecodeErfDagThreadDeinit" alt="" coords="221,84,403,111"/><area shape="rect" id="node10" href="source-erf-file_8c.html#ad490c99f184e1a57d79a381d23658fd3" title="DecodeErfFileThreadDeinit" alt="" coords="223,192,401,219"/><area shape="rect" id="node12" href="source-ipfw_8c.html#a81efbe592654d1938744b11b53988c30" title="DecodeIPFWThreadDeinit" alt="" coords="225,5,399,32"/><area shape="rect" id="node14" href="source-nfq_8c.html#ab2b0780dd2b06a06a328601656415f9b" title="DecodeNFQThreadDeinit" alt="" coords="227,755,397,781"/><area shape="rect" id="node16" href="source-pcap-file_8c.html#afb35954ee3770828d4f43991f0d1447f" title="DecodePcapFileThreadDeinit" alt="" coords="216,828,408,855"/><area shape="rect" id="node18" href="source-pcap_8c.html#ae70054297eb6079e7d391aa329e92b3e" title="DecodePcapThreadDeinit" alt="" coords="227,657,397,684"/><area shape="rect" id="node20" href="source-pfring_8c.html#a87b1c0c7fe35d1fce94ad778f80fd5b3" title="DecodePfringThreadDeinit" alt="" coords="225,483,399,509"/><area shape="rect" id="node22" href="group__decode.html#gac7665e2409fe6cc688c1ba7bead8cc57" title="Alloc and setup DecodeThreadVars. " alt="" coords="231,432,393,459"/><area shape="rect" id="node33" href="source-napatech_8c.html#a16fe31e46b66b413c5d2f685476da38d" title="NapatechDecodeThreadDeinit" alt="" coords="213,565,411,592"/><area shape="rect" id="node3" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="704,345,907,372"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="971,396,1106,423"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1155,396,1253,423"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1499,396,1549,423"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1301,421,1451,448"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="696,193,915,220"/><area shape="rect" id="node11" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="698,295,913,321"/><area shape="rect" id="node13" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="700,92,911,119"/><area shape="rect" id="node15" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="703,649,908,676"/><area shape="rect" id="node17" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="691,751,919,777"/><area shape="rect" id="node19" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="702,548,909,575"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="700,396,911,423"/><area shape="rect" id="node23" href="group__afppacket.html#ga1a26fc40f8dfa5016aada1955beb9ec2" title="DecodeAFPThreadInit" alt="" coords="474,345,625,372"/><area shape="rect" id="node24" href="source-erf-dag_8c.html#a662c7de24bb6f9bfab58dd71cd90590d" title="DecodeErfDagThreadInit" alt="" coords="466,193,633,220"/><area shape="rect" id="node25" href="source-erf-file_8c.html#adafcbf2338cc6bb37fc789ca962ce5f0" title="Initialize the ERF decoder thread. " alt="" coords="468,295,631,321"/><area shape="rect" id="node26" href="source-ipfw_8c.html#a050a1a30a989817ff690350617397aa0" title="This function initializes the DecodeThreadVariables. " alt="" coords="470,92,629,119"/><area shape="rect" id="node27" href="source-napatech_8c.html#a63b6b73db5df2b1201944c46b67bed20" title="NapatechDecodeThreadInit" alt="" coords="459,447,640,473"/><area shape="rect" id="node29" href="source-nfq_8c.html#a927d58521731b4f905d73d55c650afa0" title="Initialize the NFQ Decode threadvars. " alt="" coords="473,649,626,676"/><area shape="rect" id="node30" href="source-pcap-file_8c.html#a2829038cb3227afb1c9c41024c3145b3" title="DecodePcapFileThreadInit" alt="" coords="461,751,637,777"/><area shape="rect" id="node31" href="source-pcap_8c.html#adad64130c7cc6e231d32cdd19302a2a1" title="DecodePcapThreadInit" alt="" coords="472,548,627,575"/><area shape="rect" id="node32" href="source-pfring_8c.html#ae2135001a6c641f815994e4354f1b502" title="This an Init function for DecodePfring. " alt="" coords="470,396,629,423"/><area shape="rect" id="node28" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="689,447,922,473"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga3d5a53f9af62c80797e8095c7e95e947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DecodeTunnel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="decode_8h.html#a6bb493f9ee8010c70ce6c3858f5a0815">DecodeTunnelProto</a>&#160;</td>
          <td class="paramname"><em>proto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00069">69</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00858">DECODE_TUNNEL_ERSPAN</a>, <a class="el" href="decode_8h_source.html#l00857">DECODE_TUNNEL_ETHERNET</a>, <a class="el" href="decode_8h_source.html#l00860">DECODE_TUNNEL_IPV4</a>, <a class="el" href="decode_8h_source.html#l00861">DECODE_TUNNEL_IPV6</a>, <a class="el" href="decode_8h_source.html#l00862">DECODE_TUNNEL_PPP</a>, <a class="el" href="decode_8h_source.html#l00859">DECODE_TUNNEL_VLAN</a>, <a class="el" href="decode-erspan_8c_source.html#l00046">DecodeERSPAN()</a>, <a class="el" href="decode-ethernet_8c_source.html#l00041">DecodeEthernet()</a>, <a class="el" href="decode-ipv4_8c_source.html#l00520">DecodeIPV4()</a>, <a class="el" href="decode-ipv6_8c_source.html#l00600">DecodeIPV6()</a>, <a class="el" href="decode-ppp_8c_source.html#l00043">DecodePPP()</a>, <a class="el" href="decode-vlan_8c_source.html#l00059">DecodeVLAN()</a>, <a class="el" href="util-debug_8h_source.html#l00247">SCLogInfo</a>, and <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00257">PacketTunnelPktSetup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_cgraph.png" border="0" usemap="#group__decode_ga3d5a53f9af62c80797e8095c7e95e947_cgraph" alt=""/></div>
<map name="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_cgraph" id="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_cgraph">
<area shape="rect" id="node2" href="decode-erspan_8c.html#af55b5b63849ebbbc396d3b4f97d5b9c9" title="Function to decode ERSPAN packets. " alt="" coords="160,263,283,290"/><area shape="rect" id="node3" href="decode-ethernet_8c.html#ac1afbb2de3c48f5e55238a68a80c1a28" title="DecodeEthernet" alt="" coords="331,364,447,391"/><area shape="rect" id="node4" href="decode-ipv4_8c.html#ad21e971ed8a39cbd704e59c535c09696" title="DecodeIPV4" alt="" coords="869,635,965,662"/><area shape="rect" id="node43" href="decode-ipv6_8c.html#a82f0d48b6022ab2630da21d3b0fa0542" title="DecodeIPV6" alt="" coords="869,480,965,507"/><area shape="rect" id="node50" href="decode-ppp_8c.html#aa1cb8247d5f82507327372a9af7daa71" title="DecodePPP" alt="" coords="687,314,782,340"/><area shape="rect" id="node49" href="decode-vlan_8c.html#a2f04a35b7ddf4f8443df460cd18c583e" title="DecodeVLAN" alt="" coords="497,263,599,290"/><area shape="rect" id="node15" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1473,404,1548,431"/><area shape="rect" id="node46" href="decode-mpls_8c.html#aa91e2972618ccbcaf595ab1072eec718" title="DecodeMPLS" alt="" coords="683,478,786,504"/><area shape="rect" id="node47" href="decode-pppoe_8c.html#a07b9952ea991dac758976e25fa90033a" title="Main decoding function for PPPOE Discovery packets. " alt="" coords="649,50,821,76"/><area shape="rect" id="node48" href="decode-pppoe_8c.html#aac0b8cb4381233c884de7320889b0571" title="Main decoding function for PPPOE Session packets. " alt="" coords="655,364,815,391"/><area shape="rect" id="node5" href="decode-gre_8c.html#a53db4a10141df6f438736b5409933569" title="Function to decode GRE packets. " alt="" coords="1237,1215,1333,1242"/><area shape="rect" id="node16" href="decode-icmpv4_8c.html#ab06bf50acf1abcea5e85f31d66fcad5c" title="Main ICMPv4 decoding function. " alt="" coords="1028,860,1145,887"/><area shape="rect" id="node26" href="decode-sctp_8c.html#a10d4d580215e385f2ae1dfbc18d96e56" title="DecodeSCTP" alt="" coords="1035,582,1138,608"/><area shape="rect" id="node27" href="decode-tcp_8c.html#a8bc5a8474325211e3c8dcbf49362a22e" title="DecodeTCP" alt="" coords="1039,683,1134,710"/><area shape="rect" id="node28" href="decode-udp_8c.html#aa315124ac688837f31bded8b253e7d62" title="DecodeUDP" alt="" coords="1039,784,1135,811"/><area shape="rect" id="node40" href="defrag_8c.html#a0887ef3b129e978f0d27b469c68eb2ba" title="Entry point for IPv4 and IPv6 fragments. " alt="" coords="1056,430,1117,456"/><area shape="rect" id="node6" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="1453,1190,1568,1216"/><area shape="rect" id="node7" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="1433,1291,1589,1318"/><area shape="rect" id="node18" href="util-print_8c.html#a90bfafc4dfabddab2662c4b7bf6f7d03" title="PrintInet" alt="" coords="1475,1038,1546,1064"/><area shape="rect" id="node42" href="util-debug_8c.html#ab793aa1c0db8ab4c177d80f79c085297" title="Returns whether debug messages are enabled to be logged or not. " alt="" coords="1013,531,1160,558"/><area shape="rect" id="node8" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="1699,1291,1893,1318"/><area shape="rect" id="node11" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="1735,1354,1857,1380"/><area shape="rect" id="node13" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="1717,1215,1875,1242"/><area shape="rect" id="node9" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="2002,1259,2153,1286"/><area shape="rect" id="node10" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="2006,1310,2149,1336"/><area shape="rect" id="node12" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="1998,1360,2157,1387"/><area shape="rect" id="node14" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="1994,1208,2161,1235"/><area shape="rect" id="node17" href="decode-icmpv4_8c.html#a1bcac56d7695147a538006f6c2d386ad" title="DecodePartialIPV4" alt="" coords="1219,1012,1352,1039"/><area shape="rect" id="node20" href="flow_8c.html#a630858d075864b1b8693caf370fa8e00" title="Entry point for packet flow handling. " alt="" coords="1219,911,1351,938"/><area shape="rect" id="node19" href="win32-misc_8h.html#a8b4e65d5530474709182ee0d9faa6dda" title="inet_ntop" alt="" coords="1759,1038,1833,1064"/><area shape="rect" id="node21" href="flow-hash_8c.html#ab9b72607bceec0064346afce2f6cbdd1" title="Get Flow for packet. " alt="" coords="1431,911,1591,938"/><area shape="rect" id="node24" href="flow_8c.html#a3d88a8d5aee8f279280f3d7976a15a61" title="Update Packet and Flow. " alt="" coords="1423,962,1598,988"/><area shape="rect" id="node22" href="flow-util_8c.html#ab860700383c3811a4aaf74b2cfd1de05" title="FlowInit" alt="" coords="1762,911,1830,938"/><area shape="rect" id="node23" href="flow-util_8c.html#a897ee3b52fa7876e9780704dbc2d1b11" title="Function to map the protocol to the defined FLOW_PROTO_* enumeration. " alt="" coords="2002,810,2153,836"/><area shape="rect" id="node25" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow " alt="" coords="1714,962,1878,988"/><area shape="rect" id="node29" href="app-layer_8c.html#ad71bacf418c62589d8da38247850e10f" title="Handle a app layer UDP message. " alt="" coords="1214,810,1357,836"/><area shape="rect" id="node39" href="decode-teredo_8c.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1232,962,1339,988"/><area shape="rect" id="node30" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1436,708,1585,735"/><area shape="rect" id="node38" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1411,810,1610,836"/><area shape="rect" id="node31" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="1714,556,1878,583"/><area shape="rect" id="node32" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="1715,607,1877,634"/><area shape="rect" id="node34" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="1709,708,1883,735"/><area shape="rect" id="node33" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="1982,632,2173,659"/><area shape="rect" id="node35" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="1689,810,1903,836"/><area shape="rect" id="node36" href="stream-tcp-reassemble_8c.html#a419339627115993b6ef9f55ebbd4365c" title="StreamTcpDisableAppLayer" alt="" coords="1703,860,1889,887"/><area shape="rect" id="node37" href="stream-tcp-reassemble_8h.html#a740e5a7f3e6792cf64cfe9926a93abb6" title="Set the No reassembly flag for the given direction in given TCP session. " alt="" coords="1659,506,1933,532"/><area shape="rect" id="node41" href="defrag-hash_8c.html#a31638db8974dd1ef93586526a8b8b1fd" title="DefragTrackerRelease" alt="" coords="1209,455,1362,482"/><area shape="rect" id="node44" href="decode-icmpv6_8c.html#abf958842b8ab82927b35fec37813be8f" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="1028,480,1145,507"/><area shape="rect" id="node45" href="decode-icmpv6_8c.html#a77763bde0c82ec50dd179f10478fee74" title="Get variables and do some checks of the embedded IPV6 packet. " alt="" coords="1219,860,1352,887"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_icgraph.png" border="0" usemap="#group__decode_ga3d5a53f9af62c80797e8095c7e95e947_icgraph" alt=""/></div>
<map name="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_icgraph" id="group__decode_ga3d5a53f9af62c80797e8095c7e95e947_icgraph">
<area shape="rect" id="node2" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="161,328,317,354"/><area shape="rect" id="node3" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="520,277,616,304"/><area shape="rect" id="node4" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="685,353,781,380"/><area shape="rect" id="node36" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="365,429,472,456"/><area shape="rect" id="node5" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1318,365,1434,392"/><area shape="rect" id="node26" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="880,264,981,290"/><area shape="rect" id="node17" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1521,213,1623,240"/><area shape="rect" id="node28" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="883,112,978,138"/><area shape="rect" id="node30" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1119,541,1209,568"/><area shape="rect" id="node31" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1329,770,1423,797"/><area shape="rect" id="node32" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="851,416,1011,442"/><area shape="rect" id="node35" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1329,669,1423,696"/><area shape="rect" id="node34" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1335,618,1417,645"/><area shape="rect" id="node33" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1113,490,1215,517"/><area shape="rect" id="node6" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1525,618,1619,645"/><area shape="rect" id="node12" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1518,314,1626,341"/><area shape="rect" id="node14" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1519,365,1625,392"/><area shape="rect" id="node16" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1511,162,1633,189"/><area shape="rect" id="node18" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1523,517,1621,544"/><area shape="rect" id="node20" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1521,416,1623,442"/><area shape="rect" id="node22" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1511,264,1633,290"/><area shape="rect" id="node24" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1483,568,1661,594"/><area shape="rect" id="node7" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="1725,618,1928,645"/><area shape="rect" id="node8" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1993,416,2127,442"/><area shape="rect" id="node9" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2176,416,2275,442"/><area shape="rect" id="node10" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2520,416,2571,442"/><area shape="rect" id="node11" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2323,441,2472,468"/><area shape="rect" id="node13" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1717,314,1936,341"/><area shape="rect" id="node15" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1719,365,1934,392"/><area shape="rect" id="node19" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="1723,517,1930,544"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1721,416,1932,442"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1710,264,1943,290"/><area shape="rect" id="node25" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="1711,568,1942,594"/><area shape="rect" id="node27" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="1059,289,1269,316"/><area shape="rect" id="node29" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1061,112,1267,138"/><area shape="rect" id="node37" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="520,429,616,456"/><area shape="rect" id="node38" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="685,480,781,506"/><area shape="rect" id="node39" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="665,429,802,456"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga80f244d5793581bd92abab9e8f83ef0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DecodeUpdatePacketCounters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00426">426</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00590">DecodeThreadVars_::counter_avg_pkt_size</a>, <a class="el" href="decode_8h_source.html#l00589">DecodeThreadVars_::counter_bytes</a>, <a class="el" href="decode_8h_source.html#l00591">DecodeThreadVars_::counter_max_pkt_size</a>, <a class="el" href="decode_8h_source.html#l00588">DecodeThreadVars_::counter_pkts</a>, <a class="el" href="decode_8h_source.html#l00213">GET_PKT_LEN</a>, <a class="el" href="counters_8c_source.html#l00130">StatsAddUI64()</a>, <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>, and <a class="el" href="counters_8c_source.html#l00173">StatsSetUI64()</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01844">DecodeAFP()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00612">DecodeErfDag()</a>, <a class="el" href="source-erf-file_8c_source.html#l00276">DecodeErfFile()</a>, <a class="el" href="source-ipfw_8c_source.html#l00441">DecodeIPFW()</a>, <a class="el" href="source-nfq_8c_source.html#l01222">DecodeNFQ()</a>, <a class="el" href="source-pcap_8c_source.html#l00696">DecodePcap()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00406">DecodePcapFile()</a>, <a class="el" href="source-pfring_8c_source.html#l00619">DecodePfring()</a>, and <a class="el" href="source-napatech_8c_source.html#l00347">NapatechDecode()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_cgraph.png" border="0" usemap="#group__decode_ga80f244d5793581bd92abab9e8f83ef0c_cgraph" alt=""/></div>
<map name="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_cgraph" id="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#afe875414dd4620c523f895a83d365c4b" title="Adds a value of type uint64_t to the local counter. " alt="" coords="256,5,360,32"/><area shape="rect" id="node3" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="271,56,345,83"/><area shape="rect" id="node4" href="counters_8c.html#aba1b0562d8156303e65898f0cff186f0" title="Sets a value of type double to the local counter. " alt="" coords="257,107,359,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_icgraph.png" border="0" usemap="#group__decode_ga80f244d5793581bd92abab9e8f83ef0c_icgraph" alt=""/></div>
<map name="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_icgraph" id="group__decode_ga80f244d5793581bd92abab9e8f83ef0c_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="271,5,364,32"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="263,56,371,83"/><area shape="rect" id="node10" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="265,107,370,133"/><area shape="rect" id="node12" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="267,157,368,184"/><area shape="rect" id="node14" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="270,208,365,235"/><area shape="rect" id="node16" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="269,259,366,285"/><area shape="rect" id="node18" href="source-pcap-file_8c.html#a41c54f12c157322cb9fb519cf29ee5e6" title="DecodePcapFile" alt="" coords="258,309,377,336"/><area shape="rect" id="node20" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="267,360,368,387"/><area shape="rect" id="node22" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="256,411,379,437"/><area shape="rect" id="node3" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="443,5,645,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="710,208,845,235"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="893,208,992,235"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1237,208,1288,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1040,233,1189,260"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="435,56,653,83"/><area shape="rect" id="node11" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="437,107,651,133"/><area shape="rect" id="node13" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="439,157,649,184"/><area shape="rect" id="node15" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="441,208,647,235"/><area shape="rect" id="node17" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="441,259,647,285"/><area shape="rect" id="node19" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="430,309,658,336"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="439,360,649,387"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="427,411,661,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga75e1aa7780434c2c66943eaf33028d0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PacketCallocExtPkt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00178">178</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00494">Packet_::ext_pkt</a>, <a class="el" href="util-mem_8h_source.html#l00205">SCCalloc</a>, <a class="el" href="decode_8h_source.html#l00218">SET_PKT_LEN</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="gac6e35d6641ed3e55adc0ac5ea698fe4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PacketCopyData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pktdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pktlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy data to Packet payload and set packet length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pointer</td><td>to the Packet to modify </td></tr>
    <tr><td class="paramname">Pointer</td><td>to the data to copy </td></tr>
    <tr><td class="paramname">Length</td><td>of the data to copy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00241">241</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8c_source.html#l00204">PacketCopyDataOffset()</a>, and <a class="el" href="decode_8h_source.html#l00218">SET_PKT_LEN</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l00531">AFPRead()</a>, <a class="el" href="source-af-packet_8c_source.html#l00725">AFPReadFromRing()</a>, <a class="el" href="source-napatech_8c_source.html#l00181">NapatechStreamLoop()</a>, <a class="el" href="source-nfq_8c_source.html#l00413">NFQSetupPkt()</a>, <a class="el" href="decode_8c_source.html#l00327">PacketDefragPktSetup()</a>, <a class="el" href="decode_8c_source.html#l00257">PacketTunnelPktSetup()</a>, <a class="el" href="source-pcap_8c_source.html#l00230">PcapCallbackLoop()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00141">PcapFileCallbackLoop()</a>, <a class="el" href="source-ipfw_8c_source.html#l00227">ReceiveIPFWLoop()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05763">StreamTcpPseudoSetup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_cgraph.png" border="0" usemap="#group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_cgraph" alt=""/></div>
<map name="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_cgraph" id="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_cgraph">
<area shape="rect" id="node2" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="177,5,335,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_icgraph.png" border="0" usemap="#group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_icgraph" alt=""/></div>
<map name="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_icgraph" id="group__decode_gac6e35d6641ed3e55adc0ac5ea698fe4a_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="219,851,298,877"/><area shape="rect" id="node8" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="191,800,327,827"/><area shape="rect" id="node9" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="421,948,569,975"/><area shape="rect" id="node11" href="source-nfq_8c.html#a685bd5abf241e1e7281beeb512567e0f" title="Read data from nfq message and setup Packet. " alt="" coords="207,952,311,979"/><area shape="rect" id="node12" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597" title="Setup a pseudo packet (reassembled frags) " alt="" coords="181,1003,337,1029"/><area shape="rect" id="node13" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="181,521,337,548"/><area shape="rect" id="node42" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="429,15,560,41"/><area shape="rect" id="node45" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="688,889,840,916"/><area shape="rect" id="node47" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="937,65,1069,92"/><area shape="rect" id="node49" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="177,1053,341,1080"/><area shape="rect" id="node3" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="433,851,557,877"/><area shape="rect" id="node4" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="2053,1148,2259,1175"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2321,1005,2455,1032"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2504,1005,2603,1032"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2651,1005,2701,1032"/><area shape="rect" id="node10" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="649,1231,879,1257"/><area shape="rect" id="node14" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="716,471,812,497"/><area shape="rect" id="node15" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="955,496,1051,523"/><area shape="rect" id="node38" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="441,572,548,599"/><area shape="rect" id="node16" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1649,432,1765,459"/><area shape="rect" id="node28" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1180,1028,1281,1055"/><area shape="rect" id="node22" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1851,229,1954,256"/><area shape="rect" id="node30" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1183,724,1278,751"/><area shape="rect" id="node32" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1447,959,1537,985"/><area shape="rect" id="node33" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1659,736,1754,763"/><area shape="rect" id="node34" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1151,420,1311,447"/><area shape="rect" id="node37" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1659,685,1754,712"/><area shape="rect" id="node36" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1665,635,1748,661"/><area shape="rect" id="node21" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2103,331,2209,357"/><area shape="rect" id="node35" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1441,533,1543,560"/><area shape="rect" id="node17" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1856,635,1949,661"/><area shape="rect" id="node18" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1849,381,1957,408"/><area shape="rect" id="node19" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1850,432,1955,459"/><area shape="rect" id="node20" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1841,331,1964,357"/><area shape="rect" id="node23" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1854,685,1951,712"/><area shape="rect" id="node24" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1852,483,1953,509"/><area shape="rect" id="node25" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1841,533,1964,560"/><area shape="rect" id="node26" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1813,736,1992,763"/><area shape="rect" id="node27" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2041,1005,2271,1032"/><area shape="rect" id="node29" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2051,1067,2261,1093"/><area shape="rect" id="node31" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1389,837,1595,864"/><area shape="rect" id="node39" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="716,572,812,599"/><area shape="rect" id="node40" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="955,749,1051,776"/><area shape="rect" id="node41" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="934,572,1071,599"/><area shape="rect" id="node43" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="700,15,828,41"/><area shape="rect" id="node44" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="1125,15,1336,41"/><area shape="rect" id="node46" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="928,952,1077,979"/><area shape="rect" id="node48" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="1385,65,1599,92"/><area shape="rect" id="node50" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="389,1046,600,1087"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga4fcac3c41c0cab4466ac184d2719e24e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PacketCopyDataOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy data to Packet payload at given offset. </p>
<p>This function copies data/payload to a Packet. It uses the space allocated at Packet creation (pointed by Packet::pkt) or allocate some memory (pointed by <a class="el" href="structPacket__.html#a499e3aff2d65091f21471450a276fbc1">Packet::ext_pkt</a>) if the data size is to big to fit in initial space (of size default_packet_size).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pointer</td><td>to the Packet to modify </td></tr>
    <tr><td class="paramname">Offset</td><td>of the copy relatively to payload of Packet </td></tr>
    <tr><td class="paramname">Pointer</td><td>to the data to copy </td></tr>
    <tr><td class="paramname">Length</td><td>of the data to copy </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00204">204</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00565">default_packet_size</a>, <a class="el" href="decode_8h_source.html#l00494">Packet_::ext_pkt</a>, <a class="el" href="decode_8h_source.html#l00215">GET_PKT_DIRECT_DATA</a>, <a class="el" href="decode_8h_source.html#l00216">GET_PKT_DIRECT_MAX_SIZE</a>, <a class="el" href="decode_8h_source.html#l00564">MAX_PAYLOAD_SIZE</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="decode_8h_source.html#l00218">SET_PKT_LEN</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00241">PacketCopyData()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga4fcac3c41c0cab4466ac184d2719e24e_icgraph.png" border="0" usemap="#group__decode_ga4fcac3c41c0cab4466ac184d2719e24e_icgraph" alt=""/></div>
<map name="group__decode_ga4fcac3c41c0cab4466ac184d2719e24e_icgraph" id="group__decode_ga4fcac3c41c0cab4466ac184d2719e24e_icgraph">
<area shape="rect" id="node2" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="213,551,336,577"/><area shape="rect" id="node3" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="389,588,545,615"/><area shape="rect" id="node34" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597" title="Setup a pseudo packet (reassembled frags) " alt="" coords="389,360,545,387"/><area shape="rect" id="node35" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="427,309,506,336"/><area shape="rect" id="node38" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="399,411,535,437"/><area shape="rect" id="node39" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="637,411,769,437"/><area shape="rect" id="node41" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="890,512,1038,539"/><area shape="rect" id="node43" href="source-nfq_8c.html#a685bd5abf241e1e7281beeb512567e0f" title="Read data from nfq message and setup Packet. " alt="" coords="415,639,519,665"/><area shape="rect" id="node44" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="627,1171,779,1197"/><area shape="rect" id="node46" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="637,1221,768,1248"/><area shape="rect" id="node49" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="385,1196,549,1223"/><area shape="rect" id="node4" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="916,563,1012,589"/><area shape="rect" id="node5" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1176,563,1272,589"/><area shape="rect" id="node30" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="649,664,756,691"/><area shape="rect" id="node6" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1915,537,2031,564"/><area shape="rect" id="node20" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1441,259,1543,285"/><area shape="rect" id="node12" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2118,385,2221,412"/><area shape="rect" id="node22" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1445,1069,1539,1096"/><area shape="rect" id="node24" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1716,879,1807,905"/><area shape="rect" id="node25" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1926,841,2021,868"/><area shape="rect" id="node26" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1412,461,1572,488"/><area shape="rect" id="node29" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1926,740,2021,767"/><area shape="rect" id="node28" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1932,689,2015,716"/><area shape="rect" id="node11" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2369,487,2476,513"/><area shape="rect" id="node27" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1710,461,1813,488"/><area shape="rect" id="node7" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="2123,740,2216,767"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="2115,588,2223,615"/><area shape="rect" id="node9" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="2117,639,2222,665"/><area shape="rect" id="node10" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="2108,487,2231,513"/><area shape="rect" id="node13" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="2121,791,2218,817"/><area shape="rect" id="node14" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="2119,689,2220,716"/><area shape="rect" id="node15" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="2108,537,2231,564"/><area shape="rect" id="node16" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="2080,841,2259,868"/><area shape="rect" id="node17" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2307,841,2538,868"/><area shape="rect" id="node18" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2587,157,2722,184"/><area shape="rect" id="node19" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2771,157,2869,184"/><area shape="rect" id="node21" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2317,157,2528,184"/><area shape="rect" id="node23" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1659,1120,1864,1147"/><area shape="rect" id="node31" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="916,664,1012,691"/><area shape="rect" id="node32" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="1176,664,1272,691"/><area shape="rect" id="node33" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="1155,715,1293,741"/><area shape="rect" id="node36" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="641,309,765,336"/><area shape="rect" id="node37" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="1121,5,1327,32"/><area shape="rect" id="node40" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="857,208,1071,235"/><area shape="rect" id="node42" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="1377,107,1607,133"/><area shape="rect" id="node45" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="1149,1171,1299,1197"/><area shape="rect" id="node47" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="900,1221,1028,1248"/><area shape="rect" id="node48" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="1656,1221,1867,1248"/><area shape="rect" id="node50" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="597,1273,808,1314"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga34b0a10ee3a77793bddbc8f8eceb832f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketDecodeFinalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalize decoding of a packet. </p>
<p>This function needs to be call at the end of decode functions when decoding has been succesful. </p>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00109">109</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00593">DecodeThreadVars_::counter_invalid</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l01041">PKT_IS_INVALID</a>, and <a class="el" href="counters_8c_source.html#l00151">StatsIncr()</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l01844">DecodeAFP()</a>, <a class="el" href="source-erf-dag_8c_source.html#l00612">DecodeErfDag()</a>, <a class="el" href="source-erf-file_8c_source.html#l00276">DecodeErfFile()</a>, <a class="el" href="source-ipfw_8c_source.html#l00441">DecodeIPFW()</a>, <a class="el" href="source-nfq_8c_source.html#l01222">DecodeNFQ()</a>, <a class="el" href="source-pcap_8c_source.html#l00696">DecodePcap()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00406">DecodePcapFile()</a>, <a class="el" href="source-pfring_8c_source.html#l00619">DecodePfring()</a>, and <a class="el" href="source-napatech_8c_source.html#l00347">NapatechDecode()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_cgraph.png" border="0" usemap="#group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_cgraph" alt=""/></div>
<map name="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_cgraph" id="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_cgraph">
<area shape="rect" id="node2" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="208,5,283,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_icgraph.png" border="0" usemap="#group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_icgraph" alt=""/></div>
<map name="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_icgraph" id="group__decode_ga34b0a10ee3a77793bddbc8f8eceb832f_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="223,5,316,32"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="215,56,323,83"/><area shape="rect" id="node10" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="217,107,322,133"/><area shape="rect" id="node12" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="219,157,320,184"/><area shape="rect" id="node14" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="222,208,317,235"/><area shape="rect" id="node16" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="221,259,318,285"/><area shape="rect" id="node18" href="source-pcap-file_8c.html#a41c54f12c157322cb9fb519cf29ee5e6" title="DecodePcapFile" alt="" coords="210,309,329,336"/><area shape="rect" id="node20" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="219,360,320,387"/><area shape="rect" id="node22" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="208,411,331,437"/><area shape="rect" id="node3" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="395,5,597,32"/><area shape="rect" id="node4" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="662,208,797,235"/><area shape="rect" id="node5" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="845,208,944,235"/><area shape="rect" id="node6" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1189,208,1240,235"/><area shape="rect" id="node7" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="992,233,1141,260"/><area shape="rect" id="node9" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="387,56,605,83"/><area shape="rect" id="node11" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="389,107,603,133"/><area shape="rect" id="node13" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="391,157,601,184"/><area shape="rect" id="node15" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="393,208,599,235"/><area shape="rect" id="node17" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="393,259,599,285"/><area shape="rect" id="node19" href="source-pcap-file_8h.html#a2eb0f3cbe2c09246bb9275f85e07806c" title="TmModuleDecodePcapFileRegister" alt="" coords="382,309,610,336"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="391,360,601,387"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="379,411,613,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga6a2a9e86342d10a67ce9178598793597"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* PacketDefragPktSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>proto</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup a pseudo packet (reassembled frags) </p>
<p>Difference with PacketPseudoPktSetup is that this func doesn't increment the recursion level. It needs to be on the same level as the frags because we run the flow engine against this and we need to get the same flow.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>parent packet for this pseudo pkt </td></tr>
    <tr><td class="paramname">pkt</td><td>raw packet data </td></tr>
    <tr><td class="paramname">len</td><td>packet data length </td></tr>
    <tr><td class="paramname">proto</td><td>protocol of the tunneled packet</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">p</td><td>the pseudo packet or NULL if out of memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00327">327</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00518">Packet_::datalink</a>, <a class="el" href="decode_8c_source.html#l00241">PacketCopyData()</a>, <a class="el" href="decode_8c_source.html#l00163">PacketGetFromQueueOrAlloc()</a>, <a class="el" href="decode_8h_source.html#l00388">Packet_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00525">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>, <a class="el" href="decode_8h_source.html#l00849">SET_TUNNEL_PKT</a>, <a class="el" href="decode_8h_source.html#l00542">Packet_::tenant_id</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, <a class="el" href="decode_8h_source.html#l00390">Packet_::vlan_id</a>, and <a class="el" href="decode_8h_source.html#l00391">Packet_::vlan_idx</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga6a2a9e86342d10a67ce9178598793597_cgraph.png" border="0" usemap="#group__decode_ga6a2a9e86342d10a67ce9178598793597_cgraph" alt=""/></div>
<map name="group__decode_ga6a2a9e86342d10a67ce9178598793597_cgraph" id="group__decode_ga6a2a9e86342d10a67ce9178598793597_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="247,5,369,32"/><area shape="rect" id="node4" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="211,56,405,83"/><area shape="rect" id="node3" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="454,5,613,32"/><area shape="rect" id="node5" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="458,56,609,83"/><area shape="rect" id="node6" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="462,107,605,133"/><area shape="rect" id="node7" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="662,107,751,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga23b8b588f6c258541769c1e94347a947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketDefragPktSetupParent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>inform defrag "parent" that a pseudo packet is now assosiated to it. </p>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00363">363</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00913">DecodeSetNoPayloadInspectionFlag</a>, <a class="el" href="decode_8h_source.html#l00849">SET_TUNNEL_PKT</a>, and <a class="el" href="decode_8h_source.html#l00829">TUNNEL_INCR_PKT_TPR</a>.</p>

</div>
</div>
<a class="anchor" id="gadbb7a223135dab327a0f78a96f931889"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketFree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a malloced packet. </p>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00095">95</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00777">PACKET_DESTRUCTOR</a>, and <a class="el" href="util-mem_8h_source.html#l00236">SCFree</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00148">PacketFreeOrRelease()</a>, <a class="el" href="decode_8c_source.html#l00127">PacketGetFromAlloc()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00401">PacketPoolDestroy()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00284">PacketPoolReturnPacket()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gadbb7a223135dab327a0f78a96f931889_icgraph.png" border="0" usemap="#group__decode_gadbb7a223135dab327a0f78a96f931889_icgraph" alt=""/></div>
<map name="group__decode_gadbb7a223135dab327a0f78a96f931889_icgraph" id="group__decode_gadbb7a223135dab327a0f78a96f931889_icgraph">
<area shape="rect" id="node2" href="group__decode.html#gad9ba0322fe2563acde4b409301b9a39d" title="Return a packet to where it was allocated. " alt="" coords="363,558,514,584"/><area shape="rect" id="node7" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="158,659,301,686"/><area shape="rect" id="node48" href="tmqh-packetpool_8h.html#a31e71693c415a1b0f3820cc0c186808d" title="PacketPoolDestroy" alt="" coords="371,760,506,787"/><area shape="rect" id="node50" href="tmqh-packetpool_8h.html#aecfd7fbbc040386dbe6546236b7d20b7" title="Return packet to Packet pool. " alt="" coords="145,608,314,635"/><area shape="rect" id="node3" href="group__afppacket.html#ga06d6e504cb7e3262d6f2a66042fd6570" title="AFPReleasePacket" alt="" coords="591,203,729,230"/><area shape="rect" id="node4" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="820,102,956,128"/><area shape="rect" id="node5" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="1073,107,1197,134"/><area shape="rect" id="node6" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="1299,107,1506,134"/><area shape="rect" id="node8" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="563,380,757,407"/><area shape="rect" id="node41" href="tmqh-packetpool_8h.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="385,684,492,711"/><area shape="rect" id="node9" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="810,456,966,483"/><area shape="rect" id="node25" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597" title="Setup a pseudo packet (reassembled frags) " alt="" coords="810,507,966,534"/><area shape="rect" id="node26" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="849,152,927,179"/><area shape="rect" id="node27" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop. " alt="" coords="820,608,956,635"/><area shape="rect" id="node29" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="822,203,954,230"/><area shape="rect" id="node31" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="814,254,962,280"/><area shape="rect" id="node33" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="812,304,964,331"/><area shape="rect" id="node35" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="823,355,953,382"/><area shape="rect" id="node37" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="822,406,954,432"/><area shape="rect" id="node39" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="806,558,970,584"/><area shape="rect" id="node10" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="1355,368,1451,395"/><area shape="rect" id="node11" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1555,343,1651,370"/><area shape="rect" id="node23" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1081,520,1188,547"/><area shape="rect" id="node12" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="2059,166,2175,192"/><area shape="rect" id="node15" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1728,470,1829,496"/><area shape="rect" id="node13" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="2226,166,2329,192"/><area shape="rect" id="node16" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1731,520,1826,547"/><area shape="rect" id="node17" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1733,64,1824,91"/><area shape="rect" id="node18" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1911,419,2006,446"/><area shape="rect" id="node19" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1699,166,1859,192"/><area shape="rect" id="node22" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1731,216,1826,243"/><area shape="rect" id="node21" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="2076,318,2159,344"/><area shape="rect" id="node14" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2224,368,2331,395"/><area shape="rect" id="node20" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1907,267,2010,294"/><area shape="rect" id="node24" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="1355,520,1451,547"/><area shape="rect" id="node28" href="source-erf-file_8h.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module. " alt="" coords="1025,688,1244,715"/><area shape="rect" id="node30" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="1027,166,1242,192"/><area shape="rect" id="node32" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="1019,216,1250,243"/><area shape="rect" id="node34" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="1060,267,1209,294"/><area shape="rect" id="node36" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="1071,318,1199,344"/><area shape="rect" id="node38" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="1027,368,1242,395"/><area shape="rect" id="node40" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="1029,622,1240,664"/><area shape="rect" id="node42" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1109,807,1160,834"/><area shape="rect" id="node43" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="611,811,709,838"/><area shape="rect" id="node45" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="569,710,751,736"/><area shape="rect" id="node44" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="813,811,963,838"/><area shape="rect" id="node46" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="823,710,953,736"/><area shape="rect" id="node47" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="1075,739,1195,766"/><area shape="rect" id="node49" href="tm-threads_8c.html#a86f906803e6e37b43aed5cf1a37c91ee" title="TmThreadsSlotVar" alt="" coords="595,760,725,787"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad9ba0322fe2563acde4b409301b9a39d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PacketFreeOrRelease </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a packet to where it was allocated. </p>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00148">148</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8c_source.html#l00095">PacketFree()</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00284">PacketPoolReturnPacket()</a>, and <a class="el" href="decode_8h_source.html#l01020">PKT_ALLOC</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l00710">AFPReleasePacket()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gad9ba0322fe2563acde4b409301b9a39d_cgraph.png" border="0" usemap="#group__decode_gad9ba0322fe2563acde4b409301b9a39d_cgraph" alt=""/></div>
<map name="group__decode_gad9ba0322fe2563acde4b409301b9a39d_cgraph" id="group__decode_gad9ba0322fe2563acde4b409301b9a39d_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="425,5,514,32"/><area shape="rect" id="node3" href="tmqh-packetpool_8c.html#aecfd7fbbc040386dbe6546236b7d20b7" title="Return packet to Packet pool. " alt="" coords="206,31,375,57"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gad9ba0322fe2563acde4b409301b9a39d_icgraph.png" border="0" usemap="#group__decode_gad9ba0322fe2563acde4b409301b9a39d_icgraph" alt=""/></div>
<map name="group__decode_gad9ba0322fe2563acde4b409301b9a39d_icgraph" id="group__decode_gad9ba0322fe2563acde4b409301b9a39d_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#ga06d6e504cb7e3262d6f2a66042fd6570" title="AFPReleasePacket" alt="" coords="206,5,343,32"/><area shape="rect" id="node3" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="392,5,528,32"/><area shape="rect" id="node4" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="577,5,701,32"/><area shape="rect" id="node5" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="750,5,957,32"/><area shape="rect" id="node6" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1006,5,1141,32"/><area shape="rect" id="node7" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1189,5,1288,32"/><area shape="rect" id="node8" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1533,5,1584,32"/><area shape="rect" id="node9" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1336,31,1485,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gadd3d2505353dbc2b396776da9afbcd74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* PacketGetFromAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a malloced packet. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">p</td><td>packet, NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00127">127</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l00684">PACKET_INITIALIZE</a>, <a class="el" href="util-profiling_8h_source.html#l00091">PACKET_PROFILING_START</a>, <a class="el" href="decode_8c_source.html#l00095">PacketFree()</a>, <a class="el" href="decode_8h_source.html#l01020">PKT_ALLOC</a>, <a class="el" href="decode_8h_source.html#l00431">Packet_::ReleasePacket</a>, <a class="el" href="util-debug_8h_source.html#l00306">SCLogDebug</a>, <a class="el" href="util-mem_8h_source.html#l00174">SCMalloc</a>, <a class="el" href="decode_8h_source.html#l00566">SIZE_OF_PACKET</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="decode_8c_source.html#l00163">PacketGetFromQueueOrAlloc()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00364">PacketPoolInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gadd3d2505353dbc2b396776da9afbcd74_cgraph.png" border="0" usemap="#group__decode_gadd3d2505353dbc2b396776da9afbcd74_cgraph" alt=""/></div>
<map name="group__decode_gadd3d2505353dbc2b396776da9afbcd74_cgraph" id="group__decode_gadd3d2505353dbc2b396776da9afbcd74_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="198,5,287,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gadd3d2505353dbc2b396776da9afbcd74_icgraph.png" border="0" usemap="#group__decode_gadd3d2505353dbc2b396776da9afbcd74_icgraph" alt=""/></div>
<map name="group__decode_gadd3d2505353dbc2b396776da9afbcd74_icgraph" id="group__decode_gadd3d2505353dbc2b396776da9afbcd74_icgraph">
<area shape="rect" id="node2" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="197,764,392,791"/><area shape="rect" id="node47" href="tmqh-packetpool_8h.html#a56fafc07686d12d34251bbc629005441" title="PacketPoolInit" alt="" coords="1207,992,1313,1019"/><area shape="rect" id="node3" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="445,499,601,525"/><area shape="rect" id="node22" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597" title="Setup a pseudo packet (reassembled frags) " alt="" coords="445,688,601,715"/><area shape="rect" id="node23" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="483,941,562,968"/><area shape="rect" id="node30" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="455,891,591,917"/><area shape="rect" id="node31" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop. " alt="" coords="691,637,827,664"/><area shape="rect" id="node33" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="693,688,825,715"/><area shape="rect" id="node35" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="685,967,833,993"/><area shape="rect" id="node37" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="447,739,599,765"/><area shape="rect" id="node40" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="457,789,588,816"/><area shape="rect" id="node43" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="457,840,589,867"/><area shape="rect" id="node45" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="441,393,605,420"/><area shape="rect" id="node4" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="980,448,1076,475"/><area shape="rect" id="node5" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1212,359,1308,385"/><area shape="rect" id="node20" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="705,499,812,525"/><area shape="rect" id="node6" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1807,181,1923,208"/><area shape="rect" id="node12" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1417,485,1519,512"/><area shape="rect" id="node10" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1977,131,2079,157"/><area shape="rect" id="node13" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1421,536,1515,563"/><area shape="rect" id="node14" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1423,5,1513,32"/><area shape="rect" id="node15" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1818,384,1913,411"/><area shape="rect" id="node16" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1388,232,1548,259"/><area shape="rect" id="node19" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1635,157,1730,184"/><area shape="rect" id="node18" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1824,333,1907,360"/><area shape="rect" id="node11" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1975,384,2081,411"/><area shape="rect" id="node17" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1631,283,1734,309"/><area shape="rect" id="node7" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1981,308,2075,335"/><area shape="rect" id="node8" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1974,181,2082,208"/><area shape="rect" id="node9" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1975,232,2081,259"/><area shape="rect" id="node21" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="980,499,1076,525"/><area shape="rect" id="node24" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="697,891,821,917"/><area shape="rect" id="node25" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="925,891,1131,917"/><area shape="rect" id="node26" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1193,815,1327,841"/><area shape="rect" id="node27" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="1419,891,1517,917"/><area shape="rect" id="node28" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1840,916,1891,943"/><area shape="rect" id="node29" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1608,865,1757,892"/><area shape="rect" id="node32" href="source-erf-file_8h.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module. " alt="" coords="919,637,1137,664"/><area shape="rect" id="node34" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="921,688,1135,715"/><area shape="rect" id="node36" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="913,955,1143,981"/><area shape="rect" id="node38" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="684,739,833,765"/><area shape="rect" id="node39" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="913,739,1143,765"/><area shape="rect" id="node41" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="695,789,823,816"/><area shape="rect" id="node42" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="923,789,1133,816"/><area shape="rect" id="node44" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="921,840,1135,867"/><area shape="rect" id="node46" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="653,331,864,373"/><area shape="rect" id="node48" href="tm-threads_8c.html#ae587bc031308c4d760fd6441136ad684" title="TmThreadsSlotPktAcqLoop" alt="" coords="1377,1017,1559,1044"/><area shape="rect" id="node49" href="tm-threads_8c.html#a25369baa1a83811c880d10bf95cad079" title="We set the slot functions. " alt="" coords="1617,1017,1748,1044"/><area shape="rect" id="node50" href="tm-threads_8c.html#af78474ba8e49604c9cf705c57cc95f51" title="Creates and returns the TV instance for a new thread. " alt="" coords="1805,1017,1925,1044"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gab9517a36d0462938ef712e5e6640d5f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* PacketGetFromQueueOrAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packet that is free'd again after processing. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">p</td><td>packet, NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00163">163</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="util-profiling_8h_source.html#l00091">PACKET_PROFILING_START</a>, <a class="el" href="decode_8c_source.html#l00127">PacketGetFromAlloc()</a>, and <a class="el" href="tmqh-packetpool_8c_source.html#l00244">PacketPoolGetPacket()</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l00531">AFPRead()</a>, <a class="el" href="source-af-packet_8c_source.html#l00725">AFPReadFromRing()</a>, <a class="el" href="source-napatech_8c_source.html#l00181">NapatechStreamLoop()</a>, <a class="el" href="decode_8c_source.html#l00327">PacketDefragPktSetup()</a>, <a class="el" href="decode_8c_source.html#l00257">PacketTunnelPktSetup()</a>, <a class="el" href="source-pcap_8c_source.html#l00230">PcapCallbackLoop()</a>, <a class="el" href="source-pcap-file_8c_source.html#l00141">PcapFileCallbackLoop()</a>, <a class="el" href="source-erf-file_8c_source.html#l00111">ReceiveErfFileLoop()</a>, <a class="el" href="source-ipfw_8c_source.html#l00227">ReceiveIPFWLoop()</a>, <a class="el" href="source-pfring_8c_source.html#l00295">ReceivePfringLoop()</a>, and <a class="el" href="stream-tcp_8c_source.html#l05763">StreamTcpPseudoSetup()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gab9517a36d0462938ef712e5e6640d5f6_cgraph.png" border="0" usemap="#group__decode_gab9517a36d0462938ef712e5e6640d5f6_cgraph" alt=""/></div>
<map name="group__decode_gab9517a36d0462938ef712e5e6640d5f6_cgraph" id="group__decode_gab9517a36d0462938ef712e5e6640d5f6_cgraph">
<area shape="rect" id="node2" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="253,5,395,32"/><area shape="rect" id="node4" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="249,56,399,83"/><area shape="rect" id="node3" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="449,5,538,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_gab9517a36d0462938ef712e5e6640d5f6_icgraph.png" border="0" usemap="#group__decode_gab9517a36d0462938ef712e5e6640d5f6_icgraph" alt=""/></div>
<map name="group__decode_gab9517a36d0462938ef712e5e6640d5f6_icgraph" id="group__decode_gab9517a36d0462938ef712e5e6640d5f6_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#gab08fbe1f470fc39a5f8844a5a597efd0" title="AF packet read function. " alt="" coords="291,107,370,133"/><area shape="rect" id="node7" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="263,183,399,209"/><area shape="rect" id="node8" href="source-napatech_8c.html#af426c67ce4670e8c4266a31c7744a657" title="Main Napatech reading Loop function. " alt="" coords="493,107,641,133"/><area shape="rect" id="node10" href="group__decode.html#ga6a2a9e86342d10a67ce9178598793597" title="Setup a pseudo packet (reassembled frags) " alt="" coords="253,284,409,311"/><area shape="rect" id="node11" href="group__decode.html#ga289ef60badcd4b221fadd90590249d15" title="Setup a pseudo packet (tunnel) " alt="" coords="253,385,409,412"/><area shape="rect" id="node38" href="source-pcap_8c.html#ac1ee449a092f7f009db6f26dcd4a470c" title="PcapCallbackLoop" alt="" coords="771,537,901,564"/><area shape="rect" id="node41" href="source-pcap-file_8c.html#a934a648259c10e7b63e9c5ccc923d0c0" title="PcapFileCallbackLoop" alt="" coords="760,487,912,513"/><area shape="rect" id="node43" href="source-erf-file_8c.html#ac0c39d17d88901a47a891a8c36ee7f80" title="ERF file reading loop. " alt="" coords="1036,588,1172,615"/><area shape="rect" id="node45" href="source-ipfw_8c.html#ad609efbfa3aadd46968c866b93ed3542" title="ReceiveIPFWLoop" alt="" coords="1299,1120,1431,1147"/><area shape="rect" id="node47" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="501,5,633,32"/><area shape="rect" id="node49" href="stream-tcp_8h.html#a160c3587cec73107189ae0e0913726bf" title="Function to fetch a packet from the packet allocation queue for creation of the pseudo packet from th..." alt="" coords="249,693,413,720"/><area shape="rect" id="node3" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="505,56,629,83"/><area shape="rect" id="node4" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="1001,56,1207,83"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="2459,867,2594,893"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2643,867,2741,893"/><area shape="rect" id="node9" href="source-napatech_8h.html#aeb949c5f1845fff47c31c10691181258" title="Register the Napatech receiver (reader) module. " alt="" coords="721,107,951,133"/><area shape="rect" id="node12" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="788,335,884,361"/><area shape="rect" id="node13" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="1056,436,1152,463"/><area shape="rect" id="node36" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="513,436,620,463"/><area shape="rect" id="node14" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1787,588,1903,615"/><area shape="rect" id="node26" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="1315,897,1416,924"/><area shape="rect" id="node20" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1990,816,2093,843"/><area shape="rect" id="node28" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="1318,771,1413,797"/><area shape="rect" id="node30" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="1800,411,1891,437"/><area shape="rect" id="node31" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1798,259,1893,285"/><area shape="rect" id="node32" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="1285,461,1445,488"/><area shape="rect" id="node35" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1798,309,1893,336"/><area shape="rect" id="node34" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1804,360,1887,387"/><area shape="rect" id="node19" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="2241,360,2348,387"/><area shape="rect" id="node33" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="1579,461,1682,488"/><area shape="rect" id="node15" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1995,309,2088,336"/><area shape="rect" id="node16" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1987,664,2095,691"/><area shape="rect" id="node17" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1989,715,2094,741"/><area shape="rect" id="node18" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1980,563,2103,589"/><area shape="rect" id="node21" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1993,360,2090,387"/><area shape="rect" id="node22" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1991,765,2092,792"/><area shape="rect" id="node23" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1980,613,2103,640"/><area shape="rect" id="node24" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1952,411,2131,437"/><area shape="rect" id="node25" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="2179,816,2410,843"/><area shape="rect" id="node27" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="2189,917,2400,944"/><area shape="rect" id="node29" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="1528,819,1733,845"/><area shape="rect" id="node37" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="788,436,884,463"/><area shape="rect" id="node39" href="source-pcap_8c.html#ab9fbe81fa4e8aae368fdf57d6db5ee4d" title="Main PCAP reading Loop function. " alt="" coords="1040,537,1168,564"/><area shape="rect" id="node40" href="source-pcap_8h.html#a3f3510c3241770c5b3cd8fb6df1c4c6c" title="Registration Function for RecievePcap. " alt="" coords="1525,1019,1736,1045"/><area shape="rect" id="node42" href="source-pcap-file_8c.html#a6feffffa554a28df067ada0ebcc0db1d" title="Main PCAP file reading Loop function. " alt="" coords="1029,487,1179,513"/><area shape="rect" id="node44" href="source-erf-file_8h.html#aa33fce1981c0cd8d648f1a1beeab14cd" title="Register the ERF file receiver (reader) module. " alt="" coords="1256,1069,1475,1096"/><area shape="rect" id="node46" href="source-ipfw_8h.html#a6a7cdbd6450ac4a9b69c5994212d3b4b" title="Registration Function for RecieveIPFW. " alt="" coords="1523,1120,1738,1147"/><area shape="rect" id="node48" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="2187,5,2402,32"/><area shape="rect" id="node50" href="stream-tcp_8c.html#ad855fab70c5359eb4d6e2671925fdaa4" title="Create a pseudo packet injected into the engine to signal the opposing direction of this stream to wr..." alt="" coords="461,690,672,731"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1b2af622dbb515f30ce521db6c3a93c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PacketSetData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pktdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pktlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set data for Packet and set length when zeo copy is used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Pointer</td><td>to the Packet to modify </td></tr>
    <tr><td class="paramname">Pointer</td><td>to the data </td></tr>
    <tr><td class="paramname">Length</td><td>of the data </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00506">506</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00494">Packet_::ext_pkt</a>, <a class="el" href="decode_8h_source.html#l00398">Packet_::flags</a>, <a class="el" href="decode_8h_source.html#l01035">PKT_ZERO_COPY</a>, <a class="el" href="decode_8h_source.html#l00218">SET_PKT_LEN</a>, and <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>.</p>

<p>Referenced by <a class="el" href="source-af-packet_8c_source.html#l00725">AFPReadFromRing()</a>, <a class="el" href="source-nfq_8c_source.html#l00413">NFQSetupPkt()</a>, and <a class="el" href="source-pfring_8c_source.html#l00295">ReceivePfringLoop()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga1b2af622dbb515f30ce521db6c3a93c9_icgraph.png" border="0" usemap="#group__decode_ga1b2af622dbb515f30ce521db6c3a93c9_icgraph" alt=""/></div>
<map name="group__decode_ga1b2af622dbb515f30ce521db6c3a93c9_icgraph" id="group__decode_ga1b2af622dbb515f30ce521db6c3a93c9_icgraph">
<area shape="rect" id="node2" href="group__afppacket.html#gadcd185d5bd2d2529761199165612cad5" title="AF packet read function for ring. " alt="" coords="165,5,301,32"/><area shape="rect" id="node9" href="source-nfq_8c.html#a685bd5abf241e1e7281beeb512567e0f" title="Read data from nfq message and setup Packet. " alt="" coords="181,56,285,83"/><area shape="rect" id="node10" href="source-pfring_8c.html#a167659c0da5f077f562bca0ef8acc47c" title="Recieves packets from an interface via libpfring. " alt="" coords="350,81,482,108"/><area shape="rect" id="node3" href="group__afppacket.html#ga47336052bf58297a6dc5dbc7ac7da790" title="Main AF_PACKET reading Loop function. " alt="" coords="354,9,478,36"/><area shape="rect" id="node4" href="group__afppacket.html#ga125f047940f8ff0ea8f5295cd2ce7f3e" title="Registration Function for RecieveAFP. " alt="" coords="535,21,742,48"/><area shape="rect" id="node5" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="795,51,930,77"/><area shape="rect" id="node6" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="979,51,1077,77"/><area shape="rect" id="node7" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="1323,51,1373,77"/><area shape="rect" id="node8" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="1125,76,1275,103"/><area shape="rect" id="node11" href="source-pfring_8h.html#a9de1117ec94d507f460b0ae08ac9036f" title="Registration Function for RecievePfring. " alt="" coords="531,79,746,105"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga289ef60badcd4b221fadd90590249d15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a>* PacketTunnelPktSetup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="threadvars_8h.html#acfe16eec231bc01ff6bc0492d44667c5">ThreadVars</a> *&#160;</td>
          <td class="paramname"><em>tv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#aac7da5e273ff96206f6b040cda006435">DecodeThreadVars</a> *&#160;</td>
          <td class="paramname"><em>dtv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#a54892c47a6b692461f50aaeb3a9c16ae">Packet</a> *&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="decode_8h.html#a6bb493f9ee8010c70ce6c3858f5a0815">DecodeTunnelProto</a>&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="decode_8h.html#ad8061e05d03a459b22619ac247b716a5">PacketQueue</a> *&#160;</td>
          <td class="paramname"><em>pq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup a pseudo packet (tunnel) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>parent packet for this pseudo pkt </td></tr>
    <tr><td class="paramname">pkt</td><td>raw packet data </td></tr>
    <tr><td class="paramname">len</td><td>packet data length </td></tr>
    <tr><td class="paramname">proto</td><td>protocol of the tunneled packet</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">p</td><td>the pseudo packet or NULL if out of memory </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="decode_8c_source.html#l00257">257</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00518">Packet_::datalink</a>, <a class="el" href="decode_8h_source.html#l00913">DecodeSetNoPayloadInspectionFlag</a>, <a class="el" href="decode_8c_source.html#l00069">DecodeTunnel()</a>, <a class="el" href="decode_8h_source.html#l00214">GET_PKT_DATA</a>, <a class="el" href="decode_8h_source.html#l00213">GET_PKT_LEN</a>, <a class="el" href="decode_8c_source.html#l00241">PacketCopyData()</a>, <a class="el" href="decode_8c_source.html#l00163">PacketGetFromQueueOrAlloc()</a>, <a class="el" href="decode_8h_source.html#l00388">Packet_::recursion_level</a>, <a class="el" href="decode_8h_source.html#l00525">Packet_::root</a>, <a class="el" href="util-debug_8h_source.html#l00308">SCEnter</a>, <a class="el" href="util-debug_8h_source.html#l00324">SCReturnPtr</a>, <a class="el" href="decode_8h_source.html#l00849">SET_TUNNEL_PKT</a>, <a class="el" href="decode_8h_source.html#l00542">Packet_::tenant_id</a>, <a class="el" href="tm-threads-common_8h_source.html#l00119">TM_ECODE_OK</a>, <a class="el" href="tmqh-packetpool_8c_source.html#l00443">TmqhOutputPacketpool()</a>, <a class="el" href="decode_8h_source.html#l00402">Packet_::ts</a>, <a class="el" href="decode_8h_source.html#l00829">TUNNEL_INCR_PKT_TPR</a>, <a class="el" href="util-optimize_8h_source.html#l00035">unlikely</a>, and <a class="el" href="decode_8h_source.html#l00850">UNSET_TUNNEL_PKT</a>.</p>

<p>Referenced by <a class="el" href="decode-gre_8c_source.html#l00046">DecodeGRE()</a>, <a class="el" href="decode-ipv4_8c_source.html#l00520">DecodeIPV4()</a>, and <a class="el" href="decode-teredo_8c_source.html#l00047">DecodeTeredo()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga289ef60badcd4b221fadd90590249d15_cgraph.png" border="0" usemap="#group__decode_ga289ef60badcd4b221fadd90590249d15_cgraph" alt=""/></div>
<map name="group__decode_ga289ef60badcd4b221fadd90590249d15_cgraph" id="group__decode_ga289ef60badcd4b221fadd90590249d15_cgraph">
<area shape="rect" id="node2" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="255,820,361,847"/><area shape="rect" id="node41" href="group__decode.html#gac6e35d6641ed3e55adc0ac5ea698fe4a" title="Copy data to Packet payload and set packet length. " alt="" coords="247,1104,369,1131"/><area shape="rect" id="node43" href="group__decode.html#gab9517a36d0462938ef712e5e6640d5f6" title="Get a packet. We try to get a packet from the packetpool first, but if that is empty we alloc a packe..." alt="" coords="211,1168,405,1195"/><area shape="rect" id="node47" href="tmqh-packetpool_8c.html#a7459d4fb3fb4e341f4644fac509e3463" title="TmqhOutputPacketpool" alt="" coords="229,1224,387,1251"/><area shape="rect" id="node3" href="decode-erspan_8c.html#af55b5b63849ebbbc396d3b4f97d5b9c9" title="Function to decode ERSPAN packets. " alt="" coords="476,820,599,847"/><area shape="rect" id="node4" href="decode-ethernet_8c.html#ac1afbb2de3c48f5e55238a68a80c1a28" title="DecodeEthernet" alt="" coords="719,755,835,782"/><area shape="rect" id="node5" href="decode-ipv4_8c.html#ad21e971ed8a39cbd704e59c535c09696" title="DecodeIPV4" alt="" coords="1307,775,1403,802"/><area shape="rect" id="node33" href="decode-ipv6_8c.html#a82f0d48b6022ab2630da21d3b0fa0542" title="DecodeIPV6" alt="" coords="1307,662,1403,688"/><area shape="rect" id="node40" href="decode-ppp_8c.html#aa1cb8247d5f82507327372a9af7daa71" title="DecodePPP" alt="" coords="1125,952,1219,979"/><area shape="rect" id="node39" href="decode-vlan_8c.html#a2f04a35b7ddf4f8443df460cd18c583e" title="DecodeVLAN" alt="" coords="934,560,1037,587"/><area shape="rect" id="node8" href="counters_8c.html#aec6ddff16e99087dbf6c4b13f7aa5ab6" title="Increments the local counter. " alt="" coords="1911,724,1985,751"/><area shape="rect" id="node36" href="decode-mpls_8c.html#aa91e2972618ccbcaf595ab1072eec718" title="DecodeMPLS" alt="" coords="1121,814,1223,840"/><area shape="rect" id="node37" href="decode-pppoe_8c.html#a07b9952ea991dac758976e25fa90033a" title="Main decoding function for PPPOE Discovery packets. " alt="" coords="1086,440,1258,467"/><area shape="rect" id="node38" href="decode-pppoe_8c.html#aac0b8cb4381233c884de7320889b0571" title="Main decoding function for PPPOE Session packets. " alt="" coords="1092,611,1252,638"/><area shape="rect" id="node6" href="decode-gre_8c.html#a53db4a10141df6f438736b5409933569" title="Function to decode GRE packets. " alt="" coords="1675,1231,1771,1258"/><area shape="rect" id="node9" href="decode-icmpv4_8c.html#ab06bf50acf1abcea5e85f31d66fcad5c" title="Main ICMPv4 decoding function. " alt="" coords="1465,319,1583,346"/><area shape="rect" id="node18" href="decode-sctp_8c.html#a10d4d580215e385f2ae1dfbc18d96e56" title="DecodeSCTP" alt="" coords="1473,674,1575,700"/><area shape="rect" id="node19" href="decode-tcp_8c.html#a8bc5a8474325211e3c8dcbf49362a22e" title="DecodeTCP" alt="" coords="1477,572,1571,599"/><area shape="rect" id="node20" href="decode-udp_8c.html#aa315124ac688837f31bded8b253e7d62" title="DecodeUDP" alt="" coords="1476,775,1572,802"/><area shape="rect" id="node30" href="defrag_8c.html#a0887ef3b129e978f0d27b469c68eb2ba" title="Entry point for IPv4 and IPv6 fragments. " alt="" coords="1493,826,1555,852"/><area shape="rect" id="node7" href="packet-queue_8c.html#a1ab70c26cf76410d008c664031a2ced2" title="PacketEnqueue" alt="" coords="1891,1206,2005,1232"/><area shape="rect" id="node11" href="util-print_8c.html#a90bfafc4dfabddab2662c4b7bf6f7d03" title="PrintInet" alt="" coords="1913,91,1983,118"/><area shape="rect" id="node32" href="util-debug_8c.html#ab793aa1c0db8ab4c177d80f79c085297" title="Returns whether debug messages are enabled to be logged or not. " alt="" coords="1451,724,1597,751"/><area shape="rect" id="node10" href="decode-icmpv4_8c.html#a1bcac56d7695147a538006f6c2d386ad" title="DecodePartialIPV4" alt="" coords="1656,167,1789,194"/><area shape="rect" id="node13" href="flow_8c.html#a630858d075864b1b8693caf370fa8e00" title="Entry point for packet flow handling. " alt="" coords="1657,218,1789,244"/><area shape="rect" id="node12" href="win32-misc_8h.html#a8b4e65d5530474709182ee0d9faa6dda" title="inet_ntop" alt="" coords="2167,91,2241,118"/><area shape="rect" id="node14" href="flow-hash_8c.html#ab9b72607bceec0064346afce2f6cbdd1" title="Get Flow for packet. " alt="" coords="1868,142,2028,168"/><area shape="rect" id="node16" href="flow_8c.html#a3d88a8d5aee8f279280f3d7976a15a61" title="Update Packet and Flow. " alt="" coords="1861,206,2035,232"/><area shape="rect" id="node15" href="flow-util_8c.html#ab860700383c3811a4aaf74b2cfd1de05" title="FlowInit" alt="" coords="2170,142,2238,168"/><area shape="rect" id="node17" href="flow_8c.html#a6f7e81aaf61a41cdaa7cbb87d8964122" title="determine the direction of the packet compared to the flow " alt="" coords="2122,192,2286,219"/><area shape="rect" id="node21" href="app-layer_8c.html#ad71bacf418c62589d8da38247850e10f" title="Handle a app layer UDP message. " alt="" coords="1651,268,1794,295"/><area shape="rect" id="node29" href="decode-teredo_8c.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="1669,1130,1776,1156"/><area shape="rect" id="node22" href="app-layer-parser_8c.html#a5a66dce8dbc099890c70dc69b2bbc608" title="AppLayerParserParse" alt="" coords="1873,294,2023,320"/><area shape="rect" id="node28" href="app-layer-detect-proto_8c.html#a66d46449e14e7c771daca31e94c88ec1" title="Returns the app layer protocol given a buffer. " alt="" coords="1849,344,2047,371"/><area shape="rect" id="node23" href="app-layer_8c.html#aee0b3432de6ed541981bdf337c841782" title="Given the internal protocol id, returns a string representation of the protocol. " alt="" coords="2122,446,2286,472"/><area shape="rect" id="node24" href="app-layer-parser_8c.html#aa72062e79f18f6d030db0ce26eb54307" title="AppLayerParserSetEOF" alt="" coords="2123,243,2285,270"/><area shape="rect" id="node26" href="app-layer-parser_8c.html#a473dd94cc4eaaa2c2189f6ac6af19590" title="AppLayerParserStateAlloc" alt="" coords="2117,294,2291,320"/><area shape="rect" id="node25" href="app-layer-parser_8c.html#a46f6694519727b6264e667a2048ff5e9" title="AppLayerParserStateSetFlag" alt="" coords="2361,294,2551,320"/><area shape="rect" id="node27" href="app-layer-parser_8c.html#a57e41a543e96435dcb36fac0b18a2b76" title="AppLayerParserStreamTruncated" alt="" coords="2097,395,2311,422"/><area shape="rect" id="node31" href="defrag-hash_8c.html#a31638db8974dd1ef93586526a8b8b1fd" title="DefragTrackerRelease" alt="" coords="1646,775,1799,802"/><area shape="rect" id="node34" href="decode-icmpv6_8c.html#abf958842b8ab82927b35fec37813be8f" title="Decode ICMPV6 packets and fill the Packet with the decoded info. " alt="" coords="1465,268,1583,295"/><area shape="rect" id="node35" href="decode-icmpv6_8c.html#a77763bde0c82ec50dd179f10478fee74" title="Get variables and do some checks of the embedded IPV6 packet. " alt="" coords="1656,116,1789,143"/><area shape="rect" id="node42" href="group__decode.html#ga4fcac3c41c0cab4466ac184d2719e24e" title="Copy data to Packet payload at given offset. " alt="" coords="458,1079,617,1106"/><area shape="rect" id="node44" href="group__decode.html#gadd3d2505353dbc2b396776da9afbcd74" title="Get a malloced packet. " alt="" coords="466,1180,609,1207"/><area shape="rect" id="node46" href="tmqh-packetpool_8c.html#a144d5e3c9b77c7b9fb4a8c369d7dd8cc" title="Get a new packet from the packet pool. " alt="" coords="462,1130,613,1156"/><area shape="rect" id="node45" href="group__decode.html#gadbb7a223135dab327a0f78a96f931889" title="Return a malloced packet. " alt="" coords="733,1180,822,1207"/><area shape="rect" id="node48" href="stream-tcp-reassemble_8c.html#afe50d83dc6803121f9a01ed920e7f6b1" title="Remove idle TcpSegments from TcpSession. " alt="" coords="454,1231,621,1258"/><area shape="rect" id="node49" href="stream-tcp-reassemble_8c.html#a11fcdabd0f9f4889f7b15cd098e28c00" title="Function to return the segment back to the pool. " alt="" coords="670,1231,885,1258"/><area shape="rect" id="node50" href="group__utilpool.html#ga6552ceb7e157bc1ccc9de8bc33c0528e" title="PoolReturn" alt="" coords="942,1231,1029,1258"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__decode_ga289ef60badcd4b221fadd90590249d15_icgraph.png" border="0" usemap="#group__decode_ga289ef60badcd4b221fadd90590249d15_icgraph" alt=""/></div>
<map name="group__decode_ga289ef60badcd4b221fadd90590249d15_icgraph" id="group__decode_ga289ef60badcd4b221fadd90590249d15_icgraph">
<area shape="rect" id="node2" href="decode_8h.html#a521419ba999cb4758e74fa21f021cbef" title="Function to decode GRE packets. " alt="" coords="365,296,461,323"/><area shape="rect" id="node3" href="decode_8h.html#a7f31196d1cd88c8133fb4656dc78e1bd" title="DecodeIPV4" alt="" coords="531,296,627,323"/><area shape="rect" id="node36" href="decode-teredo_8h.html#a790ad61958f0ed71e2587689c4a0a625" title="Function to decode Teredo packets. " alt="" coords="211,347,317,373"/><area shape="rect" id="node4" href="decode_8h.html#ae757db8ee52f5be0ff2821688334952f" title="DecodeEthernet" alt="" coords="1163,499,1279,525"/><area shape="rect" id="node26" href="source-ipfw_8c.html#aff41eec89b2fa3b70bc09a9bdfcea306" title="This function passes off to link type decoders. " alt="" coords="725,245,827,272"/><area shape="rect" id="node17" href="decode_8h.html#a0c75ef88ccdbe3c0df34f350ed1e032c" title="DecodeMPLS" alt="" coords="1366,245,1469,272"/><area shape="rect" id="node28" href="source-nfq_8c.html#a7ff150b157e75ee5d9ecf69428d86bab" title="Decode a packet coming from NFQ. " alt="" coords="729,144,823,171"/><area shape="rect" id="node30" href="decode_8h.html#a46a9ea30bc854963d0a96973d549b6b6" title="DecodeNull" alt="" coords="964,904,1055,931"/><area shape="rect" id="node31" href="decode_8h.html#a99dbd5a218dfd26395ba5cfdad281b25" title="DecodePPP" alt="" coords="1174,651,1269,677"/><area shape="rect" id="node32" href="decode_8h.html#aeeb1c6b240a0451183f492c97c472f75" title="Main decoding function for PPPOE Session packets. " alt="" coords="696,499,856,525"/><area shape="rect" id="node35" href="decode_8h.html#ad6fc587c40fd8d1bace41472f5e26011" title="DecodeRaw" alt="" coords="1174,752,1269,779"/><area shape="rect" id="node34" href="decode_8h.html#ad4bd1f7377175ca5a86169d41fa82f0c" title="DecodeSll" alt="" coords="1180,701,1263,728"/><area shape="rect" id="node16" href="group__decode.html#ga3d5a53f9af62c80797e8095c7e95e947" title="DecodeTunnel" alt="" coords="1619,347,1725,373"/><area shape="rect" id="node33" href="decode_8h.html#a6e6385134dd2185e197e71cf14f539d7" title="DecodeVLAN" alt="" coords="958,448,1061,475"/><area shape="rect" id="node5" href="group__afppacket.html#gafcbf7219ec47e4cc77337c9f314836e7" title="This function passes off to link type decoders. " alt="" coords="1371,701,1464,728"/><area shape="rect" id="node11" href="source-erf-dag_8c.html#afca2cd02f51930712b129fc69947b7e5" title="This function passes off to link type decoders. " alt="" coords="1363,600,1471,627"/><area shape="rect" id="node13" href="source-erf-file_8c.html#a25f55aa3160c3f3e2401ff59a1bf0006" title="Decode the ERF file. " alt="" coords="1365,549,1470,576"/><area shape="rect" id="node15" href="decode_8h.html#a264209b4296a1f54359b9fde4a34c407" title="Function to decode ERSPAN packets. " alt="" coords="1356,397,1479,424"/><area shape="rect" id="node18" href="source-pcap_8c.html#a4472b637a70511616e225fa8563d03bb" title="This function passes off to link type decoders. " alt="" coords="1369,803,1466,829"/><area shape="rect" id="node20" href="source-pfring_8c.html#a915feec31d0e3f61cfdc47b15d4201eb" title="This function passes off to link type decoders. " alt="" coords="1367,499,1468,525"/><area shape="rect" id="node22" href="source-napatech_8c.html#a96df81e27da7d60754c92162338c8c3f" title="This function passes off to link type decoders. " alt="" coords="1356,448,1479,475"/><area shape="rect" id="node24" href="source-pcap-file_8c.html#a6fe91932d9ed6fee895232a82f65fdda" title="ReceivePcapFileThreadInit" alt="" coords="1328,752,1507,779"/><area shape="rect" id="node6" href="group__afppacket.html#ga5619eeb40186e176637afb0b010dfd52" title="Registration Function for DecodeAFP. " alt="" coords="1571,657,1773,684"/><area shape="rect" id="node7" href="suricata_8c.html#a0244eab618439c8cf7e02cd267bb1476" title="RegisterAllModules" alt="" coords="1838,549,1973,576"/><area shape="rect" id="node8" href="runmode-unittests_8h.html#af4ef6e372fa252edddd5b1fad38813cd" title="RunUnittests" alt="" coords="2021,549,2120,576"/><area shape="rect" id="node9" href="suricata_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="2365,549,2416,576"/><area shape="rect" id="node10" href="suricata_8c.html#ad351743ba4aecaae3b9b47da48566748" title="StartInternalRunMode" alt="" coords="2168,575,2317,601"/><area shape="rect" id="node12" href="source-erf-dag_8h.html#aa47bd0f6507811ee5e58ddbabe5a9e66" title="Register the ERF file decoder module. " alt="" coords="1563,600,1781,627"/><area shape="rect" id="node14" href="source-erf-file_8h.html#a5d63afd9d35d0b55b8ccf9786f4b3119" title="Register the ERF file decoder module. " alt="" coords="1565,549,1779,576"/><area shape="rect" id="node19" href="source-pcap_8h.html#a60c81766c6d86f298c28b7e6afd4bf93" title="Registration Function for DecodePcap. " alt="" coords="1569,796,1775,823"/><area shape="rect" id="node21" href="source-pfring_8h.html#aa66fd20b9ff077eeceaa3b651c66c74d" title="Registration Function for DecodePfring. " alt="" coords="1567,499,1777,525"/><area shape="rect" id="node23" href="source-napatech_8h.html#a3c6286bd204f451242392057ef46bc52" title="Register the Napatech decoder module. " alt="" coords="1555,448,1789,475"/><area shape="rect" id="node25" href="source-pcap-file_8h.html#a11a753284083f1df62c9709579f10ffb" title="TmModuleReceivePcapFileRegister" alt="" coords="1557,720,1787,747"/><area shape="rect" id="node27" href="source-ipfw_8h.html#a7ce5e29608a3a5fdbb24698934ccc066" title="Registration Function for DecodeIPFW. " alt="" coords="904,245,1115,272"/><area shape="rect" id="node29" href="source-nfq_8c.html#aae0ce2a417f5740d558f3489af38f402" title="TmModuleDecodeNFQRegister" alt="" coords="907,144,1112,171"/><area shape="rect" id="node37" href="decode_8h.html#a57055d07a01f1dc95b9d6e4ee101b052" title="DecodeUDP" alt="" coords="365,347,461,373"/><area shape="rect" id="node38" href="decode_8h.html#ae8378247ce97b52c75938e7ac548495f" title="DecodeIPV6" alt="" coords="531,524,627,551"/><area shape="rect" id="node39" href="decode-template_8c.html#af6cb1d2778038e00d46d7cde8f21f419" title="Function to decode XXX packets. " alt="" coords="510,347,647,373"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="gad9efa0fb28aaf19e0bcc56f12534bb14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* PktSrcToString </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="decode_8h.html#aefc62937f305eb5e11ff205a5fd056b0">PktSrcEnum</a>&#160;</td>
          <td class="paramname"><em>pkt_src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="decode_8c_source.html#l00518">518</a> of file <a class="el" href="decode_8c_source.html">decode.c</a>.</p>

<p>References <a class="el" href="decode_8h_source.html#l00049">PKT_SRC_DECODER_GRE</a>, <a class="el" href="decode_8h_source.html#l00050">PKT_SRC_DECODER_IPV4</a>, <a class="el" href="decode_8h_source.html#l00051">PKT_SRC_DECODER_IPV6</a>, <a class="el" href="decode_8h_source.html#l00052">PKT_SRC_DECODER_TEREDO</a>, <a class="el" href="decode_8h_source.html#l00053">PKT_SRC_DEFRAG</a>, <a class="el" href="decode_8h_source.html#l00055">PKT_SRC_FFR</a>, <a class="el" href="decode_8h_source.html#l00054">PKT_SRC_STREAM_TCP_STREAM_END_PSEUDO</a>, and <a class="el" href="decode_8h_source.html#l00048">PKT_SRC_WIRE</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Nov 25 2015 05:53:17 for suricata by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
